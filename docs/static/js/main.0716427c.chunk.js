(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{268:function(e,t,n){e.exports=n(457)},273:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},372:function(e,t,n){},381:function(e,t,n){},382:function(e,t,n){},383:function(e,t,n){},384:function(e,t,n){},456:function(e,t,n){},457:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(46),l=n.n(o),i=(n(273),n(8)),s=n(9),c=n(12),u=n(10),m=n(11),h=(n(274),n(468)),d=n(167),p=n(476),v=n(474),f=n(477),g=(n(275),n(276),n(35)),y=n(25),b=n.n(y),E=function(){function e(){var t=this;Object(i.a)(this,e),this.scriptIoReloadInterval=null,this.reloadScriptIo=function(){if(!window.io.unavailable)return clearInterval(t.scriptIoReloadInterval),t.scriptIoReloadInterval=null,t.bindSocket(),void console.log("Loaded script.io!");var e=document.getElementById("socket-io-script"),n=document.createElement("script");n.id=e.id,n.type=e.type,n.src=e.src,e.remove(),document.head.append(n),console.warn("Retrying socket.io script download...")},this.reload=function(){window.location.reload(!0)},this.justConnected=function(){t.getUser(),t.connected=!0,t.onConnect.map(function(e){return e(t.connected)})},this.justDisconnected=function(){t.connected=!1,t.disconnected=!0,t.onDisconnect.map(function(e){return e(t.connected)})},this.gotUser=function(e){e&&(t.id=e.id,t.username=e.name,t.token=e.token,t.settings=e.settings,localStorage.setItem("user-id",t.id),localStorage.setItem("user-name",t.username),localStorage.setItem("user-token",t.token),localStorage.setItem("user-settings",JSON.stringify(t.settings))),t.user=e,t.onUser.map(function(t){return t(e)}),t.gotUsers(t.usersInfo.users)},this.gotUsers=function(e){(e=b.a.orderBy(e,[function(e){return e.isUserRatingProvisional?1:0},"score","maxScore"],["asc","desc","desc"])).forEach(function(e,t){e.rank=t+1}),t.usersInfo=t.prepareUsers(e),t.onUsers.map(function(e){return e(t.usersInfo)})},this.gotGames=function(e){e=b.a.sortBy(e,["startDatetime","id"],["desc","desc"]),t.gamesInfo=t.prepareGames(e),t.onGames.map(function(e){return e(t.gamesInfo)})},this.gotTournaments=function(e){e=b.a.sortBy(e,["startDatetime","endDatetime","createdDatetime","id"],["desc","desc","desc","desc"]),t.tournamentsInfo=t.prepareTournaments(e),t.onTournaments.map(function(e){return e(t.tournamentsInfo)})},this.id=localStorage.getItem("user-id")||null,this.username=localStorage.getItem("user-name")||null;var n=localStorage.getItem("user-password")||null;localStorage.removeItem("user-password"),this.token=localStorage.getItem("user-token")||n;var a=localStorage.getItem("user-settings")||"null";try{this.settings=JSON.parse(a)}catch(r){this.settings=null}this.settings||(this.settings=this.constructor.getDefaultSettings()),window.io||(window.io=function(){return{on:function(){return console.warn("Socket script was missing")},emit:function(){return console.warn("Socket script was missing")},unavailable:!0}},window.io.unavailable=!0,this.scriptIoReloadInterval=setInterval(this.reloadScriptIo,1e3)),this.disconnected=!1,this.onConnect=[],this.onDisconnect=[],this.onUser=[],this.onUsers=[],this.onGames=[],this.onTournaments=[],this.bindSocket()}return Object(s.a)(e,null,[{key:"getDefaultSettings",value:function(){return JSON.parse(JSON.stringify({autoSubmitMoves:!1,enableNotifications:!1,theme:{pieces:"king",scheme:"",rotateOpponent:!0,animations:!0,arrows:!0,numbers:"obvious"}}))}}]),Object(s.a)(e,[{key:"bindSocket",value:function(){this.socket=window.io("https://thyra.basdekis.io"),this.available=!this.socket.unavailable,this.connected=!1,this.socket.on("connect",this.justConnected),this.socket.on("disconnect",this.justDisconnected),this.socket.on("reload",this.reload),this.user=null,this.socket.on("user",this.gotUser),this.usersInfo=this.prepareUsers([]),this.socket.on("users",this.gotUsers),this.gamesInfo=this.prepareGames([]),this.socket.on("games",this.gotGames),this.tournamentsInfo=this.prepareTournaments([]),this.socket.on("tournaments",this.gotTournaments),this.getUser()}},{key:"subscribe",value:function(e){for(var t=0,n=["onConnect","onDisconnect","onUser","onUsers","onGames","onTournaments"];t<n.length;t++){var a=n[t],r=e[a];r&&this[a].push(r)}}},{key:"unsubscribe",value:function(e){for(var t=0,n=["onConnect","onDisconnect","onUser","onUsers","onGames"];t<n.length;t++){var a=n[t],r=e[a];r&&b.a.pull(this[a],r)}}},{key:"getUser",value:function(){this.socket.emit("create-user",{appVersion:3,id:this.id,name:this.username,token:this.token,settings:this.settings})}},{key:"logIn",value:function(e,t,n){this.socket.emit("log-in",{appVersion:3,name:e,password:t,mergeUsers:n})}},{key:"logOut",value:function(){this.socket.emit("log-out")}},{key:"changeUsername",value:function(e){this.socket.emit("change-username",e)}},{key:"changePassword",value:function(e){this.socket.emit("change-password",e)}},{key:"updateSettings",value:function(e){this.socket.emit("update-settings",e)}},{key:"changeReadyToPlay",value:function(e){this.socket.emit("change-ready-to-play",e)}},{key:"prepareUsers",value:function(e){var t,n=this;if(this.user){var a=e.findIndex(function(e){return e.id===n.user.id});a>=0?(t=e.slice(0,a).concat(e.slice(a+1)),e=[e[a]].concat(Object(g.a)(t))):t=e}else t=e;var r=b.a.fromPairs(e.map(function(e){return[e.id,e]})),o=e.filter(function(e){return e.online}),l=o.filter(function(e){return[!0,!n.user||n.user.id].includes(e.readyToPlay)});return{users:e,byId:r,other:t,online:o,offline:e.filter(function(e){return!e.online}),readyToPlay:l,readyToPlayMe:l.filter(function(e){return n.user&&n.user.id===e.readyToPlay}),challengedUser:this.user&&r[this.user.readyToPlay]||null}}},{key:"prepareGames",value:function(e){var t=this,n=e.filter(function(e){return!e.finished}),a=e.filter(function(e){return e.finished});return{games:e,byId:b.a.fromPairs(e.map(function(e){return[e.id,e]})),live:n,myLive:this.user?n.filter(function(e){return e.userIds.includes(t.user.id)}):[],otherLive:this.user?n.filter(function(e){return!e.userIds.includes(t.user.id)}):n,finished:a,myFinished:this.user?a.filter(function(e){return e.userIds.includes(t.user.id)}):[],otherFinished:this.user?a.filter(function(e){return!e.userIds.includes(t.user.id)}):n,mine:this.user?e.filter(function(e){return e.userIds.includes(t.user.id)}):[]}}},{key:"submitGameMove",value:function(e,t){this.socket.emit("submit-game-moves",{id:e.id,moves:t})}},{key:"createTournament",value:function(e){this.socket.emit("create-tournament",e)}},{key:"joinTournament",value:function(e){this.socket.emit("join-tournament",e.id)}},{key:"leaveTournament",value:function(e){this.socket.emit("leave-tournament",e.id)}},{key:"startTournament",value:function(e){this.socket.emit("start-tournament",e.id)}},{key:"abortTournament",value:function(e){this.socket.emit("abort-tournament",e.id)}},{key:"prepareTournaments",value:function(e){var t=this,n=e.filter(function(e){return!e.started}),a=e.filter(function(e){return e.started&&!e.finished}),r=n.concat(a),o=e.filter(function(e){return e.finished});return{tournaments:e,byId:b.a.fromPairs(e.map(function(e){return[e.id,e]})),future:n,live:a,futureAndLive:r,finished:o,myFuture:this.user?n.filter(function(e){return e.userIds.includes(t.user.id)}):[],myLive:this.user?a.filter(function(e){return e.userIds.includes(t.user.id)}):[],myFutureAndLive:this.user?r.filter(function(e){return e.userIds.includes(t.user.id)}):[],myFinished:this.user?o.filter(function(e){return e.userIds.includes(t.user.id)}):[],otherFuture:this.user?a.filter(function(e){return!e.userIds.includes(t.user.id)}):a,otherLive:this.user?n.filter(function(e){return!e.userIds.includes(t.user.id)}):n,otherFutureAndLive:this.user?r.filter(function(e){return!e.userIds.includes(t.user.id)}):n,otherFinished:this.user?o.filter(function(e){return!e.userIds.includes(t.user.id)}):o,mine:this.user?e.filter(function(e){return e.userIds.includes(t.user.id)}):[]}}}]),e}(),O=new E;window.client=O;var k=E,C=n(22),w=n(94),P=n(69),j=n(60),M=n(254),R=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"constructUrl",value:function(e){var t=this.props.match;return"".concat(t.url.endsWith("/")?t.url.slice(0,-1):t.url).concat(e?"/".concat(e):"")}},{key:"getPreparedPanesDefaultToAndActiveIndex",value:function(){var e=this,t=this.props,n=t.panes,a=t.defaultIndex,o=t.match,l=t.location,i=null,s=null,c=o.url;return{preparedPanes:n.map(function(e,t){return[e,t]}).filter(function(e){return Object(w.a)(e,1)[0]}).map(function(t,n){var o=Object(w.a)(t,2),u=o[0],m=o[1];if(!u)return null;var h=e.constructUrl(u.path);m===a&&(i=h);var d=void 0!==u.navigate?e.constructUrl(u.navigate):h;l.pathname.startsWith(d)&&(s=n,c=h);var p="string"===typeof u.menuItem?{content:u.menuItem}:u.menuItem;return Object(C.a)({to:h},u,{menuItem:r.a.createElement(M.a.Item,Object.assign({key:u.path,as:P.b,to:d},p,{icon:u.icon||p.icon}))})}).filter(function(e){return e}),defaultTo:i,activeIndex:s,activeTo:c}}},{key:"render",value:function(){var e=this.props,t=e.tab,n=e.menu,o=e.match,l=e.renderActiveOnly,i=e.className,s=this.getPreparedPanesDefaultToAndActiveIndex(),c=s.preparedPanes,u=s.defaultTo,m=s.activeIndex,h=s.activeTo;return r.a.createElement(a.Fragment,null,null!==u?r.a.createElement(j.d,null,r.a.createElement(j.a,{exact:!0,from:o.url,to:u})):null,r.a.createElement(j.b,{path:h},r.a.createElement(f.a,Object.assign({menu:n,renderActiveOnly:l},t,{panes:c,activeIndex:m,className:i}))))}}]),t}(a.Component);R.defaultProps={renderActiveOnly:!0,defaultIndex:0};var A,T,S=Object(j.g)(R),I=n(13),_=(n(372),n(256)),x=n(37),L=n.n(x),U=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),t}(Object(_.a)(Error)),N=function(){function e(t,n,a,r,o){var l=this;if(Object(i.a)(this,e),!t||!n)throw new Error("You need to pass cells, status, and previous game");this.previous=a,this.history=(this.previous?this.previous.history:[]).filter(function(e){return!e.canUndo}).concat([this]),this.previousInHistory=this.history[this.history.length-2],this.fullHistory=(this.previous?this.previous.fullHistory:[]).concat(this),this.isNextMove=o,this.moveCount=this.previous?o?this.previous.moveCount+1:this.previous.moveCount:1,this.chainCount=this.previous?this.previous.chainCount+1:0,this.lastMove=r||(n.resignedPlayer?{resign:n.resignedPlayer}:r),this.moves=this.previous?this.previous.moves.concat([this.lastMove]):[],this.cells=t,this.allCells=Object.values(this.cells).map(function(e){return Object.values(e)}).reduce(function(e,t){return e.concat(t)}),this.rowsAndColumns=this.constructor.ROWS.map(function(e){return{y:e,cells:l.constructor.COLUMNS.map(function(t){return l.cells[e][t]})}});var s=n.nextPlayer,c=n.moveType,u=n.availableMovesMatrix,m=n.canUndo,h=n.resignedPlayer;this.thisPlayer=a?a.nextPlayer:e.PLAYER_A,this.nextPlayer=s,this.thisMoveType=a?a.moveType:null,this.moveType=c,this.availableMovesMatrix=u,this.canUndo=m,this.canTakeMoveBack=!!this.previous,this.resignedPlayer=h,this.moveNotation=h?this.constructor.RESIGNED_NOTATION[h]:r?this.constructor.MOVE_NOTATION[r.y][r.x]:"",this.fullNotation="".concat(this.previous?this.previous.fullNotation:"").concat(this.moveNotation),this.compressedFullNotation=this.fullNotation.split(/(..)/).filter(function(e){return e}).map(function(e){return l.constructor.NOTATION_COMPRESSION[e]}).join(""),this.winner=this.getWinner(),this.winner?this.finished=!0:this.hasAvailableMove(this.availableMovesMatrix)?this.finished=!1:(this.finished=!0,this.winner=this.constructor.OTHER_PLAYER[this.nextPlayer]),this.finished&&(this.availableMovesMatrix=this.constructor.noMovesAreAvailable())}return Object(s.a)(e,[{key:"createStep",value:function(e,t,n){return new this.constructor(e,t,this,n,!1)}},{key:"createNext",value:function(e,t,n){return new this.constructor(e,t,this,n,!0)}}],[{key:"create",value:function(){return new this(this.getInitialCells(),this.getInitialStatus(),null,null,!1)}},{key:"fromMoves",value:function(e){var t=this.create(),n=!0,a=!1,r=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value;t=t.makeMove(i)}}catch(s){a=!0,r=s}finally{try{n||null==l.return||l.return()}finally{if(a)throw r}}return t}},{key:"fromNotation",value:function(e){var t=this,n=e.split("").map(function(e){return t.REVERSE_NOTATION[e]});return n.filter(function(e){return!e}).length?null:this.fromMoves(n)}},{key:"fromCompressedNotation",value:function(e){var t=this,n=e.split("").map(function(e){return t.NOTATION_DECOMPRESSION[e]});return n.filter(function(e){return!e}).length?null:this.fromMoves(n)}}]),Object(s.a)(e,[{key:"getAvailableMoves",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.availableMovesMatrix;return b.a.flatten(e.map(function(e,t){return e.map(function(e,n){return e?{x:n,y:t}:null})})).filter(function(e){return e})}},{key:"serialize",value:function(){return this.serializeCompact()}},{key:"serializeCompact",value:function(){return{moves:this.moves}}},{key:"serializeVerbose",value:function(){return{cells:this.cells,status:{nextPlayer:this.nextPlayer,moveType:this.moveType,availableMovesMatrix:this.availableMovesMatrix,canUndo:this.canUndo,resignedPlayer:this.resignedPlayer},previous:this.previous?this.previous.serialize():null,lastMove:this.lastMove,isNextMove:this.isNextMove}}},{key:"getPrintout",value:function(){var t,n,a,r,o,l,i=(r={},Object(I.a)(r,e.PLAYER_A,(t={},Object(I.a)(t,0,"a"),Object(I.a)(t,1,L.a.bgWhite("b")),Object(I.a)(t,2,L.a.bgYellow("c")),Object(I.a)(t,3,L.a.bgRed("d")),t)),Object(I.a)(r,e.PLAYER_B,(n={},Object(I.a)(n,0,"w"),Object(I.a)(n,1,L.a.bgWhite("x")),Object(I.a)(n,2,L.a.bgYellow("y")),Object(I.a)(n,3,L.a.bgRed("z")),n)),Object(I.a)(r,null,(a={},Object(I.a)(a,0," "),Object(I.a)(a,1,L.a.bgWhite(" ")),Object(I.a)(a,2,L.a.bgYellow(" ")),Object(I.a)(a,3,L.a.bgRed(" ")),Object(I.a)(a,4,L.a.bgBlue(" ")),a)),r),s=this.rowsAndColumns.map(function(e){return e.cells.map(function(e){return i[e.player][e.level]}).join("")}).join("\n"),c=(o={},Object(I.a)(o,e.PLAYER_A,"A"),Object(I.a)(o,e.PLAYER_B,"B"),o)[this.nextPlayer],u=(l={},Object(I.a)(l,e.PLAYER_A,"A"),Object(I.a)(l,e.PLAYER_B,"B"),Object(I.a)(l,null,"+"),l)[this.winner];return"".concat(c,"-----").concat(u,"\n")+s.split("\n").map(function(e){return"|".concat(L.a.black(e),"|")}).join("\n")+"\n+-----+"}},{key:"checkCoordinatesAreValid",value:function(e){var t=e.x,n=e.y;if(Math.floor(t)!==t||Math.floor(n)!==n)throw new U("Coordinates '".concat(JSON.stringify({x:t,y:n}),"' are not valid"));if(void 0===this.availableMovesMatrix[n]||void 0===this.availableMovesMatrix[n][t])throw new U("Coordinates '".concat(JSON.stringify({x:t,y:n}),"' are out of bounds"))}},{key:"hasAvailableMove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.availableMovesMatrix;return this.getAvailableMoves(e).length>0}},{key:"isMoveAvailable",value:function(e){var t=e.x,n=e.y;return this.availableMovesMatrix[n][t]}},{key:"getWinner",value:function(){if(this.resignedPlayer)return this.constructor.OTHER_PLAYER[this.resignedPlayer];var e=this.allCells.find(function(e){return e.player&&3===e.level});return e?e.player:null}},{key:"getEmptyCellsAvailableMovesMatrix",value:function(e){var t=this;return this.constructor.ROWS.map(function(n){return t.constructor.COLUMNS.map(function(t){return!e[n][t].player})})}},{key:"getPlayerAvailableMovesMatrix",value:function(e,t){var n=this;return this.constructor.ROWS.map(function(a){return n.constructor.COLUMNS.map(function(r){return e[a][r].player===t&&n.hasAvailableMove(n.getMovableAvailableMovesMatrix(e,{x:r,y:a}))})})}},{key:"getMovableAvailableMovesMatrix",value:function(e,t){var n=this,a=e[t.y][t.x].level+1;return this.constructor.ROWS.map(function(r){return n.constructor.COLUMNS.map(function(n){return Math.abs(n-t.x)<=1&&Math.abs(r-t.y)<=1&&!e[r][n].player&&e[r][n].level<=3&&e[r][n].level<=a})})}},{key:"getBuildableAvailableMovesMatrix",value:function(e,t){var n=this;return this.constructor.ROWS.map(function(a){return n.constructor.COLUMNS.map(function(n){return Math.abs(n-t.x)<=1&&Math.abs(a-t.y)<=1&&!e[a][n].player&&e[a][n].level<4})})}},{key:"checkCanMakeMove",value:function(e,t,n){if(this.finished)throw new U("The game has already finished");if(this.moveType!==e)throw new U('You cannot perform move of type "'.concat(e,'": you need to perform "').concat(this.moveType,'"'));if(this.checkCoordinatesAreValid(t),n&&this.checkCoordinatesAreValid(n),!this.availableMovesMatrix[t.y][t.x])throw new Error("Move ".concat(JSON.stringify(t)," is not one of the available ones"))}},{key:"resign",value:function(e){return this.createStep(this.cells,{nextPlayer:this.nextPlayer,moveType:this.moveType,availableMovesMatrix:this.availableMovesMatrix,canUndo:!1,resignedPlayer:e},{resign:e})}},{key:"makeMove",value:function(e){var t;if(e.resign)return this.resign(e.resign);var n=(t={},Object(I.a)(t,this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER,this.placeFirstWorker),Object(I.a)(t,this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER,this.placeSecondWorker),Object(I.a)(t,this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE,this.selectWorkerToMove),Object(I.a)(t,this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER,this.moveFirstWorker),Object(I.a)(t,this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER,this.moveSecondWorker),Object(I.a)(t,this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER,this.buildAroundWorker),t)[this.moveType];if(!n)throw new U("Don't know how to perform move of type \"".concat(this.moveType,'"'));return n.bind(this)(e)}},{key:"undo",value:function(){if(!this.canUndo)throw new Error("Cannot undo");return this.previous}},{key:"takeMoveBack",value:function(){if(!this.canTakeMoveBack)throw new Error("Cannot take move back");return this.previous}},{key:"placeFirstWorker",value:function(e){var t=e.x,n=e.y;this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER,{x:t,y:n});var a=Object(C.a)({},this.cells,Object(I.a)({},n,Object(C.a)({},this.cells[n],Object(I.a)({},t,Object(C.a)({},this.cells[n][t],{player:this.nextPlayer,worker:this.constructor.WORKER_FIRST})))));return this.createStep(a,{nextPlayer:this.nextPlayer,moveType:this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER,availableMovesMatrix:this.getEmptyCellsAvailableMovesMatrix(a),canUndo:!0,resignedPlayer:null},{x:t,y:n})}},{key:"placeSecondWorker",value:function(e){var t=e.x,n=e.y;this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER,{x:t,y:n});var a=Object(C.a)({},this.cells,Object(I.a)({},n,Object(C.a)({},this.cells[n],Object(I.a)({},t,Object(C.a)({},this.cells[n][t],{player:this.nextPlayer,worker:this.constructor.WORKER_SECOND}))))),r=this.constructor.OTHER_PLAYER[this.nextPlayer];return this.createNext(a,{nextPlayer:r,moveType:r===this.constructor.PLAYER_A?this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE:this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER,availableMovesMatrix:r===this.constructor.PLAYER_A?this.getPlayerAvailableMovesMatrix(a,r):this.getEmptyCellsAvailableMovesMatrix(a),canUndo:!1,resignedPlayer:null},{x:t,y:n})}},{key:"selectWorkerToMove",value:function(e){var t=e.x,n=e.y;this.checkCanMakeMove(this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE,{x:t,y:n});var a=this.cells[n][t];return this.createStep(this.cells,{nextPlayer:this.nextPlayer,moveType:a.worker===this.constructor.WORKER_FIRST?this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER:this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER,availableMovesMatrix:this.getMovableAvailableMovesMatrix(this.cells,{x:t,y:n}),canUndo:!0,resignedPlayer:null},{x:t,y:n})}},{key:"moveWorker",value:function(e,t){var n=this,a=this.allCells.find(function(e){return e.player===n.nextPlayer&&e.worker===t}),r=this.cells[e.y][e.x],o=Object(C.a)({},this.cells,Object(I.a)({},a.y,Object(C.a)({},this.cells[a.y],Object(I.a)({},a.x,Object(C.a)({},a,{player:null,worker:null})))));return o=Object(C.a)({},o,Object(I.a)({},e.y,Object(C.a)({},o[e.y],Object(I.a)({},e.x,Object(C.a)({},r,{player:a.player,worker:a.worker}))))),this.createStep(o,{nextPlayer:this.nextPlayer,moveType:this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER,availableMovesMatrix:this.getBuildableAvailableMovesMatrix(o,e),canUndo:!0,resignedPlayer:null},{x:e.x,y:e.y})}},{key:"moveFirstWorker",value:function(e){var t=e.x,n=e.y;return this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER,{x:t,y:n}),this.moveWorker({x:t,y:n},this.constructor.WORKER_FIRST)}},{key:"moveSecondWorker",value:function(e){var t=e.x,n=e.y;return this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER,{x:t,y:n}),this.moveWorker({x:t,y:n},this.constructor.WORKER_SECOND)}},{key:"buildAroundWorker",value:function(e){var t=e.x,n=e.y;this.checkCanMakeMove(this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER,{x:t,y:n});var a=Object(C.a)({},this.cells,Object(I.a)({},n,Object(C.a)({},this.cells[n],Object(I.a)({},t,Object(C.a)({},this.cells[n][t],{level:this.cells[n][t].level+1}))))),r=this.constructor.OTHER_PLAYER[this.nextPlayer];return this.createNext(a,{nextPlayer:r,moveType:this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE,availableMovesMatrix:this.getPlayerAvailableMovesMatrix(a,r),canUndo:!1,resignedPlayer:null},{x:t,y:n})}}],[{key:"deserialize",value:function(e){return e.moves?this.deserializeCompact(e):this.deserializeVerbose(e)}},{key:"deserializeCompact",value:function(e){var t=e.moves;return this.fromMoves(t)}},{key:"deserializeVerbose",value:function(e){var t=e.cells,n=e.status,a=e.previous,r=e.lastMove,o=e.isNextMove;return a&&(a=this.deserialize(a)),new this(t,n,a,r,o)}},{key:"getInitialCells",value:function(){var e={},t=!0,n=!1,a=void 0;try{for(var r,o=this.ROWS[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var l=r.value;e[l]={};var i=!0,s=!1,c=void 0;try{for(var u,m=this.COLUMNS[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var h=u.value;e[l][h]={x:h,y:l,player:null,worker:null,level:0}}}catch(d){s=!0,c=d}finally{try{i||null==m.return||m.return()}finally{if(s)throw c}}}}catch(d){n=!0,a=d}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"getInitialStatus",value:function(){return{nextPlayer:this.PLAYER_A,moveType:this.MOVE_TYPE_PLACE_FIRST_WORKER,finished:!1,winner:null,availableMovesMatrix:this.allMovesAreAvailableMatrix(),canUndo:!1}}},{key:"allMovesAreAvailableMatrix",value:function(){var e=this;return this.ROWS.map(function(){return e.COLUMNS.map(function(){return!0})})}},{key:"noMovesAreAvailable",value:function(){var e=this;return this.ROWS.map(function(){return e.COLUMNS.map(function(){return!1})})}}]),e}();N.PLAYER_A="player-a",N.PLAYER_B="player-b",N.PLAYERS=[N.PLAYER_A,N.PLAYER_B],N.OTHER_PLAYER=(A={},Object(I.a)(A,N.PLAYER_A,N.PLAYER_B),Object(I.a)(A,N.PLAYER_B,N.PLAYER_A),A),N.WORKER_FIRST="first-worker",N.WORKER_SECOND="second-worker",N.MOVE_TYPE_PLACE_FIRST_WORKER="place-first-worker",N.MOVE_TYPE_PLACE_SECOND_WORKER="place-second-worker",N.MOVE_TYPE_SELECT_WORKER_TO_MOVE="select-worker-to-move",N.MOVE_TYPE_MOVE_FIRST_WORKER="move-first-worker",N.MOVE_TYPE_MOVE_SECOND_WORKER="move-second-worker",N.MOVE_TYPE_BUILD_AROUND_WORKER="build-around-worker",N.MOVE_TYPES_PLACE_WORKER=[N.MOVE_TYPE_PLACE_FIRST_WORKER,N.MOVE_TYPE_PLACE_SECOND_WORKER],N.MOVE_TYPES_MOVE_WORKER=[N.MOVE_TYPE_MOVE_FIRST_WORKER,N.MOVE_TYPE_MOVE_SECOND_WORKER],N.MOVE_TYPES_MOVE_OR_BUILD=[].concat(Object(g.a)(N.MOVE_TYPES_MOVE_WORKER),[N.MOVE_TYPE_BUILD_AROUND_WORKER]),N.ROWS=Array.from({length:5},function(e,t){return t}),N.COLUMNS=Array.from({length:5},function(e,t){return t}),N.MOVE_NOTATION=N.ROWS.map(function(e){return N.COLUMNS.map(function(t){return"".concat(["A","B","C","D","E"][t]).concat(["1","2","3","4","5"][e])})}),N.RESIGNED_NOTATION=(T={},Object(I.a)(T,N.PLAYER_A,"RA"),Object(I.a)(T,N.PLAYER_B,"RB"),T),N.REVERSE_NOTATION=Object(C.a)({},b.a.fromPairs(b.a.flatten(N.ROWS.map(function(e){return N.COLUMNS.map(function(t){return["".concat(["A","B","C","D","E"][t]).concat(["1","2","3","4","5"][e]),{x:t,y:e}]})}))),{RA:[{resign:N.PLAYER_A}],RB:[{resign:N.PLAYER_B}]}),N.NOTATION_COMPRESSION=b.a.fromPairs(Object.keys(N.REVERSE_NOTATION).sort().map(function(e,t){return[e,String.fromCharCode(t<26?65+t:t-26+48)]})),N.NOTATION_DECOMPRESSION=b.a.fromPairs(Object.keys(N.REVERSE_NOTATION).sort().map(function(e,t){return[String.fromCharCode(t<26?65+t:t-26+48),N.REVERSE_NOTATION[e]]}));var G=N,Y=n(257),W=n(4),F=n.n(W),B=(n(381),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.clickable,o=t.undoable,l=t.isCellAvailable,i=t.isCellUndoable,s=t.small,c=t.medium,u=t.makeMove,m=t.onSelect,h=t.selected,d=t.settings,p=t.rowsAndColumns,v=d.theme,f=v.scheme,g=v.numbers;return n=F()("board","html-board",{"small-board":s,"medium-board":c,editable:!!u&&(a||o),selectable:!!m,selected:h,"board-theme-default":""===f,"board-theme-subtle":"subtle"===f,"board-theme-pastel":"pastel"===f,"board-theme-green":"green"===f,"numbered-levels":["obvious","subtle","very-subtle"].includes(g),"obvious-levels":"obvious"===g,"subtle-levels":"subtle"===g,"very-subtle-levels":"very-subtle"===g},n),r.a.createElement("div",{className:n,onClick:m},p.map(function(t){return r.a.createElement("div",{key:"row-".concat(t.y),className:"row"},t.cells.map(function(t){return r.a.createElement(V,{key:"".concat(t.x,"-").concat(t.y),cell:t,clickable:a||o&&i(t),available:l(t),undoable:i(t),settings:d,makeMove:e.props.makeMove,undo:e.props.undo})}))}))}}]),t}(a.Component));B.defaultProps={className:"",small:!1,medium:!1,clickable:!1,selected:!1,animated:!1};var V=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMove=function(){n.props.available&&n.props.makeMove?n.props.makeMove(n.props.cell):n.props.undoable&&n.props.undo&&n.props.undo()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.cell,n=e.clickable,a=e.available,o=e.undoable,l=e.settings.theme.numbers,i=e.makeMove,s=e.undo,c=["obvious","subtle","very-subtle"].includes(l)&&t.level>0&&t.level<4?t.level:null;return r.a.createElement("div",{key:"row-".concat(t.x,"-").concat(t.y),className:F()("cell","level-".concat(t.level),{available:a,undoable:o}),onClick:(i&&a||s&&o)&&n?this.makeMove:null},r.a.createElement("div",{className:F()("level","level-1")},r.a.createElement("div",{className:F()("level","level-2")},r.a.createElement("div",{className:F()("level","level-3")},t.player?r.a.createElement("div",{className:F()("worker","player-".concat(t.player))},c):4===t.level?r.a.createElement("div",{className:F()("level","level-4")}):c))))}}]),t}(a.Component);V.defaultProps={clickable:!1,available:!1,undoable:!1};var D=B,z=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.level;return e?r.a.createElement("g",{transform:"translate(".concat(10,",").concat(10,")")},r.a.createElement("text",{dominantBaseline:"central",textAnchor:"middle",style:{fontSize:"".concat(15,"px")}},e)):null}}]),t}(a.PureComponent),H=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.level;return e?r.a.createElement("g",{transform:"translate(22,22)"},r.a.createElement("circle",{r:15,fill:"#bbb",stroke:"#111",strokeWidth:2}),r.a.createElement("text",{dominantBaseline:"central",textAnchor:"middle",style:{fontSize:"".concat(25,"px")}},e)):null}}]),t}(a.PureComponent),K=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.level;return e?r.a.createElement("g",{transform:"translate(".concat(50,",").concat(50,")")},r.a.createElement("text",{dominantBaseline:"central",textAnchor:"middle",stroke:"#eee",strokeWidth:6,paintOrder:"stroke",style:{fontSize:"".concat(45,"px")}},e)):null}}]),t}(a.PureComponent),X=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.level,n=e.type,a=this.constructor.indicatorMap[n];return a?r.a.createElement(a,{level:t}):null}}]),t}(a.PureComponent);X.indicatorMap={"very-subtle":z,subtle:H,obvious:K};var q=X,J=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.path,o=e.dimensions,l=e.offset;return r.a.createElement(a.Fragment,null,r.a.createElement("g",{id:"piece-".concat(t,"-base"),transform:["translate(".concat(50,",").concat(50,")"),"scale(".concat(.1,",").concat(.1,")"),"translate(".concat(-o.x/2+l.x,",").concat(-o.y/2+l.y,")")].join(",")},n),r.a.createElement("g",{id:"piece-".concat(t,"-white")},r.a.createElement("use",{xlinkHref:"#piece-".concat(t,"-base"),strokeWidth:80,stroke:"#111"}),r.a.createElement("use",{xlinkHref:"#piece-".concat(t,"-base"),fill:"white"})),r.a.createElement("g",{id:"piece-".concat(t,"-black")},r.a.createElement("use",{xlinkHref:"#piece-".concat(t,"-base"),strokeWidth:80,stroke:"#bbb"}),r.a.createElement("use",{xlinkHref:"#piece-".concat(t,"-base"),fill:"black"})))}}]),t}(a.PureComponent),$=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.colour,a=e.rotated;return r.a.createElement("use",{xlinkHref:"#piece-".concat(t,"-").concat(n),transform:a?this.constructor.rotateTransform:void 0})}}]),t}(a.PureComponent);$.rotateTransform="rotate(180,".concat(50,",").concat(50,")");var Q=function(e,t){var n=t.path,o=t.dimensions,l=t.offset,h=void 0===l?{x:0,y:0}:l,d=function(t){function a(){return Object(i.a)(this,a),Object(c.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(J,{name:e,path:n,dimensions:o,offset:h})}}]),a}(a.PureComponent);d.displayName="".concat(e,"Definition");var p=function(t){function n(){return Object(i.a)(this,n),Object(c.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,t),Object(s.a)(n,[{key:"render",value:function(){var t=this.props,n=t.colour,a=t.rotated;return r.a.createElement($,{name:e,colour:n,rotated:a})}}]),n}(a.PureComponent);return p.Definition=d,p.displayName=e,p},Z=Q("PiecePawn",{path:r.a.createElement("path",{d:"M105.1 224H80a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h16v5.49c0 44-4.14 86.6-24 122.51h176c-19.89-35.91-24-78.51-24-122.51V288h16a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-25.1c29.39-18.38 49.1-50.78 49.1-88a104 104 0 0 0-208 0c0 37.22 19.71 69.62 49.1 88zM304 448H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}),dimensions:{x:320,y:480},offset:{x:0,y:-38}}),ee=Q("PieceKing",{path:r.a.createElement("path",{d:"M400 448H48a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h352a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm16-288H256v-48h40a8 8 0 0 0 8-8V56a8 8 0 0 0-8-8h-40V8a8 8 0 0 0-8-8h-48a8 8 0 0 0-8 8v40h-40a8 8 0 0 0-8 8v48a8 8 0 0 0 8 8h40v48H32a32 32 0 0 0-30.52 41.54L74.56 416h298.88l73.08-214.46A32 32 0 0 0 416 160z"}),dimensions:{x:448,y:512}}),te=Q("PieceCircle",{path:r.a.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"}),dimensions:{x:512,y:512}}),ne=Q("PieceCertificate",{path:r.a.createElement("path",{d:"M458.622 255.92l45.985-45.005c13.708-12.977 7.316-36.039-10.664-40.339l-62.65-15.99 17.661-62.015c4.991-17.838-11.829-34.663-29.661-29.671l-61.994 17.667-15.984-62.671C337.085.197 313.765-6.276 300.99 7.228L256 53.57 211.011 7.229c-12.63-13.351-36.047-7.234-40.325 10.668l-15.984 62.671-61.995-17.667C74.87 57.907 58.056 74.738 63.046 92.572l17.661 62.015-62.65 15.99C.069 174.878-6.31 197.944 7.392 210.915l45.985 45.005-45.985 45.004c-13.708 12.977-7.316 36.039 10.664 40.339l62.65 15.99-17.661 62.015c-4.991 17.838 11.829 34.663 29.661 29.671l61.994-17.667 15.984 62.671c4.439 18.575 27.696 24.018 40.325 10.668L256 458.61l44.989 46.001c12.5 13.488 35.987 7.486 40.325-10.668l15.984-62.671 61.994 17.667c17.836 4.994 34.651-11.837 29.661-29.671l-17.661-62.015 62.65-15.99c17.987-4.302 24.366-27.367 10.664-40.339l-45.984-45.004z"}),dimensions:{x:512,y:512}}),ae=Q("PieceSun",{path:r.a.createElement("path",{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"}),dimensions:{x:512,y:512}}),re=Q("PieceRocket",{path:r.a.createElement("path",{d:"M505.05 19.1a15.89 15.89 0 0 0-12.2-12.2C460.65 0 435.46 0 410.36 0c-103.2 0-165.1 55.2-211.29 128H94.87A48 48 0 0 0 52 154.49l-49.42 98.8A24 24 0 0 0 24.07 288h103.77l-22.47 22.47a32 32 0 0 0 0 45.25l50.9 50.91a32 32 0 0 0 45.26 0L224 384.16V488a24 24 0 0 0 34.7 21.49l98.7-49.39a47.91 47.91 0 0 0 26.5-42.9V312.79c72.59-46.3 128-108.4 128-211.09.1-25.2.1-50.4-6.85-82.6zM384 168a40 40 0 1 1 40-40 40 40 0 0 1-40 40z"}),dimensions:{x:512,y:512}}),oe=Q("PieceBug",{path:r.a.createElement("path",{d:"M511.988 288.9c-.478 17.43-15.217 31.1-32.653 31.1H424v16c0 21.864-4.882 42.584-13.6 61.145l60.228 60.228c12.496 12.497 12.496 32.758 0 45.255-12.498 12.497-32.759 12.496-45.256 0l-54.736-54.736C345.886 467.965 314.351 480 280 480V236c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v244c-34.351 0-65.886-12.035-90.636-32.108l-54.736 54.736c-12.498 12.497-32.759 12.496-45.256 0-12.496-12.497-12.496-32.758 0-45.255l60.228-60.228C92.882 378.584 88 357.864 88 336v-16H32.666C15.23 320 .491 306.33.013 288.9-.484 270.816 14.028 256 32 256h56v-58.745l-46.628-46.628c-12.496-12.497-12.496-32.758 0-45.255 12.498-12.497 32.758-12.497 45.256 0L141.255 160h229.489l54.627-54.627c12.498-12.497 32.758-12.497 45.256 0 12.496 12.497 12.496 32.758 0 45.255L424 197.255V256h56c17.972 0 32.484 14.816 31.988 32.9zM257 0c-61.856 0-112 50.144-112 112h224C369 50.144 318.856 0 257 0z"}),dimensions:{x:512,y:512}}),le=Q("PieceEye",{path:r.a.createElement("path",{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"}),dimensions:{x:512,y:512}}),ie=Q("PieceUser",{path:r.a.createElement("path",{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}),dimensions:{x:512,y:512}}),se=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.style,n=e.colour,a=e.rotated,o=this.constructor.pieceStyleMap[t];return r.a.createElement(o,{colour:n,rotated:a})}}]),t}(a.PureComponent);se.pieceStyleMap={pawn:Z,king:ee,circle:te,certificate:ne,sun:ae,rocket:re,bug:oe,eye:le,user:ie};var ce=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return Object.values(se.pieceStyleMap).map(function(e){return r.a.createElement(e.Definition,{key:e.displayName||e.name})})}}]),t}(a.PureComponent);se.Definitions=ce;var ue=se,me=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement("rect",{id:"cell-border",width:100,height:100}),r.a.createElement("rect",{id:"cell-0",width:90,height:90,transform:"translate(".concat(5,",").concat(5,")")}),r.a.createElement("g",{id:"cell-1"},r.a.createElement("rect",{className:"border",width:90,height:90,transform:"translate(".concat(5,",").concat(5,")")}),r.a.createElement("rect",{className:"fill",width:80,height:80,transform:"translate(".concat(10,",").concat(10,")")})),r.a.createElement("g",{id:"cell-2"},r.a.createElement("rect",{className:"border",width:80,height:80,transform:"translate(".concat(10,",").concat(10,")")}),r.a.createElement("rect",{className:"fill",width:70,height:70,transform:"translate(".concat(15,",").concat(15,")")})),r.a.createElement("g",{id:"cell-3"},r.a.createElement("rect",{className:"border",width:70,height:70,transform:"translate(".concat(15,",").concat(15,")")}),r.a.createElement("rect",{className:"fill",width:60,height:60,transform:"translate(".concat(20,",").concat(20,")")})),r.a.createElement("g",{id:"cell-4"},r.a.createElement("rect",{className:"border",width:60,height:60,transform:"translate(".concat(20,",").concat(20,")")}),r.a.createElement("rect",{className:"fill",width:50,height:50,transform:"translate(".concat(25,",").concat(25,")")})))}}]),t}(a.PureComponent),he=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={previousLevel:n.props.level,currentLevel:n.props.level},n.levelsAnimate=[0,1,2,3,4].map(function(e){return r.a.createRef()}),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){var a=this;this.props.animated&&this.state.currentLevel!==this.state.previousLevel&&setTimeout(function(){a.levelsAnimate.filter(function(e,t){return a.state.previousLevel<=t&&t<=a.state.currentLevel||a.state.currentLevel<=t&&t<=a.state.previousLevel}).filter(function(e){return e.current}).map(function(e){return e.current.beginElement()})},0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.x,o=t.y,l=t.available,i=t.undoable,s=t.level,c=t.player,u=t.onClick,m=t.animated,h=t.allowControl,d=t.theme,p=d.pieces,v=void 0===p?"king":p,f=d.rotateOpponent,g=void 0===f||f,y=d.numbers,b=this.state,E=b.previousLevel,O=b.currentLevel,k=!h.includes(G.PLAYER_A)&&h.includes(G.PLAYER_B),C=!k;return r.a.createElement("g",{transform:"translate(".concat(100*n,",").concat(100*o,")")},r.a.createElement("use",{xlinkHref:"#cell-border",className:F()({available:l,undoable:i}),onClick:u}),r.a.createElement("g",{className:"cell-contents"},m?[0,1,2,3,4].map(function(t){return r.a.createElement("use",{key:t,xlinkHref:"".concat(e.constructor.levelMap[t]),opacity:t<=s?1:0},r.a.createElement("animate",{ref:e.levelsAnimate[t],attributeName:"opacity",attributeType:"XML",type:"translate",from:E<t?0:1,to:O<t?0:1,dur:"0.2s",repeatCount:1,fill:"freeze"}))}):[0,1,2,3,4].filter(function(e){return e<=s}).map(function(t){return r.a.createElement(a.Fragment,{key:t},r.a.createElement("use",{xlinkHref:"".concat(e.constructor.levelMap[t])}),c===G.PLAYER_A?r.a.createElement(ue,{style:v,colour:"white",rotated:g&&k}):null,c===G.PLAYER_B?r.a.createElement(ue,{style:v,colour:"black",rotated:g&&C}):null)}),y?r.a.createElement(q,{level:s,type:y}):null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.animated&&e.level!==t.level?{previousLevel:t.currentLevel,currentLevel:e.level}:null}}]),t}(a.PureComponent);he.Definitions=me,he.levelMap={0:"#cell-0",1:"#cell-1",2:"#cell-2",3:"#cell-3",4:"#cell-4"},he.defaultProps={animated:!1};var de=he,pe=(n(382),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.constructor,t=e.arrowDimensions,n=e.arrowOffset,o=e.arrowScaling,l=e.hammerDimensions,i=e.hammerOffset,s=e.hammerScaling;return r.a.createElement(a.Fragment,null,r.a.createElement("path",{id:"arrow-move-base",d:"M168 345.941V44c0-6.627-5.373-12-12-12h-56c-6.627 0-12 5.373-12 12v301.941H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.569 9.373 33.941 0l86.059-86.059c15.119-15.119 4.411-40.971-16.971-40.971H168z",transform:["translate(".concat(50,",").concat(50,")"),"scale(".concat(.1*o,",").concat(.1*o,")"),"translate(".concat(-t.x/2+n.x,",").concat(-t.y/2+n.y,")")].join(",")}),r.a.createElement("path",{id:"arrow-build-base",d:"M571.31 193.94l-22.63-22.63c-6.25-6.25-16.38-6.25-22.63 0l-11.31 11.31-28.9-28.9c5.63-21.31.36-44.9-16.35-61.61l-45.25-45.25c-62.48-62.48-163.79-62.48-226.28 0l90.51 45.25v18.75c0 16.97 6.74 33.25 18.75 45.25l49.14 49.14c16.71 16.71 40.3 21.98 61.61 16.35l28.9 28.9-11.31 11.31c-6.25 6.25-6.25 16.38 0 22.63l22.63 22.63c6.25 6.25 16.38 6.25 22.63 0l90.51-90.51c6.23-6.24 6.23-16.37-.02-22.62zm-286.72-15.2c-3.7-3.7-6.84-7.79-9.85-11.95L19.64 404.96c-25.57 23.88-26.26 64.19-1.53 88.93s65.05 24.05 88.93-1.53l238.13-255.07c-3.96-2.91-7.9-5.87-11.44-9.41l-49.14-49.14z",transform:["translate(".concat(50,",").concat(50,")"),"scale(".concat(.1*s,",").concat(.1*s,")"),"rotate(135)","translate(".concat(-l.x/2+i.x,",").concat(-l.y/2+i.y,")")].join(",")}),r.a.createElement("g",{id:"arrow-move-white"},r.a.createElement("use",{xlinkHref:"#arrow-move-base",strokeWidth:80,stroke:"#111"}),r.a.createElement("use",{xlinkHref:"#arrow-move-base",fill:"white"})),r.a.createElement("g",{id:"arrow-move-black"},r.a.createElement("use",{xlinkHref:"#arrow-move-base",strokeWidth:80,stroke:"#bbb"}),r.a.createElement("use",{xlinkHref:"#arrow-move-base",fill:"black"})),r.a.createElement("g",{id:"arrow-build-white"},r.a.createElement("use",{xlinkHref:"#arrow-build-base",strokeWidth:80,stroke:"#111"}),r.a.createElement("use",{xlinkHref:"#arrow-build-base",fill:"white"})),r.a.createElement("g",{id:"arrow-build-black"},r.a.createElement("use",{xlinkHref:"#arrow-build-base",strokeWidth:80,stroke:"#bbb"}),r.a.createElement("use",{xlinkHref:"#arrow-build-base",fill:"black"})))}}]),t}(a.PureComponent));pe.arrowDimensions={x:215.81,y:439.04},pe.arrowOffset={x:-20,y:-15},pe.arrowScaling=.75,pe.hammerDimensions={x:564.48,y:501.76},pe.hammerOffset={x:50,y:-50},pe.hammerScaling=.5625;var ve=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.constructor,t=e.offsetX,n=e.smallScaling,a=this.props,o=a.from,l=a.to,i=a.colour,s=a.type,c=a.small,u={x:l.x-o.x,y:l.y-o.y},m=this.constructor.rotationMap["".concat(u.x,",").concat(u.y)],h=Math.sqrt(Math.abs(u.x)+Math.abs(u.y));return r.a.createElement("use",{xlinkHref:"#arrow-".concat(s,"-").concat(i),transform:["translate(".concat(100*o.x,",").concat(100*o.y,")"),"rotate(".concat(m,",").concat(50,",").concat(50,")"),"translate(".concat(t,",").concat(50*h,")")].concat(Object(g.a)(c?["translate(".concat(50,",").concat(50,")"),"scale(".concat(n,")"),"translate(".concat(-50,",").concat(-50,")")]:[])).filter(function(e){return e}).join(",")})}}]),t}(a.PureComponent);ve.Definition=pe,ve.offsetX=10,ve.smallScaling=.75,ve.rotationMap={"0,1":0,"-1,1":45,"-1,0":90,"-1,-1":135,"0,-1":180,"1,-1":-135,"1,0":-90,"1,1":-45},ve.defaultProps={small:!1};var fe=ve,ge=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.clickable,l=t.undoable,i=t.isCellAvailable,s=t.isCellUndoable,c=t.small,u=t.medium,m=t.makeMove,h=t.onSelect,d=t.selected,p=t.allowControl,v=t.settings,f=t.rowsAndColumns,y=t.transformation,b=t.animated,E=t.showArrows,O=t.game,k=t.arrows,C=v.theme;n=F()("board","svg-board","board-theme-".concat(C.scheme||"default"),{"small-board":c,"medium-board":u,editable:!!m&&(o||l),selectable:!!h,selected:d},n);var w=f.length,P=Math.max.apply(Math,Object(g.a)(f.map(function(e){return e.cells.length})))||0;return r.a.createElement("svg",{className:n,viewBox:"0 0 ".concat(100*P," ").concat(100*w),style:{"--column-count":P,"--row-count":w},preserveAspectRatio:"xMinYMin meet",onClick:h},r.a.createElement("g",{"data-key":"rows"},f.map(function(t){return r.a.createElement("g",{"data-key":"row-".concat(t.y),key:"row-".concat(t.y)},t.cells.map(function(t){return r.a.createElement(ke,{key:"".concat(t.x,"-").concat(t.y),cell:t,clickable:o||l&&s(t),available:i(t),undoable:s(t),allowControl:p,settings:v,makeMove:e.props.makeMove,undo:e.props.undo,theme:C,animated:b})}))})),b?r.a.createElement(Ee,{rowsAndColumns:f,theme:C,allowControl:p}):null,E?k?k.map(function(e,t){return r.a.createElement(fe,Object.assign({key:t},e))}):r.a.createElement(a.Fragment,null,r.a.createElement(be,{game:O,transformation:y})):null)}}]),t}(a.PureComponent);ge.defaultProps={className:"",small:!1,medium:!1,clickable:!1,selected:!1,allowControl:[G.PLAYER_A,G.PLAYER_B],animated:!1,showArrows:!1};var ye=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement("svg",{className:F()("board","svg-board"),style:{display:"none"}},r.a.createElement("defs",null,r.a.createElement(de.Definitions,null),r.a.createElement(ue.Definitions,null),r.a.createElement(fe.Definition,null))))}}]),t}(a.PureComponent);ge.Definitions=ye;var be=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getPlayerMoves",value:function(){var e=this.props.transformation,t=this.getRelevantHistory(),n=t.player,a=t.relevantHistory,r=a.find(function(e){return G.MOVE_TYPES_MOVE_WORKER.includes(e.thisMoveType)}),o=a.find(function(e){return e.thisMoveType===G.MOVE_TYPE_BUILD_AROUND_WORKER}),l={move:r?{from:r.previous.lastMove,to:r.lastMove}:null,build:o?{from:o.previous.lastMove,to:o.lastMove}:null},i=l.move,s=l.build;return e&&(i&&(i.from=e.reverseCoordinates(r.previous.rowsAndColumns,i.from),i.to=e.reverseCoordinates(r.rowsAndColumns,i.to),i.type="move"),s&&(s.from=e.reverseCoordinates(o.previous.rowsAndColumns,s.from),s.to=e.reverseCoordinates(o.rowsAndColumns,s.to),s.type="build")),{player:n,move:i,build:s}}},{key:"getRelevantHistory",value:function(){for(var e=this.props.game,t=[e],n=e.thisPlayer,a=e;a.previous&&(a=a.previous).thisPlayer===n;)t.push(a);return{player:n,relevantHistory:t}}},{key:"render",value:function(){if(!this.props.game)return null;var e=this.getPlayerMoves(),t=e.player,n=e.move,a=e.build;if(!n&&!a)return null;var o=t===G.PLAYER_A?"white":"black",l=null,i=null;return n&&(l=r.a.createElement(fe,{key:"move",from:n.from,to:n.to,colour:o,type:"move"})),a&&(i=r.a.createElement(fe,{key:"build",from:a.from,to:a.to,colour:o,type:"build"})),[l,i]}}]),t}(a.PureComponent),Ee=(a.PureComponent,function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.rowsAndColumns,n=e.theme,a=e.allowControl,o=b.a.sortBy(b.a.flatten(t.map(function(e){return e.cells.filter(function(e){return e.player})})),["player","worker"]);return r.a.createElement("g",{"data-key":"pieces",style:{pointerEvents:"none"}},o.map(function(e){return r.a.createElement(Oe,{key:"".concat(e.player,"-").concat(e.worker),cell:e,theme:n,allowControl:a})}))}}]),t}(a.PureComponent)),Oe=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={previousPosition:{x:n.props.cell.x,y:n.props.cell.y},position:{x:n.props.cell.x,y:n.props.cell.y}},n.animateTransform=r.a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){var a=this;this.state.position!==t.position&&setTimeout(function(){a.animateTransform.current&&a.animateTransform.current.beginElement()},0)}},{key:"render",value:function(){var e=this.props,t=e.cell,n=e.theme,a=e.allowControl,o=this.state,l=o.previousPosition,i=o.position,s=!a.includes(G.PLAYER_A)&&a.includes(G.PLAYER_B),c=!s;return r.a.createElement("g",{transform:"translate(".concat(100*i.x,",").concat(100*i.y,")")},r.a.createElement(ue,{style:n.pieces||"king",colour:t.player===G.PLAYER_A?"white":"black",rotated:n.rotateOpponent&&(t.player===G.PLAYER_A?s:c)}),r.a.createElement("animateTransform",{ref:this.animateTransform,attributeName:"transform",attributeType:"XML",type:"translate",from:"".concat(100*l.x," ").concat(100*l.y),to:"".concat(100*i.x," ").concat(100*i.y),dur:"0.1s",repeatCount:1,fill:"freeze"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.cell.x!==t.position.x||e.cell.y!==t.position.y?{previousPosition:t.position,position:{x:e.cell.x,y:e.cell.y}}:null}}]),t}(a.PureComponent),ke=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMove=function(){n.props.available&&n.props.makeMove?n.props.makeMove(n.props.cell):n.props.undoable&&n.props.undo&&n.props.undo()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.cell,n=e.clickable,a=e.available,o=e.undoable,l=e.settings.theme,i=e.makeMove,s=e.undo,c=e.animated,u=e.allowControl;return r.a.createElement(de,{x:t.x,y:t.y,available:a,undoable:o,level:t.level,player:t.player,allowControl:u,animated:c,theme:l,onClick:(i&&a||s&&o)&&n?this.makeMove:null})}}]),t}(a.PureComponent);ke.defaultProps={clickable:!1,available:!1,undoable:!1,animated:!1,allowControl:[G.PLAYER_A,G.PLAYER_B]};var Ce=ge,we=(n(383),n(384),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.renderer,n=void 0===t?"svg":t,a=Object(Y.a)(e,["renderer"]),o={html:D,svg:Ce}[n];return r.a.createElement(o,a)}}]),t}(a.Component));we.defaultProps={className:"",small:!1,medium:!1,clickable:!1,selected:!1,allowControl:[G.PLAYER_A,G.PLAYER_B],animated:!1,showArrows:!1};var Pe=we,je=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMove=function(e){n.props.makeMove(n.props.game.makeMove({x:e.x,y:e.y}))},n.undo=function(){n.props.makeMove(n.props.game.canUndo?n.props.game.undo():n.props.game.takeMoveBack())},n.onSelect=function(){n.props.onSelect(n.props.game)},n.isCellAvailable=function(e){return n.props.game.isMoveAvailable(e)},n.isCellUndoable=function(e){if(void 0===n.props.minChainCount||null===n.props.minChainCount){if(2===n.props.allowControl.length)return!0;if(!n.props.game.canUndo)return!1}else if(n.props.game.chainCount<=n.props.minChainCount)return!1;var t=n.props.game.lastMove;return!!t&&(t.x===e.x&&t.y===e.y)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"isGameUndoable",value:function(){var e=this;return!!this.props.game.rowsAndColumns.find(function(t){return t.cells.find(function(t){return e.isCellUndoable(t)})})}},{key:"render",value:function(){var e=this.props,t=e.game,n=e.transformation,a=e.allowControl,o=e.onSelect,l=e.makeMove,i=e.animated,s=t.rowsAndColumns;return n&&(s=n(s)),r.a.createElement(Pe,Object.assign({},this.props,{isCellAvailable:i?this.isCellAvailable:function(){return!1},isCellUndoable:i?this.isCellUndoable:function(){return!1},clickable:a.includes(t.nextPlayer),undoable:!!i&&this.isGameUndoable(),onSelect:o?this.onSelect:null,makeMove:l?this.makeMove:null,undo:l?this.undo:null,rowsAndColumns:s,transformation:n,game:t,animated:i}))}}]),t}(a.PureComponent);je.defaultProps={className:"",small:!1,medium:!1,selected:!1,allowControl:[G.PLAYER_A,G.PLAYER_B],animated:!1};var Me=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={rotations:0,flippedHorizontally:!1},n.updateOrientation=function(e){n.setState(e,function(){if(n.props.onChange){var e=n.state,t=e.rotations,a=e.flippedHorizontally,r=n.constructor.transformationMap["".concat(t,",").concat(a)];n.props.onChange({rotations:t,flippedHorizontally:a,transformation:r})}})},n.rotateCounterClockwise=function(){n.updateOrientation(function(e){return{rotations:(e.rotations+3)%4}})},n.rotateClockwise=function(){n.updateOrientation(function(e){return{rotations:(e.rotations+1)%4}})},n.flipHorizontally=function(){n.updateOrientation(function(e){return{flippedHorizontally:!e.flippedHorizontally}})},n.flipVertically=function(){n.updateOrientation(function(e){return{rotations:(e.rotations+2)%4,flippedHorizontally:!e.flippedHorizontally}})},n.reset=function(){n.updateOrientation(function(e){return{rotations:0,flippedHorizontally:!1}})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.rotations,n=e.flippedHorizontally;return r.a.createElement(M.a,{size:"massive",items:[{key:"rotate-counter-clockwise",icon:"undo",onClick:this.rotateCounterClockwise},{key:"rotate-clockwise",icon:"redo",onClick:this.rotateClockwise},{key:"flip-horizontal",icon:"arrows alternate horizontal",onClick:this.flipHorizontally},{key:"flip-vertical",icon:"arrows alternate vertical",onClick:this.flipVertically},{key:"home",icon:"home",onClick:this.reset,disabled:!t&&!n}]})}}],[{key:"makeTransformRowsAndColumns",value:function(e){var t=this,n=function(n){return t.transformRowsAndColumns(n,e)},a=e.transpose^e.flipX^e.flipY,r=e.transpose&&!a?{transpose:e.transpose,flipX:!e.flipX,flipY:!e.flipY}:e;return n.reverseCoordinates=function(e,n){return t.reverseTransformCoordinates(e,n,r)},n}},{key:"transformRowsAndColumns",value:function(e,t){var n=this,a=this.getNewRowAndColumnCount(e,t),r=a.newRowCount,o=a.newColumnCount,l=b.a.range(o);return b.a.range(r).map(function(a){return{y:a,cells:l.map(function(l){var i=n.getOldCoordinates({newX:l,newY:a},{newRowCount:r,newColumnCount:o},t),s=i.oldX,c=i.oldY;return Object(C.a)({},e[c].cells[s],{x:l,y:a})})}})}},{key:"reverseTransformCoordinates",value:function(e,t,n){var a=this.getNewRowAndColumnCount(e,n),r=a.newRowCount,o=a.newColumnCount,l=t.x,i=t.y,s=this.getOldCoordinates({newX:l,newY:i},{newRowCount:r,newColumnCount:o},n);return{x:s.oldX,y:s.oldY}}},{key:"getNewRowAndColumnCount",value:function(e,t){var n,a,r=e.length,o=Math.max.apply(Math,Object(g.a)(e.map(function(e){return e.cells.length})))||0;return t.transpose?(a=r,n=o):(a=o,n=r),{newRowCount:n,newColumnCount:a}}},{key:"getOldCoordinates",value:function(e,t,n){var a,r,o=e.newX,l=e.newY,i=t.newColumnCount,s=t.newRowCount;return n.transpose?(a=l,r=o):(a=o,r=l),n.flipX&&(a=i-1-a),n.flipY&&(r=s-1-r),{oldX:a,oldY:r}}}]),t}(a.PureComponent);Me.transformationMap={"0,false":null,"1,false":Me.makeTransformRowsAndColumns({transpose:!0,flipX:!1,flipY:!0}),"2,false":Me.makeTransformRowsAndColumns({transpose:!1,flipX:!0,flipY:!0}),"3,false":Me.makeTransformRowsAndColumns({transpose:!0,flipX:!0,flipY:!1}),"0,true":Me.makeTransformRowsAndColumns({transpose:!1,flipX:!0,flipY:!1}),"1,true":Me.makeTransformRowsAndColumns({transpose:!0,flipX:!0,flipY:!0}),"2,true":Me.makeTransformRowsAndColumns({transpose:!1,flipX:!1,flipY:!0}),"3,true":Me.makeTransformRowsAndColumns({transpose:!0,flipX:!1,flipY:!1})};var Re=je,Ae=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={rowsAndColumns:n.constructor.demoRowsAndColumns},n.isCellAvailable=function(){return!1},n.isCellUndoable=function(){return!1},n.animate=function(){n.setState(function(e){return{rowsAndColumns:e.rowsAndColumns===n.constructor.demoRowsAndColumns?n.constructor.demoRowsAndColumnsAnimated:n.constructor.demoRowsAndColumns}})},n.animationInterval=n.props.settings.theme.animations?setInterval(n.animate,2e3):null,n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){this.props.settings.theme.animations!==e.settings.theme.animations&&(this.props.settings.theme.animations?this.animationInterval||(this.animationInterval=setInterval(this.animate,2e3)):this.animationInterval&&(clearInterval(this.animationInterval),this.animationInterval=null))}},{key:"componentWillUnmount",value:function(){this.animationInterval&&(clearInterval(this.animationInterval),this.animationInterval=null)}},{key:"render",value:function(){var e=this.props,t=e.small,n=e.medium,a=e.settings,o=this.state.rowsAndColumns;return r.a.createElement(Pe,{small:t,medium:n,allowControl:[G.PLAYER_A,G.PLAYER_B],rowsAndColumns:o,undoable:!1,isCellAvailable:this.isCellAvailable,isCellUndoable:this.isCellUndoable,arrows:a.theme.arrows?this.constructor.arrows:void 0,settings:a,animated:a.theme.animations,showArrows:a.theme.arrows})}}]),t}(a.Component);Ae.demoRowsAndColumns=[{y:0,cells:[{x:0,y:0,player:null,worker:null,level:0},{x:1,y:0,player:null,worker:null,level:1},{x:2,y:0,player:null,worker:null,level:2},{x:3,y:0,player:null,worker:null,level:3},{x:4,y:0,player:null,worker:null,level:4},{x:5,y:0,player:G.PLAYER_A,worker:G.WORKER_FIRST,level:0},{x:6,y:0,player:G.PLAYER_B,worker:G.WORKER_FIRST,level:0}]}],Ae.demoRowsAndColumnsAnimated=[{y:0,cells:[{x:0,y:0,player:null,worker:null,level:0},{x:1,y:0,player:null,worker:null,level:1},{x:2,y:0,player:null,worker:null,level:2},{x:3,y:0,player:null,worker:null,level:3},{x:4,y:0,player:G.PLAYER_A,worker:G.WORKER_FIRST,level:3},{x:5,y:0,player:null,worker:null,level:0},{x:6,y:0,player:G.PLAYER_B,worker:G.WORKER_FIRST,level:0}]}],Ae.arrows=[{from:{x:5,y:0},to:{x:4,y:0},colour:"white",type:"build"},{from:{x:4,y:0},to:{x:5,y:0},colour:"white",type:"move"}],Ae.defaultProps={className:"",small:!1,medium:!1};var Te,Se=Ae,Ie=Re,_e=n(255),xe=n(478),Le=n(475),Ue=n(470),Ne=n(458),Ge=n(466),Ye=n(95),We=n(471),Fe=n(62),Be=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).isCellAvailable=function(){return!1},n.isCellUndoable=function(){return!1},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.small,n=e.medium,a=e.player,o=e.settings,l=e.allowControl;return r.a.createElement(Pe,{small:t,medium:n,rowsAndColumns:this.constructor.colours[a],undoable:!1,isCellAvailable:this.isCellAvailable,isCellUndoable:this.isCellUndoable,settings:o,allowControl:l})}}]),t}(a.Component);Be.colours=(Te={},Object(I.a)(Te,G.PLAYER_A,[{y:0,cells:[{x:0,y:0,player:G.PLAYER_A,worker:G.WORKER_FIRST,level:0}]}]),Object(I.a)(Te,G.PLAYER_B,[{y:0,cells:[{x:0,y:0,player:G.PLAYER_B,worker:G.WORKER_FIRST,level:0}]}]),Te),Be.defaultProps={small:!1,medium:!1};var Ve,De,ze,He=Be,Ke=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={selectedGame:null,game:n.props.game,transformation:null},n.autoSubmitModal=r.a.createRef(),n.makeMove=function(e){n.props.submit?n.setState({game:e}):n.props.makeMove(e)},n.takeMoveBack=function(){n.makeMove(n.state.game.takeMoveBack())},n.undo=function(){n.makeMove(n.state.game.undo())},n.newGame=function(){n.makeMove(G.create())},n.selectGame=function(e){n.setState({selectedGame:e===n.state.game?null:e})},n.makeMoveToSelected=function(e){n.selectGame(e)},n.takeMoveBackToSelected=function(){n.selectGame(n.state.selectedGame.takeMoveBack())},n.undoToSelected=function(){n.selectGame(n.state.selectedGame.undo())},n.deselectGame=function(){n.selectGame(null)},n.submit=function(){var e=n.getMovesToSubmit();e.length&&n.props.submit(e)},n.resignOrAbort=function(){n.props.submit("resign")},n.changeAutoSubmitMoves=function(){n.props.user.settings.autoSubmitMoves?n.props.changeSettings(Object(C.a)({},n.props.user.settings,{autoSubmitMoves:!1})):n.autoSubmitModal.current.handleOpen()},n.doAutoSubmitMoves=function(){n.props.changeSettings(Object(C.a)({},n.props.user.settings,{autoSubmitMoves:!0})),n.canSubmit()&&n.submit()},n.onTransformationChange=function(e){var t=e.transformation;n.setState({transformation:t})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getMovesToSubmit",value:function(){var e=this.props.game,t=this.state.game.fullHistory,n=t.findIndex(function(t){return t.compressedFullNotation===e.compressedFullNotation});return n<0?(console.error("Could not find live game in history"),[]):t.slice(n+1).map(function(e){return e.lastMove})}},{key:"componentDidUpdate",value:function(e,t){this.props.game!==e.game&&((!this.props.game||!e.game||this.props.game.compressedFullNotation!==e.game.compressedFullNotation)&&this.setState({selectedGame:null,game:this.props.game,resigning:!1}));this.props.user&&this.props.user.settings.autoSubmitMoves&&!this.canSubmit(e,t)&&this.canSubmit()&&this.submit()}},{key:"canSubmit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,n=e.submit,a=t.selectedGame,r=t.game;return!!n&&!a&&r!==e.game&&!!this.getMovesToSubmit().length&&(r.finished||r.nextPlayer!==e.game.nextPlayer)}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.defaultSettings,o=e.names,l=e.allowControl,i=e.matchGame,s=e.children,c=this.state,u=c.selectedGame,m=c.game,h=c.transformation,v=u||m,f=l.length>0,g=this.canSubmit(),y=!!i&&i.tooShortToResign,b=t?t.settings:n,E=l.includes(G.PLAYER_A),O=r.a.createElement(a.Fragment,null,r.a.createElement(_e.a.Row,null,r.a.createElement(Xe,{player:E?G.PLAYER_B:G.PLAYER_A,canSubmit:!1,submit:this.props.submit?this.submit:null,changeAutoSubmitMoves:this.changeAutoSubmitMoves,game:g?m.previous:m,settings:b,names:o,allowControl:l})),r.a.createElement(_e.a.Row,null,r.a.createElement(Xe,{player:E?G.PLAYER_A:G.PLAYER_B,canSubmit:g,submit:this.props.submit?this.submit:null,changeAutoSubmitMoves:this.changeAutoSubmitMoves,game:g?m.previous:m,settings:b,names:o,allowControl:l})),r.a.createElement(_e.a.Row,null,r.a.createElement(Je,{game:m,selectedGame:u,selectGame:this.selectGame})),r.a.createElement(_e.a.Row,null,r.a.createElement(Me,{onChange:this.onTransformationChange})),s),k=r.a.createElement(Ie,{game:v,transformation:h,makeMove:u?this.makeMoveToSelected:this.makeMove,minChainCount:this.props.submit?this.props.game.chainCount:this.props.game.canUndo?this.props.game.previous.chainCount:this.props.game.chainCount,allowControl:v===m?l:void 0,settings:b,animated:b.theme.animations,showArrows:b.theme.arrows});return r.a.createElement(a.Fragment,null,r.a.createElement(d.a,{style:{textAlign:"center"}},r.a.createElement(_e.a,{centered:!0,columns:"equal",textAlign:"center"},r.a.createElement(xe.a,{as:_e.a.Row,minWidth:800},r.a.createElement(_e.a.Column,null,O),r.a.createElement(_e.a.Column,null,k)),r.a.createElement(xe.a,{as:a.Fragment,maxWidth:800},r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{stretched:!1,textAlign:"center"},k)),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{stretched:!1,textAlign:"center"},O))))),this.props.submit&&f?r.a.createElement(d.a,null,r.a.createElement(Le.a.Group,{widths:"two",size:"tiny"},r.a.createElement(Le.a,{value:r.a.createElement(Ue.a,{trigger:r.a.createElement(Ne.a,{negative:!0,disabled:!!u||this.props.game.finished},y?"Abort":"Resign"),header:y?"Abort?":"Resign?",content:"Are you sure you want to ".concat(y?"abort":"forfeit","?").concat(y?" This game is too short to resign.":""),actions:[{key:"resign",content:y?"Abort":"Resign",negative:!0,onClick:this.resignOrAbort},{key:"continue",content:"Continue",inverted:!0,secondary:!0}]})}),r.a.createElement(Le.a,{value:r.a.createElement(Ne.a,{negative:!0,onClick:this.props.submit?this.takeMoveBack:this.undo,disabled:!!u||(this.props.submit?m.chainCount<=this.props.game.chainCount:!m.canUndo)},"Undo")}))):null,this.props.submit?null:r.a.createElement(d.a,null,r.a.createElement(Le.a.Group,{widths:"two",size:"small"},r.a.createElement(Le.a,{value:r.a.createElement(Ne.a,{negative:!0,onClick:this.takeMoveBack,disabled:!!u||!m.previous},"Take Back a Move")}),r.a.createElement(Le.a,{value:r.a.createElement(Ne.a,{negative:!0,onClick:this.newGame,disabled:!!u||!m.previous},"New Game")}))),r.a.createElement(qe,{game:m,selectedGame:u,selectGame:this.selectGame,user:t,defaultSettings:n}),u?r.a.createElement(d.a,{textAlign:"center"},r.a.createElement(p.a,{as:"h2"},"Reviewing previous move"),r.a.createElement(Le.a.Group,{widths:"three",size:"small"},u.finished?r.a.createElement(Le.a,{color:"green",value:o[u.winner],label:"Won!"}):r.a.createElement(Le.a,{value:o[u.nextPlayer],label:this.constructor.MOVE_TYPE_NAMES[u.moveType]}),r.a.createElement(Le.a,{value:u.moveCount,label:"Move"}),r.a.createElement(Le.a,{value:r.a.createElement(Ne.a,{negative:!0,onClick:this.undoToSelected,disabled:!u.canUndo},"Undo")})),r.a.createElement(Le.a.Group,{widths:"two",size:"small"},r.a.createElement(Le.a,{value:r.a.createElement(Ne.a,{negative:!0,onClick:this.takeMoveBackToSelected,disabled:!u.previous},"Take Back a Move")}),r.a.createElement(Le.a,{value:r.a.createElement(Ne.a,{negative:!0,onClick:this.deselectGame},"Stop reviewing")}))):null,r.a.createElement(Ue.a,{ref:this.autoSubmitModal,header:"Auto submit moves",content:"Are you sure you want to be auto submitting your moves?",actions:[{key:"yes",content:"Auto submit",onClick:this.doAutoSubmitMoves,primary:!0},{key:"no",content:"No, manually submit moves",secondary:!0}]}))}}]),t}(a.Component);Ke.MOVE_TYPE_NAMES=(De={},Object(I.a)(De,G.MOVE_TYPE_PLACE_FIRST_WORKER,"Place a worker"),Object(I.a)(De,G.MOVE_TYPE_PLACE_SECOND_WORKER,"Place a worker"),Object(I.a)(De,G.MOVE_TYPE_SELECT_WORKER_TO_MOVE,"Select a worker"),Object(I.a)(De,G.MOVE_TYPE_MOVE_FIRST_WORKER,"Move worker"),Object(I.a)(De,G.MOVE_TYPE_MOVE_SECOND_WORKER,"Move worker"),Object(I.a)(De,G.MOVE_TYPE_BUILD_AROUND_WORKER,"Build"),De),Ke.defaultProps={names:(Ve={},Object(I.a)(Ve,G.PLAYER_A,"Player A"),Object(I.a)(Ve,G.PLAYER_B,"Player B"),Ve),allowControl:[G.PLAYER_A,G.PLAYER_B]};var Xe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.game,n=e.player,o=e.allowControl,l=e.names,i=e.settings,s=e.canSubmit,c=e.submit,u=e.changeAutoSubmitMoves,m=o.includes(n),h=t.nextPlayer===n,d=t.winner===n;return r.a.createElement(M.a,{stackable:!0,className:F()({attention:!t.finished&&m&&h&&!s}),size:"massive",inverted:t.finished||n===G.PLAYER_B,color:t.finished?d?"green":"red":void 0,items:[{key:"icon",icon:t.finished?d?"trophy":"thumbs down":h?"play":"hourglass",content:r.a.createElement(a.Fragment,null,r.a.createElement(He,{medium:!0,settings:i,player:n,allowControl:o}),l[n])},{key:"instructions",content:t.finished?d?"Won":"Lost":s?i.autoSubmitMoves?"Auto-submitting":r.a.createElement(Ne.a,{positive:!0,onClick:c,className:"attention"},"Submit"):h?this.constructor.MOVE_TYPE_NAMES[t.moveType]:"Waiting for opponent"},!t.finished&&c&&o.includes(n)?{key:"auto-submit",content:r.a.createElement(Ge.a,{label:"Auto submit moves",toggle:!0,checked:i.autoSubmitMoves,onChange:u})}:null].filter(function(e){return e})})}}]),t}(a.Component);Xe.MOVE_TYPE_NAMES=(ze={},Object(I.a)(ze,G.MOVE_TYPE_PLACE_FIRST_WORKER,"Place a worker"),Object(I.a)(ze,G.MOVE_TYPE_PLACE_SECOND_WORKER,"Place a worker"),Object(I.a)(ze,G.MOVE_TYPE_SELECT_WORKER_TO_MOVE,"Select a worker"),Object(I.a)(ze,G.MOVE_TYPE_MOVE_FIRST_WORKER,"Move worker"),Object(I.a)(ze,G.MOVE_TYPE_MOVE_SECOND_WORKER,"Move worker"),Object(I.a)(ze,G.MOVE_TYPE_BUILD_AROUND_WORKER,"Build"),ze);var qe=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={activePage:1},n.onPageChange=function(e,t){var a=t.activePage;n.setState({activePage:a})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.game,n=e.selectedGame,o=e.user,l=e.defaultSettings,i=e.selectGame,s=e.pageSize,c=this.state.activePage,u=Math.ceil((t.history.length-1)/s),m=Object(g.a)(t.history).slice(1+(u-c)*s,1+(u-c)*s+s).reverse(),h=m[m.length-1];return r.a.createElement(d.a,null,r.a.createElement(_e.a,{centered:!0},r.a.createElement(_e.a.Row,null,r.a.createElement(Je,{game:t,selectedGame:n,selectGame:i})),r.a.createElement(_e.a.Row,null,m.map(function(e){return r.a.createElement(a.Fragment,{key:e.chainCount},e.moveCount%2===1?r.a.createElement(Ye.a,{content:e.moveCount-1}):null,r.a.createElement(Ie,{game:e,small:!0,onSelect:i,selected:e===n,settings:o?o.settings:l}))}),h&&h.moveCount%2===0?r.a.createElement(Ye.a,{content:h.moveCount-2}):null),r.a.createElement(_e.a.Row,null,r.a.createElement(We.a,{totalPages:u,activePage:c,onPageChange:this.onPageChange,pointing:!0,secondary:!0}))))}}]),t}(a.Component);qe.defaultProps={pageSize:10};var Je=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).goToCurrentMove=function(){n.canGoToCurrentMove()&&n.props.selectGame(n.props.game)},n.goToNextMove=function(){if(n.canGoToNextMove()){var e=n.props.game.history.indexOf(n.props.selectedGame||n.props.game);n.props.selectGame(n.props.game.history[e+1])}},n.goToPreviousMove=function(){n.canGoToPreviousMove()&&n.props.selectGame((n.props.selectedGame||n.props.game).previousInHistory)},n.goToFirstMove=function(){n.canGoToFirstMove()&&n.props.selectGame(n.props.game.history[0])},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.keydown;if(t.event){var n=t.event,a=n.which,r=n.shiftKey;a===Fe.a.left&&r?this.goToCurrentMove():a===Fe.a.home?this.goToCurrentMove():a!==Fe.a.left||r?a!==Fe.a.right||r?a===Fe.a.right&&r?this.goToFirstMove():a===Fe.a.home&&this.goToFirstMove():this.goToPreviousMove():this.goToNextMove()}}},{key:"canGoToCurrentMove",value:function(){var e=this.gameIndexes;return e.selectedGameIndex!==e.lastGameIndex}},{key:"canGoToNextMove",value:function(){var e=this.gameIndexes,t=e.selectedGameIndex,n=e.lastGameIndex;return t>=0&&t!==n}},{key:"canGoToPreviousMove",value:function(){var e=this.gameIndexes.selectedGameIndex;return e>=0&&0!==e}},{key:"canGoToFirstMove",value:function(){return 0!==this.gameIndexes.selectedGameIndex}},{key:"render",value:function(){var e=this.props,t=e.game,n=e.selectedGame,a=this.gameIndexes.selectedGameIndex;return r.a.createElement(M.a,{size:"massive",items:[{key:"current",icon:"fast backward",onClick:this.goToCurrentMove,disabled:!this.canGoToCurrentMove()},{key:"previous",icon:"backward",onClick:this.goToNextMove,disabled:!this.canGoToNextMove()},{key:"moveCount",content:a>=0?"".concat((n||t).moveCount,"/").concat(t.moveCount):n.moveCount,disabled:t.finished},{key:"next",icon:"forward",onClick:this.goToPreviousMove,disabled:!this.canGoToPreviousMove()},{key:"first",icon:"fast forward",onClick:this.goToFirstMove,disabled:!this.canGoToFirstMove()}]})}},{key:"gameIndexes",get:function(){var e=this.props,t=e.game,n=e.selectedGame;return{selectedGameIndex:t.history.indexOf(n||t),lastGameIndex:t.history.length-1}}}]),t}(a.Component);Je.keys=["left","right","shift+left","shift+right","home","end"],Je=Object(Fe.b)(Je.keys)(Je);var $e=Ke,Qe=function(e){var t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)},Ze=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={connected:O.connected,available:O.available,disconnected:O.disconnected,user:O.user,username:O.user?O.user.name:null,usersInfo:O.usersInfo,gamesInfo:O.gamesInfo,tournamentsInfo:O.tournamentsInfo},n.connectionChanged=function(e){n.setState({connected:e,disconnected:O.disconnected,available:O.available})},n.gotUser=function(e){n.setState({user:e})},n.gotUsers=function(e){n.setState({usersInfo:e})},n.gotGames=function(e){n.setState({gamesInfo:e})},n.gotTournaments=function(e){n.setState({tournamentsInfo:e})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){O.subscribe({onConnect:this.connectionChanged,onDisconnect:this.connectionChanged,onUser:this.gotUser,onUsers:this.gotUsers,onGames:this.gotGames,onTournaments:this.gotTournaments})}},{key:"componentWillUnmount",value:function(){O.unsubscribe({onUser:this.gotUser,onUsers:this.gotUsers,onGames:this.gotGames,onTournaments:this.gotTournaments})}},{key:"render",value:function(){var e=this.state,t=e.connected,n=e.disconnected,a=e.available,o=e.user,l=e.usersInfo,i=e.gamesInfo,s=e.tournamentsInfo,c=this.constructor.SubComponent;return r.a.createElement(c,Object.assign({},this.props,{connected:t,disconnected:n,available:a,client:O,user:o,usersInfo:l,gamesInfo:i,tournamentsInfo:s}))}}],[{key:"forComponent",value:function(e){var t=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),t}(this);return t.SubComponent=e,t}}]),t}(a.Component);Ze.SubComponent=null;var et=function(e){return Ze.forComponent(e)},tt=et(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state=Object(C.a)({error:!1},n.constructor.getGameAndErrorFromUrlPosition()),n.dismissUrlPositionError=function(){n.setState({error:null})},n.makeMove=function(e){n.setState({game:e})},n.share=function(){var e=n.props.location.pathname;if(navigator.share){var t=n.state.game;navigator.share({title:"Thyra Online - Game after ".concat(t.moveCount," moves"),text:"Review Santorini game between after ".concat(t.moveCount," moves"),url:e}).catch(function(){Qe(e),alert("Link copied to clipboard")})}else Qe(e),alert("Link copied to clipboard")},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.game,n=e.error,o=this.props,l=o.user,i=o.client;return r.a.createElement(a.Fragment,null,r.a.createElement(Ue.a,{open:n,size:"mini",onClose:this.dismissUrlPositionError,header:"Could not load shared position",content:"".concat(n,". Please check that you copied the full URL"),actions:[{content:"OK",positive:!0}]}),r.a.createElement(_e.a,{centered:!0},r.a.createElement(_e.a.Row,null,r.a.createElement(M.a,{inverted:!0,size:"massive",items:[{key:"share",icon:"share",content:"Share position",color:"green",active:!0,as:"a",href:"?position=".concat(t.compressedFullNotation),title:navigator.share?"Click to open the sharing menu":"Click to copy URL to game"}]}))),r.a.createElement($e,{user:l,defaultSettings:i.settings,game:t,makeMove:this.makeMove}))}}],[{key:"getGameAndErrorFromUrlPosition",value:function(){var e=new URLSearchParams(window.location.search).get("position");if(e){var t,n;try{(t=G.fromCompressedNotation(e))||(n="The position was not valid")}catch(a){t=null,n="The series of moves where not valid"}return n?{game:G.create(),error:n}:{game:t,error:!1}}return{game:G.create(),error:!1}}}]),t}(a.Component)),nt=n(473),at=n(61),rt=n(467),ot=n(245),lt=n.n(ot),it=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).ref=r.a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.updateIcon()}},{key:"updateIcon",value:function(){this.ref.current&&lt.a.update(this.ref.current)}},{key:"componentDidUpdate",value:function(e){e.hash!==this.props&&this.updateIcon()}},{key:"render",value:function(){var e,t=this.props,n=t.hash,a=t.floated,o=t.size,l=t.textSized;return r.a.createElement("svg",{ref:this.ref,className:F()(["ui","mini","right","floated","image"],(e={floated:!!a},Object(I.a)(e,a,!!a),Object(I.a)(e,o,!!o),Object(I.a)(e,"text-sized",l),e)),"data-jdenticon-value":n})}}]),t}(a.Component);it.defaultProps={textSized:!1};var st=it,ct=n(127),ut=n.n(ct),mt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).selectLiveGame=function(){n.props.selectLiveGame(n.props.game)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.usersById,a=e.tournamentsById,o=e.game,l=e.terse,i=e.live,s=e.currentGameId,c=a[o.tournamentId],u=G.deserialize(o.game),m=n[o.userIds[0]],h=n[o.userIds[1]],d=u.nextPlayer===G.PLAYER_A?m:h,p=d===m,v=d===h,f=!!t&&m.id===t.id,g=!!t&&h.id===t.id,y=o.finished?o.winner===G.PLAYER_A?m:h:null,b=f||g,E=f&&p||g&&v,O=!l||!b||g,k=!l||!b||f;return r.a.createElement(nt.a,{onClick:this.selectLiveGame,style:Object(C.a)({},l?{width:"auto"}:{},o.id===s?{backgroundColor:"lightgreen"}:{}),className:F()({attention:i&&E})},r.a.createElement(nt.a.Content,null,l?null:r.a.createElement(Ie,{className:"ui image floated right mini",game:u,small:!0,settings:t?t.settings:void 0}),r.a.createElement(nt.a.Header,null,O&&k?null:" vs ",O?r.a.createElement(Ye.a,{color:y===m||E?"green":void 0},y===m?r.a.createElement(at.a,{name:"trophy"}):null,p?r.a.createElement(at.a,{name:"caret right"}):null,m.name,r.a.createElement(st,{floated:"right",size:"mini",textSized:!0,hash:m.id})):null,O&&k?" vs ":null,k?r.a.createElement(Ye.a,{color:y===h||E?"green":void 0},y===h?r.a.createElement(at.a,{name:"trophy"}):null,v?r.a.createElement(at.a,{name:"caret right",color:"green"}):null,h.name,r.a.createElement(st,{floated:"right",size:"mini",textSized:!0,hash:h.id})):null),l?null:r.a.createElement(nt.a.Meta,null,b?r.a.createElement(Ye.a,{icon:{name:"user",color:"green"},content:"My game"}):null," ",o.finished?null:r.a.createElement(Ye.a,{icon:{name:"circle",color:"green"},content:"Live"})," ",r.a.createElement(Ye.a,{content:"Move ".concat(o.move),icon:"play"})," ",r.a.createElement(Ye.a,{content:ut()(o.endDatetime||o.startDatetime).from(),icon:"calendar"})," ",c?r.a.createElement(Ye.a,{content:c.name,icon:"sitemap"}):null)))}}]),t}(a.Component);mt.defaultProps={terse:!1,live:!1};var ht=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={activePage:1},n.onPageChange=function(e,t){var a=t.activePage;n.setState({activePage:a})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.usersById,o=e.tournamentsById,l=e.games,i=e.terse,s=e.live,c=e.selectLiveGame,u=e.currentGameId,m=e.pageSize;if(!Object.values(n).length)return null;var h=this.state.activePage,d=Math.ceil(l.length/m);h>d&&(h=d);var p=l.slice((d-h)*m,(d-h)*m+m).reverse();return r.a.createElement(a.Fragment,null,r.a.createElement(nt.a.Group,{style:{maxHeight:"300px",overflowY:"auto",flexWrap:i?"unset":void 0}},p.map(function(e){return r.a.createElement(mt,{key:e.id,user:t,usersById:n,tournamentsById:o,game:e,selectLiveGame:c,terse:i,live:s,currentGameId:u})})),d>1?r.a.createElement(_e.a,{centered:!0},r.a.createElement(_e.a.Row,null,r.a.createElement(We.a,{totalPages:d,activePage:h,onPageChange:this.onPageChange,pointing:!0,secondary:!0}))):null)}}]),t}(a.Component);ht.defaultProps={terse:!1,live:!1,pageSize:10};var dt=ht,pt=n(469),vt=et(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",gameCount:"1"},n.createTournament=function(){var e=n.props.client,t=n.state,a=t.name,r=t.gameCount;e.createTournament({name:a,gameCount:parseInt(r,10)})},n.onClose=function(){n.setState({name:"",gameCount:1})},n.setValue=function(e,t){var a=t.name,r=t.value;n.setState(Object(I.a)({},a,r))},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(Ue.a,{size:"mini",trigger:r.a.createElement(Ne.a,{color:"yellow",icon:"sitemap",content:"Create tournament"}),header:"Create tournament",content:r.a.createElement(d.a,null,r.a.createElement(pt.a,null,r.a.createElement(pt.a.Field,{name:"name",control:rt.a,label:"Name",placeholder:"Tournament name",onChange:this.setValue,required:!0,defaultValue:this.state.name}),r.a.createElement(pt.a.Field,{name:"gameCount",control:rt.a,label:"".concat(this.state.gameCount," game(s) between each pair of players"),placeholder:"Game count between each pair of players",onChange:this.setValue,type:"range",min:1,max:5,defaultValue:this.state.gameCount,required:!0}))),actions:[{key:"cancel",content:"Cancel"},{key:"create",positive:!0,content:"Create Tournament",onClick:this.createTournament,disabled:!this.state.name}],onClose:this.onClose})}}]),t}(a.Component)),ft=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).selectLiveTournament=function(){n.props.selectLiveTournament(n.props.tournament)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.usersById,a=e.currentTournamentId,o=e.tournament,l=e.terse,i=!!t&&o.userIds.includes(t.id),s=!!t&&o.creatorUserId===t.id,c=!!o.finished&&o.winnerUserId===t.id,u=n[o.creatorUserId],m=r.a.createElement(Ye.a,{content:o.started?o.finished?"Finished":"Round ".concat(o.round,"/").concat(o.rounds):"Waiting",icon:{name:o.started?o.finished?"trophy":"play":"hourglass",colour:o.started?"green":void 0}});return r.a.createElement(nt.a,{onClick:this.selectLiveTournament,style:Object(C.a)({},l?{width:"auto"}:{},o.id===a?{backgroundColor:"lightgreen"}:{})},r.a.createElement(nt.a.Content,null,r.a.createElement(nt.a.Header,null,r.a.createElement(Ye.a,{content:o.name})," by",r.a.createElement(Ye.a,{color:s?"green":void 0,content:u.name}),l?m:null),l?null:r.a.createElement(nt.a.Meta,null,i?r.a.createElement(Ye.a,{icon:{name:"user",color:"green"},content:"Participating"}):null," ",c?r.a.createElement(Ye.a,{icon:{name:"trophy",color:"yellow"},content:"Won"}):o.finished?r.a.createElement(Ye.a,{icon:"trophy",content:n[o.winnerUserId]?n[o.winnerUserId].name:o.winnerUserId}):null," ",o.started&&!o.finished?r.a.createElement(Ye.a,{icon:{name:"circle",color:"green"},content:"Live"}):null," ",m," ",r.a.createElement(Ye.a,{content:"".concat(o.userIds.length," players"),icon:"users"})," ",r.a.createElement(Ye.a,{content:ut()(o.endDatetime||o.startDatetime||o.createdDate).from(),icon:"calendar"}))))}}]),t}(a.Component);ft.defaultProps={terse:!1};var gt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={activePage:1},n.onPageChange=function(e,t){var a=t.activePage;n.setState({activePage:a})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.usersById,o=e.tournaments,l=e.terse,i=e.selectLiveTournament,s=e.currentTournamentId,c=e.pageSize;if(!Object.values(n).length)return null;var u=this.state.activePage,m=Math.ceil(o.length/c);u>m&&(u=m);var h=o.slice((m-u)*c,(m-u)*c+c).reverse();return r.a.createElement(a.Fragment,null,r.a.createElement(nt.a.Group,{style:{maxHeight:"300px",overflowY:"auto",flexWrap:l?"unset":void 0}},h.map(function(e){return r.a.createElement(ft,{key:e.id,user:t,usersById:n,tournament:e,currentTournamentId:s,selectLiveTournament:i,terse:l})})),m>1?r.a.createElement(_e.a,{centered:!0},r.a.createElement(_e.a.Row,null,r.a.createElement(We.a,{totalPages:m,activePage:u,onPageChange:this.onPageChange,pointing:!0,secondary:!0}))):null)}}]),t}(a.Component);gt.defaultProps={terse:!1,pageSize:10};var yt=gt,bt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.client,n=e.user,a=e.users,o=e.challengedUser,l=e.readyToPlayUsers,i=e.readyToPlayMeUsers;return r.a.createElement(nt.a.Group,{style:{maxHeight:"300px",overflowY:"auto"}},a.map(function(e){return r.a.createElement(Et,{key:e.id,client:t,user:n,otherUser:e,challengedUser:o,readyToPlayUsers:l,readyToPlayMeUsers:i})}))}}]),t}(a.Component),Et=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).changeReadyToPlay=function(){n.props.client.changeReadyToPlay(!n.props.user.readyToPlay)},n.challengeUser=function(){n.props.client.changeReadyToPlay(n.props.user.readyToPlay!==n.props.otherUser.id&&n.props.otherUser.id)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t,n,a,o,l=this.props,i=l.client,s=l.user,c=l.otherUser,u=l.challengedUser,m=l.readyToPlayUsers,h=l.readyToPlayMeUsers;return i&&s&&(s.id===c.id?(a=this.changeReadyToPlay,s.readyToPlay?(e="green",n={loading:!0,name:"circle notch"},o=u?"Waiting for ".concat(u.name,"..."):"Waiting for opponent..."):(e="yellow",n={name:"play"},h&&h.length?1===h.length?(o="".concat(h[0].name," has challenged you"),t=!0):(o="".concat(h.length," users have challenged you"),t=!0):o=m&&m.length?1===m.length?"Play ".concat(m[0].name):"".concat(m.length," users ready to play"):"Play")):(a=this.challengeUser,u&&u.id===c.id?(e="green",n={loading:!0,name:"circle notch"},o="Waiting for ".concat(c.name,"...")):c.online?(e="yellow",n={name:"play"},c.readyToPlay===s.id?(o="".concat(c.name," has challenged you"),t=!0):o=!0===c.readyToPlay?"".concat(c.name," is ready to Play"):"Challenge ".concat(c.name)):(o=null,a=null))),r.a.createElement(nt.a,null,r.a.createElement(nt.a.Content,null,r.a.createElement(st,{floated:"right",size:"mini",hash:c.id}),r.a.createElement(nt.a.Header,null,c.name," ",i&&s&&s.id===c.id?r.a.createElement(Ot,{client:i,user:s,trigger:r.a.createElement(Ye.a,{as:"a",icon:"edit",content:"Edit"})}):null),r.a.createElement(nt.a.Meta,null,s&&c.id===s.id?r.a.createElement(Ye.a,null,r.a.createElement(at.a,{name:"user",color:"green"}),"Me"):null," ",s&&c.id===s.id?r.a.createElement(Ot,{client:i,user:s,trigger:r.a.createElement(Ye.a,{as:"a"},r.a.createElement(at.a,{name:"lock",color:s.hasPassword?"green":"red"}),s.hasPassword?"":"No password")}):null," ",c.readyToPlay?r.a.createElement(Ye.a,null,r.a.createElement(at.a,{loading:!0,name:"circle notch",color:"green"}),"Ready"):null," ",c.online?r.a.createElement(Ye.a,null,r.a.createElement(at.a,{name:"circle",color:"green"}),"Online"):null," ",r.a.createElement(Ye.a,{title:"".concat(c.isUserRatingProvisional?"Provisional - ":"","Won ").concat(c.winCount," out of ").concat(c.gameCount),color:{1:"yellow",2:"grey",3:"brown"}[c.rank]},r.a.createElement(at.a,{name:c.isUserRatingProvisional?"question":"star outline",color:c.isUserRatingProvisional?"orange":void 0})," ",c.score)," ",r.a.createElement(Ye.a,{icon:"trophy",content:" ".concat(c.winCount,"/").concat(c.gameCount)})," ",c.tournamentWinCount?r.a.createElement(Ye.a,{icon:{name:"sitemap",color:"yellow"},content:c.tournamentWinCount,title:"Won ".concat(c.tournamentWinCount,"/").concat(c.tournamentCount," tournaments entered")}):null)),o?r.a.createElement(nt.a.Content,{extra:!0},r.a.createElement("div",{className:"ui two buttons"},r.a.createElement(Ne.a,{className:F()({attention:t}),color:e,onClick:a},r.a.createElement(at.a,n),o))):null)}}]),t}(a.Component),Ot=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user:n.props.user,username:n.props.user.name,password:""},n.changeUsername=function(e){var t=e.target.value;n.setState({username:t})},n.changePassword=function(e){var t=e.target.value;n.setState({password:t})},n.updateUsername=function(){n.props.client.changeUsername(n.state.username)},n.updatePassword=function(){n.props.client.changePassword(n.state.password),n.setState({password:""})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.password,a=this.props,o=a.user,l=a.trigger;return r.a.createElement(Ue.a,{trigger:l,size:"small",header:"Edit user",content:r.a.createElement(d.a,null,r.a.createElement(rt.a,{label:"Name",value:t,onChange:this.changeUsername,action:{content:"Change",onClick:this.updateUsername}}),r.a.createElement("br",null),r.a.createElement(rt.a,{label:{content:o.hasPassword?"Password is set":"Set a password",color:o.hasPassword?"green":"red"},value:n,onChange:this.changePassword,action:{content:"Change",color:o.hasPassword?void 0:"green",onClick:this.updatePassword}})),actions:[{key:"cancel",negative:!0,content:"Cancel"}]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.user!==t.user?{user:e.user,username:e.user?e.user.name:null}:null}}]),t}(a.Component),kt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",mergeUsers:!1},n.changeUsername=function(e){var t=e.target.value;n.setState({username:t})},n.changePassword=function(e){var t=e.target.value;n.setState({password:t})},n.changeMergeUsers=function(e){var t=e.target.checked;n.setState({mergeUsers:t})},n.logIn=function(){n.props.client.logIn(n.state.username,n.state.password,n.mergeUsers),n.setState({username:"",password:""})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.password,a=e.mergeUsers;return r.a.createElement(Ue.a,{ref:this.modal,trigger:r.a.createElement(Ye.a,{as:"a",icon:"sign in",content:"Log In",float:"left"}),size:"small",header:"Log In",content:r.a.createElement(d.a,null,r.a.createElement(rt.a,{label:"Name",value:t,onChange:this.changeUsername}),r.a.createElement("br",null),r.a.createElement(rt.a,{label:"Password",value:n,onChange:this.changePassword}),r.a.createElement("br",null),r.a.createElement(Ge.a,{label:"Merge users",checked:a,onChange:this.changeMergeUsers})),actions:[{key:"cancel",negative:!0,content:"Cancel"},{key:"logIn",positive:!0,content:"Log In",onClick:this.logIn}]})}}]),t}(a.Component),Ct=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).logOut=function(){n.props.client.logOut()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(Ye.a,{as:"a",icon:"log out",content:"Log Out",onClick:this.logOut})}}]),t}(a.Component),wt=et(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).changeReadyToPlay=function(){n.props.client.changeReadyToPlay(!n.props.user.readyToPlay)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.client,n=e.user,o=e.usersInfo,l=o.byId,i=o.users,s=o.online,c=o.offline,u=o.challengedUser,m=o.readyToPlay,h=o.readyToPlayMe,p=e.gamesInfo,v=p.myLive,g=p.otherLive,y=p.myFinished,b=p.otherFinished,E=e.selectLiveGame,O=e.selectLiveTournament,k=e.tournamentsInfo,C=k.byId;return n?r.a.createElement(a.Fragment,null,r.a.createElement(nt.a.Group,{centered:!0},n?r.a.createElement(Et,{client:t,otherUser:n,user:n,challengedUser:u,readyToPlayUsers:m,readyToPlayMeUsers:h}):null),r.a.createElement(d.a,null,r.a.createElement(f.a,{menu:{pointing:!0},panes:[{label:"My Live games",items:v,color:"green"},{label:"Other Live games",items:g,color:"green"},{label:"My Past games",items:y},{label:"Other Past games",items:b}].filter(function(e){return e.items.length}).map(function(e){var t=e.label,o=e.items,i=e.color;return{menuItem:{content:r.a.createElement(a.Fragment,null,t," ",r.a.createElement(Ye.a,{content:o.length,color:i}))},render:function(){return r.a.createElement(dt,{user:n,usersById:l,tournamentsById:C,games:o,selectLiveGame:E})}}})})),r.a.createElement(d.a,null,r.a.createElement(vt,null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(f.a,{menu:{pointing:!0},panes:[{label:"My Future & Running tournaments",items:k.myFutureAndLive,color:"green"},{label:"Other Future and Running tournaments",items:k.otherFutureAndLive,color:"green"},{label:"My Past tournaments",items:k.myFinished},{label:"Other Past tournaments",items:k.otherFinished}].filter(function(e){return e.items.length}).map(function(e){var t=e.label,o=e.items,i=e.color;return{menuItem:{content:r.a.createElement(a.Fragment,null,t," ",r.a.createElement(Ye.a,{content:o.length,color:i}))},render:function(){return r.a.createElement(yt,{user:n,usersById:l,tournaments:o,selectLiveTournament:O})}}})})),r.a.createElement(d.a,null,r.a.createElement(f.a,{menu:{pointing:!0},panes:[{label:"Online Users",items:s,color:"green"},{label:"Offline Users",items:c},{label:"All Users",items:i}].filter(function(e){return e.items.length}).map(function(e){var o=e.label,l=e.items,i=e.color;return{menuItem:{key:o,content:r.a.createElement(a.Fragment,null,o," ",r.a.createElement(Ye.a,{content:l.length,color:i}))},render:function(){return r.a.createElement(bt,{client:t,users:l,user:n,challengedUser:u,readyToPlayUsers:m,readyToPlayMeUsers:h})}}})}))):r.a.createElement(f.a.Pane,null,"Connecting to server...")}}]),t}(a.Component)),Pt=n(50),jt=n(74),Mt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).themeSchemeOptions=[{value:"",label:"Default"},{value:"subtle",label:"Subtle"},{value:"pastel",label:"Pastel"},{value:"green",label:"Green"}],n.themePiecesOptions=[{value:"pawn",label:"Pawn"},{value:"king",label:"King"},{value:"circle",label:"Circle"},{value:"certificate",label:"Star"},{value:"sun",label:"Sun"},{value:"rocket",label:"Rocket"},{value:"bug",label:"Bug"},{value:"eye",label:"Eye"},{value:"user",label:"User"}],n.themeNumbersOptions=[{value:"",label:"None"},{value:"obvious",label:"Obvious"},{value:"subtle",label:"Subtle"},{value:"very-subtle",label:"Very subtle"}],n.themeDemoBoard=function(e){var t=n.props.settings.theme;return r.a.createElement(Se,{medium:!0,settings:{theme:Object(C.a)({},t,{animations:!1},e)}})},n.updateAutoSubmitMove=function(e,t){var a=t.checked;n.props.updateSettings({autoSubmitMoves:a})},n.updateEnableNotifications=function(e,t){var a=t.checked;n.props.updateSettings({enableNotifications:a})},n.updateThemeRotateOpponent=function(e,t){var a=t.checked;n.props.updateSettings({theme:{rotateOpponent:a}})},n.updateAnimations=function(e,t){var a=t.checked;n.props.updateSettings({theme:{animations:a}})},n.updateArrows=function(e,t){var a=t.checked;n.props.updateSettings({theme:{arrows:a}})},n.updateThemeNumbers=function(e,t){var a=t.value;n.props.updateSettings({theme:{numbers:a}})},n.updateThemeScheme=function(e,t){var a=t.value;n.props.updateSettings({theme:{scheme:a}})},n.updateThemePieces=function(e,t){var a=t.value;n.props.updateSettings({theme:{pieces:a}})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.settings,n=t.autoSubmitMoves,a=t.enableNotifications,o=t.theme,l=o.pieces,i=void 0===l?"king":l,s=o.scheme,c=o.rotateOpponent,u=o.animations,m=o.arrows,h=o.numbers;return r.a.createElement(f.a,{menu:{pointing:!0,attached:!1},panes:[{menuItem:"Playing",render:function(){return r.a.createElement(d.a,null,r.a.createElement(pt.a,null,r.a.createElement(pt.a.Group,null,r.a.createElement(Ge.a,{label:"Auto-submit online moves",name:"autoSubmitMoves",checked:n,onChange:e.updateAutoSubmitMove})),r.a.createElement(pt.a.Group,null,r.a.createElement(Ge.a,{label:"Enable notifications",name:"enableNotifications",checked:a,onChange:e.updateEnableNotifications}))))}},{menuItem:"Theme",render:function(){return r.a.createElement(d.a,null,r.a.createElement(_e.a,{stackable:!0,columns:"equal",verticalAlign:"middle"},r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{textAlign:"center"},e.themeDemoBoard({animations:o.animations}))),r.a.createElement(_e.a.Row,null,r.a.createElement(f.a,{menu:{pointing:!0,attached:!1},panes:[{menuItem:"Pieces",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(_e.a,{stackable:!0,columns:"equal",verticalAlign:"middle"},r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{width:4},r.a.createElement(Ge.a,{label:"Rotate Opponent",name:"theme.rotateOpponent",checked:c,onChange:e.updateThemeRotateOpponent})),r.a.createElement(_e.a.Column,{floated:"right",textAlign:"right"},e.themeDemoBoard({rotateOpponent:!0}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{width:4},r.a.createElement(Ge.a,{label:"Animation",name:"theme.animations",checked:u,onChange:e.updateAnimations})),r.a.createElement(_e.a.Column,{floated:"right",textAlign:"right"},e.themeDemoBoard({animations:!0}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{width:4},r.a.createElement(Ge.a,{label:"Arrows",name:"theme.arrows",checked:m,onChange:e.updateArrows})),r.a.createElement(_e.a.Column,{floated:"right",textAlign:"right"},e.themeDemoBoard({arrows:!0}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Column,{textAlign:"center"},r.a.createElement(pt.a.Field,null,r.a.createElement(p.a,{as:"h2"},"Pieces:")))),e.themePiecesOptions.map(function(t){return r.a.createElement(_e.a.Row,{key:"theme-pieces-".concat(t.value)},r.a.createElement(_e.a.Column,{width:4},r.a.createElement(Ge.a,{radio:!0,label:t.label,name:"theme.pieces",value:t.value,checked:i===t.value,onChange:e.updateThemePieces})),r.a.createElement(_e.a.Column,{floated:"right",textAlign:"right"},e.themeDemoBoard({pieces:t.value})))})))}},{menuItem:"Board",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(_e.a,{stackable:!0,columns:"equal",verticalAlign:"middle"},e.themeSchemeOptions.map(function(t){return r.a.createElement(_e.a.Row,{key:"theme-scheme-".concat(t.value)},r.a.createElement(_e.a.Column,{width:4},r.a.createElement(Ge.a,{radio:!0,label:t.label,name:"theme.scheme",value:t.value,checked:s===t.value,onChange:e.updateThemeScheme})),r.a.createElement(_e.a.Column,{floated:"right",textAlign:"right"},e.themeDemoBoard({scheme:t.value})))})))}},{menuItem:"Level Indicators",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(_e.a,{stackable:!0,columns:"equal",verticalAlign:"middle"},e.themeNumbersOptions.map(function(t){return r.a.createElement(_e.a.Row,{key:"theme-numbers-".concat(t.value)},r.a.createElement(_e.a.Column,{width:4},r.a.createElement(Ge.a,{radio:!0,label:t.label,name:"theme.numbers",value:t.value,checked:h===t.value,onChange:e.updateThemeNumbers})),r.a.createElement(_e.a.Column,{floated:"right",textAlign:"right"},e.themeDemoBoard({numbers:t.value})))})))}}]}))))}}]})}}]),t}(a.Component),Rt=et(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,settings:k.getDefaultSettings()},n.updateSettings=function(e){n.setState(function(t){return{settings:Object(C.a)({},t.settings,e,{theme:Object(C.a)({},t.settings.theme,e.theme)})}})},n.save=function(){n.props.client.updateSettings(n.state.settings)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.settings;return r.a.createElement(Ue.a,{trigger:r.a.createElement(Ye.a,{as:"a",icon:"cog",content:"Settings"}),size:"small",header:"Settings",actions:[{key:"cancel",content:"Cancel"},{key:"save",content:"Save",positive:!0,onClick:this.save}],content:{scrolling:!0,content:r.a.createElement(Mt,{settings:e,updateSettings:this.updateSettings})}})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.user&&e.user!==t.user?{user:e.user,settings:e.user.settings||k.getDefaultSettings()}:{}}}]),t}(a.Component)),At=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t,n=this.props,o=n.game,l=n.player;o?o.initialPlayerA.id===l.id?(e=o.initialPlayerA,t=o.resultingPlayerAScore):o.initialPlayerB.id===l.id?(e=o.initialPlayerB,t=o.resultingPlayerBScore):(e=null,t=null):(e=null,t=null);var i=o&&o.winnerUserId===l.id;return r.a.createElement(a.Fragment,null,i?r.a.createElement(at.a,{name:"trophy",color:"green"}):null," ",r.a.createElement("span",{style:i?{color:"#21BA45"}:void 0},l.name,e?r.a.createElement(a.Fragment,null," ","(",t?r.a.createElement(a.Fragment,null,i?"+".concat(e.winPoints):e.losePoints," ",r.a.createElement(at.a,{name:"long arrow alternate right"})," ",t):r.a.createElement(a.Fragment,null,e.score," ","+",e.winPoints,"/",e.losePoints),")"):null),r.a.createElement(st,{floated:"right",size:"mini",hash:l.id}))}}]),t}(a.Component),Tt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).gameSelector=Object(jt.a)([function(e){return e.match.params.id},function(e){return e.gamesInfo.byId}],function(e,t){return t[e]}),n.playersInfoSelector=Object(jt.a)([function(e){return e.user},function(e){return e.usersInfo},function(){return n.game}],function(e,t,n){var a=t.byId,r=a[n.userIds[0]],o=a[n.userIds[1]],l=!!e&&r.id===e.id,i=!!e&&o.id===e.id;return{playerA:r,playerB:o,isUserPlayerA:l,isUserPlayerB:i,userPlayer:l?G.PLAYER_A:i?G.PLAYER_B:null,otherUser:l?o:i?r:null}}),n.gameGameSelector=Object(jt.a)([function(){return n.game}],function(e){return e?G.deserialize(e.game):null}),n.dismissUrlGameError=function(){n.props.selectLiveGame(null)},n.submit=function(e){n.props.client.submitGameMove(n.game,e)},n.close=function(){n.props.selectLiveGame(null)},n.changeSettings=function(e){n.props.client.updateSettings(e)},n.shareGame=function(e){var t=n.props.location.pathname;if(navigator.share){var a=n.game,r=n.playersInfo,o=r.playerA,l=r.playerB;navigator.share({title:"Thyra Online - ".concat(a.finished?"Review":"Live"," ").concat(o.name," vs ").concat(l.name),text:"".concat(a.finished?"Review finished":"Watch live"," Santorini game between ").concat(o.name," and ").concat(l.name),url:t}).catch(function(){Qe(t),alert("Link copied to clipboard")})}else Qe(t),alert("Link copied to clipboard");e.preventDefault()},n.challengeUser=function(){var e=n.playersInfo.otherUser;e&&n.props.client.changeReadyToPlay(e.id)},n.stopChallengeUser=function(){n.props.client.changeReadyToPlay(!1)},n.getEditPositionUrl=function(){var e=Object(Pt.a)(n).gameGame;return"".concat("/thyra-online").concat("/thyra-online".endsWith("/")?"":"/","hotseat?position=").concat(e.compressedFullNotation)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.game;e&&this.props.selectLiveGame(e)}},{key:"componentDidUpdate",value:function(){var e=this.game;e&&this.props.selectLiveGame(e)}},{key:"render",value:function(){var e,t=this.props,n=t.location,o=t.user,l=t.client,i=t.game,s=t.selectLiveGame,c=t.usersInfo,u=c.challengedUser,m=c.byId,h=t.gamesInfo,p=h.otherLive,v=h.myLive,f=t.tournamentsInfo.byId,g=this.gameGame;if(!g)return r.a.createElement(a.Fragment,null,r.a.createElement(Ue.a,{open:!0,size:"mini",onClose:this.dismissUrlGameError,header:"Could not find game",content:"This game cannot be found. Please check that you copied the full URL, or perhaps the game was aborted",actions:[{key:"ok",content:"OK",positive:!0}]}),"Could not find game");var y=this.playersInfo,b=y.otherUser,E=y.playerA,O=y.playerB,k=y.isUserPlayerA,C=y.isUserPlayerB,w=y.userPlayer;if(!E||!O)return null;var P=r.a.createElement(d.a,null,r.a.createElement(dt,{user:o,selectLiveGame:s,games:v,usersById:m,tournamentsById:f,terse:!0,live:!0,currentGameId:i?i.id:null}),p.length?r.a.createElement(dt,{user:o,selectLiveGame:s,games:p,usersById:m,tournamentsById:f,terse:!0,live:!0,currentGameId:i?i.id:null}):null);return r.a.createElement(a.Fragment,null,r.a.createElement(Rt,null),r.a.createElement(_e.a,{centered:!0},r.a.createElement(_e.a.Row,null,r.a.createElement(M.a,{stackable:!0,size:"massive",inverted:!0,items:[{key:"close",content:"Close",icon:"x",onClick:this.close,color:"red",active:!0},{key:"share",content:"Share Game",icon:"share",onClick:this.shareGame,as:"a",href:n.pathname,color:"green",active:!0,title:navigator.share?"Click to open the sharing menu":"Click to copy URL to game"},{key:"edit",content:"Edit position",icon:"edit",as:"a",href:this.getEditPositionUrl(),color:"green",active:!0,title:"Click to open hotseat with this game",target:"_blank"}]})),r.a.createElement(_e.a.Row,null,r.a.createElement(M.a,{stackable:!0,size:"massive",items:[{key:"player-a",content:r.a.createElement(a.Fragment,null,k?r.a.createElement(Ye.a,{color:"green",icon:"user",content:"Me"}):null,r.a.createElement(At,{game:i,player:E})),color:k?"green":void 0},{key:"player-b",content:r.a.createElement(a.Fragment,null,C?r.a.createElement(Ye.a,{color:"green",icon:"user",content:"Me"}):null,r.a.createElement(At,{game:i,player:O})),color:C?"green":void 0}]}))),r.a.createElement(xe.a,{as:a.Fragment,maxWidth:800},P),r.a.createElement($e,{user:o,defaultSettings:l.settings,otherUser:b,changeSettings:this.changeSettings,game:g,matchGame:i,names:(e={},Object(I.a)(e,G.PLAYER_A,E.name),Object(I.a)(e,G.PLAYER_B,O.name),e),allowControl:[w].filter(function(e){return e}),submit:this.submit,challengeUser:this.challengeUser,stopChallengeUser:this.stopChallengeUser,challengedUser:u},r.a.createElement(xe.a,{as:_e.a.Row,minWidth:800},P)))}},{key:"game",get:function(){return this.gameSelector(this.props)}},{key:"playersInfo",get:function(){return this.playersInfoSelector(this.props)}},{key:"gameGame",get:function(){return this.gameGameSelector(this.props)}}]),t}(a.Component);Tt=Object(j.g)(et(Tt));var St=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).gameGameSelector=Object(jt.a)([function(e){return e.game}],function(e){return e?G.deserialize(e.game):null}),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.selectLiveGame,n=e.game,o=e.user,l=e.usersInfo.byId,i=e.gamesInfo,s=i.myLive,c=i.otherLive,u=i.myFinished,m=i.otherFinished,h=e.tournamentsInfo.byId;if(!Object.values(l).length)return null;var p=this.gameGame;return r.a.createElement(j.d,null,r.a.createElement(j.b,{exact:!0,path:this.props.match.path},r.a.createElement(d.a,null,r.a.createElement(f.a,{menu:{pointing:!0},panes:[{label:"My Live games",items:s,color:"green"},{label:"Other Live games",items:c,color:"green"},{label:"My Past games",items:u},{label:"Other Past games",items:m}].filter(function(e){return e.items.length}).map(function(e){var n=e.label,i=e.items,s=e.color;return{menuItem:{content:r.a.createElement(a.Fragment,null,n," ",r.a.createElement(Ye.a,{content:i.length,color:s}))},render:function(){return r.a.createElement(dt,{user:o,usersById:l,tournamentsById:h,games:i,selectLiveGame:t})}}})}))),r.a.createElement(j.b,{path:"".concat(this.props.match.path,"/:id")},r.a.createElement(Tt,{game:n,gameGame:p,selectLiveGame:t})))}},{key:"gameGame",get:function(){return this.gameGameSelector(this.props)}}]),t}(a.Component),It=Object(j.g)(et(St)),_t=n(124),xt=n(96),Lt=n.n(xt),Ut=n(166),Nt={notifications:new(function(){function e(){var t=this;Object(i.a)(this,e),this.onUser=function(e){t.user=e},this.user=O.user,O.subscribe({onUser:this.onUser})}return Object(s.a)(e,[{key:"requestPermission",value:function(){var e=Object(Ut.a)(Lt.a.mark(function e(){return Lt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.Notification||"denied"===window.Notification.permission){e.next=3;break}return e.next=3,window.Notification.requestPermission();case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"notify",value:function(){var e=Object(Ut.a)(Lt.a.mark(function e(){var t=arguments;return Lt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.user&&this.user.settings.enableNotifications){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.requestPermission();case 4:if(window.Notification&&"granted"===window.Notification.permission)try{Object(_t.a)(Notification,Array.prototype.slice.call(t))}catch(n){console.error("Could not send notification",n)}case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}())},Gt=n(472),Yt=(n(456),function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).tournamentSelector=Object(jt.a)([function(e){return e.match.params.id},function(e){return e.tournamentsInfo.byId}],function(e,t){return t[e]}),n.dismissUrlTournamentError=function(){n.props.selectLiveTournament(null)},n.close=function(){n.props.selectLiveTournament(null)},n.shareTournament=function(e){var t=n.props.location.pathname;if(navigator.share){var a=Object(Pt.a)(n).tournament;navigator.share({title:"Thyra Online - ".concat(a.started?a.finished?"Past":"Live":"Future"," tournament ").concat(a.name),text:"".concat(a.started?a.finished?"Review Past":"Watch Live":"Future"," Santorini tournament ").concat(a.name),url:t}).catch(function(){Qe(t),alert("Link copied to clipboard")})}else Qe(t),alert("Link copied to clipboard");e.preventDefault()},n.toggleParticipation=function(){var e=Object(Pt.a)(n).tournament;n.props.toggleParticipation(e)},n.startTournament=function(){var e=Object(Pt.a)(n).tournament;n.props.startTournament(e)},n.abortTournament=function(){var e=Object(Pt.a)(n).tournament;n.props.abortTournament(e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.tournament;e&&this.props.selectLiveTournament(e)}},{key:"componentDidUpdate",value:function(){var e=this.tournament;e&&this.props.selectLiveTournament(e)}},{key:"render",value:function(){var e=this.props,t=e.location,n=e.user,o=e.selectLiveGame,l=e.usersInfo.byId,i=e.gamesInfo.byId,s=e.tournamentsInfo.byId,c=this.tournament;if(!c)return r.a.createElement(a.Fragment,null,r.a.createElement(Ue.a,{open:!0,size:"mini",onClose:this.dismissUrlTournamentError,header:"Could not find tournament",content:"This tournament cannot be found. Please check that you copied the full URL, or perhaps the tournament was aborted",actions:[{key:"ok",content:"OK",positive:!0}]}),"Could not find tournament");var u=b.a.orderBy(c.userIds.map(function(e){return l[e]}),[function(e){return c.userStats?c.userStats[e.id].points:0},function(e){return c.userStats?c.userStats[e.id].initialScore.score:0},"id"],["desc","desc","desc"]),m=!!n&&c.userIds.includes(n.id),h=!!n&&c.creatorUserId===n.id;return r.a.createElement(a.Fragment,null,r.a.createElement(d.a,null,r.a.createElement(Le.a.Group,{widths:"three",size:"tiny"},r.a.createElement(Le.a,{value:c.started?c.finished?"Finished":"".concat(c.round,"/").concat(c.rounds):"Waiting",label:c.started?c.finished?"Status":"Rounds":"Status"}),r.a.createElement(Le.a,{value:c.userIds.length,label:"Users"}),r.a.createElement(Le.a,{value:c.gameCount,label:"Games between each pair"})),r.a.createElement(_e.a,{columns:"equal"},r.a.createElement(_e.a.Column,{textAlign:"left"},r.a.createElement(Ne.a,{negative:!0,onClick:this.close},"Close")),r.a.createElement(_e.a.Column,null,r.a.createElement(Ne.a,{positive:!0,icon:!0,onClick:this.shareTournament,style:{width:"100%"},as:"a",href:t.pathname,title:navigator.share?"Click to open the sharing menu":"Click to copy URL to tournament"},r.a.createElement(at.a,{name:"share"})," Share Tournament")))),c.started?null:r.a.createElement(d.a,null,r.a.createElement(_e.a,{columns:"equal"},r.a.createElement(_e.a.Column,{textAlign:"left"},r.a.createElement(Ne.a,{disabled:c.started,style:{width:"100%"},color:m?"yellow":"green",onClick:this.toggleParticipation},c.started?null:r.a.createElement(at.a,{name:m?"hourglass":"play"}),m?"Participating":c.started?c.finished?"Tournament finished":"Tournament started":"Join the tournament")),r.a.createElement(_e.a.Column,null,r.a.createElement(Ne.a,{disabled:!h||u.length<2||c.started,positive:!0,icon:!0,onClick:this.startTournament,style:{width:"100%"},color:u.length>=2&&h?"green":"yellow"},c.finished?null:r.a.createElement(at.a,{name:u.length>=2?h?"play":"hourglass":"play"}),c.started?c.finished?"Finished":"Started":u.length>=2?h?"Start tournament":"Waiting for tournament to start":"Needs at least participants")))),r.a.createElement(d.a,null,c.started?r.a.createElement(f.a,{menu:{pointing:!0,attached:!1},panes:[{menuItem:"Rankings",render:function(){return r.a.createElement(Gt.a,{celled:!0,collapsing:!0,unstackable:!0},r.a.createElement(Gt.a.Header,null,r.a.createElement(Gt.a.Row,null,c.finished?r.a.createElement(Gt.a.HeaderCell,null," "):null,r.a.createElement(Gt.a.HeaderCell,null,"Rank"),r.a.createElement(Gt.a.HeaderCell,null,"User"),r.a.createElement(Gt.a.HeaderCell,null,"Score (TB)"),r.a.createElement(Gt.a.HeaderCell,null,"Expected Score"),c.started&&!c.finished?r.a.createElement(Gt.a.HeaderCell,null,"Game"):null,c.finished?r.a.createElement(Gt.a.HeaderCell,null,"Score difference"):null)),r.a.createElement(Gt.a.Body,null,u.map(function(e){var t=c.userStats[e.id];return r.a.createElement(Gt.a.Row,{key:e.id},c.finished?r.a.createElement(Gt.a.Cell,null,t.rank<=3?r.a.createElement(at.a,{name:{1:"trophy",2:"certificate",3:"certificate"}[t.rank],color:{1:"yellow",2:"grey",3:"brown"}[t.rank]}):null):null,r.a.createElement(Gt.a.Cell,null,t.rank),r.a.createElement(Gt.a.Cell,null,r.a.createElement(st,{floated:"left",size:"mini",hash:e.id}),e.name),r.a.createElement(Gt.a.Cell,null,t.points===t.ratedPoints?t.points:"".concat(t.ratedPoints," (").concat(t.points,")")),r.a.createElement(Gt.a.Cell,null,t.initialScore.expectedPoints.toFixed(1)),c.started&&!c.finished?r.a.createElement(Gt.a.Cell,null,t.waitingForNextRound?"Waiting for next round":t.currentGameId?r.a.createElement(mt,{user:null,usersById:l,tournamentsById:s,game:i[t.currentGameId],selectLiveGame:o,terse:!0,live:!0}):"Finished"):null,c.finished?r.a.createElement(Gt.a.Cell,null,t.scoreDifference>0?"+".concat(t.scoreDifference):t.scoreDifference):null)})))}},{menuItem:"Games",render:function(){return r.a.createElement(Gt.a,{celled:!0,collapsing:!0,unstackable:!0},r.a.createElement(Gt.a.Header,null,r.a.createElement(Gt.a.Row,null,r.a.createElement(Gt.a.HeaderCell,{colSpan:2},"White"),r.a.createElement(Gt.a.HeaderCell,{colSpan:2},"Black"),r.a.createElement(Gt.a.HeaderCell,null,"Game"))),c.schedule.map(function(e,t){return r.a.createElement(a.Fragment,{key:t},r.a.createElement(Gt.a.Header,null,r.a.createElement(Gt.a.Row,null,r.a.createElement(Gt.a.HeaderCell,{colSpan:5},"playoff"===e.type?"Playoffs - ":null,"Round ",e.round))),r.a.createElement(Gt.a.Body,null,e.pairings.map(function(e,t){var n=Object(w.a)(e.userIds,2),c=n[0],u=n[1],m=e.gameId,h=i[m],d=h&&h.finished&&h.winnerUserId===c,p=h&&h.finished&&h.winnerUserId===u;return r.a.createElement(Gt.a.Row,{key:t},r.a.createElement(Gt.a.Cell,{className:F()("tournament-game","player-a",{"player-a-won":d,"player-b-won":p})},c?r.a.createElement(a.Fragment,null,r.a.createElement(st,{floated:"left",size:"mini",hash:c}),l[c].name):"Sitting out this round"),r.a.createElement(Gt.a.Cell,{className:F()("tournament-game","player-a",{"player-a-won":d,"player-b-won":p})},h&&h.finished?h.winnerUserId===c?"1":"0":"-"),r.a.createElement(Gt.a.Cell,{className:F()("tournament-game","player-b",{"player-a-won":d,"player-b-won":p})},u?r.a.createElement(a.Fragment,null,r.a.createElement(st,{floated:"left",size:"mini",hash:u}),l[u].name):"Sitting out this round"),r.a.createElement(Gt.a.Cell,{className:F()("tournament-game","player-b",{"player-a-won":d,"player-b-won":p})},h&&h.finished?h.winnerUserId===u?"1":"0":"-"),r.a.createElement(Gt.a.Cell,null,c&&u?h?r.a.createElement(mt,{user:null,usersById:l,tournamentsById:s,game:h,selectLiveGame:o,terse:!0,live:!0}):"Not started yet":null))})))}))}}]}):r.a.createElement(Gt.a,{celled:!0,collapsing:!0,unstackable:!0},r.a.createElement(Gt.a.Header,null,r.a.createElement(Gt.a.Row,null,r.a.createElement(Gt.a.HeaderCell,null,"User"),r.a.createElement(Gt.a.HeaderCell,null,"Rating"))),r.a.createElement(Gt.a.Body,null,u.map(function(e){return r.a.createElement(Gt.a.Row,{key:e.id},r.a.createElement(Gt.a.Cell,null,r.a.createElement(st,{floated:"left",size:"mini",hash:e.id}),e.name),r.a.createElement(Gt.a.Cell,null,e.score))})))),h&&!c.started?r.a.createElement(d.a,null,r.a.createElement(_e.a,{columns:"equal"},r.a.createElement(_e.a.Column,{textAlign:"left"}),r.a.createElement(_e.a.Column,null,r.a.createElement(Ue.a,{size:"mini",trigger:r.a.createElement(Ne.a,{disabled:!h,negative:!0,icon:!0,style:{width:"100%"}},r.a.createElement(at.a,{name:"stop"}),"Abort tournament"),header:"Abort tournament",content:"Are you sure you want to abort the tournament?",actions:[{key:"yes",content:"Abort",onClick:this.abortTournament,negative:!0},{key:"no",content:"No, keep tournament",secondary:!0}]})))):null)}},{key:"tournament",get:function(){return this.tournamentSelector(this.props)}}]),t}(a.Component));Yt=Object(j.g)(et(Yt));var Wt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.selectLiveGame,n=e.selectLiveTournament,o=e.toggleParticipation,l=e.startTournament,i=e.abortTournament,s=e.tournament,c=e.user,u=e.usersInfo.byId,m=e.tournamentsInfo;return Object.values(u).length?r.a.createElement(j.d,null,r.a.createElement(j.b,{exact:!0,path:this.props.match.path},r.a.createElement(d.a,null,r.a.createElement(vt,null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(f.a,{menu:{pointing:!0},panes:[{label:"My Future & Running tournaments",items:m.myFutureAndLive,color:"green"},{label:"Other Future and Running tournaments",items:m.otherFutureAndLive,color:"green"},{label:"My Past tournaments",items:m.myFinished},{label:"Other Past tournaments",items:m.otherFinished}].filter(function(e){return e.items.length}).map(function(e){var t=e.label,o=e.items,l=e.color;return{menuItem:{content:r.a.createElement(a.Fragment,null,t," ",r.a.createElement(Ye.a,{content:o.length,color:l}))},render:function(){return r.a.createElement(yt,{user:c,usersById:u,tournaments:o,selectLiveTournament:n})}}})}))),r.a.createElement(j.b,{path:"".concat(this.props.match.path,"/:id")},r.a.createElement(Yt,{tournament:s,selectLiveGame:t,selectLiveTournament:n,toggleParticipation:o,startTournament:l,abortTournament:i}))):null}}]),t}(a.Component),Ft=Object(j.g)(et(Wt)),Bt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={liveGame:null,liveTournament:null},n.selectLiveGame=function(e){var t;(t=e?n.getLiveGameUrl(e):"".concat(n.props.match.url.endsWith("/")?n.props.match.url.slice(0,-1):n.props.match.url,"/lobby"))!==n.props.location.pathname&&n.props.history.push(t),n.state.liveGame!==e&&n.setState({liveGame:e})},n.selectLiveTournament=function(e){var t;(t=e?n.getLiveTournamentUrl(e):"".concat(n.props.match.url.endsWith("/")?n.props.match.url.slice(0,-1):n.props.match.url,"/lobby"))!==n.props.location.pathname&&n.props.history.push(t),n.state.liveTournament!==e&&n.setState({liveTournament:e})},n.toggleParticipation=function(e){var t=n.props,a=t.user,r=t.client;e.userIds.includes(a.id)?r.leaveTournament(e):r.joinTournament(e)},n.startTournament=function(e){n.props.client.startTournament(e)},n.abortTournament=function(e){n.props.client.abortTournament(e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getLiveGameUrl",value:function(e){return"".concat(this.props.match.url.endsWith("/")?this.props.match.url.slice(0,-1):this.props.match.url,"/game/").concat(e.id)}},{key:"getLiveTournamentUrl",value:function(e){return"".concat(this.props.match.url.endsWith("/")?this.props.match.url.slice(0,-1):this.props.match.url,"/tournament/").concat(e.id)}},{key:"componentDidUpdate",value:function(e){this.askForNotificationPermissionOnWaitForGame(e),this.navigateToMyNewGame(e),this.notifyAboutMyMove(e)}},{key:"askForNotificationPermissionOnWaitForGame",value:function(e){var t=this.props.user;t&&(e.user&&e.user.readyToPlay||!t||!t.readyToPlay||!t.settings.enableNotifications||Nt.notifications.requestPermission())}},{key:"navigateToMyNewGame",value:function(e){var t=this.props.user;if(t&&e.gamesInfo.myLive!==this.props.gamesInfo.myLive&&(!this.state.liveGame||this.state.liveGame.finished)){var n=new Set(e.gamesInfo.myLive.map(function(e){return e.id})),a=this.props.gamesInfo.myLive.map(function(e){return e.id}).filter(function(e){return!n.has(e)});if(1===a.length){var r=this.props.gamesInfo.byId[a[0]];if(1===r.move){var o=r.userIds[0]===t.id?r.userIds[1]:r.userIds[1]===t.id?r.userIds[0]:null,l=this.props.usersInfo.byId[o];Nt.notifications.notify(l?"New game vs ".concat(l.name," started"):"New game started")}1===r.move&&this.selectLiveGame(r)}}}},{key:"notifyAboutMyMove",value:function(e){var t=this,n=this.props.user;if(n&&this.props.gamesInfo.myLive.length){var a=this.props.gamesInfo.myLive.filter(function(e){return e.nextUserId===n.id}).filter(function(t){var a=e.gamesInfo.byId[t.id];return a&&a.nextUserId!==n.id});if(a.length){var r=a.map(function(e){var a=e.userIds[0]===n.id?e.userIds[1]:e.userIds[1]===n.id?e.userIds[0]:null;return t.props.usersInfo.byId[a]}),o=1===r.length?r[0]:null;Nt.notifications.notify(o?"Your turn at game vs ".concat(o.name):"It's your turn to play in ".concat(a.length),{tag:"your-turn",body:"It's your turn to play in ".concat(a.length," games")})}}}},{key:"render",value:function(){var e=this,t=this.state,n=t.liveGame,a=t.liveTournament,o=this.props,l=o.connected,i=o.disconnected,s=o.available,c=o.user,u=o.usersInfo.byId,m=n?u[n.userIds[0]]:null,g=n?u[n.userIds[1]]:null,y=!(!c||!m)&&m.id===c.id,b=!(!c||!g)&&g.id===c.id,E=y||b,k=n&&m&&g?n.finished?"Review ".concat(y?"you":m.name," vs ").concat(b?"you":g.name):E?"Live Play ".concat(y?"you":m.name," vs ").concat(b?"you":g.name):"Spectate ".concat(y?"you":m.name," vs ").concat(b?"you":g.name):"Live Play/Spectate/Review",C=!(!a||!c)&&a.userIds.includes(c.id),w=a?a.finished?"Review tournament ".concat(a.name):C?"Live tournament ".concat(a.name):"Spectate tournament ".concat(a.name):"Tournaments";return r.a.createElement(h.a,null,r.a.createElement(Ce.Definitions,null),r.a.createElement(d.a,{textAlign:"center"},r.a.createElement(p.a,{as:"h1"},"Thyra Online"),r.a.createElement(Rt,null),r.a.createElement(kt,{client:O}),r.a.createElement(Ct,{client:O})),l?null:i||!s?r.a.createElement(v.a,{negative:!0,header:"Trying to connect ot server...",content:r.a.createElement("p",null,"The server seems to be experiencing problems, or maybe it's a bit slow. It will connect as soon as possible")}):r.a.createElement(v.a,{header:"Connecting to server...",content:r.a.createElement("p",null,"Please sit tight as we're trying to connect to the server")}),r.a.createElement(S,{menu:{pointing:!0,attached:!1},panes:[O.available?{menuItem:"Lobby",path:"lobby",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(wt,{selectLiveGame:e.selectLiveGame,selectLiveTournament:e.selectLiveTournament}))}}:null,O.available?{menuItem:k,path:"game",navigate:n?"game/".concat(n.id):"game",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(It,{game:n,selectLiveGame:e.selectLiveGame}))}}:null,O.available?{menuItem:w,path:"tournament",navigate:a?"tournament/".concat(a.id):"tournament",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(Ft,{tournament:a,selectLiveTournament:e.selectLiveTournament,selectLiveGame:e.selectLiveGame,toggleParticipation:e.toggleParticipation,startTournament:e.startTournament,abortTournament:e.abortTournament}))}}:null,{menuItem:"Hotseat",path:"hotseat",render:function(){return r.a.createElement(f.a.Pane,null,r.a.createElement(tt,null))}}]}),r.a.createElement(p.a,{as:"h6",style:{color:"#dddddd"}},"v1.2.1"))}}]),t}(a.Component),Vt=Object(j.g)(et(Bt));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(P.a,null,r.a.createElement(j.d,null,r.a.createElement(j.b,{path:"/thyra-online"},r.a.createElement(Vt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[268,1,2]]]);
//# sourceMappingURL=main.0716427c.chunk.js.map