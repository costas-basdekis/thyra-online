{"version":3,"sources":["client/client.js","components/NavigationalTab.js","game/game.js","components/Board.js","components/Play.js","utils.js","client/withClient.js","components/Settings.js","components/Hotseat.js","components/HashedIcon.js","components/GameList.js","components/Lobby.js","components/OnlineGame.js","services/index.js","services/notifications.js","App.js","serviceWorker.js","index.js"],"names":["Client","_this","this","Object","classCallCheck","reload","window","location","justConnected","getUser","connected","onConnect","map","callback","justDisconnected","onDisconnect","gotUser","user","id","username","name","token","localStorage","setItem","onUser","gotUsers","usersInfo","users","_","orderBy","isUserRatingProvisional","forEach","index","rank","prepareUsers","onUsers","gotGames","games","gamesInfo","prepareGames","onGames","getItem","password","removeItem","io","on","console","warn","emit","unavailable","socket","process","available","callbacks","_i","_arr","length","push","_i2","_arr2","pull","appVersion","mergeUsers","settings","readyToPlay","otherUsers","_this2","myIndex","findIndex","slice","concat","toConsumableArray","byId","fromPairs","online","filter","includes","other","offline","readyToPlayMe","challengedUser","_this3","live","game","finished","myLive","userIds","otherLive","mine","moves","client","NavigationalTab","path","match","props","url","endsWith","_this$props","panes","defaultIndex","defaultTo","activeIndex","activeTo","preparedPanes","pane","to","constructUrl","navigate","undefined","pathname","startsWith","menuItem","content","objectSpread","react_default","a","createElement","Menu","Item","assign","key","as","NavLink","icon","preparedPane","_this$props2","tab","menu","renderActiveOnly","className","_this$getPreparedPane","getPreparedPanesDefaultToAndActiveIndex","react","react_router","exact","from","Tab","Component","defaultProps","withRouter","InvalidMoveError","Error","Game","cells","status","previous","lastMove","isNextMove","history","canUndo","fullHistory","moveCount","chainCount","resignedPlayer","resign","allCells","values","row","reduce","total","current","rowsAndColumns","constructor","ROWS","y","COLUMNS","x","nextPlayer","moveType","availableMovesMatrix","canTakeMoveBack","moveNotation","RESIGNED_NOTATION","MOVE_NOTATION","fullNotation","compressedFullNotation","split","part","NOTATION_COMPRESSION","join","winner","getWinner","hasAvailableMove","OTHER_PLAYER","noMovesAreAvailable","getInitialCells","getInitialStatus","create","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","move","value","makeMove","err","return","REVERSE_NOTATION","fromMoves","NOTATION_DECOMPRESSION","arguments","flatten","serializeCompact","serialize","_Game$PLAYER_A","_Game$PLAYER_B","_ref","_printMap","_nextPlayerMap","_winnerMap","printMap","defineProperty","PLAYER_A","chalk","bgWhite","bgYellow","bgRed","PLAYER_B","bgBlue","cellsPrintout","cell","player","level","nextPlayerPrintout","winnerPrintout","black","_ref2","Math","floor","JSON","stringify","getAvailableMoves","_ref3","winningCell","find","_this4","_this5","getMovableAvailableMovesMatrix","coordinates","_this6","maximumLevel","abs","_this7","expectedMoveType","targetCoordinates","checkCoordinatesAreValid","createStep","_makeMoveMethods","makeMoveMethod","MOVE_TYPE_PLACE_FIRST_WORKER","placeFirstWorker","MOVE_TYPE_PLACE_SECOND_WORKER","placeSecondWorker","MOVE_TYPE_SELECT_WORKER_TO_MOVE","selectWorkerToMove","MOVE_TYPE_MOVE_FIRST_WORKER","moveFirstWorker","MOVE_TYPE_MOVE_SECOND_WORKER","moveSecondWorker","MOVE_TYPE_BUILD_AROUND_WORKER","buildAroundWorker","bind","_ref4","checkCanMakeMove","worker","WORKER_FIRST","getEmptyCellsAvailableMovesMatrix","_ref5","WORKER_SECOND","createNext","getPlayerAvailableMovesMatrix","_ref6","_this8","fromCell","toCell","getBuildableAvailableMovesMatrix","_ref7","moveWorker","_ref8","_ref9","serialized","deserializeCompact","deserializeVerbose","_ref10","_ref11","deserialize","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","allMovesAreAvailableMatrix","_this9","_this10","PLAYERS","Array","RA","RB","keys","sort","String","fromCharCode","BoardBackground","clickable","undoable","isCellAvailable","isCellUndoable","small","medium","onSelect","selected","allowControl","children","_settings$theme","theme","scheme","rotated","rounded","numbers","classNames","small-board","medium-board","editable","selectable","theme-subtle","theme-pastel","theme-green","theme-rotated","theme-rounded","numbered-levels","obvious-levels","subtle-levels","very-subtle-levels","Board_BoardCell","undo","onClick","BoardCell","displayLevel","ThemeDemoBoard","_this$props3","Board_BoardBackground","demoRowsAndColumns","Board","takeMoveBack","isMoveAvailable","minChainCount","_this$props4","isGameUndoable","Play","state","selectedGame","autoSubmitModal","React","createRef","submit","setState","newGame","selectGame","makeMoveToSelected","takeMoveBackToSelected","undoToSelected","deselectGame","getMovesToSubmit","resignOrAbort","changeAutoSubmitMoves","autoSubmitMoves","changeSettings","handleOpen","doAutoSubmitMoves","canSubmit","propsGame","propsGameIndex","error","prevProps","prevState","resigning","otherUser","challengeUser","stopChallengeUser","names","matchGame","_this$state","displayGame","isMyGame","tooShortToResign","Segment","Statistic","Group","widths","size","color","label","MOVE_TYPE_NAMES","Button","Icon","loading","negative","disabled","positive","attention","Checkbox","toggle","checked","onChange","Modal","ref","header","actions","primary","secondary","trigger","inverted","style","textAlign","components_Board","reverse","previousGame","Header","_names","copyToClipboard","text","textArea","document","body","appendChild","select","execCommand","removeChild","ClientWatcher","connectionChanged","subscribe","unsubscribe","SubComponent","ClientWatcherForComponent","possibleConstructorReturn","getPrototypeOf","apply","inherits","withClient","forComponent","SettingsContent","themeSchemeOptions","themeNumbersOptions","updateAutoSubmitMove","e","updateSettings","updateEnableNotifications","enableNotifications","updateThemeRotated","updateThemeRounded","updateThemeNumbers","updateThemeScheme","_this$props$settings","_this$props$settings$","pointing","attached","render","Form","Grid","stackable","columns","verticalAlign","Row","Column","Board_ThemeDemoBoard","width","floated","Field","option","radio","update","save","Label","Settings_SettingsContent","getGameAndErrorFromUrlPosition","dismissUrlPositionError","share","navigator","title","catch","utils","alert","open","onClose","components_Settings","href","components_Play","position","URLSearchParams","search","get","fromCompressedNotation","HashedIcon","updateIcon","jdenticon","hash","_classNames","textSized","data-jdenticon-value","GameCard","selectLiveGame","usersById","terse","currentGameId","gameGame","playerA","playerB","nextPlayerUser","playerAToPlay","playerBToPlay","isUserPlayerA","isUserPlayerB","winnerUser","isMyTurn","showPlayerA","showPlayerB","Card","backgroundColor","Content","components_HashedIcon","Meta","GameList","maxHeight","overflowY","flexWrap","GameList_GameCard","UserList","readyToPlayUsers","readyToPlayMeUsers","Lobby_UserCard","UserCard","changeReadyToPlay","playButtonColour","playButtonAttention","playButtonIcon","playButtonOnClick","playButtonLabel","Lobby_EditUser","hasPassword","winCount","gameCount","1","2","3","score","extra","EditUser","changeUsername","target","changePassword","updateUsername","updatePassword","Input","action","LogIn","changeMergeUsers","logIn","_this$state2","modal","LogOut","logOut","_this$props4$usersInf","_this$props4$gamesInf","Lobby_LogIn","Lobby_LogOut","centered","components_GameList","Lobby_UserList","Pane","OnlineGamePlayer","initialPlayer","resultingPlayerScore","initialPlayerA","resultingPlayerAScore","initialPlayerB","resultingPlayerBScore","isWinner","winnerUserId","winPoints","losePoints","ChosenOnlineGame","gameSelector","createSelector","params","gameId","gamesById","playersInfoSelector","userPlayer","gameGameSelector","dismissUrlGameError","submitGameMove","close","shareGame","_this$playersInfo","playersInfo","preventDefault","_this$props2$usersInf","_this$props2$gamesInf","otherLiveGames","myLiveGames","_this$playersInfo2","Value","OnlineGame_OnlineGamePlayer","OnlineGame","_this$props3$gamesInf","OnlineGame_ChosenOnlineGame","services","notifications","Notifications","Notification","permission","requestPermission","construct","prototype","call","_args2","App","liveGame","gameUrl","getLiveGameUrl","askForNotificationPermissionOnWaitForGame","navigateToMyNewGame","notifyAboutMyMove","previousMyLiveGameIds","Set","newMyLiveGameIds","has","otherUserId","notify","gamesThatChangedToMyTurn","nextUserId","prevGame","tag","onlineGameLabel","Container","components_NavigationalTab","components_Lobby","components_OnlineGame","components_Hotseat","Boolean","hostname","ReactDOM","react_router_dom","src_App","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.ebb3f49e.chunk.js","sourcesContent":["import _ from \"lodash\";\r\n\r\nconst appVersion = 3;\r\n\r\nclass Client {\r\n  constructor() {\r\n    this.id = localStorage.getItem('user-id') || null;\r\n    this.username = localStorage.getItem('user-name') || null;\r\n    const password = localStorage.getItem('user-password') || null;\r\n    localStorage.removeItem('user-password');\r\n    this.token = localStorage.getItem('user-token') || password;\r\n    if (!window.io) {\r\n      window.io = () => ({\r\n        on: () => console.warn(\"Socket script was missing\"),\r\n        emit: () => console.warn(\"Socket script was missing\"),\r\n        unavailable: true,\r\n      });\r\n    }\r\n    this.socket = window.io(process.env.REACT_APP_SERVER_URL);\r\n    this.available = !this.socket.unavailable;\r\n    this.connected = false;\r\n    this.socket.on('connect', this.justConnected);\r\n    this.onConnect = [];\r\n    this.socket.on('disconnect', this.justDisconnected);\r\n    this.onDisconnect = [];\r\n    this.socket.on(\"reload\", this.reload);\r\n\r\n    this.user = null;\r\n    this.onUser = [];\r\n    this.socket.on(\"user\", this.gotUser);\r\n\r\n    this.usersInfo = this.prepareUsers([]);\r\n    this.onUsers = [];\r\n    this.socket.on(\"users\", this.gotUsers);\r\n\r\n    this.gamesInfo = this.prepareGames([]);\r\n    this.onGames = [];\r\n    this.socket.on(\"games\", this.gotGames);\r\n\r\n    this.getUser();\r\n  }\r\n\r\n  subscribe(callbacks) {\r\n    for (const name of ['onConnect', 'onDisconnect', 'onUser', 'onUsers', 'onGames']) {\r\n      const callback = callbacks[name];\r\n      if (callback) {\r\n        this[name].push(callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  unsubscribe(callbacks) {\r\n    for (const name of ['onConnect', 'onDisconnect', 'onUser', 'onUsers', 'onGames']) {\r\n      const callback = callbacks[name];\r\n      if (callback) {\r\n        _.pull(this[name], callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  getUser() {\r\n    this.socket.emit(\"create-user\", {appVersion, id: this.id, name: this.username, token: this.token});\r\n  }\r\n\r\n  logIn(name, password, mergeUsers) {\r\n    this.socket.emit(\"log-in\", {appVersion, name, password, mergeUsers});\r\n  }\r\n\r\n  logOut() {\r\n    this.socket.emit(\"log-out\");\r\n  }\r\n\r\n  reload = () => {\r\n    window.location.reload(true);\r\n  };\r\n\r\n  justConnected = () => {\r\n    this.getUser();\r\n    this.connected = true;\r\n    this.onConnect.map(callback => callback(this.connected));\r\n  };\r\n\r\n  justDisconnected = () => {\r\n    this.connected = false;\r\n    this.onDisconnect.map(callback => callback(this.connected));\r\n  };\r\n\r\n  gotUser = user => {\r\n    if (user) {\r\n      this.id = user.id;\r\n      this.username = user.name;\r\n      this.token = user.token;\r\n      localStorage.setItem('user-id', this.id);\r\n      localStorage.setItem('user-name', this.username);\r\n      localStorage.setItem('user-token', this.token);\r\n    }\r\n    this.user = user;\r\n    this.onUser.map(callback => callback(user));\r\n    this.gotUsers(this.usersInfo.users);\r\n  };\r\n\r\n  changeUsername(name) {\r\n    this.socket.emit(\"change-username\", name);\r\n  }\r\n\r\n  changePassword(password) {\r\n    this.socket.emit(\"change-password\", password);\r\n  }\r\n\r\n  updateSettings(settings) {\r\n    this.socket.emit(\"update-settings\", settings);\r\n  }\r\n\r\n  changeReadyToPlay(readyToPlay) {\r\n    this.socket.emit(\"change-ready-to-play\", readyToPlay);\r\n  }\r\n\r\n  gotUsers = users => {\r\n    users = _.orderBy(users, [user => user.isUserRatingProvisional ? 1 : 0, 'score', 'maxScore'], ['asc', 'desc', 'desc']);\r\n    users.forEach((user, index) => {\r\n      user.rank = index + 1;\r\n    });\r\n    this.usersInfo = this.prepareUsers(users);\r\n    this.onUsers.map(callback => callback(this.usersInfo));\r\n  };\r\n\r\n  prepareUsers(users) {\r\n    let otherUsers;\r\n    if (this.user) {\r\n      const myIndex = users.findIndex(user => user.id === this.user.id);\r\n      if (myIndex >= 0) {\r\n        otherUsers = users.slice(0, myIndex).concat(users.slice(myIndex + 1));\r\n        users = [users[myIndex], ...otherUsers];\r\n      } else {\r\n        otherUsers = users;\r\n      }\r\n    } else {\r\n      otherUsers = users;\r\n    }\r\n    const byId = _.fromPairs(users.map(user => [user.id, user]));\r\n    const online = users.filter(user => user.online);\r\n    const readyToPlay = online.filter(user => [true, this.user ? this.user.id : true].includes(user.readyToPlay));\r\n    return {\r\n      users,\r\n      byId,\r\n      other: otherUsers,\r\n      online,\r\n      offline: users.filter(user => !user.online),\r\n      readyToPlay,\r\n      readyToPlayMe: readyToPlay.filter(user => this.user && this.user.id === user.readyToPlay),\r\n      challengedUser: this.user ? (byId[this.user.readyToPlay] || null ): null,\r\n    };\r\n  }\r\n\r\n  gotGames = games => {\r\n    this.gamesInfo = this.prepareGames(games);\r\n    this.onGames.map(callback => callback(this.gamesInfo));\r\n  };\r\n\r\n  prepareGames(games) {\r\n    const live = games.filter(game => !game.finished);\r\n    return {\r\n      games,\r\n      byId: _.fromPairs(games.map(game => [game.id, game])),\r\n      live,\r\n      myLive: this.user ? live.filter(game => game.userIds.includes(this.user.id)) : [],\r\n      otherLive: this.user ? live.filter(game => !game.userIds.includes(this.user.id)) : live,\r\n      finished: games.filter(game => game.finished),\r\n      mine: this.user ? games.filter(game => game.userIds.includes(this.user.id)) : [],\r\n    };\r\n  }\r\n\r\n  submitGameMove(game, moves) {\r\n    this.socket.emit(\"submit-game-moves\", {id: game.id, moves});\r\n  }\r\n}\r\n\r\nexport const client = new Client();\r\n\r\nexport default Client;\r\n","import PropTypes from \"prop-types\";\r\nimport React, { Component, Fragment } from 'react';\r\nimport {\r\n  NavLink,\r\n  Redirect, Route,\r\n  Switch,\r\n  withRouter\r\n} from \"react-router-dom\";\r\nimport { Menu, Tab } from 'semantic-ui-react';\r\n\r\nclass NavigationalTab extends Component {\r\n  constructUrl(path) {\r\n    const {match} = this.props;\r\n    return `${match.url.endsWith('/') ? match.url.slice(0, -1) : match.url}${path ? `/${path}` : ''}`;\r\n  }\r\n\r\n  getPreparedPanesDefaultToAndActiveIndex() {\r\n    const {panes, defaultIndex, match, location} = this.props;\r\n    let defaultTo = null;\r\n    let activeIndex = null;\r\n    let activeTo = match.url;\r\n\r\n    const preparedPanes = panes\r\n      .map((pane, index) => {\r\n        if (!pane) {\r\n          return null;\r\n        }\r\n\r\n        const to = this.constructUrl(pane.path);\r\n        if (index === defaultIndex) {\r\n          defaultTo = to;\r\n        }\r\n        const navigate = pane.navigate !== undefined ? this.constructUrl(pane.navigate) : to;\r\n        if (location.pathname.startsWith(navigate)) {\r\n          activeIndex = index;\r\n          activeTo = to;\r\n        }\r\n\r\n        const menuItem = (\r\n          typeof pane.menuItem === typeof \"\"\r\n            ? {content: pane.menuItem}\r\n            : pane.menuItem\r\n        );\r\n        return {\r\n          to,\r\n          ...pane,\r\n          menuItem: (\r\n            <Menu.Item\r\n              key={pane.path}\r\n              as={NavLink}\r\n              to={navigate}\r\n              {...menuItem}\r\n              icon={pane.icon || menuItem.icon}\r\n            />\r\n          ),\r\n        };\r\n      })\r\n      .filter(preparedPane => preparedPane);\r\n    return {preparedPanes, defaultTo, activeIndex, activeTo}\r\n  }\r\n\r\n  render() {\r\n    const {tab, menu, match, renderActiveOnly, className} = this.props;\r\n    const {preparedPanes, defaultTo, activeIndex, activeTo} = this.getPreparedPanesDefaultToAndActiveIndex();\r\n\r\n    return (\r\n      <Fragment>\r\n        {defaultTo !== null ? (\r\n          <Switch>\r\n            <Redirect exact from={match.url} to={defaultTo} />\r\n          </Switch>\r\n        ) : null}\r\n        <Route path={activeTo}>\r\n          <Tab\r\n            menu={menu}\r\n            renderActiveOnly={renderActiveOnly}\r\n            {...tab}\r\n            panes={preparedPanes}\r\n            activeIndex={activeIndex}\r\n            className={className}\r\n          />\r\n        </Route>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nNavigationalTab.propTypes = {\r\n  panes: PropTypes.arrayOf(PropTypes.shape({\r\n    ...Menu.Item.propTypes,\r\n    path: PropTypes.string,\r\n    menuItem: PropTypes.oneOfType([PropTypes.string, PropTypes.object]).isRequired,\r\n  })).isRequired,\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  tab: PropTypes.object,\r\n  menu: PropTypes.object,\r\n  renderActiveOnly: PropTypes.bool.isRequired,\r\n  defaultIndex: PropTypes.number.isRequired,\r\n};\r\n\r\nNavigationalTab.defaultProps = {\r\n  renderActiveOnly: true,\r\n  defaultIndex: 0,\r\n};\r\n\r\nexport default withRouter(NavigationalTab);\r\n","import _ from \"lodash\";\r\nimport chalk from 'chalk';\r\n\r\nclass InvalidMoveError extends Error {}\r\n\r\nclass Game {\r\n  static PLAYER_A = 'player-a';\r\n  static PLAYER_B = 'player-b';\r\n  static PLAYERS = [\r\n    this.PLAYER_A,\r\n    this.PLAYER_B,\r\n  ];\r\n  static OTHER_PLAYER = {\r\n    [this.PLAYER_A]: this.PLAYER_B,\r\n    [this.PLAYER_B]: this.PLAYER_A,\r\n  };\r\n\r\n  static WORKER_FIRST = 'first-worker';\r\n  static WORKER_SECOND = 'second-worker';\r\n\r\n  static MOVE_TYPE_PLACE_FIRST_WORKER = 'place-first-worker';\r\n  static MOVE_TYPE_PLACE_SECOND_WORKER = 'place-second-worker';\r\n  static MOVE_TYPE_SELECT_WORKER_TO_MOVE = 'select-worker-to-move';\r\n  static MOVE_TYPE_MOVE_FIRST_WORKER = 'move-first-worker';\r\n  static MOVE_TYPE_MOVE_SECOND_WORKER = 'move-second-worker';\r\n  static MOVE_TYPE_BUILD_AROUND_WORKER = 'build-around-worker';\r\n\r\n  static ROWS = Array.from({length: 5}, (value, index) => index);\r\n  static COLUMNS = Array.from({length: 5}, (value, index) => index);\r\n  static MOVE_NOTATION = this.ROWS.map(y => this.COLUMNS.map(x =>\r\n    `${['A', 'B', 'C', 'D', 'E'][x]}${['1', '2', '3', '4', '5'][y]}`));\r\n  static RESIGNED_NOTATION = {\r\n    [this.PLAYER_A]: 'RA',\r\n    [this.PLAYER_B]: 'RB',\r\n  };\r\n  static REVERSE_NOTATION = {\r\n    ..._.fromPairs(_.flatten(this.ROWS.map(y => this.COLUMNS.map(x =>\r\n      [`${['A', 'B', 'C', 'D', 'E'][x]}${['1', '2', '3', '4', '5'][y]}`, {x, y}])))),\r\n    'RA': [{resign: this.PLAYER_A}],\r\n    'RB': [{resign: this.PLAYER_B}],\r\n  };\r\n  static NOTATION_COMPRESSION = _.fromPairs(Object.keys(this.REVERSE_NOTATION).sort().map((value, index) =>\r\n    [value, String.fromCharCode(index < 26 ? 65 + index : 48 + (index - 26))]));\r\n  static NOTATION_DECOMPRESSION = _.fromPairs(Object.keys(this.REVERSE_NOTATION).sort().map((value, index) =>\r\n    [String.fromCharCode(index < 26 ? 65 + index : 48 + (index - 26)), this.REVERSE_NOTATION[value]]));\r\n\r\n  static create() {\r\n    const cells = this.getInitialCells();\r\n    const status = this.getInitialStatus();\r\n    return new this(cells, status, null, null, false);\r\n  }\r\n\r\n  static fromMoves(moves) {\r\n    let game = this.create();\r\n    for (const move of moves) {\r\n      game = game.makeMove(move);\r\n    }\r\n\r\n    return game;\r\n  }\r\n\r\n  static fromNotation(fullNotation) {\r\n    const moves = fullNotation\r\n      .split('')\r\n      .map(part => this.REVERSE_NOTATION[part]);\r\n    if (moves.filter(move => !move).length) {\r\n      return null;\r\n    }\r\n\r\n    return this.fromMoves(moves);\r\n  }\r\n\r\n  static fromCompressedNotation(compressedFullNotation) {\r\n    const moves = compressedFullNotation\r\n      .split('')\r\n      .map(part => this.NOTATION_DECOMPRESSION[part]);\r\n    if (moves.filter(move => !move).length) {\r\n      return null;\r\n    }\r\n\r\n    return this.fromMoves(moves);\r\n  }\r\n\r\n  createStep(cells, status, lastMove) {\r\n    return new this.constructor(cells, status, this, lastMove, false);\r\n  }\r\n\r\n  createNext(cells, status, lastMove) {\r\n    return new this.constructor(cells, status, this, lastMove, true);\r\n  }\r\n\r\n  constructor(cells, status, previous, lastMove, isNextMove) {\r\n    if (!cells || !status) {\r\n      throw new Error(\"You need to pass cells, status, and previous game\");\r\n    }\r\n    this.previous = previous;\r\n    this.history = (this.previous ? this.previous.history : [])\r\n      .filter(game => !game.canUndo)\r\n      .concat([this]);\r\n    this.fullHistory = (this.previous ? this.previous.fullHistory : []).concat(this);\r\n    this.isNextMove = isNextMove;\r\n    this.moveCount = this.previous ? (isNextMove ? this.previous.moveCount + 1 : this.previous.moveCount) : 1;\r\n    this.chainCount = this.previous ? this.previous.chainCount + 1 : 0;\r\n    this.lastMove = lastMove ? lastMove : (status.resignedPlayer ? {resign: status.resignedPlayer} : lastMove);\r\n    this.moves = this.previous ? this.previous.moves.concat([this.lastMove]) : [];\r\n\r\n    this.cells = cells;\r\n    this.allCells = Object.values(this.cells)\r\n      .map(row => Object.values(row))\r\n      .reduce((total, current) => total.concat(current));\r\n    this.rowsAndColumns = this.constructor.ROWS.map(y => ({\r\n      y,\r\n      cells: this.constructor.COLUMNS.map(x => this.cells[y][x]),\r\n    }));\r\n\r\n    const {nextPlayer, moveType, availableMovesMatrix, canUndo, resignedPlayer} = status;\r\n    this.nextPlayer = nextPlayer;\r\n    this.moveType = moveType;\r\n    this.availableMovesMatrix = availableMovesMatrix;\r\n    this.canUndo = canUndo;\r\n    this.canTakeMoveBack = !!this.previous;\r\n    this.resignedPlayer = resignedPlayer;\r\n    this.moveNotation = resignedPlayer\r\n      ? this.constructor.RESIGNED_NOTATION[resignedPlayer]\r\n      : (lastMove\r\n        ? this.constructor.MOVE_NOTATION[lastMove.y][lastMove.x]\r\n        : '');\r\n    this.fullNotation = `${this.previous ? this.previous.fullNotation : ''}${this.moveNotation}`;\r\n    this.compressedFullNotation = this.fullNotation\r\n      .split(/(..)/)\r\n      .filter(part => part)\r\n      .map(part => this.constructor.NOTATION_COMPRESSION[part])\r\n      .join('');\r\n\r\n    this.winner = this.getWinner();\r\n    if (this.winner) {\r\n      this.finished = true;\r\n    } else if (!this.hasAvailableMove(this.availableMovesMatrix)) {\r\n      this.finished = true;\r\n      this.winner = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    } else {\r\n      this.finished = false;\r\n    }\r\n\r\n    if (this.finished) {\r\n      this.availableMovesMatrix = this.constructor.noMovesAreAvailable();\r\n    }\r\n  }\r\n\r\n  getAvailableMoves(availableMovesMatrix = this.availableMovesMatrix) {\r\n    return _.flatten(availableMovesMatrix\r\n      .map((row, y) => row\r\n        .map((available, x) => available ? {x, y} : null)))\r\n      .filter(move => move);\r\n  }\r\n\r\n  serialize() {\r\n    return this.serializeCompact();\r\n  }\r\n\r\n  serializeCompact() {\r\n    return {\r\n      moves: this.moves,\r\n    };\r\n  }\r\n\r\n  serializeVerbose() {\r\n    return {\r\n      cells: this.cells,\r\n      status: {\r\n        nextPlayer: this.nextPlayer,\r\n        moveType: this.moveType,\r\n        availableMovesMatrix: this.availableMovesMatrix,\r\n        canUndo: this.canUndo,\r\n        resignedPlayer: this.resignedPlayer,\r\n      },\r\n      previous: this.previous ? this.previous.serialize() : null,\r\n      lastMove: this.lastMove,\r\n      isNextMove: this.isNextMove,\r\n    };\r\n  }\r\n\r\n  static deserialize(serialized) {\r\n    if (serialized.moves) {\r\n      return this.deserializeCompact(serialized);\r\n    } else {\r\n      return this.deserializeVerbose(serialized);\r\n    }\r\n  }\r\n\r\n  static deserializeCompact({moves}) {\r\n    return this.fromMoves(moves);\r\n  }\r\n\r\n  static deserializeVerbose({cells, status, previous, lastMove, isNextMove}) {\r\n    if (previous) {\r\n      previous = this.deserialize(previous);\r\n    }\r\n    return new this(cells, status, previous, lastMove, isNextMove);\r\n  }\r\n\r\n  static getInitialCells() {\r\n    const cells = {};\r\n    for (const y of this.ROWS) {\r\n      cells[y] = {};\r\n      for (const x of this.COLUMNS) {\r\n        cells[y][x] = {\r\n          x, y,\r\n          player: null,\r\n          worker: null,\r\n          level: 0,\r\n        };\r\n      }\r\n    }\r\n\r\n    return cells;\r\n  }\r\n\r\n  static getInitialStatus() {\r\n    return  {\r\n      nextPlayer: this.PLAYER_A,\r\n      moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n      finished: false,\r\n      winner: null,\r\n      availableMovesMatrix: this.allMovesAreAvailableMatrix(),\r\n      canUndo: false,\r\n    };\r\n  }\r\n\r\n  getPrintout() {\r\n    /* eslint-disable no-useless-computed-key */\r\n    const printMap = {\r\n      [Game.PLAYER_A]: {[0]: 'a', [1]: chalk.bgWhite('b'), [2]: chalk.bgYellow('c'), [3]: chalk.bgRed('d')},\r\n      [Game.PLAYER_B]: {[0]: 'w', [1]: chalk.bgWhite('x'), [2]: chalk.bgYellow('y'), [3]: chalk.bgRed('z')},\r\n      [null]: {[0]: ' ', [1]: chalk.bgWhite(' '), [2]: chalk.bgYellow(' '), [3]: chalk.bgRed(' '), [4]: chalk.bgBlue(' ')},\r\n    };\r\n    /* eslint-enable no-useless-computed-key */\r\n    const cellsPrintout = this.rowsAndColumns\r\n      .map(row => row.cells\r\n        .map(cell => printMap[cell.player][cell.level])\r\n        .join(''))\r\n      .join('\\n');\r\n    const nextPlayerMap = {\r\n      [Game.PLAYER_A]: 'A', [Game.PLAYER_B]: 'B',\r\n    };\r\n    const nextPlayerPrintout = nextPlayerMap[this.nextPlayer];\r\n    const winnerMap = {\r\n      [Game.PLAYER_A]: 'A', [Game.PLAYER_B]: 'B', [null]: '+',\r\n    };\r\n    const winnerPrintout = winnerMap[this.winner];\r\n    return (\r\n      `${nextPlayerPrintout}-----${winnerPrintout}\\n`\r\n      + cellsPrintout.split('\\n').map(row => `|${chalk.black(row)}|`).join('\\n')\r\n      + '\\n+-----+'\r\n    );\r\n  }\r\n\r\n  checkCoordinatesAreValid({x, y}) {\r\n    if (Math.floor(x) !== x || Math.floor(y) !== y) {\r\n      throw new InvalidMoveError(`Coordinates '${JSON.stringify({x, y})}' are not valid`);\r\n    }\r\n    if (this.availableMovesMatrix[y] === undefined || this.availableMovesMatrix[y][x] === undefined) {\r\n      throw new InvalidMoveError(`Coordinates '${JSON.stringify({x, y})}' are out of bounds`);\r\n    }\r\n  }\r\n\r\n  hasAvailableMove(availableMovesMatrix = this.availableMovesMatrix) {\r\n    return this.getAvailableMoves(availableMovesMatrix).length > 0;\r\n  }\r\n\r\n  isMoveAvailable({x, y}) {\r\n    return this.availableMovesMatrix[y][x];\r\n  }\r\n\r\n  getWinner() {\r\n    if (this.resignedPlayer) {\r\n      return this.constructor.OTHER_PLAYER[this.resignedPlayer];\r\n    }\r\n\r\n    const winningCell = this.allCells.find(cell => cell.player && cell.level === 3);\r\n    if (!winningCell) {\r\n      return null;\r\n    }\r\n\r\n    return winningCell.player;\r\n  }\r\n\r\n  static allMovesAreAvailableMatrix() {\r\n    return this.ROWS.map(() => this.COLUMNS.map(() => true));\r\n  }\r\n\r\n  static noMovesAreAvailable() {\r\n    return this.ROWS.map(() => this.COLUMNS.map(() => false));\r\n  }\r\n\r\n  getEmptyCellsAvailableMovesMatrix(cells) {\r\n    return this.constructor.ROWS.map(y => this.constructor.COLUMNS.map(x => !cells[y][x].player));\r\n  }\r\n\r\n  getPlayerAvailableMovesMatrix(cells, player) {\r\n    return this.constructor.ROWS.map(y => this.constructor.COLUMNS.map(x => {\r\n      if (cells[y][x].player !== player) {\r\n        return false;\r\n      }\r\n\r\n      return this.hasAvailableMove(this.getMovableAvailableMovesMatrix(cells, {x, y}));\r\n    }));\r\n  }\r\n\r\n  getMovableAvailableMovesMatrix(cells, coordinates) {\r\n    const cell = cells[coordinates.y][coordinates.x];\r\n    const maximumLevel = cell.level + 1;\r\n    return this.constructor.ROWS.map(y => this.constructor.COLUMNS.map(x => (\r\n      Math.abs(x - coordinates.x) <= 1\r\n      && Math.abs(y - coordinates.y) <= 1\r\n      && !cells[y][x].player\r\n      && cells[y][x].level <= 3\r\n      && cells[y][x].level <= maximumLevel\r\n    )));\r\n  }\r\n\r\n  getBuildableAvailableMovesMatrix(cells, coordinates) {\r\n    return this.constructor.ROWS.map(y => this.constructor.COLUMNS.map(x => (\r\n      Math.abs(x - coordinates.x) <= 1\r\n      && Math.abs(y - coordinates.y) <= 1\r\n      && !cells[y][x].player\r\n      && cells[y][x].level < 4\r\n    )));\r\n  }\r\n\r\n  checkCanMakeMove(expectedMoveType, coordinates, targetCoordinates) {\r\n    if (this.finished) {\r\n      throw new InvalidMoveError(\"The game has already finished\");\r\n    }\r\n    if (this.moveType !== expectedMoveType) {\r\n      throw new InvalidMoveError(`You cannot perform move of type \"${expectedMoveType}\": you need to perform \"${this.moveType}\"`);\r\n    }\r\n    this.checkCoordinatesAreValid(coordinates);\r\n    if (targetCoordinates) {\r\n      this.checkCoordinatesAreValid(targetCoordinates);\r\n    }\r\n    if (!this.availableMovesMatrix[coordinates.y][coordinates.x]) {\r\n      throw new Error(`Move ${JSON.stringify(coordinates)} is not one of the available ones`);\r\n    }\r\n  }\r\n\r\n  resign(player) {\r\n    return this.createStep(this.cells, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.moveType,\r\n      availableMovesMatrix: this.availableMovesMatrix,\r\n      canUndo: false,\r\n      resignedPlayer: player,\r\n    }, {resign: player});\r\n  }\r\n\r\n  makeMove(coordinates) {\r\n    if (coordinates.resign) {\r\n      return this.resign(coordinates.resign);\r\n    }\r\n    const makeMoveMethods = {\r\n      [this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER]: this.placeFirstWorker,\r\n      [this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER]: this.placeSecondWorker,\r\n      [this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: this.selectWorkerToMove,\r\n      [this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER]: this.moveFirstWorker,\r\n      [this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER]: this.moveSecondWorker,\r\n      [this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER]: this.buildAroundWorker,\r\n    };\r\n    const makeMoveMethod = makeMoveMethods[this.moveType];\r\n    if (!makeMoveMethod) {\r\n      throw new InvalidMoveError(`Don't know how to perform move of type \"${this.moveType}\"`);\r\n    }\r\n    return makeMoveMethod.bind(this)(coordinates);\r\n  }\r\n\r\n  undo() {\r\n    if (!this.canUndo) {\r\n      throw new Error(\"Cannot undo\");\r\n    }\r\n\r\n    return this.previous;\r\n  }\r\n\r\n  takeMoveBack() {\r\n    if (!this.canTakeMoveBack) {\r\n      throw new Error(\"Cannot take move back\");\r\n    }\r\n\r\n    return this.previous;\r\n  }\r\n\r\n  placeFirstWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER, {x, y});\r\n\r\n    const cells = {\r\n      ...this.cells,\r\n      [y]: {\r\n        ...this.cells[y],\r\n        [x]: {\r\n          ...this.cells[y][x],\r\n          player: this.nextPlayer,\r\n          worker: this.constructor.WORKER_FIRST,\r\n        },\r\n      },\r\n    };\r\n    return this.createStep(cells, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n      availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(cells),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  placeSecondWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER, {x, y});\r\n\r\n    const cells = {\r\n      ...this.cells,\r\n      [y]: {\r\n        ...this.cells[y],\r\n        [x]: {\r\n          ...this.cells[y][x],\r\n          player: this.nextPlayer,\r\n          worker: this.constructor.WORKER_SECOND,\r\n        },\r\n      },\r\n    };\r\n    const nextPlayer = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    return this.createNext(cells, {\r\n      nextPlayer: nextPlayer,\r\n      moveType: nextPlayer === this.constructor.PLAYER_A\r\n        ? this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE\r\n        : this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n      availableMovesMatrix: nextPlayer === this.constructor.PLAYER_A\r\n        ? this.getPlayerAvailableMovesMatrix(cells, nextPlayer)\r\n        : this.getEmptyCellsAvailableMovesMatrix(cells),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  selectWorkerToMove({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE, {x, y});\r\n\r\n    const cell = this.cells[y][x];\r\n    return this.createStep(this.cells, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: cell.worker === this.constructor.WORKER_FIRST\r\n        ? this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER\r\n        : this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER,\r\n      availableMovesMatrix: this.getMovableAvailableMovesMatrix(this.cells, {x, y}),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  moveWorker(to, worker) {\r\n    const fromCell = this.allCells.find(cell => cell.player === this.nextPlayer && cell.worker === worker);\r\n    const toCell = this.cells[to.y][to.x];\r\n    let cells = {\r\n      ...this.cells,\r\n      [fromCell.y]: {\r\n        ...this.cells[fromCell.y],\r\n        [fromCell.x]: {\r\n          ...fromCell,\r\n          player: null,\r\n          worker: null,\r\n        },\r\n      },\r\n    };\r\n    cells = {\r\n      ...cells,\r\n      [to.y]: {\r\n        ...cells[to.y],\r\n        [to.x]: {\r\n          ...toCell,\r\n          player: fromCell.player,\r\n          worker: fromCell.worker,\r\n        },\r\n      },\r\n    };\r\n    return this.createStep(cells, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER,\r\n      availableMovesMatrix: this.getBuildableAvailableMovesMatrix(cells, to),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x: to.x, y: to.y});\r\n  }\r\n\r\n  moveFirstWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER, {x, y});\r\n\r\n    return this.moveWorker({x, y}, this.constructor.WORKER_FIRST)\r\n  }\r\n\r\n  moveSecondWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER, {x, y});\r\n\r\n    return this.moveWorker({x, y}, this.constructor.WORKER_SECOND)\r\n  }\r\n\r\n  buildAroundWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER, {x, y});\r\n\r\n    const cells = {\r\n      ...this.cells,\r\n      [y]: {\r\n        ...this.cells[y],\r\n        [x]: {\r\n          ...this.cells[y][x],\r\n          level: this.cells[y][x].level + 1,\r\n        },\r\n      },\r\n    };\r\n    const nextPlayer = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    return this.createNext(cells, {\r\n      nextPlayer: nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n      availableMovesMatrix: this.getPlayerAvailableMovesMatrix(cells, nextPlayer),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n}\r\n\r\nexport {\r\n  InvalidMoveError,\r\n};\r\n\r\nexport default Game;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport Game from \"../game/game\";\r\n\r\nclass BoardBackground extends Component {\r\n  render() {\r\n    let {\r\n      className, clickable, undoable, isCellAvailable, isCellUndoable, small, medium, makeMove, onSelect, selected,\r\n      allowControl, settings, children, rowsAndColumns,\r\n    } = this.props;\r\n    const {theme: {scheme, rotated, rounded, numbers}} = settings;\r\n\r\n    className = classNames(\"background\", {\r\n      'small-board': small,\r\n      'medium-board': medium,\r\n      editable: !!makeMove && (clickable || undoable),\r\n      selectable: !!onSelect,\r\n      selected,\r\n      'theme-subtle': scheme === 'subtle',\r\n      'theme-pastel': scheme === 'pastel',\r\n      'theme-green': scheme === 'green',\r\n      'theme-rotated': rotated,\r\n      'theme-rounded': rounded,\r\n      'numbered-levels': ['obvious', 'subtle', 'very-subtle'].includes(numbers),\r\n      'obvious-levels': numbers === 'obvious',\r\n      'subtle-levels': numbers === 'subtle',\r\n      'very-subtle-levels': numbers === 'very-subtle',\r\n    }, className);\r\n    if (!children) {\r\n      children = (\r\n        rowsAndColumns.map(row => (\r\n          <div key={`row-${row.y}`} className={\"row\"}>\r\n            {row.cells.map(cell => (\r\n              <BoardCell\r\n                key={`${cell.x}-${cell.y}`}\r\n                cell={cell}\r\n                clickable={clickable || (undoable && isCellUndoable(cell))}\r\n                available={isCellAvailable(cell)}\r\n                undoable={isCellUndoable(cell)}\r\n                allowControl={allowControl}\r\n                settings={settings}\r\n                makeMove={this.props.makeMove}\r\n                undo={this.props.undo}\r\n              />\r\n            ))}\r\n          </div>\r\n        ))\r\n      );\r\n    }\r\n    return (\r\n      <div className={className} onClick={onSelect}>{children}</div>\r\n    );\r\n  }\r\n}\r\n\r\nBoardBackground.propTypes = {\r\n  children: PropTypes.node,\r\n  rowsAndColumns: PropTypes.array,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n};\r\n\r\nBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n};\r\n\r\nclass BoardCell extends Component {\r\n  makeMove = () => {\r\n    if (this.props.available && this.props.makeMove) {\r\n      this.props.makeMove(this.props.cell);\r\n    } else if (this.props.undoable && this.props.undo) {\r\n      this.props.undo();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {cell, clickable, available, undoable, settings: {theme: {numbers}}, makeMove, undo} = this.props;\r\n    const displayLevel = (\r\n      ['obvious', 'subtle', 'very-subtle'].includes(numbers)\r\n      && cell.level > 0\r\n      && cell.level <4\r\n    ) ? cell.level : null;\r\n    return (\r\n      <div\r\n        key={`row-${cell.x}-${cell.y}`}\r\n        className={classNames(\"cell\", `level-${cell.level}`, {available, undoable})}\r\n        onClick={((makeMove && available) || (undo && undoable)) && clickable ? this.makeMove : null}\r\n      >\r\n        <div className={classNames(\"level\", \"level-1\")}>\r\n          <div className={classNames(\"level\", \"level-2\")}>\r\n            <div className={classNames(\"level\", \"level-3\")}>\r\n              {cell.player ? (\r\n                <div className={classNames(\"worker\", `player-${cell.player}`)}>\r\n                  {displayLevel}\r\n                </div>\r\n              ) : cell.level === 4 ? (\r\n                <div className={classNames(\"level\", \"level-4\")} />\r\n              ) : displayLevel}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nBoardCell.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n};\r\n\r\nBoardCell.defaultProps = {\r\n  clickable: false,\r\n  available: false,\r\n  undoable: false,\r\n};\r\n\r\nclass ThemeDemoBoard extends Component {\r\n  static demoRowsAndColumns = [\r\n    {\r\n      y: 0,\r\n      cells: [\r\n        {x: 0, y: 0, player: null, worker: null, level: 0},\r\n        {x: 1, y: 0, player: null, worker: null, level: 1},\r\n        {x: 2, y: 0, player: null, worker: null, level: 2},\r\n        {x: 3, y: 0, player: null, worker: null, level: 3},\r\n        {x: 4, y: 0, player: null, worker: null, level: 4},\r\n        {x: 5, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 0},\r\n        {x: 6, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n      ],\r\n    },\r\n  ];\r\n\r\n  isCellAvailable = () => {\r\n    return false;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  render() {\r\n    const {small, medium, settings} = this.props;\r\n    return (\r\n      <BoardBackground\r\n        small={small}\r\n        medium={medium}\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={this.constructor.demoRowsAndColumns}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        settings={settings}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nThemeDemoBoard.propTypes = {\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n};\r\n\r\nThemeDemoBoard.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  settings: {\r\n    theme: {\r\n      scheme: '',\r\n      rotated: false,\r\n      rounded: false,\r\n      numbers: '',\r\n    },\r\n  },\r\n};\r\n\r\nclass Board extends Component {\r\n  makeMove = (cell) => {\r\n    this.props.makeMove(this.props.game.makeMove({x: cell.x, y: cell.y}));\r\n  };\r\n\r\n  undo = () => {\r\n    this.props.makeMove(this.props.game.canUndo ? this.props.game.undo() : this.props.game.takeMoveBack());\r\n  };\r\n\r\n  onSelect = () => {\r\n    this.props.onSelect(this.props.game);\r\n  };\r\n\r\n  isCellAvailable = cell => {\r\n    return this.props.game.isMoveAvailable(cell);\r\n  };\r\n\r\n  isCellUndoable = cell => {\r\n    if (this.props.minChainCount === undefined || this.props.minChainCount === null) {\r\n      if (!this.props.game.canUndo) {\r\n        return false;\r\n      }\r\n    } else {\r\n      if (this.props.game.chainCount <= this.props.minChainCount) {\r\n        return false;\r\n      }\r\n    }\r\n    const lastMove = this.props.game.lastMove;\r\n    if (!lastMove) {\r\n      return false;\r\n    }\r\n    return lastMove.x === cell.x && lastMove.y === cell.y;\r\n  };\r\n\r\n  isGameUndoable() {\r\n    return !!this.props.game.rowsAndColumns.find(row => row.cells.find(cell => this.isCellUndoable(cell)));\r\n  }\r\n\r\n  render() {\r\n    let {game, allowControl, onSelect, makeMove} = this.props;\r\n\r\n    return (\r\n      <BoardBackground\r\n        {...this.props}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        clickable={allowControl.includes(game.nextPlayer)}\r\n        undoable={this.isGameUndoable()}\r\n        onSelect={onSelect ? this.onSelect : null}\r\n        makeMove={makeMove ? this.makeMove : null}\r\n        undo={makeMove ? this.undo : null}\r\n        rowsAndColumns={game.rowsAndColumns}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nBoard.propTypes = {\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  makeMove: PropTypes.func,\r\n  minChainCount: PropTypes.number,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n};\r\n\r\nBoard.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  settings: {\r\n    theme: {\r\n      scheme: '',\r\n      rotated: false,\r\n      rounded: false,\r\n      numbers: '',\r\n    },\r\n  },\r\n};\r\n\r\nexport {\r\n  ThemeDemoBoard,\r\n};\r\n\r\nexport default Board;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport '../styles/play.css';\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport {Button, Checkbox, Header, Icon, Modal, Segment, Statistic} from \"semantic-ui-react\";\r\nimport classNames from 'classnames';\r\n\r\nclass Play extends Component {\r\n  static MOVE_TYPE_NAMES = {\r\n    [Game.MOVE_TYPE_PLACE_FIRST_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_PLACE_SECOND_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: \"Select a worker\",\r\n    [Game.MOVE_TYPE_MOVE_FIRST_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_MOVE_SECOND_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_BUILD_AROUND_WORKER]: \"Build\",\r\n  };\r\n\r\n  state = {\r\n    selectedGame: null,\r\n    game: this.props.game,\r\n  };\r\n\r\n  autoSubmitModal = React.createRef();\r\n\r\n  makeMove = game => {\r\n    if (this.props.submit) {\r\n      this.setState({game})\r\n    } else {\r\n      this.props.makeMove(game);\r\n    }\r\n  };\r\n\r\n  takeMoveBack = () => {\r\n    this.makeMove(this.state.game.takeMoveBack());\r\n  };\r\n\r\n  undo = () => {\r\n    this.makeMove(this.state.game.undo());\r\n  };\r\n\r\n  newGame = () => {\r\n    this.makeMove(Game.create());\r\n  };\r\n\r\n  selectGame = game => {\r\n    this.setState({selectedGame: game === this.state.game ? null : game});\r\n  };\r\n\r\n  makeMoveToSelected = game => {\r\n    this.selectGame(game);\r\n  };\r\n\r\n  takeMoveBackToSelected = () => {\r\n    this.selectGame(this.state.selectedGame.takeMoveBack());\r\n  };\r\n\r\n  undoToSelected = () => {\r\n    this.selectGame(this.state.selectedGame.undo());\r\n  };\r\n\r\n  deselectGame = () => {\r\n    this.selectGame(null);\r\n  };\r\n\r\n  submit = () => {\r\n    const moves = this.getMovesToSubmit();\r\n    if (moves.length) {\r\n      this.props.submit(moves);\r\n    }\r\n  };\r\n\r\n  getMovesToSubmit() {\r\n    const {game: propsGame} = this.props;\r\n    const {game: stateGame} = this.state;\r\n    const history = stateGame.fullHistory;\r\n    const propsGameIndex = history.findIndex(\r\n      game => game.compressedFullNotation === propsGame.compressedFullNotation);\r\n    if (propsGameIndex < 0) {\r\n      console.error(\"Could not find live game in history\");\r\n      return [];\r\n    }\r\n    const newHistory = history.slice(propsGameIndex + 1);\r\n    const moves = newHistory.map(game => game.lastMove);\r\n\r\n    return moves;\r\n  }\r\n\r\n  resignOrAbort = () => {\r\n    this.props.submit(\"resign\");\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props.game !== prevProps.game) {\r\n      const gameChanged = (\r\n        !this.props.game\r\n        || !prevProps.game\r\n        || this.props.game.compressedFullNotation !== prevProps.game.compressedFullNotation\r\n      );\r\n      if (gameChanged) {\r\n        this.setState({selectedGame: null, game: this.props.game, resigning: false});\r\n      }\r\n    }\r\n    if (this.props.user && this.props.user.settings.autoSubmitMoves) {\r\n      if (!this.canSubmit(prevProps, prevState) && this.canSubmit()) {\r\n        this.submit();\r\n      }\r\n    }\r\n  }\r\n\r\n  changeAutoSubmitMoves = () => {\r\n    if (!this.props.user.settings.autoSubmitMoves) {\r\n      this.autoSubmitModal.current.handleOpen();\r\n    } else {\r\n      this.props.changeSettings({...this.props.user.settings, autoSubmitMoves: false});\r\n    }\r\n  };\r\n\r\n  doAutoSubmitMoves = () => {\r\n    this.props.changeSettings({...this.props.user.settings, autoSubmitMoves: true});\r\n    if (this.canSubmit()) {\r\n      this.submit();\r\n    }\r\n  };\r\n\r\n  canSubmit(props = this.props, state = this.state) {\r\n    const {submit} = props;\r\n    const {selectedGame, game} = state;\r\n    return (\r\n      !!submit\r\n      && !selectedGame\r\n      && game !== props.game\r\n      && this.getMovesToSubmit().length\r\n      && (\r\n        game.finished\r\n        || game.nextPlayer !== props.game.nextPlayer\r\n      )\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const {user, otherUser, changeSettings, challengeUser, stopChallengeUser, challengedUser, names, allowControl, matchGame} = this.props;\r\n    const {selectedGame, game} = this.state;\r\n    const displayGame = selectedGame || game;\r\n    const isMyGame = allowControl.length > 0;\r\n    const canSubmit = this.canSubmit();\r\n    const tooShortToResign = matchGame ? matchGame.tooShortToResign : false;\r\n    return (\r\n      <Fragment>\r\n        <Segment>\r\n          <Statistic.Group widths={\"three\"} size={\"tiny\"}>\r\n            {game.finished ? (\r\n              <Statistic color={\"green\"} value={names[game.winner]} label={\"Won!\"} />\r\n            ) : (\r\n              <Statistic value={names[game.nextPlayer]} label={this.constructor.MOVE_TYPE_NAMES[game.moveType]} />\r\n            )}\r\n            <Statistic value={game.moveCount} label={\"Move\"} />\r\n            {this.props.game.finished ? (\r\n              this.props.submit ? (\r\n                (isMyGame && challengeUser) ? (\r\n                  challengedUser ? (\r\n                    <Statistic value={<Button color={'green'} onClick={stopChallengeUser}><Icon loading name={'circle notch'} />Waiting for {challengedUser.name}...</Button>} />\r\n                  ) : (\r\n                    otherUser && otherUser.readyToPlay === user.id ? (\r\n                      <Statistic value={<Button className={'attention'} color={'yellow'} icon={'play'} onClick={challengeUser} content={'Accept challenge'} />} />\r\n                    ) : (\r\n                      <Statistic value={<Button color={'yellow'} icon={'play'} onClick={challengeUser} content={'Challenge user'} />} />\r\n                    )\r\n                  )\r\n                ) : null\r\n              ) : (\r\n                <Statistic value={<Button negative onClick={this.newGame} disabled={!game.previous}>New Game</Button>} />\r\n              )\r\n            ) : (\r\n              this.props.submit\r\n                ? <Statistic value={(\r\n                  <Fragment>\r\n                    {!user || !user.settings.autoSubmitMoves ? <Button positive onClick={this.submit} className={classNames({attention: canSubmit})} disabled={!canSubmit}>Submit</Button> : null}\r\n                    {user && changeSettings ? (\r\n                      <Segment>\r\n                        <Checkbox\r\n                          label={'Auto submit moves'}\r\n                          toggle\r\n                          checked={user.settings.autoSubmitMoves}\r\n                          onChange={this.changeAutoSubmitMoves}\r\n                        />\r\n                        <Modal\r\n                          ref={this.autoSubmitModal}\r\n                          header={'Auto submit moves'}\r\n                          content={'Are you sure you want to be auto submitting your moves?'}\r\n                          actions={[\r\n                            {key: 'yes', content: 'Auto submit', onClick: this.doAutoSubmitMoves, primary: true},\r\n                            {key: 'no', content: 'No, manually submit moves', secondary: true},\r\n                          ]}\r\n                        />\r\n                      </Segment>\r\n                    ) : null}\r\n                  </Fragment>\r\n                )}/>\r\n                : <Statistic value={<Button negative onClick={this.props.submit ? this.takeMoveBack : this.undo} disabled={!!selectedGame || (this.props.submit ? game.chainCount <= this.props.game.chainCount : !game.canUndo)}>Undo</Button>} />\r\n            )}\r\n          </Statistic.Group>\r\n        </Segment>\r\n        {this.props.submit && isMyGame ? (\r\n          <Segment>\r\n            <Statistic.Group widths={\"two\"} size={\"tiny\"}>\r\n              <Statistic value={\r\n                <Modal\r\n                  trigger={<Button negative disabled={!!selectedGame || this.props.game.finished}>{tooShortToResign ? 'Abort' : 'Resign'}</Button>}\r\n                  header={matchGame.tooShortToResign ? 'Abort?' : 'Resign?'}\r\n                  content={`Are you sure you want to ${matchGame.tooShortToResign ? 'abort' : 'forfeit'}?${matchGame.tooShortToResign ? ' This game is too short to resign.' : ''}`}\r\n                  actions={[{key: 'resign', content: matchGame.tooShortToResign ? 'Abort' : 'Resign', negative: true, onClick: this.resignOrAbort}, { key: 'continue', content: 'Continue', inverted: true, secondary: true }]}\r\n                />\r\n              } />\r\n              <Statistic value={<Button negative onClick={this.props.submit ? this.takeMoveBack : this.undo} disabled={!!selectedGame || (this.props.submit ? game.chainCount <= this.props.game.chainCount : !game.canUndo)}>Undo</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        <Segment style={{textAlign: \"center\"}}>\r\n          <Board\r\n            game={displayGame}\r\n            makeMove={selectedGame ? this.makeMoveToSelected : this.makeMove}\r\n            minChainCount={this.props.submit ? this.props.game.chainCount : (\r\n              this.props.game.canUndo ? this.props.game.previous.chainCount : this.props.game.chainCount\r\n            )}\r\n            allowControl={displayGame === game ? allowControl : undefined}\r\n            settings={user ? user.settings : undefined}\r\n          />\r\n        </Segment>\r\n        <Segment>\r\n          <div>\r\n            {[...game.history].reverse().map(previousGame => (\r\n              <Board key={previousGame.chainCount} game={previousGame} small onSelect={this.selectGame} selected={previousGame === selectedGame} settings={user ? user.settings : undefined} />\r\n            ))}\r\n          </div>\r\n        </Segment>\r\n        {selectedGame ? (\r\n          <Segment textAlign={\"center\"}>\r\n            <Header as={\"h2\"}>Reviewing previous move</Header>\r\n            <Statistic.Group widths={\"three\"} size={\"small\"}>\r\n              {selectedGame.finished ? (\r\n                <Statistic color={\"green\"} value={names[selectedGame.winner]} label={\"Won!\"} />\r\n              ) : (\r\n                <Statistic value={names[selectedGame.nextPlayer]} label={this.constructor.MOVE_TYPE_NAMES[selectedGame.moveType]} />\r\n              )}\r\n              <Statistic value={selectedGame.moveCount} label={\"Move\"} />\r\n              <Statistic value={<Button negative onClick={this.undoToSelected} disabled={!selectedGame.canUndo}>Undo</Button>} />\r\n            </Statistic.Group>\r\n            <Statistic.Group widths={\"two\"} size={\"small\"}>\r\n              <Statistic value={<Button negative onClick={this.takeMoveBackToSelected} disabled={!selectedGame.previous}>Take Back a Move</Button>}/>\r\n              <Statistic value={<Button negative onClick={this.deselectGame}>Stop reviewing</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        {!this.props.submit ? (\r\n          <Segment>\r\n            <Statistic.Group widths={\"two\"} size={\"small\"}>\r\n              <Statistic value={<Button negative onClick={this.takeMoveBack} disabled={!!selectedGame || !game.previous}>Take Back a Move</Button>}/>\r\n              <Statistic value={<Button negative onClick={this.newGame} disabled={!!selectedGame || !game.previous}>New Game</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nPlay.propTypes = {\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object,\r\n  settings: PropTypes.object,\r\n  changeSettings: PropTypes.func,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  matchGame: PropTypes.object,\r\n  makeMove: PropTypes.func,\r\n  submit: PropTypes.func,\r\n  challengeUser: PropTypes.func,\r\n  stopChallengeUser: PropTypes.func,\r\n  challengedUser: PropTypes.object,\r\n  names: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nPlay.defaultProps = {\r\n  names: {\r\n    [Game.PLAYER_A]: \"Player A\",\r\n    [Game.PLAYER_B]: \"Player B\",\r\n  },\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n};\r\n\r\nexport default Play;\r\n","export const copyToClipboard = text => {\r\n    const textArea = document.createElement(\"textarea\");\r\n    // This won't work\r\n    // textArea.style.display = 'none'\r\n    document.body.appendChild(textArea);\r\n    textArea.value = text;\r\n    textArea.select();\r\n    document.execCommand(\"copy\");\r\n    document.body.removeChild(textArea);\r\n};\r\n","import React, {Component} from 'react';\r\nimport {client} from \"./client\";\r\n\r\nclass ClientWatcher extends Component {\r\n  static SubComponent = null;\r\n\r\n  static forComponent(Component) {\r\n    class ClientWatcherForComponent extends this {\r\n      static SubComponent = Component;\r\n    }\r\n\r\n    return ClientWatcherForComponent;\r\n  }\r\n\r\n  state = {\r\n    connected: client.connected,\r\n    user: client.user,\r\n    username: client.user ? client.user.name : null,\r\n    usersInfo: client.usersInfo,\r\n    gamesInfo: client.gamesInfo,\r\n  };\r\n\r\n  componentDidMount() {\r\n    client.subscribe({\r\n      onConnect: this.connectionChanged,\r\n      onDisconnect: this.connectionChanged,\r\n      onUser: this.gotUser,\r\n      onUsers: this.gotUsers,\r\n      onGames: this.gotGames,\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    client.unsubscribe({\r\n      onUser: this.gotUser,\r\n      onUsers: this.gotUsers,\r\n      onGames: this.gotGames,\r\n    });\r\n  }\r\n\r\n  connectionChanged = connected => {\r\n    this.setState({connected});\r\n  };\r\n\r\n  gotUser = user => {\r\n    this.setState({user});\r\n  };\r\n\r\n  gotUsers = usersInfo => {\r\n    this.setState({usersInfo});\r\n  };\r\n\r\n  gotGames = gamesInfo => {\r\n    this.setState({gamesInfo});\r\n  };\r\n\r\n  render() {\r\n    const {connected, user, usersInfo, gamesInfo} = this.state;\r\n    const SubComponent = this.constructor.SubComponent;\r\n    return (\r\n      <SubComponent\r\n        {...this.props}\r\n        connected={connected}\r\n        client={client}\r\n        user={user}\r\n        usersInfo={usersInfo}\r\n        gamesInfo={gamesInfo}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport const withClient = Component => {\r\n  return ClientWatcher.forComponent(Component);\r\n};\r\n","import React, {Component} from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport {Checkbox, Form, Grid, Header, Label, Modal, Segment, Tab} from \"semantic-ui-react\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport {ThemeDemoBoard} from \"./Board\";\r\n\r\nclass SettingsContent extends Component {\r\n  themeSchemeOptions = [\r\n    {value: '', label: 'Default'},\r\n    {value: 'subtle', label: 'Subtle'},\r\n    {value: 'pastel', label: 'Pastel'},\r\n    {value: 'green', label: 'Green'},\r\n  ];\r\n  themeNumbersOptions = [\r\n    {value: '', label: 'None'},\r\n    {value: 'obvious', label: 'Obvious'},\r\n    {value: 'subtle', label: 'Subtle'},\r\n    {value: 'very-subtle', label: 'Very subtle'},\r\n  ];\r\n\r\n  updateAutoSubmitMove = (e, {checked}) => {\r\n    this.props.updateSettings({autoSubmitMoves: checked});\r\n  };\r\n\r\n  updateEnableNotifications = (e, {checked}) => {\r\n    this.props.updateSettings({enableNotifications: checked});\r\n  };\r\n\r\n  updateThemeRotated = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {rotated: checked}});\r\n  };\r\n\r\n  updateThemeRounded = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {rounded: checked}});\r\n  };\r\n\r\n  updateThemeNumbers = (e, {value}) => {\r\n    this.props.updateSettings({theme: {numbers: value}});\r\n  };\r\n\r\n  updateThemeScheme = (e, {value}) => {\r\n    this.props.updateSettings({theme: {scheme: value}});\r\n  };\r\n\r\n  render() {\r\n    const {settings: {autoSubmitMoves, enableNotifications, theme: {scheme, rotated, rounded, numbers}}} = this.props;\r\n\r\n    return (\r\n      <Tab menu={{pointing: true, attached: false}} panes={[\r\n        {menuItem: 'Playing', render: () => (\r\n          <Segment>\r\n            <Form>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Auto-submit online moves'}\r\n                  name={'autoSubmitMoves'}\r\n                  checked={autoSubmitMoves}\r\n                  onChange={this.updateAutoSubmitMove}\r\n                />\r\n              </Form.Group>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Enable notifications'}\r\n                  name={'enableNotifications'}\r\n                  checked={enableNotifications}\r\n                  onChange={this.updateEnableNotifications}\r\n                />\r\n              </Form.Group>\r\n            </Form>\r\n          </Segment>\r\n        )},\r\n        {menuItem: 'Theme', render: () => (\r\n          <Segment>\r\n            <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n              <Grid.Row>\r\n                <Grid.Column textAlign={'center'}>\r\n                  <ThemeDemoBoard medium settings={{theme: {scheme, rotated, rounded, numbers}}}/>\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column width={4}>\r\n                  <Checkbox\r\n                    label={'Rotated'}\r\n                    name={'theme.rotated'}\r\n                    checked={rotated}\r\n                    onChange={this.updateThemeRotated}\r\n                  />\r\n                </Grid.Column>\r\n                <Grid.Column floated={'right'} textAlign={'right'}>\r\n                  <ThemeDemoBoard medium settings={{theme: {scheme, rotated: true, rounded, numbers}}}/>\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column width={4}>\r\n                  <Checkbox\r\n                    label={'Rounded'}\r\n                    name={'theme.rounded'}\r\n                    checked={rounded}\r\n                    onChange={this.updateThemeRounded}\r\n                  />\r\n                </Grid.Column>\r\n                <Grid.Column floated={'right'} textAlign={'right'}>\r\n                  <ThemeDemoBoard medium settings={{theme: {scheme, rotated, rounded: true, numbers}}}/>\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column textAlign={'center'}>\r\n                  <Form.Field><Header as={'h2'}>Numbers:</Header></Form.Field>\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              {this.themeNumbersOptions.map(option => (\r\n                <Grid.Row key={`theme-numbers-${option.value}`}>\r\n                  <Grid.Column width={4}>\r\n                    <Checkbox\r\n                      radio\r\n                      label={option.label}\r\n                      name={'theme.numbers'}\r\n                      value={option.value}\r\n                      checked={numbers === option.value}\r\n                      onChange={this.updateThemeNumbers}\r\n                    />\r\n                  </Grid.Column>\r\n                  <Grid.Column floated={'right'} textAlign={'right'}>\r\n                    <ThemeDemoBoard medium settings={{theme: {scheme, rotated, rounded, numbers: option.value}}}/>\r\n                  </Grid.Column>\r\n                </Grid.Row>\r\n              ))}\r\n              <Grid.Row>\r\n                <Grid.Column textAlign={'center'}>\r\n                  <Form.Field><Header as={'h2'}>Scheme:</Header></Form.Field>\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              {this.themeSchemeOptions.map(option => (\r\n                <Grid.Row key={`theme-scheme-${option.value}`}>\r\n                  <Grid.Column width={4}>\r\n                    <Checkbox\r\n                      radio\r\n                      label={option.label}\r\n                      name={'theme.scheme'}\r\n                      value={option.value}\r\n                      checked={scheme === option.value}\r\n                      onChange={this.updateThemeScheme}\r\n                    />\r\n                  </Grid.Column>\r\n                  <Grid.Column floated={'right'} textAlign={'right'}>\r\n                    <ThemeDemoBoard medium settings={{theme: {scheme: option.value, rotated, rounded, numbers}}}/>\r\n                  </Grid.Column>\r\n                </Grid.Row>\r\n              ))}\r\n            </Grid>\r\n          </Segment>\r\n        )},\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nSettingsContent.propTypes = {\r\n  settings: PropTypes.object.isRequired,\r\n  updateSettings: PropTypes.func.isRequired,\r\n};\r\n\r\nclass Settings extends Component {\r\n  state = {\r\n    user: null,\r\n    settings: {\r\n      autoSubmitMoves: false,\r\n      theme: {scheme: '', rotated: false, rounded: false, numbers: ''},\r\n    },\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.user && props.user !== state.user) {\r\n      return {\r\n        user: props.user,\r\n        settings: props.user.settings || {\r\n          autoSubmitMoves: false,\r\n          theme: {scheme: '', rotated: false, rounded: false, numbers: ''},\r\n        },\r\n      };\r\n    }\r\n\r\n    return {};\r\n  }\r\n\r\n  updateSettings = update => {\r\n    this.setState(state => ({\r\n      settings: {\r\n        ...state.settings,\r\n        ...update,\r\n        theme: {\r\n          ...state.settings.theme,\r\n          ...update.theme,\r\n        },\r\n      },\r\n    }));\r\n  };\r\n\r\n  save = () => {\r\n    this.props.client.updateSettings(this.state.settings);\r\n  };\r\n\r\n  render() {\r\n    const {settings} = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        trigger={<Label as={'a'} icon={'cog'} content={'Settings'} />}\r\n        size={'small'}\r\n        header={'Settings'}\r\n        actions={[\r\n          {key: 'cancel', content: 'Cancel'},\r\n          {key: 'save', content: 'Save', positive: true, onClick: this.save},\r\n        ]}\r\n        content={<SettingsContent settings={settings} updateSettings={this.updateSettings} />}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nSettings.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n};\r\n\r\nexport default withClient(Settings);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Play from \"./Play\";\r\nimport Game from \"../game/game\";\r\nimport {Button, Icon, Grid, Modal} from \"semantic-ui-react\";\r\nimport * as utils from \"../utils\";\r\nimport Settings from \"./Settings\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass Hotseat extends Component {\r\n  state = {\r\n    error: false,\r\n    ...this.constructor.getGameAndErrorFromUrlPosition(),\r\n  };\r\n\r\n  static getGameAndErrorFromUrlPosition() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const position = params.get('position');\r\n    if (position) {\r\n      let game, error;\r\n      try {\r\n        game = Game.fromCompressedNotation(position);\r\n        if (!game) {\r\n          error = 'The position was not valid';\r\n        }\r\n      } catch (e) {\r\n        game = null;\r\n        error = 'The series of moves where not valid'\r\n      }\r\n      if (error) {\r\n        return {game: Game.create(), error};\r\n      }\r\n      return {game, error: false};\r\n    } else {\r\n      return {game: Game.create(), error: false};\r\n    }\r\n  }\r\n\r\n  dismissUrlPositionError = () =>{\r\n    this.setState({error: null});\r\n  };\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  share = () => {\r\n    const url = this.props.location.pathname;\r\n    if (navigator.share) {\r\n      const game = this.state.game;\r\n      navigator.share({\r\n        title: `Thyra Online - Game after ${game.moveCount} moves`,\r\n        text: `Review Santorini game between after ${game.moveCount} moves`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {game, error} = this.state;\r\n    const {user} = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Modal\r\n          open={error}\r\n          size={'mini'}\r\n          onClose={this.dismissUrlPositionError}\r\n          header={'Could not load shared position'}\r\n          content={`${error}. Please check that you copied the full URL`}\r\n          actions={[{content: 'OK', positive: true}]}\r\n        />\r\n        <Grid columns={'equal'}>\r\n          <Grid.Column>\r\n            <Grid columns={'equal'}>\r\n              <Grid.Column><Settings/></Grid.Column>\r\n              <Grid.Column />\r\n            </Grid>\r\n          </Grid.Column>\r\n          <Grid.Column>\r\n            <Button\r\n              positive\r\n              icon\r\n              onClick={this.share}\r\n              style={{width: '100%'}}\r\n              as={'a'}\r\n              href={`?position=${game.compressedFullNotation}`}\r\n              title={navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to game'}\r\n            >\r\n              <Icon name={'share'}/> Share position\r\n            </Button>\r\n          </Grid.Column>\r\n        </Grid>\r\n        <Play user={user} game={game} makeMove={this.makeMove} />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nHotseat.propTypes = {\r\n  user: PropTypes.object,\r\n};\r\n\r\nexport default withClient(Hotseat);\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport jdenticon from \"jdenticon\";\r\nimport classNames from \"classnames\";\r\n\r\nclass HashedIcon extends Component {\r\n  ref = React.createRef();\r\n\r\n  componentDidMount() {\r\n    this.updateIcon();\r\n  }\r\n\r\n  updateIcon() {\r\n    if (this.ref.current) {\r\n      jdenticon.update(this.ref.current);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.hash !== this.props) {\r\n      this.updateIcon();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {hash, floated, size, textSized} = this.props;\r\n    return (\r\n      <svg\r\n        ref={this.ref}\r\n        className={classNames([\"ui\", \"mini\", \"right\", \"floated\", \"image\"], {floated: !!floated, [floated]: !!floated, [size]: !!size, 'text-sized': textSized})}\r\n        data-jdenticon-value={hash}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nHashedIcon.propTypes = {\r\n  hash: PropTypes.string.isRequired,\r\n  floated: PropTypes.oneOf(['left', 'right']),\r\n  size: PropTypes.oneOf(['mini', 'tiny', 'small', 'medium', 'large', 'big', 'huge', 'massive']),\r\n  textSized: PropTypes.bool.isRequired,\r\n};\r\n\r\nHashedIcon.defaultProps = {\r\n  textSized: false,\r\n};\r\n\r\nexport default HashedIcon;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Icon, Label, Card} from \"semantic-ui-react\";\r\n\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport classNames from \"classnames\";\r\n\r\nclass GameCard extends Component {\r\n  selectLiveGame = () => {\r\n    this.props.selectLiveGame(this.props.game);\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, game, terse, live, currentGameId} = this.props;\r\n\r\n    const gameGame = Game.deserialize(game.game);\r\n    const playerA = usersById[game.userIds[0]];\r\n    const playerB = usersById[game.userIds[1]];\r\n    const nextPlayerUser = gameGame.nextPlayer === Game.PLAYER_A ? playerA : playerB;\r\n    const playerAToPlay = nextPlayerUser === playerA;\r\n    const playerBToPlay = nextPlayerUser === playerB;\r\n    const isUserPlayerA = user ? playerA.id === user.id : false;\r\n    const isUserPlayerB = user ? playerB.id === user.id : false;\r\n    const winnerUser = game.finished ? (game.winner === Game.PLAYER_A ? playerA : playerB) : null;\r\n    const isMyGame = isUserPlayerA || isUserPlayerB;\r\n    const isMyTurn = (isUserPlayerA && playerAToPlay) || (isUserPlayerB && playerBToPlay);\r\n    const showPlayerA = !terse || !isMyGame || isUserPlayerB;\r\n    const showPlayerB = !terse || !isMyGame || isUserPlayerA;\r\n\r\n    return (\r\n      <Card\r\n        onClick={this.selectLiveGame}\r\n        style={{\r\n          ...(!terse ? {} : {width: 'auto'}),\r\n          ...(game.id === currentGameId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n        className={classNames({attention: live && isMyTurn})}\r\n      >\r\n        <Card.Content>\r\n          {!terse ? (\r\n            <Board\r\n              className={'ui image floated right mini'}\r\n              game={gameGame}\r\n              small\r\n              settings={user ? user.settings : undefined}\r\n            />\r\n          ) : null}\r\n          <Card.Header>\r\n            {!(showPlayerA && showPlayerB) ? \" vs \" : null}\r\n            {showPlayerA ? (\r\n              <Label color={winnerUser === playerA || isMyTurn ? 'green' : undefined} >\r\n                {winnerUser === playerA ? <Icon name={'trophy'}/> : null}\r\n                {playerAToPlay ? <Icon name={'caret right'}/> : null}\r\n                {playerA.name}\r\n                <HashedIcon floated={'right'} size={'mini'} textSized hash={playerA.id} />\r\n              </Label>\r\n            ) : null}\r\n            {showPlayerA && showPlayerB ? \" vs \" : null}\r\n            {showPlayerB ? (\r\n              <Label color={winnerUser === playerB || isMyTurn ? 'green' : undefined} >\r\n                {winnerUser === playerB ? <Icon name={'trophy'}/> : null}\r\n                {playerBToPlay ? <Icon name={'caret right'} color={\"green\"}/> : null}\r\n                {playerB.name}\r\n                <HashedIcon floated={'right'} size={'mini'} textSized hash={playerB.id} />\r\n              </Label>\r\n            ) : null}\r\n          </Card.Header>\r\n          {!terse ? (\r\n            <Card.Meta>\r\n              {isMyGame ? <Label><Icon name={\"user\"} color={\"green\"} />My game</Label> : null}\r\n              {\" \"}\r\n              {!game.finished ? <Label><Icon name={\"circle\"} color={\"green\"} />Live</Label> : null}\r\n              {\" \"}\r\n              <Label content={`Move ${game.move}`} />\r\n            </Card.Meta>\r\n          ) : null}\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nGameCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  game: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  live: PropTypes.bool.isRequired,\r\n  currentGameId: PropTypes.string,\r\n};\r\n\r\nGameCard.defaultProps = {\r\n  terse: false,\r\n  live: false,\r\n};\r\n\r\nclass GameList extends Component {\r\n  render() {\r\n    const {user, usersById, games, terse, live, selectLiveGame, currentGameId} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Card.Group style={{maxHeight: '300px', overflowY: 'auto', flexWrap: !terse ? undefined : 'unset'}}>\r\n        {games.map(game => (\r\n          <GameCard\r\n            key={game.id}\r\n            user={user}\r\n            usersById={usersById}\r\n            game={game}\r\n            selectLiveGame={selectLiveGame}\r\n            terse={terse}\r\n            live={live}\r\n            currentGameId={currentGameId}\r\n          />\r\n        ))}\r\n      </Card.Group>\r\n    );\r\n  }\r\n}\r\n\r\nGameList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  games: PropTypes.array.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  live: PropTypes.bool.isRequired,\r\n  currentGameId: PropTypes.string,\r\n};\r\n\r\nGameList.defaultProps = {\r\n  terse: false,\r\n  live: false,\r\n};\r\n\r\nexport default GameList;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport {Tab, Button, Icon, Input, Label, Card, Segment, Modal, Header, Checkbox} from \"semantic-ui-react\";\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport Settings from \"./Settings\";\r\nimport GameList from \"./GameList\";\r\n\r\nclass UserList extends Component {\r\n  render() {\r\n    const {client, user, users, challengedUser, readyToPlayUsers, readyToPlayMeUsers} = this.props;\r\n    return (\r\n      <Card.Group style={{maxHeight: '300px', overflowY: 'auto'}}>\r\n        {users.map(otherUser => (\r\n          <UserCard\r\n            key={otherUser.id}\r\n            client={client}\r\n            user={user}\r\n            otherUser={otherUser}\r\n            challengedUser={challengedUser}\r\n            readyToPlayUsers={readyToPlayUsers}\r\n            readyToPlayMeUsers={readyToPlayMeUsers}\r\n          />\r\n        ))}\r\n      </Card.Group>\r\n    );\r\n  }\r\n}\r\n\r\nUserList.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  users: PropTypes.array.isRequired,\r\n  challengedUser: PropTypes.object,\r\n  readyToPlayUsers: PropTypes.array,\r\n  readyToPlayMeUsers: PropTypes.array,\r\n};\r\n\r\nclass UserCard extends Component {\r\n  changeReadyToPlay = () => {\r\n    this.props.client.changeReadyToPlay(!this.props.user.readyToPlay);\r\n  };\r\n\r\n  challengeUser = () => {\r\n    this.props.client.changeReadyToPlay(this.props.user.readyToPlay === this.props.otherUser.id ? false : this.props.otherUser.id);\r\n  };\r\n\r\n  render() {\r\n    const {client, user, otherUser, challengedUser, readyToPlayUsers, readyToPlayMeUsers} = this.props;\r\n    let playButtonColour, playButtonAttention, playButtonIcon, playButtonOnClick, playButtonLabel;\r\n    if (client && user) {\r\n      if (user.id === otherUser.id) {\r\n        playButtonOnClick = this.changeReadyToPlay;\r\n        if (user.readyToPlay) {\r\n          playButtonColour = 'green';\r\n          playButtonIcon = {loading: true, name: 'circle notch'};\r\n          if (challengedUser) {\r\n            playButtonLabel = `Waiting for ${challengedUser.name}...`;\r\n          } else {\r\n            playButtonLabel = 'Waiting for opponent...';\r\n          }\r\n        } else {\r\n          playButtonColour = 'yellow';\r\n          playButtonIcon = {name: 'play'};\r\n          if (readyToPlayMeUsers && readyToPlayMeUsers.length) {\r\n            if (readyToPlayMeUsers.length === 1) {\r\n              playButtonLabel = `${readyToPlayMeUsers[0].name} has challenged you`;\r\n              playButtonAttention = true;\r\n            } else {\r\n              playButtonLabel = `${readyToPlayMeUsers.length} users have challenged you`;\r\n              playButtonAttention = true;\r\n            }\r\n          } else if (readyToPlayUsers && readyToPlayUsers.length) {\r\n            if (readyToPlayUsers.length === 1) {\r\n              playButtonLabel = `Play ${readyToPlayUsers[0].name}`;\r\n            } else {\r\n              playButtonLabel = `${readyToPlayUsers.length} users ready to play`;\r\n            }\r\n          } else {\r\n            playButtonLabel = 'Play';\r\n          }\r\n        }\r\n      } else {\r\n        playButtonOnClick = this.challengeUser;\r\n        if (challengedUser && challengedUser.id === otherUser.id) {\r\n          playButtonColour = 'green';\r\n          playButtonIcon = {loading: true, name: 'circle notch'};\r\n          playButtonLabel = `Waiting for ${otherUser.name}...`;\r\n        } else if (!otherUser.online) {\r\n          playButtonLabel = null;\r\n          playButtonOnClick = null;\r\n        } else {\r\n          playButtonColour = 'yellow';\r\n          playButtonIcon = {name: 'play'};\r\n          if (otherUser.readyToPlay === user.id) {\r\n            playButtonLabel = `${otherUser.name} has challenged you`;\r\n            playButtonAttention = true;\r\n          } else if (otherUser.readyToPlay === true) {\r\n            playButtonLabel = `${otherUser.name} is ready to Play`;\r\n          } else {\r\n            playButtonLabel = `Challenge ${otherUser.name}`;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Card>\r\n        <Card.Content>\r\n          <HashedIcon floated={'right'} size={'mini'} hash={otherUser.id} />\r\n          <Card.Header>\r\n            {otherUser.name}\r\n            {\" \"}\r\n            {client && user && user.id === otherUser.id ? (\r\n              <EditUser client={client} user={user} trigger={<Label as={'a'} icon={'edit'} content={'Edit'}/>} />\r\n            ) : null}\r\n          </Card.Header>\r\n          <Card.Meta>\r\n            {user && otherUser.id === user.id ? <Label><Icon name={\"user\"} color={\"green\"} />Me</Label> : null}\r\n            {\" \"}\r\n            {user && otherUser.id === user.id ? <EditUser client={client} user={user} trigger={<Label as={'a'}><Icon name={\"lock\"} color={user.hasPassword ? \"green\" : \"red\"} />{user.hasPassword ? '' : 'No password'}</Label>} /> : null}\r\n            {\" \"}\r\n            {otherUser.readyToPlay ? <Label><Icon loading name={\"circle notch\"} color={\"green\"} />Ready</Label> : null}\r\n            {\" \"}\r\n            {otherUser.online ? <Label><Icon name={\"circle\"} color={\"green\"} />Online</Label> : null}\r\n            {\" \"}\r\n            <Label\r\n              title={`${otherUser.isUserRatingProvisional ? 'Provisional - ' : ''}Won ${otherUser.winCount} out of ${otherUser.gameCount}`}\r\n              color={{1: 'yellow', 2: 'grey', 3: 'brown'}[otherUser.rank]}\r\n            >\r\n              <Icon\r\n                name={otherUser.isUserRatingProvisional ? \"question\" : \"star outline\"}\r\n                color={otherUser.isUserRatingProvisional ? \"orange\" : undefined}\r\n              />\r\n              {\" \"}{otherUser.score}\r\n            </Label>\r\n            {\" \"}\r\n            <Label icon={'trophy'} content={` ${otherUser.winCount}/${otherUser.gameCount}`} />\r\n          </Card.Meta>\r\n        </Card.Content>\r\n        {playButtonLabel ? <Card.Content extra>\r\n          <div className='ui two buttons'>\r\n            <Button className={classNames({attention: playButtonAttention})} color={playButtonColour} onClick={playButtonOnClick}>\r\n              <Icon {...playButtonIcon} />\r\n              {playButtonLabel}\r\n            </Button>\r\n          </div>\r\n        </Card.Content> : null}\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nUserCard.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object.isRequired,\r\n  changeReadyToPlay: PropTypes.func,\r\n  challengedUser: PropTypes.object,\r\n  readyToPlayUsers: PropTypes.array,\r\n  readyToPlayMeUsers: PropTypes.array,\r\n};\r\n\r\nclass EditUser extends Component {\r\n  state = {\r\n    user: this.props.user,\r\n    username: this.props.user.name,\r\n    password: '',\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.user !== state.user) {\r\n      return {\r\n        user: props.user,\r\n        username: props.user ? props.user.name : null,\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  changeUsername = ({target: {value}}) => {\r\n    this.setState({username: value});\r\n  };\r\n\r\n  changePassword = ({target: {value}}) => {\r\n    this.setState({password: value});\r\n  };\r\n\r\n  updateUsername = () => {\r\n    this.props.client.changeUsername(this.state.username);\r\n  };\r\n\r\n  updatePassword = () => {\r\n    this.props.client.changePassword(this.state.password);\r\n    this.setState({password: ''});\r\n  };\r\n\r\n  render() {\r\n    const {username, password} = this.state;\r\n    const {user, trigger} = this.props;\r\n\r\n    return (\r\n      <Modal\r\n        trigger={trigger}\r\n        size={'small'}\r\n        header={'Edit user'}\r\n        content={(\r\n          <Segment>\r\n            <Input label={'Name'} value={username} onChange={this.changeUsername} action={{content: 'Change', onClick: this.updateUsername}} />\r\n            <br />\r\n            <Input label={{content: user.hasPassword ? 'Password is set' : 'Set a password', color: user.hasPassword ? 'green' : 'red'}} value={password} onChange={this.changePassword} action={{content: 'Change', color: user.hasPassword ? undefined : 'green', onClick: this.updatePassword}} />\r\n          </Segment>\r\n        )}\r\n        actions={[\r\n          {key: 'cancel', negative: true, content: 'Cancel'},\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditUser.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object.isRequired,\r\n  trigger: PropTypes.node.isRequired,\r\n};\r\n\r\nclass LogIn extends Component {\r\n  state = {\r\n    username: '',\r\n    password: '',\r\n    mergeUsers: false,\r\n  };\r\n\r\n  changeUsername = ({target: {value}}) => {\r\n    this.setState({username: value});\r\n  };\r\n\r\n  changePassword = ({target: {value}}) => {\r\n    this.setState({password: value});\r\n  };\r\n\r\n  changeMergeUsers = ({target: {checked}}) => {\r\n    this.setState({mergeUsers: checked});\r\n  };\r\n\r\n  logIn = () => {\r\n    this.props.client.logIn(this.state.username, this.state.password, this.mergeUsers);\r\n    this.setState({username: '', password: ''});\r\n  };\r\n\r\n  render() {\r\n    const {username, password, mergeUsers} = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        ref={this.modal}\r\n        trigger={<Label as={'a'} icon={'sign in'} content={'Log In'} />}\r\n        size={'small'}\r\n        header={'Log In'}\r\n        content={(\r\n          <Segment>\r\n            <Input label={'Name'} value={username} onChange={this.changeUsername}/>\r\n            <br />\r\n            <Input label={'Password'} value={password} onChange={this.changePassword} />\r\n            <br />\r\n            <Checkbox\r\n              label={'Merge users'}\r\n              checked={mergeUsers}\r\n              onChange={this.changeMergeUsers}\r\n            />\r\n          </Segment>\r\n        )}\r\n        actions={[\r\n          {key: 'cancel', negative: true, content: 'Cancel'},\r\n          {key: 'logIn', positive: true, content: 'Log In', onClick: this.logIn},\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nLogIn.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nclass LogOut extends Component {\r\n  logOut = () => {\r\n    this.props.client.logOut();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Label as={'a'} icon={'log out'} content={'Log Out'} onClick={this.logOut} />\r\n    );\r\n  }\r\n}\r\n\r\nLogOut.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nclass Lobby extends Component {\r\n  changeReadyToPlay = () => {\r\n    this.props.client.changeReadyToPlay(!this.props.user.readyToPlay);\r\n  };\r\n\r\n  render() {\r\n    const {client, user, usersInfo: {byId: usersById, users, online, offline, challengedUser, readyToPlay, readyToPlayMe}, gamesInfo: {live, myLive, finished}, selectLiveGame} = this.props;\r\n\r\n    if (!user) {\r\n      return <Tab.Pane>Connecting to server...</Tab.Pane>;\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Settings/>\r\n        <LogIn client={client} />\r\n        <LogOut client={client} />\r\n        <Card.Group centered>\r\n          {user ? (\r\n            <UserCard\r\n              client={client}\r\n              otherUser={user}\r\n              user={user}\r\n              challengedUser={challengedUser}\r\n              readyToPlayUsers={readyToPlay}\r\n              readyToPlayMeUsers={readyToPlayMe}\r\n            />\r\n          ) : null}\r\n        </Card.Group>\r\n        {myLive.length ? (\r\n          <Segment>\r\n            <Header as={'h2'}>My live games ({myLive.length})</Header>\r\n            <GameList user={user} usersById={usersById} games={myLive} selectLiveGame={selectLiveGame} />\r\n          </Segment>\r\n        ) : null}\r\n        <Segment>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {menuItem: `${live.length} live games`, render: () => (\r\n              <GameList user={user} usersById={usersById} games={live} selectLiveGame={selectLiveGame} />\r\n            )},\r\n            {menuItem: `${finished.length} past games`, render: () => (\r\n              <GameList user={user} usersById={usersById} games={finished} selectLiveGame={selectLiveGame} />\r\n            )},\r\n          ]} />\r\n        </Segment>\r\n        <Segment>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {menuItem: `${online.length} users online`, render: () => (\r\n              <UserList\r\n                client={client}\r\n                users={online}\r\n                user={user}\r\n                challengedUser={challengedUser}\r\n                readyToPlayUsers={readyToPlay}\r\n                readyToPlayMeUsers={readyToPlayMe}\r\n              />\r\n            )},\r\n            {menuItem: `${offline.length} users offline`, render: () => (\r\n              <UserList users={offline} user={user} challengedUser={challengedUser} />\r\n            )},\r\n            {menuItem: `${users.length} users`, render: () => (\r\n              <UserList\r\n                client={client}\r\n                users={users}\r\n                user={user}\r\n                challengedUser={challengedUser}\r\n                readyToPlayUsers={readyToPlay}\r\n                readyToPlayMeUsers={readyToPlayMe}\r\n              />\r\n            )},\r\n          ]} />\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nLobby.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withClient(Lobby);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Grid, Header, Icon, Label, Modal, Segment, Statistic} from \"semantic-ui-react\";\r\nimport { createSelector } from 'reselect';\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport Game from \"../game/game\";\r\nimport Play from \"./Play\";\r\nimport {Route, Switch, withRouter} from \"react-router-dom\";\r\nimport * as utils from \"../utils\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport Settings from \"./Settings\";\r\nimport GameList from \"./GameList\";\r\n\r\nclass OnlineGamePlayer extends Component {\r\n  render() {\r\n    const {game, player} = this.props;\r\n    let initialPlayer, resultingPlayerScore;\r\n    if (game) {\r\n      if (game.initialPlayerA.id === player.id) {\r\n        initialPlayer = game.initialPlayerA;\r\n        resultingPlayerScore = game.resultingPlayerAScore;\r\n      } else if (game.initialPlayerB.id === player.id) {\r\n        initialPlayer = game.initialPlayerB;\r\n        resultingPlayerScore = game.resultingPlayerBScore;\r\n      } else {\r\n        initialPlayer = null;\r\n        resultingPlayerScore = null;\r\n      }\r\n    } else {\r\n      initialPlayer = null;\r\n      resultingPlayerScore = null;\r\n    }\r\n    const isWinner = game && game.winnerUserId === player.id;\r\n    return (\r\n      <Fragment>\r\n        {isWinner ? <Icon name={'trophy'} color={\"green\"} /> : null}{\" \"}\r\n        <span style={isWinner ? {color: '#21BA45'} : undefined}>\r\n          {player.name}\r\n          {initialPlayer ? (\r\n            <Fragment>\r\n              {\" \"}({resultingPlayerScore ? (\r\n                <Fragment>\r\n                  {resultingPlayerScore - initialPlayer.score}\r\n                  {\" \"}<Icon name={'long arrow alternate right'} />{\" \"}\r\n                  {resultingPlayerScore}\r\n                </Fragment>\r\n              ) : (\r\n                <Fragment>\r\n                  {initialPlayer.score}\r\n                  {\" \"}+{initialPlayer.winPoints}/{initialPlayer.losePoints}\r\n                </Fragment>\r\n              )})\r\n            </Fragment>\r\n          ) : null}\r\n        </span>\r\n        <HashedIcon floated={'right'} size={'mini'} hash={player.id} />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineGamePlayer.propTypes = {\r\n  game: PropTypes.object,\r\n  player: PropTypes.object.isRequired,\r\n};\r\n\r\nclass ChosenOnlineGame extends Component {\r\n  gameSelector = createSelector([\r\n    props => props.match.params.id,\r\n    props => props.gamesInfo.byId,\r\n  ], (gameId, gamesById) => gamesById[gameId]);\r\n\r\n  get game() {\r\n    return this.gameSelector(this.props);\r\n  }\r\n\r\n  playersInfoSelector = createSelector([\r\n    props => props.user,\r\n    props => props.usersInfo,\r\n    () => this.game,\r\n  ], (user, {byId: usersById}, game) => {\r\n    const playerA = usersById[game.userIds[0]];\r\n    const playerB = usersById[game.userIds[1]];\r\n    const isUserPlayerA = user ? playerA.id === user.id : false;\r\n    const isUserPlayerB = user ? playerB.id === user.id : false;\r\n    const userPlayer = isUserPlayerA ? Game.PLAYER_A : isUserPlayerB ? Game.PLAYER_B : null;\r\n    const otherUser = isUserPlayerA ? playerB : isUserPlayerB ? playerA : null;\r\n\r\n    return {\r\n      playerA, playerB,\r\n      isUserPlayerA, isUserPlayerB,\r\n      userPlayer, otherUser,\r\n    };\r\n  });\r\n\r\n  get playersInfo() {\r\n    return this.playersInfoSelector(this.props);\r\n  }\r\n\r\n  gameGameSelector = createSelector([\r\n    () => this.game,\r\n  ], game => game ? Game.deserialize(game.game) : null);\r\n\r\n  get gameGame() {\r\n    return this.gameGameSelector(this.props);\r\n  }\r\n\r\n  dismissUrlGameError = () => {\r\n    this.props.selectLiveGame(null);\r\n  };\r\n\r\n  submit = moves => {\r\n    this.props.client.submitGameMove(this.game, moves);\r\n  };\r\n\r\n  componentDidMount() {\r\n    const game = this.game;\r\n    if (game) {\r\n      this.props.selectLiveGame(game);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const game = this.game;\r\n    if (game) {\r\n      this.props.selectLiveGame(game);\r\n    }\r\n  }\r\n\r\n  close = () => {\r\n    this.props.selectLiveGame(null);\r\n  };\r\n\r\n  changeSettings = settings => {\r\n    this.props.client.updateSettings(settings);\r\n  };\r\n\r\n  shareGame = e => {\r\n    const url = this.props.location.pathname;\r\n    if (navigator.share) {\r\n      const game = this.game;\r\n      const {playerA, playerB} = this.playersInfo;\r\n      navigator.share({\r\n        title: `Thyra Online - ${game.finished ? 'Review' : 'Live'} ${playerA.name} vs ${playerB.name}`,\r\n        text: `${game.finished? 'Review finished': 'Watch live'} Santorini game between ${playerA.name} and ${playerB.name}`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  challengeUser = () => {\r\n    const {otherUser} = this.playersInfo;\r\n    if (otherUser) {\r\n      this.props.client.changeReadyToPlay(otherUser.id);\r\n    }\r\n  };\r\n\r\n  stopChallengeUser = () => {\r\n    this.props.client.changeReadyToPlay(false);\r\n  };\r\n\r\n  render() {\r\n    const {location, user, usersInfo: {challengedUser, byId: usersById}, gamesInfo: {otherLive: otherLiveGames, myLive: myLiveGames}, game, selectLiveGame} = this.props;\r\n    const {gameGame} = this;\r\n\r\n    if (!gameGame) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlGameError}\r\n            header={'Could not find game'}\r\n            content={'This game cannot be found. Please check that you copied the full URL, or perhaps the game was aborted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find game\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const {otherUser, playerA, playerB, isUserPlayerA, isUserPlayerB, userPlayer} = this.playersInfo;\r\n    if (!playerA || !playerB) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Fragment>\r\n        <Settings/>\r\n        <Segment>\r\n          <Statistic.Group widths={\"three\"} size={\"tiny\"}>\r\n            <Statistic\r\n              value={<Statistic.Value><OnlineGamePlayer game={game} player={playerA} /></Statistic.Value>}\r\n              label={isUserPlayerA ? <Label><Icon name={\"user\"} />Me</Label> : null}\r\n              color={isUserPlayerA ? \"green\" : undefined}\r\n            />\r\n            <Statistic label={\"vs\"}/>\r\n            <Statistic\r\n              value={<Statistic.Value><OnlineGamePlayer game={game} player={playerB} /></Statistic.Value>}\r\n              label={isUserPlayerB ? <Label><Icon name={\"user\"} />Me</Label> : null}\r\n              color={isUserPlayerB ? \"green\" : undefined}\r\n            />\r\n          </Statistic.Group>\r\n          <Grid columns={'equal'}>\r\n            <Grid.Column textAlign={'left'}><Button negative onClick={this.close}>Close</Button></Grid.Column>\r\n            <Grid.Column>\r\n              <Button\r\n                positive\r\n                icon\r\n                onClick={this.shareGame}\r\n                style={{width: '100%'}}\r\n                as={'a'}\r\n                href={location.pathname}\r\n                title={navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to game'}\r\n              >\r\n                <Icon name={'share'}/> Share Game\r\n              </Button>\r\n              <Button\r\n                positive\r\n                icon\r\n                style={{width: '100%'}}\r\n                as={'a'}\r\n                href={`${process.env.REACT_APP_PAGE_BASE_PATH}${process.env.REACT_APP_PAGE_BASE_PATH.endsWith('/') ? '' : '/'}hotseat?position=${gameGame.compressedFullNotation}`}\r\n                title={'Click to open hotseat with this game'}\r\n                target={'_blank'}\r\n              >\r\n                <Icon name={'share'}/> Edit position\r\n              </Button>\r\n            </Grid.Column>\r\n          </Grid>\r\n        </Segment>\r\n        <Segment>\r\n          <GameList user={user} selectLiveGame={selectLiveGame} games={myLiveGames} usersById={usersById} terse live currentGameId={game ? game.id : null} />\r\n          {otherLiveGames.length ? (\r\n            <GameList user={user} selectLiveGame={selectLiveGame} games={otherLiveGames} usersById={usersById} terse live currentGameId={game ? game.id : null} />\r\n          ) : null}\r\n        </Segment>\r\n        <Play\r\n          user={user}\r\n          otherUser={otherUser}\r\n          changeSettings={this.changeSettings}\r\n          game={gameGame}\r\n          matchGame={game}\r\n          names={{[Game.PLAYER_A]: playerA.name, [Game.PLAYER_B]: playerB.name}}\r\n          allowControl={[userPlayer].filter(player => player)}\r\n          submit={this.submit}\r\n          challengeUser={this.challengeUser}\r\n          stopChallengeUser={this.stopChallengeUser}\r\n          challengedUser={challengedUser}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChosenOnlineGame.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  game: PropTypes.object,\r\n};\r\n\r\nChosenOnlineGame = withRouter(withClient(ChosenOnlineGame));\r\n\r\nclass OnlineGame extends Component {\r\n  gameGameSelector = createSelector([\r\n    props => props.game,\r\n  ], game => game ? Game.deserialize(game.game) : null);\r\n\r\n  get gameGame() {\r\n    return this.gameGameSelector(this.props);\r\n  }\r\n\r\n  render() {\r\n    const {selectLiveGame, game, user, usersInfo: {byId}, gamesInfo: {live, myLive}} = this.props;\r\n    if (!Object.values(byId).length) {\r\n      return null;\r\n    }\r\n    const gameGame = this.gameGame;\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Segment>\r\n            <Header as={'h2'}>My live games ({myLive.length})</Header>\r\n            <GameList user={user} usersById={byId} games={myLive} selectLiveGame={selectLiveGame} />\r\n          </Segment>\r\n          <Segment>\r\n            <Header as={'h2'}>Live games ({live.length})</Header>\r\n            <GameList user={user} usersById={byId} games={live} selectLiveGame={selectLiveGame} />\r\n          </Segment>\r\n        </Route>\r\n        <Route path={`${this.props.match.path}/:id`}>\r\n          <ChosenOnlineGame game={game} gameGame={gameGame} selectLiveGame={selectLiveGame} />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineGame.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  game: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(OnlineGame));\r\n","import notifications from './notifications';\r\n\r\nexport default {\r\n  notifications,\r\n};\r\n","import {client} from \"../client/client\";\r\n\r\nclass Notifications {\r\n  constructor() {\r\n    this.user = client.user;\r\n    client.subscribe({onUser: this.onUser});\r\n  }\r\n\r\n  onUser = user => {\r\n    this.user = user;\r\n  };\r\n\r\n  async requestPermission() {\r\n    if (window.Notification && window.Notification.permission !== 'denied') {\r\n      await window.Notification.requestPermission();\r\n    }\r\n  }\r\n\r\n  async notify() {\r\n    if (!this.user || !this.user.settings.enableNotifications) {\r\n      return;\r\n    }\r\n    await this.requestPermission();\r\n    if (window.Notification && window.Notification.permission === \"granted\") {\r\n      try {\r\n        new Notification(...arguments);\r\n      } catch (e) {\r\n        console.error(\"Could not send notification\", e);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst notifications = new Notifications();\r\n\r\nexport default notifications;\r\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport 'fomantic-ui-css/semantic.css';\nimport {Container, Header, Segment, Tab} from 'semantic-ui-react';\nimport './styles/App.css';\nimport {client} from \"./client/client\";\nimport NavigationalTab from \"./components/NavigationalTab\";\nimport {withRouter} from \"react-router-dom\";\nimport Hotseat from \"./components/Hotseat\";\nimport Lobby from \"./components/Lobby\";\nimport OnlineGame from \"./components/OnlineGame\";\nimport {withClient} from \"./client/withClient\";\nimport services from \"./services\";\n\nclass App extends Component {\n  state = {\n    liveGame: null,\n  };\n\n  getLiveGameUrl(game) {\n    return `${this.props.match.url.endsWith('/') ? this.props.match.url.slice(0, -1) : this.props.match.url}/game/${game.id}`;\n  }\n\n  selectLiveGame = liveGame => {\n    let gameUrl;\n    if (liveGame) {\n      gameUrl = this.getLiveGameUrl(liveGame);\n    } else {\n      gameUrl = `${this.props.match.url.endsWith('/') ? this.props.match.url.slice(0, -1) : this.props.match.url}/lobby`;\n    }\n    if (gameUrl !== this.props.location.pathname) {\n      this.props.history.push(gameUrl);\n    }\n    if (this.state.liveGame === liveGame) {\n      return;\n    }\n    this.setState({liveGame});\n  };\n\n  componentDidUpdate(prevProps) {\n    this.askForNotificationPermissionOnWaitForGame(prevProps);\n    this.navigateToMyNewGame(prevProps);\n    this.notifyAboutMyMove(prevProps);\n  }\n\n  askForNotificationPermissionOnWaitForGame(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return;\n    }\n    if ((!prevProps.user || !prevProps.user.readyToPlay) && (user && user.readyToPlay) && user.settings.enableNotifications) {\n      services.notifications.requestPermission();\n    }\n  }\n\n  navigateToMyNewGame(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return\n    }\n\n    if (prevProps.gamesInfo.myLive === this.props.gamesInfo.myLive) {\n      return;\n    }\n\n    if (this.state.liveGame && !this.state.liveGame.finished) {\n      return;\n    }\n\n    const previousMyLiveGameIds = new Set(prevProps.gamesInfo.myLive.map(game => game.id));\n    const myLiveGameIds = this.props.gamesInfo.myLive.map(game => game.id);\n    const newMyLiveGameIds = myLiveGameIds.filter(id => !previousMyLiveGameIds.has(id));\n    if (newMyLiveGameIds.length !== 1) {\n      return;\n    }\n\n    const newGame = this.props.gamesInfo.byId[newMyLiveGameIds[0]];\n    if (newGame.move === 1) {\n      const otherUserId = newGame.userIds[0] === user.id ? newGame.userIds[1] : (newGame.userIds[1] === user.id ? newGame.userIds[0] : null);\n      const otherUser = this.props.usersInfo.byId[otherUserId];\n      services.notifications.notify(otherUser ? `New game vs ${otherUser.name} started` : `New game started`);\n    }\n    if (newGame.move === 1) {\n      this.selectLiveGame(newGame);\n    }\n  }\n\n  notifyAboutMyMove(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return;\n    }\n    if (!this.props.gamesInfo.myLive.length) {\n      return;\n    }\n    const gamesThatChangedToMyTurn = this.props.gamesInfo.myLive\n      .filter(game => game.nextUserId === user.id)\n      .filter(game => {\n        const prevGame = prevProps.gamesInfo.byId[game.id];\n        return prevGame && prevGame.nextUserId !== user.id;\n      });\n    if (!gamesThatChangedToMyTurn.length) {\n      return;\n    }\n\n    const otherUsers = gamesThatChangedToMyTurn.map(game => {\n      const otherUserId = game.userIds[0] === user.id ? game.userIds[1] : (game.userIds[1] === user.id ? game.userIds[0] : null);\n      const otherUser = this.props.usersInfo.byId[otherUserId];\n      return otherUser;\n    });\n    const otherUser = otherUsers.length === 1 ? otherUsers[0] : null;\n    services.notifications.notify(otherUser ? `Your turn at game vs ${otherUser.name}` : `It's your turn to play in ${gamesThatChangedToMyTurn.length}`, {\n      tag: 'your-turn',\n      body: `It's your turn to play in ${gamesThatChangedToMyTurn.length} games`,\n    });\n  }\n\n  render() {\n    const {liveGame} = this.state;\n    const {user, usersInfo: {byId: usersById}} = this.props;\n    const playerA = liveGame ? usersById[liveGame.userIds[0]] : null;\n    const playerB = liveGame ? usersById[liveGame.userIds[1]] : null;\n    const isUserPlayerA = (user && playerA) ? playerA.id === user.id : false;\n    const isUserPlayerB = (user && playerB) ? playerB.id === user.id : false;\n    const isMyGame = isUserPlayerA || isUserPlayerB;\n    const onlineGameLabel = (liveGame && playerA && playerB)\n      ? (liveGame.finished\n        ? `Review ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`\n        : (isMyGame\n          ? `Live Play ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`\n          : `Spectate ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`))\n      : 'Live Play/Spectate/Review';\n    return (\n      <Container>\n        <Segment textAlign={\"center\"}>\n          <Header as={\"h1\"}>Thyra Online</Header>\n        </Segment>\n          <NavigationalTab menu={{pointing: true, attached: false}} panes={[\n            client.available ? {menuItem: 'Lobby', path: 'lobby', render: () => (\n              <Tab.Pane><Lobby selectLiveGame={this.selectLiveGame} /></Tab.Pane>\n            )} : null,\n            client.available ? {menuItem: onlineGameLabel, path: 'game', navigate: liveGame ? `game/${liveGame.id}` : 'game', render: () => (\n              <Tab.Pane><OnlineGame game={liveGame} selectLiveGame={this.selectLiveGame} /></Tab.Pane>\n            )} : null,\n            {menuItem: 'Hotseat', path: 'hotseat', render: () => (\n              <Tab.Pane><Hotseat /></Tab.Pane>\n            )},\n          ]} />\n          <Header as={\"h6\"} style={{color: '#dddddd'}}>{process.env.REACT_APP_VERSION || '?'}</Header>\n      </Container>\n    );\n  }\n}\n\nApp.propTypes = {\n  location: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  user: PropTypes.object,\n  usersInfo: PropTypes.object.isRequired,\n};\n\nexport default withRouter(withClient(App));\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {BrowserRouter, Route, Switch} from \"react-router-dom\";\n\nReactDOM.render((\n  <BrowserRouter>\n    <Switch>\n      <Route path={process.env.REACT_APP_PAGE_BASE_PATH}>\n        <App />\n      </Route>\n    </Switch>\n  </BrowserRouter>\n), document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}