{"version":3,"sources":["client/client.js","components/NavigationalTab.js","game/game.js","components/Board/HtmlBoardBackground.js","components/Board/SvgBoardBackground/LevelIndicator.js","components/Board/SvgBoardBackground/Piece.js","components/Board/SvgBoardBackground/constants.js","components/Board/SvgBoardBackground/Cell.js","components/Board/SvgBoardBackground/Arrow.js","components/Board/SvgBoardBackground/SvgBoardBackground.js","components/Board/SvgBoardBackground/index.js","components/Board/BoardBackground.js","components/Board/Board.js","components/Board/ThemeDemoBoard.js","components/Board/index.js","components/Board/PlayerColourBoard.js","client/withClient.js","components/HashedIcon.js","components/GameList.js","components/CreateTournament.js","components/TournamentList.js","components/ChallengeList.js","components/Lobby.js","components/Play.js","utils.js","components/Hotseat.js","components/Settings.js","components/OnlineGame.js","services/index.js","services/notifications.js","components/OnlineTournament.js","components/LearnToPlay.js","components/EditPosition.js","components/CreateChallenge.js","components/EditChallenge.js","components/Challenges.js","App.js","serviceWorker.js","index.js"],"names":["Client","_this","this","Object","classCallCheck","scriptIoReloadInterval","reloadScriptIo","window","io","unavailable","clearInterval","bindSocket","console","log","oldScriptEl","document","getElementById","newScriptEl","createElement","id","type","src","remove","head","append","warn","reload","location","justConnected","getUser","connected","onConnect","map","callback","justDisconnected","disconnected","onDisconnect","gotUser","user","username","name","token","settings","localStorage","setItem","JSON","stringify","onUser","gotUsers","usersInfo","users","_","orderBy","isUserRatingProvisional","forEach","index","rank","prepareUsers","onUsers","gotGames","games","sortBy","gamesInfo","prepareGames","onGames","gotTournaments","tournaments","tournamentsInfo","prepareTournaments","onTournaments","gotChallenges","challenges","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","challenge","value","meta","publishDatetime","moment","err","return","challengesInfo","prepareChallenges","onChallenges","getItem","password","removeItem","localSettings","parse","e","constructor","getDefaultSettings","on","emit","setInterval","autoSubmitMoves","confirmSubmitMoves","enableNotifications","theme","pieces","scheme","rotateOpponent","animations","arrows","numbers","socket","process","available","callbacks","_i","_arr","length","push","_i2","_arr2","pull","appVersion","mergeUsers","readyToPlay","otherUsers","_this2","myIndex","findIndex","slice","concat","toConsumableArray","byId","fromPairs","online","filter","includes","other","offline","readyToPlayMe","challengedUser","_this3","live","game","finished","myLive","userIds","otherLive","myFinished","otherFinished","mine","moves","data","tournament","_this4","future","started","futureAndLive","myFuture","myFutureAndLive","otherFuture","otherFutureAndLive","path","_this5","otherChallenges","userId","otherSolved","won","otherUnsolved","otherStarted","otherNotStarted","client","NavigationalTab","match","props","url","endsWith","_this$props","panes","defaultIndex","defaultTo","activeIndex","activeTo","preparedPanes","pane","originalIndex","_ref","slicedToArray","_ref3","_ref4","to","constructUrl","navigate","pathname","startsWith","menuItem","content","objectSpread","react_default","a","Menu","Item","assign","key","as","NavLink","icon","preparedPane","_this$props2","tab","menu","renderActiveOnly","className","_this$getPreparedPane","getPreparedPanesDefaultToAndActiveIndex","react","react_router","exact","from","Tab","Component","defaultProps","withRouter","InvalidMoveError","Error","Game","rowsAndColumns","status","previous","lastMove","isNextMove","_this7","history","canUndo","previousInHistory","fullHistory","moveCount","chainCount","resignedPlayer","resign","lastMovesInHistory","indexOf","missingStatusKeys","join","nextPlayer","moveType","availableMovesMatrix","thisPlayer","PLAYER_A","thisMoveType","canTakeMoveBack","moveNotation","MOVE_RESIGNED_NOTATION","MOVE_NOTATION","y","x","fullNotation","compressedFullNotation","split","part","MOVE_NOTATION_COMPRESSION","positionNotation","getPositionNotation","winner","getWinner","hasAvailableMove","OTHER_PLAYER","noMovesAreAvailable","getInitialRowsAndColumns","getInitialStatus","create","makeMoves","find","row","cells","cell","findCell","player","PLAYERS","worker","WORKERS","level","playerACount","findCells","playerBCount","PLAYER_B","Math","max","apply","flatten","MOVE_TYPE_PLACE_FIRST_WORKER","allMovesAreAvailableMatrix","MOVE_TYPE_PLACE_SECOND_WORKER","getEmptyCellsAvailableMovesMatrix","playerAFirstWorker","WORKER_FIRST","playerASecondWorker","WORKER_SECOND","playerBFirstWorker","playerBSecondWorker","MOVE_TYPE_SELECT_WORKER_TO_MOVE","getPlayerAvailableMovesMatrix","sum","MOVE_REVERSE_NOTATION","move","fromMoves","MOVE_NOTATION_DECOMPRESSION","POSITION_NOTATION_COMPRESSION","notation","ROWS","COLUMNS","POSITION_REVERSE_NOTATION","fromPosition","_this6","POSITION_NOTATION_DECOMPRESSION","fromCompressedPositionNotation","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","fromRowsAndColumns","_Game$PLAYER_A","_Game$PLAYER_B","_printMap","_nextPlayerMap","_winnerMap","printMap","defineProperty","chalk","bgWhite","bgYellow","bgRed","bgBlue","cellsPrintout","nextPlayerPrintout","winnerPrintout","black","_ref2","floor","condition","winningCell","canPlayerWin","expectedMoveType","coordinates","targetCoordinates","checkCoordinatesAreValid","createStep","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","makeMove","_makeMoveMethods","makeMoveMethod","placeFirstWorker","placeSecondWorker","selectWorkerToMove","MOVE_TYPE_MOVE_FIRST_WORKER","moveFirstWorker","MOVE_TYPE_MOVE_SECOND_WORKER","moveSecondWorker","MOVE_TYPE_BUILD_AROUND_WORKER","buildAroundWorker","bind","checkCanMakeMove","updateCells","_ref5","createNext","_ref6","getMovableAvailableMovesMatrix","_this$constructor","_this8","fromCell","toCell","getBuildableAvailableMovesMatrix","_ref7","moveWorker","_ref8","_ref9","_ref10","_this9","getAvailableMoves","playerCells","playerCell","abs","_this10","_this11","getAvailableMovesMatrix","_this12","_this13","maximumLevel","_this14","isMoveAvailable","updates","_len","arguments","newCells","Array","_key","_newCells","update","MOVE_TYPES_START_OF_TURN","MOVE_TYPES_PLACE_WORKER","MOVE_TYPES_MOVE_WORKER","MOVE_TYPES_MOVE_OR_BUILD","RA","RB","keys","sort","String","fromCharCode","POSITION_NOTATION","entries","_ref11","_ref12","levelStr","notations","_ref13","_ref14","playerStr","parseInt","POSITION_NOTATION_COMPRESSION_MAP","_ref15","_ref17","_ref19","_ref20","_ref21","_ref22","_ref23","_ref24","HtmlBoardBackground","clickable","undoable","isCellAvailable","isCellUndoable","small","medium","onSelect","selected","_settings$theme","classNames","small-board","medium-board","editable","selectable","board-theme-default","board-theme-subtle","board-theme-pastel","board-theme-green","numbered-levels","obvious-levels","subtle-levels","very-subtle-levels","onClick","HtmlBoardBackground_HtmlBoardCell","undo","animated","HtmlBoardCell","displayLevel","LevelIndicatorVerySubtle","transform","constants","dominantBaseline","textAnchor","style","fontSize","PureComponent","LevelIndicatorSubtle","r","fill","stroke","strokeWidth","LevelIndicatorObvious","paintOrder","LevelIndicator","Indicator","indicatorMap","very-subtle","subtle","obvious","BasePieceDefinition","dimensions","offset","xlinkHref","BasePiece","colour","rotated","rotateTransform","definePiece","_ref$offset","PieceDefinitionFor","_PureComponent3","possibleConstructorReturn","getPrototypeOf","inherits","createClass","Piece_BasePieceDefinition","displayName","PieceFor","_PureComponent4","_this$props3","Piece_BasePiece","Definition","PiecePawn","d","PieceKing","PieceCircle","PieceCertificate","PieceSun","PieceRocket","PieceBug","PieceEye","PieceUser","Piece","_this$props4","PieceStyle","pieceStyleMap","pawn","king","circle","certificate","sun","rocket","bug","eye","PieceDefinitions","values","Definitions","CellDefinitions","width","height","Cell","state","previousLevel","currentLevel","levelsAnimate","i","React","createRef","prevProps","prevState","snapshot","setTimeout","levelAnimate","current","beginElement","allowControl","_this$props$theme","_this$props$theme$pie","_this$props$theme$rot","_this$state","isPlayerAOpponent","isPlayerBOpponent","levelMap","opacity","ref","attributeName","attributeType","dur","repeatCount","SvgBoardBackground_Piece","SvgBoardBackground_LevelIndicator","0","1","2","3","4","ArrowDefinition","arrowDimensions","arrowOffset","arrowScaling","hammerDimensions","hammerOffset","hammerScaling","Arrow","_this$constructor2","offsetX","smallScaling","diff","rotation","rotationMap","offsetYFactor","sqrt","0,1","-1,1","-1,0","-1,-1","0,-1","1,-1","1,0","1,1","SvgBoardBackground","transformation","showArrows","rowCount","columnCount","viewBox","--column-count","--row-count","preserveAspectRatio","data-key","SvgBoardBackground_SvgBoardCell","SvgBoardBackground_SvgBoardPieces","arrow","SvgBoardBackground_Arrow","SvgBoardBackground_SvgBoardHistoryArrows","SvgBoardBackgroundDefinitions","display","SvgBoardBackground_Cell","SvgBoardHistoryArrows","_this$getRelevantHist","getRelevantHistory","relevantHistory","gameWithPieceMove","gameWithBuildMove","_move$build","build","reverseCoordinates","iteratingGame","_this$getPlayerMoves","getPlayerMoves","moveArrow","buildArrow","SvgBoardPieces","pointerEvents","SvgBoardBackground_SvgBoardPiece","SvgBoardPiece","previousPosition","position","animateTransform","SvgBoardCell","_this$props5","BoardBackground","_this$props$renderer","renderer","objectWithoutProperties","Renderer","html","svg","Board","takeMoveBack","minChainCount","Board_BoardBackground","isGameUndoable","BoardTransformation","rotations","flippedHorizontally","updateOrientation","method","setState","onChange","_this2$state","transformationMap","rotateCounterClockwise","rotateClockwise","flipHorizontally","flipVertically","reset","size","items","disabled","config","transformRowsAndColumns","reverseTransformCoordinates","flipped","transpose","flipX","flipY","reverseConfig","_this$getNewRowAndCol","getNewRowAndColumnCount","newRowCount","newColumnCount","newXs","range","newY","newX","_this4$getOldCoordina","getOldCoordinates","oldX","oldY","_this$getNewRowAndCol2","_this$getOldCoordinat","0,false","1,false","makeTransformRowsAndColumns","2,false","3,false","0,true","1,true","2,true","3,true","ThemeDemoBoard","demoRowsAndColumns","animate","demoRowsAndColumnsAnimated","animationInterval","PlayerColourBoard","colours","ClientWatcher","connectionChanged","subscribe","unsubscribe","SubComponent","ClientWatcherForComponent","withClient","forComponent","HashedIcon","updateIcon","jdenticon","hash","_classNames","floated","textSized","data-jdenticon-value","GameCard","_Component","_getPrototypeOf2","args","call","selectLiveGame","usersById","tournamentsById","terse","currentGameId","tournamentId","gameGame","deserialize","playerA","playerB","nextPlayerUser","playerAToPlay","playerBToPlay","isUserPlayerA","isUserPlayerB","winnerUser","isMyGame","isMyTurn","showPlayerA","showPlayerB","Card","backgroundColor","attention","Content","components_Board","Header","Label","color","Icon","components_HashedIcon","Meta","endDatetime","startDatetime","GameList","activePage","onPageChange","pageSize","reverse","totalPages","ceil","visibleGames","Group","maxHeight","overflowY","flexWrap","GameList_GameCard","Grid","centered","Row","Pagination","pointing","secondary","gameCount","createTournament","onClose","setValue","Modal","trigger","Button","header","Segment","Form","Field","control","Input","label","placeholder","required","defaultValue","min","actions","positive","TournamentCard","selectLiveTournament","currentTournamentId","isMyTournament","didUserCreated","creatorUserId","didUserWin","winnerUserId","creator","statusLabel","round","rounds","createdDatetime","TournamentList","visibleTournaments","TournamentList_TournamentCard","ChallengeCard","selectChallenge","currentChallengeId","userChallenge","options","typeOptions","mateIn","difficulty","maxDifficulty","title","mistakes","public","isSameOrBefore","fromNow","toNow","startingPosition","get","ChallengeList","visibleChallenges","ChallengeList_ChallengeCard","UserList","readyToPlayUsers","readyToPlayMeUsers","otherUser","Lobby_UserCard","ChallengeUserButton","changeReadyToPlay","challengeUser","playButtonColour","playButtonAttention","playButtonIcon","playButtonOnClick","playButtonLabel","_this$props2$usersInf","loading","UserCard","Lobby_EditUser","hasPassword","winCount","score","tournamentWinCount","tournamentCount","extra","Lobby_ChallengeUserButton","EditUser","changeUsername","target","changePassword","updateUsername","updatePassword","action","negative","LogIn","_Component5","_getPrototypeOf4","_len3","_key3","changeMergeUsers","checked","logIn","_this$state2","modal","float","Checkbox","LogOut","_Component6","_getPrototypeOf5","_len4","_key4","logOut","_this$props5$usersInf","_this$props5$gamesInf","_this$props5$challeng","selectLiveChallenge","render","components_GameList","challengesList","components_ChallengeList","components_CreateTournament","components_TournamentList","Lobby_UserList","Pane","Play","selectedGame","autoSubmitModal","submit","onDisplayPositionChange","newGame","selectGame","onSelectedGameChange","makeMoveToSelected","takeMoveBackToSelected","undoToSelected","deselectGame","getMovesToSubmit","resignOrAbort","changeAutoSubmitMoves","changeSettings","handleOpen","doAutoSubmitMoves","canSubmit","onTransformationChange","propsGame","propsGameIndex","error","resigning","defaultSettings","names","matchGame","children","displayGame","tooShortToResign","canTakeBack","controlsNode","Play_PlayPlayer","playerUser","canAnyPlayerSubmit","takeBack","Play_PlayNavigation","Board_BoardTransformation","boardNode","textAlign","columns","Responsive","minWidth","Column","Fragment","maxWidth","stretched","Statistic","widths","inverted","Play_PlayHistory","MOVE_TYPE_NAMES","primary","_names","PlayPlayer","submitAndDisableConfirm","updateSettings","isPlayerControlled","previousGame","isPlayersTurn","playerWon","stackable","Board_PlayerColourBoard","toggle","item","PlayHistory","lastVisibleGame","PlayNavigation","goToCurrentMove","canGoToCurrentMove","goToNextMove","canGoToNextMove","selectedGameIndex","goToAncestor","mostRecentAncestorGameIndex","gameIndexes","goToPreviousMove","canGoToPreviousMove","goToPreviousVariationMove","goToFirstMove","canGoToFirstMove","keydown","event","_keydown$event","which","shiftKey","Keys","left","home","right","_this$gameIndexes","lastGameIndex","_this$gameIndexes2","_this$gameIndexes3","ancestor","copyToClipboard","text","textArea","body","appendChild","select","execCommand","removeChild","getGameAndErrorFromUrlPosition","dismissUrlPositionError","share","href","navigator","catch","utils","alert","open","active","components_Play","URLSearchParams","search","fromCompressedMoveNotation","SettingsContent","themeSchemeOptions","themePiecesOptions","themeNumbersOptions","themeDemoBoard","overrides","Board_ThemeDemoBoard","updateAutoSubmitMove","updateConfirmSubmitMoves","updateEnableNotifications","updateThemeRotateOpponent","updateAnimations","updateArrows","updateThemeNumbers","updateThemeScheme","updateThemePieces","_this$props$settings","_theme$pieces","attached","verticalAlign","option","radio","save","scrolling","Settings_SettingsContent","OnlineGamePlayer","initialPlayer","resultingPlayerScore","initialPlayerA","resultingPlayerAScore","initialPlayerB","resultingPlayerBScore","isWinner","winPoints","losePoints","ChosenOnlineGame","gameSelector","createSelector","params","gameId","gamesById","playersInfoSelector","userPlayer","gameGameSelector","dismissUrlGameError","submitGameMove","close","shareGame","_this$playersInfo","playersInfo","preventDefault","stopChallengeUser","copyPlayPosition","_this$props2$gamesInf","otherLiveGames","myLiveGames","_this$playersInfo2","gamesNode","components_Settings","REACT_APP_DEBUG","OnlineGame_OnlineGamePlayer","react_router_dom","OnlineGame","_this$props3$gamesInf","OnlineGame_ChosenOnlineGame","services","notifications","Notifications","Notification","permission","requestPermission","construct","prototype","_args2","ChosenOnlineTournament","tournamentSelector","dismissUrlTournamentError","shareTournament","assertThisInitialized","toggleParticipation","startTournament","abortTournament","players","otherUserId","userStats","points","initialScore","Table","celled","collapsing","unstackable","HeaderCell","Body","stats","ratedPoints","expectedPoints","toFixed","waitingForNextRound","scoreDifference","colSpan","schedule","roundIndex","pairings","gameIndex","_ref$userIds","playerAId","playerBId","playerAWon","playerBWon","player-a-won","player-b-won","OnlineTournament","OnlineTournament_ChosenOnlineTournament","LearnBoard","selectedMoveCell","movedFromCell","selectedBuildCell","canMove","canBuild","isCellAvailableForMoving","isCellAvailableForBuilding","makeMoveMoving","makeMoveBuilding","_this$state3","_this$state4","makeMoveUndoMoving","board","originalRowsAndColumns","_this$state5","rawSettings","LearnToPlay","stepIndex","goToFirstStep","goToPreviousStep","goToNextStep","goToLastStep","steps","step","Message","LearnToPlay_LearnBoard","EditPosition","paletteSelectedItem","paletteUpdate","positionError","urlError","onPaletteSelectedItemChange","onPositionChange","message","copyGame","visibleGame","resetBoard","resetGame","copyPosition","usePosition","initialPositionNotation","EditPosition_EditPositionPalette","selectedItem","onSelectedItemChange","EditPosition_EditPositionBoard","EditPositionPalette","moveFromKey","q","b","EditPositionBoard","updatePosition","newCell","newPosition","CreateChallenge","editing","currentStep","tree","onCreateChallenge","getTree","existingResponse","getExistingResponse","pathIndexes","getPathIndexes","_this$duplicateChalle","duplicateChallenge","newChallenge","newModifyingStep","newStep","addGameToStep","getNextTreePath","treePath","lastTreeStep","playerResponses","nextStep","challengeResponse","deleteCurrentStep","_this$duplicateChalle2","removeStep","editChallenge","createChallenge","cleanedChallenge","discardChallenge","initialChallenge","fillGames","challengeStep","response","treePathStep","oldStep","isArray","getNextTree","nextTree","CreateChallenge_ChallengeForm","challengePrompt","getDifficultyStars","source","rowIndex","columnIndex","ChallengeForm","editingPosition","convertedValue","valueConversion","newChallengeToChange","parts","onValueSet","isPositionValid","isValidCompressedPositionNotation","_this3$state","editPosition","components_EditPosition","onSubmit","inline","Radio","Select","format","options.typeOptions.mateIn","meta.difficulty","meta.publishDatetime","timestamp","EditChallenge","dismissUrlChallengeError","components_CreateChallenge","Challenges","_this$props$challenge","components_EditChallenge","Challenges_ChallengePlayer","ChallengePlayer","challengeId","getResumedChallengeGame","submittedGame","wrongMove","updateChallenge","askServer","shareChallenge","resultingGame","userChallengeStep","lastPlayerResponse","gameToUpdate","_ref3$askServer","remainingHistory","_loop","historyGame","shift","invalidPlayerPositions","v","validPlayerResponse","submitChallengeMove","_ret","success","App","liveGame","liveTournament","liveChallenge","gameUrl","tournamentUrl","challengeUrl","leaveTournament","joinTournament","askForNotificationPermissionOnWaitForGame","navigateToMyNewGame","notifyAboutMyMove","previousMyLiveGameIds","Set","newMyLiveGameIds","has","notify","gamesThatChangedToMyTurn","nextUserId","prevGame","tag","onlineGameLabel","onlineTournamentLabel","Container","Board_SvgBoardBackground","Lobby_LogIn","Lobby_LogOut","components_NavigationalTab","components_Lobby","components_OnlineGame","components_OnlineTournament","components_Hotseat","components_Challenges","components_LearnToPlay","Boolean","hostname","ReactDOM","basename","src_App","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.f7aab782.chunk.js","sourcesContent":["import _ from \"lodash\";\r\nimport moment from \"moment\";\r\n\r\nconst appVersion = 6;\r\n\r\nclass Client {\r\n  static getDefaultSettings() {\r\n    return JSON.parse(JSON.stringify({\r\n      autoSubmitMoves: false,\r\n      confirmSubmitMoves: true,\r\n      enableNotifications: false,\r\n      theme: {pieces: 'king', scheme: '', rotateOpponent: true, animations: true, arrows: true, numbers: 'obvious'},\r\n    }));\r\n  }\r\n\r\n  scriptIoReloadInterval = null;\r\n\r\n  constructor() {\r\n    this.id = localStorage.getItem('user-id') || null;\r\n    this.username = localStorage.getItem('user-name') || null;\r\n    const password = localStorage.getItem('user-password') || null;\r\n    localStorage.removeItem('user-password');\r\n    this.token = localStorage.getItem('user-token') || password;\r\n    const localSettings = localStorage.getItem('user-settings') || 'null';\r\n    try {\r\n      this.settings = JSON.parse(localSettings);\r\n    } catch (e) {\r\n      this.settings = null;\r\n    }\r\n    if (!this.settings) {\r\n      this.settings = this.constructor.getDefaultSettings();\r\n    }\r\n    if (!window.io) {\r\n      window.io = () => ({\r\n        on: () => console.warn(\"Socket script was missing\"),\r\n        emit: () => console.warn(\"Socket script was missing\"),\r\n        unavailable: true,\r\n      });\r\n      window.io.unavailable = true;\r\n      this.scriptIoReloadInterval = setInterval(this.reloadScriptIo, 1000);\r\n    }\r\n\r\n    this.disconnected = false;\r\n\r\n    this.onConnect = [];\r\n    this.onDisconnect = [];\r\n    this.onUser = [];\r\n    this.onUsers = [];\r\n    this.onGames = [];\r\n    this.onTournaments = [];\r\n    this.onChallenges = [];\r\n\r\n    this.bindSocket();\r\n  }\r\n\r\n  bindSocket() {\r\n    this.socket = window.io(process.env.REACT_APP_SERVER_URL);\r\n    this.available = !this.socket.unavailable;\r\n    this.connected = false;\r\n    this.socket.on('connect', this.justConnected);\r\n    this.socket.on('disconnect', this.justDisconnected);\r\n    this.socket.on(\"reload\", this.reload);\r\n\r\n    this.user = null;\r\n    this.socket.on(\"user\", this.gotUser);\r\n\r\n    this.usersInfo = this.prepareUsers([]);\r\n    this.socket.on(\"users\", this.gotUsers);\r\n\r\n    this.gamesInfo = this.prepareGames([]);\r\n    this.socket.on(\"games\", this.gotGames);\r\n\r\n    this.tournamentsInfo = this.prepareTournaments([]);\r\n    this.socket.on(\"tournaments\", this.gotTournaments);\r\n\r\n    this.challengesInfo = this.prepareChallenges([]);\r\n    this.socket.on(\"challenges\", this.gotChallenges);\r\n\r\n    this.getUser();\r\n  }\r\n\r\n  reloadScriptIo = () => {\r\n    if (!window.io.unavailable) {\r\n      clearInterval(this.scriptIoReloadInterval);\r\n      this.scriptIoReloadInterval = null;\r\n      this.bindSocket();\r\n      console.log('Loaded script.io!');\r\n      return;\r\n    }\r\n    const oldScriptEl = document.getElementById('socket-io-script');\r\n    const newScriptEl = document.createElement('script');\r\n    newScriptEl.id = oldScriptEl.id;\r\n    newScriptEl.type = oldScriptEl.type;\r\n    newScriptEl.src = oldScriptEl.src;\r\n    oldScriptEl.remove();\r\n    document.head.append(newScriptEl);\r\n    console.warn('Retrying socket.io script download...');\r\n  };\r\n\r\n  subscribe(callbacks) {\r\n    for (const name of ['onConnect', 'onDisconnect', 'onUser', 'onUsers', 'onGames', 'onTournaments', 'onChallenges']) {\r\n      const callback = callbacks[name];\r\n      if (callback) {\r\n        this[name].push(callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  unsubscribe(callbacks) {\r\n    for (const name of ['onConnect', 'onDisconnect', 'onUser', 'onUsers', 'onGames', 'onChallenges']) {\r\n      const callback = callbacks[name];\r\n      if (callback) {\r\n        _.pull(this[name], callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  getUser() {\r\n    this.socket.emit(\"create-user\", {\r\n      appVersion,\r\n      id: this.id,\r\n      name: this.username,\r\n      token: this.token,\r\n      settings: this.settings,\r\n    });\r\n  }\r\n\r\n  logIn(name, password, mergeUsers) {\r\n    this.socket.emit(\"log-in\", {appVersion, name, password, mergeUsers});\r\n  }\r\n\r\n  logOut() {\r\n    this.socket.emit(\"log-out\");\r\n  }\r\n\r\n  reload = () => {\r\n    window.location.reload(true);\r\n  };\r\n\r\n  justConnected = () => {\r\n    this.getUser();\r\n    this.connected = true;\r\n    this.onConnect.map(callback => callback(this.connected));\r\n  };\r\n\r\n  justDisconnected = () => {\r\n    this.connected = false;\r\n    this.disconnected = true;\r\n    this.onDisconnect.map(callback => callback(this.connected));\r\n  };\r\n\r\n  gotUser = user => {\r\n    if (user) {\r\n      this.id = user.id;\r\n      this.username = user.name;\r\n      this.token = user.token;\r\n      this.settings = user.settings;\r\n      localStorage.setItem('user-id', this.id);\r\n      localStorage.setItem('user-name', this.username);\r\n      localStorage.setItem('user-token', this.token);\r\n      localStorage.setItem('user-settings', JSON.stringify(this.settings));\r\n    }\r\n    this.user = user;\r\n    this.onUser.map(callback => callback(user));\r\n    this.gotUsers(this.usersInfo.users);\r\n  };\r\n\r\n  changeUsername(name) {\r\n    this.socket.emit(\"change-username\", name);\r\n  }\r\n\r\n  changePassword(password) {\r\n    this.socket.emit(\"change-password\", password);\r\n  }\r\n\r\n  updateSettings(settings) {\r\n    this.socket.emit(\"update-settings\", settings);\r\n  }\r\n\r\n  changeReadyToPlay(readyToPlay) {\r\n    this.socket.emit(\"change-ready-to-play\", readyToPlay);\r\n  }\r\n\r\n  gotUsers = users => {\r\n    users = _.orderBy(users, [user => user.isUserRatingProvisional ? 1 : 0, 'score', 'maxScore'], ['asc', 'desc', 'desc']);\r\n    users.forEach((user, index) => {\r\n      user.rank = index + 1;\r\n    });\r\n    this.usersInfo = this.prepareUsers(users);\r\n    this.onUsers.map(callback => callback(this.usersInfo));\r\n  };\r\n\r\n  prepareUsers(users) {\r\n    let otherUsers;\r\n    if (this.user) {\r\n      const myIndex = users.findIndex(user => user.id === this.user.id);\r\n      if (myIndex >= 0) {\r\n        otherUsers = users.slice(0, myIndex).concat(users.slice(myIndex + 1));\r\n        users = [users[myIndex], ...otherUsers];\r\n      } else {\r\n        otherUsers = users;\r\n      }\r\n    } else {\r\n      otherUsers = users;\r\n    }\r\n    const byId = _.fromPairs(users.map(user => [user.id, user]));\r\n    const online = users.filter(user => user.online);\r\n    const readyToPlay = online.filter(user => [true, this.user ? this.user.id : true].includes(user.readyToPlay));\r\n    return {\r\n      users,\r\n      byId,\r\n      other: otherUsers,\r\n      online,\r\n      offline: users.filter(user => !user.online),\r\n      readyToPlay,\r\n      readyToPlayMe: readyToPlay.filter(user => this.user && this.user.id === user.readyToPlay),\r\n      challengedUser: this.user ? (byId[this.user.readyToPlay] || null ): null,\r\n    };\r\n  }\r\n\r\n  gotGames = games => {\r\n    games = _.sortBy(games, ['startDatetime', 'id'], ['desc', 'desc']);\r\n    this.gamesInfo = this.prepareGames(games);\r\n    this.onGames.map(callback => callback(this.gamesInfo));\r\n  };\r\n\r\n  prepareGames(games) {\r\n    const live = games.filter(game => !game.finished);\r\n    const finished = games.filter(game => game.finished);\r\n    return {\r\n      games,\r\n      byId: _.fromPairs(games.map(game => [game.id, game])),\r\n      live,\r\n      myLive: this.user ? live.filter(game => game.userIds.includes(this.user.id)) : [],\r\n      otherLive: this.user ? live.filter(game => !game.userIds.includes(this.user.id)) : live,\r\n      finished,\r\n      myFinished: this.user ? finished.filter(game => game.userIds.includes(this.user.id)) : [],\r\n      otherFinished: this.user ? finished.filter(game => !game.userIds.includes(this.user.id)) : live,\r\n      mine: this.user ? games.filter(game => game.userIds.includes(this.user.id)) : [],\r\n    };\r\n  }\r\n\r\n  submitGameMove(game, moves) {\r\n    this.socket.emit(\"submit-game-moves\", {id: game.id, moves});\r\n  }\r\n\r\n  createTournament(data) {\r\n    this.socket.emit(\"create-tournament\", data);\r\n  }\r\n\r\n  joinTournament(tournament) {\r\n    this.socket.emit(\"join-tournament\", tournament.id);\r\n  }\r\n\r\n  leaveTournament(tournament) {\r\n    this.socket.emit(\"leave-tournament\", tournament.id);\r\n  }\r\n\r\n  startTournament(tournament) {\r\n    this.socket.emit(\"start-tournament\", tournament.id);\r\n  }\r\n\r\n  abortTournament(tournament) {\r\n    this.socket.emit(\"abort-tournament\", tournament.id);\r\n  }\r\n\r\n  gotTournaments = tournaments => {\r\n    tournaments = _.sortBy(tournaments, ['startDatetime', 'endDatetime', 'createdDatetime', 'id'], ['desc', 'desc', 'desc', 'desc']);\r\n    this.tournamentsInfo = this.prepareTournaments(tournaments);\r\n    this.onTournaments.map(callback => callback(this.tournamentsInfo));\r\n  };\r\n\r\n  prepareTournaments(tournaments) {\r\n    const future = tournaments.filter(tournament => !tournament.started);\r\n    const live = tournaments.filter(tournament => tournament.started && !tournament.finished);\r\n    const futureAndLive = future.concat(live);\r\n    const finished = tournaments.filter(tournament => tournament.finished);\r\n    return {\r\n      tournaments,\r\n      byId: _.fromPairs(tournaments.map(game => [game.id, game])),\r\n      future, live, futureAndLive, finished,\r\n      myFuture: this.user ? future.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      myLive: this.user ? live.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      myFutureAndLive: this.user ? futureAndLive.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      myFinished: this.user ? finished.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      otherFuture: this.user ? live.filter(tournament => !tournament.userIds.includes(this.user.id)) : live,\r\n      otherLive: this.user ? future.filter(tournament => !tournament.userIds.includes(this.user.id)) : future,\r\n      otherFutureAndLive: this.user ? futureAndLive.filter(tournament => !tournament.userIds.includes(this.user.id)) : future,\r\n      otherFinished: this.user ? finished.filter(tournament => !tournament.userIds.includes(this.user.id)) : finished,\r\n      mine: this.user ? tournaments.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n    };\r\n  }\r\n\r\n  createChallenge(challenge) {\r\n    this.socket.emit('create-challenge', challenge);\r\n  }\r\n\r\n  submitChallengeMove(challenge, path) {\r\n    this.socket.emit(\"submit-challenge-moves\", {id: challenge.id, path});\r\n  }\r\n\r\n  gotChallenges = challenges => {\r\n    for (const challenge of challenges) {\r\n      challenge.meta.publishDatetime = moment(challenge.meta.publishDatetime);\r\n    }\r\n    challenges = _.sortBy(challenges, ['startDatetime', 'endDatetime', 'createdDatetime', 'id'], ['desc', 'desc', 'desc', 'desc']);\r\n    this.challengesInfo = this.prepareChallenges(challenges);\r\n    this.onChallenges.map(callback => callback(this.challengesInfo));\r\n  };\r\n\r\n  prepareChallenges(challenges) {\r\n    const otherChallenges = this.user ? challenges.filter(challenge => challenge.userId !== this.user.id) : challenges;\r\n    return {\r\n      challenges,\r\n      byId: _.fromPairs(challenges.map(game => [game.id, game])),\r\n      mine: this.user ? challenges.filter(challenge => challenge.userId === this.user.id) : [],\r\n      other: otherChallenges,\r\n      otherSolved: this.user ? otherChallenges.filter(challenge => this.user.challenges[challenge.id] && this.user.challenges[challenge.id].meta.won) : [],\r\n      otherUnsolved: this.user ? otherChallenges.filter(challenge => !this.user.challenges[challenge.id] || !this.user.challenges[challenge.id].meta.won) : otherChallenges,\r\n      otherStarted: this.user ? otherChallenges.filter(challenge => this.user.challenges[challenge.id] && this.user.challenges[challenge.id].meta.started && !this.user.challenges[challenge.id].meta.won) : [],\r\n      otherNotStarted: this.user ? otherChallenges.filter(challenge => !this.user.challenges[challenge.id] || !this.user.challenges[challenge.id].meta.started) : otherChallenges,\r\n    };\r\n  }\r\n}\r\n\r\nexport const client = new Client();\r\nwindow.client = client;\r\n\r\nexport default Client;\r\n","import PropTypes from \"prop-types\";\r\nimport React, { Component, Fragment } from 'react';\r\nimport {\r\n  NavLink,\r\n  Redirect, Route,\r\n  Switch,\r\n  withRouter\r\n} from \"react-router-dom\";\r\nimport { Menu, Tab } from 'semantic-ui-react';\r\n\r\nclass NavigationalTab extends Component {\r\n  constructUrl(path) {\r\n    const {match} = this.props;\r\n    return `${match.url.endsWith('/') ? match.url.slice(0, -1) : match.url}${path ? `/${path}` : ''}`;\r\n  }\r\n\r\n  getPreparedPanesDefaultToAndActiveIndex() {\r\n    const {panes, defaultIndex, match, location} = this.props;\r\n    let defaultTo = null;\r\n    let activeIndex = null;\r\n    let activeTo = match.url;\r\n\r\n    const preparedPanes = panes\r\n      .map((pane, originalIndex) => [pane, originalIndex])\r\n      .filter(([pane]) => pane)\r\n      .map(([pane, originalIndex], index) => {\r\n        if (!pane) {\r\n          return null;\r\n        }\r\n\r\n        const to = this.constructUrl(pane.path);\r\n        if (originalIndex === defaultIndex) {\r\n          defaultTo = to;\r\n        }\r\n        const navigate = pane.navigate !== undefined ? this.constructUrl(pane.navigate) : to;\r\n        if (location.pathname.startsWith(navigate)) {\r\n          activeIndex = index;\r\n          activeTo = to;\r\n        }\r\n\r\n        const menuItem = (\r\n          typeof pane.menuItem === typeof \"\"\r\n            ? {content: pane.menuItem}\r\n            : pane.menuItem\r\n        );\r\n        return {\r\n          to,\r\n          ...pane,\r\n          menuItem: (\r\n            <Menu.Item\r\n              key={pane.path}\r\n              as={NavLink}\r\n              to={navigate}\r\n              {...menuItem}\r\n              icon={pane.icon || menuItem.icon}\r\n            />\r\n          ),\r\n        };\r\n      })\r\n      .filter(preparedPane => preparedPane);\r\n    return {preparedPanes, defaultTo, activeIndex, activeTo}\r\n  }\r\n\r\n  render() {\r\n    const {tab, menu, match, renderActiveOnly, className} = this.props;\r\n    const {preparedPanes, defaultTo, activeIndex, activeTo} = this.getPreparedPanesDefaultToAndActiveIndex();\r\n\r\n    return (\r\n      <Fragment>\r\n        {defaultTo !== null ? (\r\n          <Switch>\r\n            <Redirect exact from={match.url} to={defaultTo} />\r\n          </Switch>\r\n        ) : null}\r\n        <Route path={activeTo}>\r\n          <Tab\r\n            menu={menu}\r\n            renderActiveOnly={renderActiveOnly}\r\n            {...tab}\r\n            panes={preparedPanes}\r\n            activeIndex={activeIndex}\r\n            className={className}\r\n          />\r\n        </Route>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nNavigationalTab.propTypes = {\r\n  panes: PropTypes.arrayOf(PropTypes.shape({\r\n    ...Menu.Item.propTypes,\r\n    path: PropTypes.string,\r\n    menuItem: PropTypes.oneOfType([PropTypes.string, PropTypes.object]).isRequired,\r\n  })).isRequired,\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  tab: PropTypes.object,\r\n  menu: PropTypes.object,\r\n  renderActiveOnly: PropTypes.bool.isRequired,\r\n  defaultIndex: PropTypes.number.isRequired,\r\n};\r\n\r\nNavigationalTab.defaultProps = {\r\n  renderActiveOnly: true,\r\n  defaultIndex: 0,\r\n};\r\n\r\nexport default withRouter(NavigationalTab);\r\n","import _ from \"lodash\";\r\nimport chalk from 'chalk';\r\n\r\nclass InvalidMoveError extends Error {}\r\n\r\nclass Game {\r\n  static PLAYER_A = 'player-a';\r\n  static PLAYER_B = 'player-b';\r\n  static PLAYERS = [\r\n    this.PLAYER_A,\r\n    this.PLAYER_B,\r\n  ];\r\n  static OTHER_PLAYER = {\r\n    [this.PLAYER_A]: this.PLAYER_B,\r\n    [this.PLAYER_B]: this.PLAYER_A,\r\n  };\r\n\r\n  static WORKER_FIRST = 'first-worker';\r\n  static WORKER_SECOND = 'second-worker';\r\n  static WORKERS = [this.WORKER_FIRST, this.WORKER_SECOND];\r\n\r\n  static MOVE_TYPE_PLACE_FIRST_WORKER = 'place-first-worker';\r\n  static MOVE_TYPE_PLACE_SECOND_WORKER = 'place-second-worker';\r\n  static MOVE_TYPE_SELECT_WORKER_TO_MOVE = 'select-worker-to-move';\r\n  static MOVE_TYPE_MOVE_FIRST_WORKER = 'move-first-worker';\r\n  static MOVE_TYPE_MOVE_SECOND_WORKER = 'move-second-worker';\r\n  static MOVE_TYPE_BUILD_AROUND_WORKER = 'build-around-worker';\r\n\r\n  static MOVE_TYPES_START_OF_TURN = [this.MOVE_TYPE_PLACE_FIRST_WORKER, this.MOVE_TYPE_SELECT_WORKER_TO_MOVE];\r\n  static MOVE_TYPES_PLACE_WORKER = [this.MOVE_TYPE_PLACE_FIRST_WORKER, this.MOVE_TYPE_PLACE_SECOND_WORKER];\r\n  static MOVE_TYPES_MOVE_WORKER = [this.MOVE_TYPE_MOVE_FIRST_WORKER, this.MOVE_TYPE_MOVE_SECOND_WORKER];\r\n  static MOVE_TYPES_MOVE_OR_BUILD = [...this.MOVE_TYPES_MOVE_WORKER, this.MOVE_TYPE_BUILD_AROUND_WORKER];\r\n\r\n  static ROWS = Array.from({length: 5}, (value, index) => index);\r\n  static COLUMNS = Array.from({length: 5}, (value, index) => index);\r\n  static MOVE_NOTATION = this.ROWS.map(y => this.COLUMNS.map(x =>\r\n    `${['A', 'B', 'C', 'D', 'E'][x]}${['1', '2', '3', '4', '5'][y]}`));\r\n  static MOVE_RESIGNED_NOTATION = {\r\n    [this.PLAYER_A]: 'RA',\r\n    [this.PLAYER_B]: 'RB',\r\n  };\r\n  static MOVE_REVERSE_NOTATION = {\r\n    ..._.fromPairs(_.flatten(this.ROWS.map(y => this.COLUMNS.map(x =>\r\n      [`${['A', 'B', 'C', 'D', 'E'][x]}${['1', '2', '3', '4', '5'][y]}`, {x, y}])))),\r\n    'RA': [{resign: this.PLAYER_A}],\r\n    'RB': [{resign: this.PLAYER_B}],\r\n  };\r\n  static MOVE_NOTATION_COMPRESSION = _.fromPairs(Object.keys(this.MOVE_REVERSE_NOTATION).sort().map((value, index) =>\r\n    [value, String.fromCharCode(index < 26 ? 65 + index : 48 + (index - 26))]));\r\n  static MOVE_NOTATION_DECOMPRESSION = _.fromPairs(Object.keys(this.MOVE_REVERSE_NOTATION).sort().map((value, index) =>\r\n    [String.fromCharCode(index < 26 ? 65 + index : 48 + (index - 26)), this.MOVE_REVERSE_NOTATION[value]]));\r\n\r\n  static POSITION_NOTATION = _.fromPairs([0, 1, 2, 3, 4].map(\r\n    level => [level, _.fromPairs([null, this.PLAYER_A, this.PLAYER_B].map(\r\n      player => [player, `${level}-${player}`]))]));\r\n  static POSITION_REVERSE_NOTATION = _.fromPairs(_.flatten(Object.entries(this.POSITION_NOTATION).map(\r\n    ([levelStr, notations]) => Object.entries(notations).map(\r\n      ([playerStr, notation]) => [notation, {level: parseInt(levelStr), player: playerStr === \"null\" ? null : playerStr}]))));\r\n  static POSITION_NOTATION_COMPRESSION_MAP = _.fromPairs(_.flatten(Object.entries(this.POSITION_NOTATION).map(\r\n    ([, notations]) => Object.entries(notations).map(\r\n      ([, notation]) => notation))).map((notation, index) => [notation, String.fromCharCode(65 + index)]));\r\n  static POSITION_NOTATION_COMPRESSION = _.fromPairs(Object.entries(this.POSITION_NOTATION).map(\r\n    ([levelStr, notations]) => [levelStr, _.fromPairs(Object.entries(notations).map(\r\n      ([playerStr, notation]) => [playerStr, this.POSITION_NOTATION_COMPRESSION_MAP[notation]]))]));\r\n  static POSITION_NOTATION_DECOMPRESSION = _.fromPairs(Object.entries(this.POSITION_NOTATION_COMPRESSION_MAP).map(\r\n    ([notation, compressedNotation]) => [compressedNotation, this.POSITION_REVERSE_NOTATION[notation]]));\r\n\r\n  static create() {\r\n    const rowsAndColumns = this.getInitialRowsAndColumns();\r\n    const status = this.getInitialStatus();\r\n    return new this(rowsAndColumns, status, null, null, false);\r\n  }\r\n\r\n  static fromMoves(moves) {\r\n    let game = this.create();\r\n    game = game.makeMoves(moves);\r\n\r\n    return game;\r\n  }\r\n\r\n  static fromRowsAndColumns(rowsAndColumns) {\r\n    if (rowsAndColumns.length !== 5) {\r\n      throw new Error(`Expected 5 rows but got ${rowsAndColumns.length}`);\r\n    }\r\n    if (rowsAndColumns.find(row => row.cells.length !== 5)) {\r\n      throw new Error(`Expected 5 columns but some rows had a different number`);\r\n    }\r\n    if (rowsAndColumns.find((row, y) => row.y !== y)) {\r\n      throw new Error(`Some rows had invalid \\`y\\``);\r\n    }\r\n    if (rowsAndColumns.find(row => row.cells.find((cell, x) => cell.x !== x || cell.y !== row.y))) {\r\n      throw new Error(`Some cells had invalid \\`x\\` or \\`y\\``);\r\n    }\r\n    const hasInvalidPlayerOrWorker = cell => (\r\n      (cell.player && !this.PLAYERS.includes(cell.player))\r\n      || (cell.worker && !this.WORKERS.includes(cell.worker))\r\n    );\r\n    if (this.findCell(rowsAndColumns, hasInvalidPlayerOrWorker)) {\r\n      throw new Error(`Some cells had invalid player or worker`);\r\n    }\r\n    if (this.findCell(rowsAndColumns, cell => ![0, 1, 2, 3, 4].includes(cell.level))) {\r\n      throw new Error(`Some cells have invalid level`);\r\n    }\r\n    const playerACount = this.findCells(rowsAndColumns, cell => cell.player === this.PLAYER_A).length;\r\n    const playerBCount = this.findCells(rowsAndColumns, cell => cell.player === this.PLAYER_B).length;\r\n    if (playerACount > 2 || playerBCount > 2) {\r\n      throw new Error(\r\n        `Players can have at most 2 workers, but player A has ${playerACount} and player B has ${playerBCount}`);\r\n    }\r\n    let status;\r\n    const maxLevel = Math.max(..._.flatten(rowsAndColumns.map(row => row.cells.map(cell => cell.level))));\r\n    if (maxLevel === 0) {\r\n      if (playerBCount === 0) {\r\n        if (playerACount === 0) {\r\n          status = {\r\n            nextPlayer: this.PLAYER_A,\r\n            moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n            availableMovesMatrix: this.allMovesAreAvailableMatrix(),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        } else if (playerACount === 1) {\r\n          status = {\r\n            nextPlayer: this.PLAYER_A,\r\n            moveType: this.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n            availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        } else {\r\n          const playerAFirstWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_A && cell.worker === this.WORKER_FIRST);\r\n          const playerASecondWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_A && cell.worker === this.WORKER_SECOND);\r\n          if (!playerAFirstWorker || !playerASecondWorker) {\r\n            throw new Error(`Could not find both workers of player A`);\r\n          }\r\n          status = {\r\n            nextPlayer: this.PLAYER_B,\r\n            moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n            availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        }\r\n      } else {\r\n        if (playerACount !== 2) {\r\n          throw new Error(`Player A must put both of their workers before player B can place theirs`);\r\n        }\r\n        if (playerBCount === 1) {\r\n          status = {\r\n            nextPlayer: this.PLAYER_B,\r\n            moveType: this.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n            availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        } else {\r\n          const playerBFirstWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_B && cell.worker === this.WORKER_FIRST);\r\n          const playerBSecondWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_B && cell.worker === this.WORKER_SECOND);\r\n          if (!playerBFirstWorker || !playerBSecondWorker) {\r\n            throw new Error(`Could not find both workers of player B`);\r\n          }\r\n          status = {\r\n            nextPlayer: this.PLAYER_A,\r\n            moveType: this.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n            availableMovesMatrix: this.getPlayerAvailableMovesMatrix(rowsAndColumns, this.PLAYER_A),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        }\r\n      }\r\n    } else {\r\n      if (playerACount !== 2 || playerBCount !== 2) {\r\n        throw new Error(`Both players must have placed both of their workers before they can move and build`);\r\n      }\r\n\r\n      if (this.findCell(rowsAndColumns, cell => cell.level === 4 && cell.player)) {\r\n        throw new Error(`Some workers are on the 4th level`);\r\n      }\r\n      const wonWorkers = this.findCells(rowsAndColumns, cell => cell.level === 3 && cell.player);\r\n      if (wonWorkers.length > 1) {\r\n        throw new Error(`Too many workers have won`);\r\n      }\r\n      const buildCount = _.sum(_.flatten(rowsAndColumns.map(row => row.cells.map(cell => cell.level))));\r\n      if (buildCount % 2 === 0) {\r\n        status = {\r\n          nextPlayer: this.PLAYER_A,\r\n          moveType: this.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n          availableMovesMatrix: this.getPlayerAvailableMovesMatrix(rowsAndColumns, this.PLAYER_A),\r\n          canUndo: false,\r\n          resignedPlayer: null,\r\n        };\r\n      } else {\r\n        status = {\r\n          nextPlayer: this.PLAYER_B,\r\n          moveType: this.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n          availableMovesMatrix: this.getPlayerAvailableMovesMatrix(rowsAndColumns, this.PLAYER_B),\r\n          canUndo: false,\r\n          resignedPlayer: null,\r\n        };\r\n      }\r\n    }\r\n    return new this(rowsAndColumns, status, null, null, false);\r\n  }\r\n\r\n  static fromMoveNotation(fullNotation) {\r\n    const moves = fullNotation\r\n      .split('')\r\n      .map(part => this.MOVE_REVERSE_NOTATION[part]);\r\n    if (moves.filter(move => !move).length) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      return this.fromMoves(moves, true);\r\n    } catch (e) {\r\n      return this.fromMoves(moves, false);\r\n    }\r\n  }\r\n\r\n  static fromCompressedMoveNotation(compressedFullNotation) {\r\n    const moves = compressedFullNotation\r\n      .split('')\r\n      .map(part => this.MOVE_NOTATION_DECOMPRESSION[part]);\r\n    if (moves.filter(move => !move).length) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      return this.fromMoves(moves, true);\r\n    } catch (e) {\r\n      return this.fromMoves(moves, false);\r\n    }\r\n  }\r\n\r\n  static getPositionNotation(rowsAndColumns) {\r\n    return _.flatten(rowsAndColumns.map(\r\n      row => row.cells.map(\r\n        cell => this.POSITION_NOTATION_COMPRESSION[cell.level][cell.player])))\r\n      .join('');\r\n  }\r\n\r\n  static fromPositionNotation(notation) {\r\n    const rowsAndColumns = this.ROWS.map(y => ({\r\n      y, cells: this.COLUMNS.map(x => ({\r\n        x, y, ...this.POSITION_REVERSE_NOTATION[notation[y * 5 + x]],\r\n      })),\r\n    }));\r\n    return this.fromPosition(rowsAndColumns);\r\n  }\r\n\r\n  static fromCompressedPositionNotation(notation) {\r\n    const rowsAndColumns = this.ROWS.map(y => ({\r\n      y, cells: this.COLUMNS.map(x => ({\r\n        x, y, ...this.POSITION_NOTATION_DECOMPRESSION[notation[y * 5 + x]],\r\n      })),\r\n    }));\r\n    return this.fromPosition(rowsAndColumns);\r\n  }\r\n\r\n  static isValidCompressedPositionNotation(notation) {\r\n    try {\r\n      this.fromCompressedPositionNotation(notation);\r\n      return true;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  static fromPosition(rowsAndColumns) {\r\n    let playerACount = 0, playerBCount = 0;\r\n    for (const x of this.ROWS) {\r\n      for (const y of this.COLUMNS) {\r\n        const cell = rowsAndColumns[y].cells[x];\r\n        if (cell.player === this.PLAYER_A) {\r\n          cell.worker = this.WORKERS[playerACount % 2];\r\n          playerACount += 1;\r\n        } else if (cell.player === this.PLAYER_B) {\r\n          cell.worker = this.WORKERS[playerBCount % 2];\r\n          playerBCount += 1;\r\n        }\r\n      }\r\n    }\r\n    return this.fromRowsAndColumns(rowsAndColumns);\r\n  }\r\n\r\n  createStep(rowsAndColumns, status, lastMove) {\r\n    return new this.constructor(rowsAndColumns, status, this, lastMove, false);\r\n  }\r\n\r\n  createNext(rowsAndColumns, status, lastMove) {\r\n    return new this.constructor(rowsAndColumns, status, this, lastMove, true);\r\n  }\r\n\r\n  constructor(rowsAndColumns, status, previous, lastMove, isNextMove) {\r\n    if (!rowsAndColumns || !status) {\r\n      throw new Error(\"You need to pass rowsAndColumns, status, and previous game\");\r\n    }\r\n    this.previous = previous;\r\n    this.history = (this.previous ? this.previous.history : [])\r\n      .filter(game => !game.canUndo)\r\n      .concat([this]);\r\n    this.previousInHistory = this.history[this.history.length - 2];\r\n    this.fullHistory = (this.previous ? this.previous.fullHistory : []).concat(this);\r\n    this.isNextMove = isNextMove;\r\n    this.moveCount = this.previous ? (isNextMove ? this.previous.moveCount + 1 : this.previous.moveCount) : 1;\r\n    this.chainCount = this.previous ? this.previous.chainCount + 1 : 0;\r\n    this.lastMove = lastMove ? lastMove : (status.resignedPlayer ? {resign: status.resignedPlayer} : lastMove);\r\n    this.moves = this.previous ? this.previous.moves.concat([this.lastMove]) : [];\r\n    this.lastMovesInHistory = this.fullHistory\r\n      .slice(this.fullHistory.indexOf(this.previousInHistory) + 1)\r\n      .map(game => game.lastMove);\r\n    this.path = this.previousInHistory\r\n      ? this.previousInHistory.path.concat([this.lastMovesInHistory])\r\n      : [];\r\n\r\n    this.rowsAndColumns = rowsAndColumns;\r\n\r\n    const missingStatusKeys =\r\n      ['nextPlayer', 'moveType', 'availableMovesMatrix', 'canUndo', 'resignedPlayer']\r\n      .filter(key => status[key] === undefined);\r\n    if (missingStatusKeys.length) {\r\n      throw new Error(`Some status keys were missing: ${missingStatusKeys.join(', ')}`);\r\n    }\r\n    const {nextPlayer, moveType, availableMovesMatrix, canUndo, resignedPlayer} = status;\r\n    this.thisPlayer = previous ? previous.nextPlayer : Game.PLAYER_A;\r\n    this.nextPlayer = nextPlayer;\r\n    this.thisMoveType = previous ? previous.moveType : null;\r\n    this.moveType = moveType;\r\n    this.availableMovesMatrix = availableMovesMatrix;\r\n    this.canUndo = canUndo;\r\n    this.canTakeMoveBack = !!this.previous;\r\n    this.resignedPlayer = resignedPlayer;\r\n    this.moveNotation = resignedPlayer\r\n      ? this.constructor.MOVE_RESIGNED_NOTATION[resignedPlayer]\r\n      : (lastMove\r\n        ? this.constructor.MOVE_NOTATION[lastMove.y][lastMove.x]\r\n        : '');\r\n    this.fullNotation = `${this.previous ? this.previous.fullNotation : ''}${this.moveNotation}`;\r\n    this.compressedFullNotation = this.fullNotation\r\n      .split(/(..)/)\r\n      .filter(part => part)\r\n      .map(part => this.constructor.MOVE_NOTATION_COMPRESSION[part])\r\n      .join('');\r\n    this.positionNotation = this.constructor.getPositionNotation(this.rowsAndColumns);\r\n\r\n    this.winner = this.getWinner();\r\n    if (this.winner) {\r\n      this.finished = true;\r\n    } else if (!this.constructor.hasAvailableMove(this.availableMovesMatrix)) {\r\n      this.finished = true;\r\n      this.winner = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    } else {\r\n      this.finished = false;\r\n    }\r\n\r\n    if (this.finished) {\r\n      this.availableMovesMatrix = this.constructor.noMovesAreAvailable();\r\n    }\r\n  }\r\n\r\n  static getAvailableMoves(availableMovesMatrix) {\r\n    return _.flatten(availableMovesMatrix\r\n      .map((row, y) => row\r\n        .map((available, x) => available ? {x, y} : null)))\r\n      .filter(move => move);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      moves: this.moves,\r\n    };\r\n  }\r\n\r\n  static deserialize({moves}) {\r\n    return this.fromMoves(moves);\r\n  }\r\n\r\n  static getInitialRowsAndColumns() {\r\n    return this.ROWS.map(y => ({\r\n      y, cells: this.COLUMNS.map(x => ({\r\n        x, y, level: 0, player: null, worker: null,\r\n      })),\r\n    }));\r\n  }\r\n\r\n  static getInitialStatus() {\r\n    return  {\r\n      nextPlayer: this.PLAYER_A,\r\n      moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n      availableMovesMatrix: this.allMovesAreAvailableMatrix(),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    };\r\n  }\r\n\r\n  getPrintout() {\r\n    /* eslint-disable no-useless-computed-key */\r\n    const printMap = {\r\n      [Game.PLAYER_A]: {[0]: 'a', [1]: chalk.bgWhite('b'), [2]: chalk.bgYellow('c'), [3]: chalk.bgRed('d')},\r\n      [Game.PLAYER_B]: {[0]: 'w', [1]: chalk.bgWhite('x'), [2]: chalk.bgYellow('y'), [3]: chalk.bgRed('z')},\r\n      [null]: {[0]: ' ', [1]: chalk.bgWhite(' '), [2]: chalk.bgYellow(' '), [3]: chalk.bgRed(' '), [4]: chalk.bgBlue(' ')},\r\n    };\r\n    /* eslint-enable no-useless-computed-key */\r\n    const cellsPrintout = this.rowsAndColumns\r\n      .map(row => row.cells\r\n        .map(cell => printMap[cell.player][cell.level])\r\n        .join(''))\r\n      .join('\\n');\r\n    const nextPlayerMap = {\r\n      [Game.PLAYER_A]: 'A', [Game.PLAYER_B]: 'B',\r\n    };\r\n    const nextPlayerPrintout = nextPlayerMap[this.nextPlayer];\r\n    const winnerMap = {\r\n      [Game.PLAYER_A]: 'A', [Game.PLAYER_B]: 'B', [null]: '+',\r\n    };\r\n    const winnerPrintout = winnerMap[this.winner];\r\n    return (\r\n      `${nextPlayerPrintout}-----${winnerPrintout}\\n`\r\n      + cellsPrintout.split('\\n').map(row => `|${chalk.black(row)}|`).join('\\n')\r\n      + '\\n+-----+'\r\n    );\r\n  }\r\n\r\n  checkCoordinatesAreValid({x, y}) {\r\n    if (Math.floor(x) !== x || Math.floor(y) !== y) {\r\n      throw new InvalidMoveError(`Coordinates '${JSON.stringify({x, y})}' are not valid`);\r\n    }\r\n    if (this.availableMovesMatrix[y] === undefined || this.availableMovesMatrix[y][x] === undefined) {\r\n      throw new InvalidMoveError(`Coordinates '${JSON.stringify({x, y})}' are out of bounds`);\r\n    }\r\n  }\r\n\r\n  static hasAvailableMove(availableMovesMatrix) {\r\n    return this.getAvailableMoves(availableMovesMatrix).length > 0;\r\n  }\r\n\r\n  isMoveAvailable({x, y}) {\r\n    return this.availableMovesMatrix[y][x];\r\n  }\r\n\r\n  static findCell(rowsAndColumns, condition) {\r\n    return rowsAndColumns.map(row => row.cells.find(condition)).find(cell => cell);\r\n  }\r\n\r\n  static findCells(rowsAndColumns, condition) {\r\n    return _.flatten(rowsAndColumns.map(row => row.cells.filter(condition)));\r\n  }\r\n\r\n  findCell(condition) {\r\n    return this.constructor.findCell(this.rowsAndColumns, condition);\r\n  }\r\n\r\n  findCells(condition) {\r\n    return this.constructor.findCells(this.rowsAndColumns, condition);\r\n  }\r\n\r\n  static canPlayerWin(rowsAndColumns, player) {\r\n    const playerCells = this.findCells(rowsAndColumns, cell => cell.player === player && cell.level === 2);\r\n    if (!playerCells.length) {\r\n      return false;\r\n    }\r\n    const playerWinningMoves = this.findCells(rowsAndColumns, cell => (\r\n      cell.level === 3\r\n      && playerCells.find(playerCell => (\r\n        Math.abs(cell.x - playerCell.x) <= 1\r\n        && Math.abs(cell.y - playerCell.y) <= 1\r\n      ))\r\n    ));\r\n\r\n    return playerWinningMoves.length > 0;\r\n  }\r\n\r\n  getWinner() {\r\n    if (this.resignedPlayer) {\r\n      return this.constructor.OTHER_PLAYER[this.resignedPlayer];\r\n    }\r\n\r\n    const winningCell = this.findCell(cell => cell.player && cell.level === 3);\r\n    if (winningCell) {\r\n      return winningCell.player;\r\n    }\r\n\r\n    if (!this.canUndo && this.constructor.canPlayerWin(this.rowsAndColumns, this.nextPlayer)) {\r\n      return this.nextPlayer;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  static allMovesAreAvailableMatrix() {\r\n    return this.ROWS.map(() => this.COLUMNS.map(() => true));\r\n  }\r\n\r\n  static noMovesAreAvailable() {\r\n    return this.ROWS.map(() => this.COLUMNS.map(() => false));\r\n  }\r\n\r\n  static getEmptyCellsAvailableMovesMatrix(rowsAndColumns) {\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => !cell.player);\r\n  }\r\n\r\n  static getPlayerAvailableMovesMatrix(rowsAndColumns, player) {\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => {\r\n      if (cell.player !== player) {\r\n        return false;\r\n      }\r\n\r\n      return this.hasAvailableMove(this.getMovableAvailableMovesMatrix(rowsAndColumns, cell));\r\n    });\r\n  }\r\n\r\n  static getMovableAvailableMovesMatrix(rowsAndColumns, coordinates) {\r\n    const fromCell = rowsAndColumns[coordinates.y].cells[coordinates.x];\r\n    const maximumLevel = fromCell.level + 1;\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => (\r\n      Math.abs(cell.x - coordinates.x) <= 1\r\n      && Math.abs(cell.y - coordinates.y) <= 1\r\n      && !cell.player\r\n      && cell.level <= 3\r\n      && cell.level <= maximumLevel\r\n      && (this.hasAvailableMove(this.getBuildableAvailableMovesMatrix(this.updateCells(rowsAndColumns, ...[\r\n        {x: fromCell.x, y: fromCell.y, player: null, worker: null},\r\n        {x: cell.x, y: cell.y, player: fromCell.player, worker: fromCell.worker}\r\n      ]), cell)))\r\n    ));\r\n  }\r\n\r\n  static getBuildableAvailableMovesMatrix(rowsAndColumns, coordinates) {\r\n    const fromCell = rowsAndColumns[coordinates.y].cells[coordinates.x];\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => (\r\n      Math.abs(cell.x - coordinates.x) <= 1\r\n      && Math.abs(cell.y - coordinates.y) <= 1\r\n      && !cell.player\r\n      && cell.level < 4\r\n      && (!this.canPlayerWin(this.updateCells(rowsAndColumns, ...[\r\n        {x: cell.x, y: cell.y, level: cell.level + 1},\r\n      ]), this.OTHER_PLAYER[fromCell.player]))\r\n    ));\r\n  }\r\n\r\n  static getAvailableMovesMatrix(rowsAndColumns, isMoveAvailable) {\r\n    return rowsAndColumns.map(row => row.cells.map(isMoveAvailable));\r\n  }\r\n\r\n  checkCanMakeMove(expectedMoveType, coordinates, targetCoordinates) {\r\n    if (this.finished) {\r\n      throw new InvalidMoveError(\"The game has already finished\");\r\n    }\r\n    if (this.moveType !== expectedMoveType) {\r\n      throw new InvalidMoveError(`You cannot perform move of type \"${expectedMoveType}\": you need to perform \"${this.moveType}\"`);\r\n    }\r\n    this.checkCoordinatesAreValid(coordinates);\r\n    if (targetCoordinates) {\r\n      this.checkCoordinatesAreValid(targetCoordinates);\r\n    }\r\n    if (!this.availableMovesMatrix[coordinates.y][coordinates.x]) {\r\n      throw new Error(`Move ${JSON.stringify(coordinates)} is not one of the available ones`);\r\n    }\r\n  }\r\n\r\n  resign(player) {\r\n    return this.createStep(this.rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.moveType,\r\n      availableMovesMatrix: this.availableMovesMatrix,\r\n      canUndo: false,\r\n      resignedPlayer: player,\r\n    }, {resign: player});\r\n  }\r\n\r\n  static updateCells(rowsAndColumns, ...newCells) {\r\n    const updates = {};\r\n    for (const update of newCells) {\r\n      updates[update.y] = updates[update.y] || {};\r\n      updates[update.y][update.x] = update;\r\n    }\r\n    return rowsAndColumns.map(row => !updates[row.y] ? row : ({\r\n      ...row,\r\n      cells: row.cells.map(cell => !updates[cell.y][cell.x] ? cell : ({\r\n        ...cell,\r\n        ...updates[cell.y][cell.x],\r\n      })),\r\n    }));\r\n  }\r\n\r\n  makeMoves(moves) {\r\n    let game = this;\r\n    for (const move of moves) {\r\n      game = game.makeMove(move);\r\n    }\r\n\r\n    return game;\r\n  }\r\n\r\n  makeMove(coordinates) {\r\n    if (coordinates.resign) {\r\n      return this.resign(coordinates.resign);\r\n    }\r\n    const makeMoveMethods = {\r\n      [this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER]: this.placeFirstWorker,\r\n      [this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER]: this.placeSecondWorker,\r\n      [this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: this.selectWorkerToMove,\r\n      [this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER]: this.moveFirstWorker,\r\n      [this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER]: this.moveSecondWorker,\r\n      [this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER]: this.buildAroundWorker,\r\n    };\r\n    const makeMoveMethod = makeMoveMethods[this.moveType];\r\n    if (!makeMoveMethod) {\r\n      throw new InvalidMoveError(`Don't know how to perform move of type \"${this.moveType}\"`);\r\n    }\r\n    return makeMoveMethod.bind(this)(coordinates);\r\n  }\r\n\r\n  undo() {\r\n    if (!this.canUndo) {\r\n      throw new Error(\"Cannot undo\");\r\n    }\r\n\r\n    return this.previous;\r\n  }\r\n\r\n  takeMoveBack() {\r\n    if (!this.canTakeMoveBack) {\r\n      throw new Error(\"Cannot take move back\");\r\n    }\r\n\r\n    return this.previous;\r\n  }\r\n\r\n  placeFirstWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER, {x, y});\r\n\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, {\r\n      x, y,\r\n      player: this.nextPlayer,\r\n      worker: this.constructor.WORKER_FIRST,\r\n    });\r\n    return this.createStep(rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n      availableMovesMatrix: this.constructor.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  placeSecondWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER, {x, y});\r\n\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, {\r\n      x, y,\r\n      player: this.nextPlayer,\r\n      worker: this.constructor.WORKER_SECOND,\r\n    });\r\n    const nextPlayer = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    return this.createNext(rowsAndColumns, {\r\n      nextPlayer: nextPlayer,\r\n      moveType: nextPlayer === this.constructor.PLAYER_A\r\n        ? this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE\r\n        : this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n      availableMovesMatrix: nextPlayer === this.constructor.PLAYER_A\r\n        ? this.constructor.getPlayerAvailableMovesMatrix(rowsAndColumns, nextPlayer)\r\n        : this.constructor.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  selectWorkerToMove({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE, {x, y});\r\n\r\n    const cell = this.rowsAndColumns[y].cells[x];\r\n    return this.createStep(this.rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: cell.worker === this.constructor.WORKER_FIRST\r\n        ? this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER\r\n        : this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER,\r\n      availableMovesMatrix: this.constructor.getMovableAvailableMovesMatrix(this.rowsAndColumns, {x, y}),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  moveWorker(to, worker) {\r\n    const fromCell = this.findCell(cell => cell.player === this.nextPlayer && cell.worker === worker);\r\n    const toCell = this.rowsAndColumns[to.y].cells[to.x];\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, ...[\r\n      {x: fromCell.x, y: fromCell.y, player: null, worker: null},\r\n      {x: toCell.x, y: toCell.y, player: fromCell.player, worker: fromCell.worker},\r\n    ]);\r\n    return this.createStep(rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER,\r\n      availableMovesMatrix: this.constructor.getBuildableAvailableMovesMatrix(rowsAndColumns, to),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x: to.x, y: to.y});\r\n  }\r\n\r\n  moveFirstWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER, {x, y});\r\n\r\n    return this.moveWorker({x, y}, this.constructor.WORKER_FIRST)\r\n  }\r\n\r\n  moveSecondWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER, {x, y});\r\n\r\n    return this.moveWorker({x, y}, this.constructor.WORKER_SECOND)\r\n  }\r\n\r\n  buildAroundWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER, {x, y});\r\n\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, {\r\n      x, y, level: this.rowsAndColumns[y].cells[x].level + 1,\r\n    });\r\n    const nextPlayer = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    return this.createNext(rowsAndColumns, {\r\n      nextPlayer: nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n      availableMovesMatrix: this.constructor.getPlayerAvailableMovesMatrix(rowsAndColumns, nextPlayer),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n}\r\n\r\nexport {\r\n  InvalidMoveError,\r\n};\r\n\r\nexport default Game;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport \"../../styles/html-board.css\";\r\n\r\nclass HtmlBoardBackground extends Component {\r\n  render() {\r\n    let {\r\n      className, clickable, undoable, isCellAvailable, isCellUndoable, small, medium, makeMove, onSelect, selected,\r\n      settings, rowsAndColumns,\r\n    } = this.props;\r\n    const {theme: {scheme, numbers}} = settings;\r\n\r\n    className = classNames(\"board\", \"html-board\", {\r\n      'small-board': small,\r\n      'medium-board': medium,\r\n      editable: !!makeMove && (clickable || undoable),\r\n      selectable: !!onSelect,\r\n      selected,\r\n      'board-theme-default': scheme === '',\r\n      'board-theme-subtle': scheme === 'subtle',\r\n      'board-theme-pastel': scheme === 'pastel',\r\n      'board-theme-green': scheme === 'green',\r\n      'numbered-levels': ['obvious', 'subtle', 'very-subtle'].includes(numbers),\r\n      'obvious-levels': numbers === 'obvious',\r\n      'subtle-levels': numbers === 'subtle',\r\n      'very-subtle-levels': numbers === 'very-subtle',\r\n    }, className);\r\n\r\n    return (\r\n      <div className={className} onClick={onSelect}>\r\n        {rowsAndColumns.map(row => (\r\n          <div key={`row-${row.y}`} className={\"row\"}>\r\n            {row.cells.map(cell => (\r\n              <HtmlBoardCell\r\n                key={`${cell.x}-${cell.y}`}\r\n                cell={cell}\r\n                clickable={clickable || (undoable && isCellUndoable(cell))}\r\n                available={isCellAvailable(cell)}\r\n                undoable={isCellUndoable(cell)}\r\n                settings={settings}\r\n                makeMove={this.props.makeMove}\r\n                undo={this.props.undo}\r\n              />\r\n            ))}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nHtmlBoardBackground.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n};\r\n\r\nHtmlBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  animated: false,\r\n};\r\n\r\nclass HtmlBoardCell extends Component {\r\n  makeMove = () => {\r\n    if (this.props.available && this.props.makeMove) {\r\n      this.props.makeMove(this.props.cell);\r\n    } else if (this.props.undoable && this.props.undo) {\r\n      this.props.undo();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {cell, clickable, available, undoable, settings: {theme: {numbers}}, makeMove, undo} = this.props;\r\n    const displayLevel = (\r\n      ['obvious', 'subtle', 'very-subtle'].includes(numbers)\r\n      && cell.level > 0\r\n      && cell.level <4\r\n    ) ? cell.level : null;\r\n    return (\r\n      <div\r\n        key={`row-${cell.x}-${cell.y}`}\r\n        className={classNames(\"cell\", `level-${cell.level}`, {available, undoable})}\r\n        onClick={((makeMove && available) || (undo && undoable)) && clickable ? this.makeMove : null}\r\n      >\r\n        <div className={classNames(\"level\", \"level-1\")}>\r\n          <div className={classNames(\"level\", \"level-2\")}>\r\n            <div className={classNames(\"level\", \"level-3\")}>\r\n              {cell.player ? (\r\n                <div className={classNames(\"worker\", `player-${cell.player}`)}>\r\n                  {displayLevel}\r\n                </div>\r\n              ) : cell.level === 4 ? (\r\n                <div className={classNames(\"level\", \"level-4\")} />\r\n              ) : displayLevel}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nHtmlBoardCell.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n};\r\n\r\nHtmlBoardCell.defaultProps = {\r\n  clickable: false,\r\n  available: false,\r\n  undoable: false,\r\n};\r\n\r\nexport default HtmlBoardBackground;\r\n","import React, {PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as constants from './constants';\r\n\r\nclass LevelIndicatorVerySubtle extends PureComponent {\r\n\trender() {\r\n    const {level} = this.props;\r\n    if (!level) {\r\n      return null;\r\n    }\r\n  \treturn (\r\n    \t<g transform={`translate(${constants.cellSize / 10},${constants.cellSize / 10})`}>\r\n        <text\r\n          dominantBaseline={\"central\"}\r\n          textAnchor={\"middle\"}\r\n          style={{fontSize: `${constants.cellSize * 0.15}px`}}\r\n        >{level}</text>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicatorVerySubtle.propTypes = {\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\nclass LevelIndicatorSubtle extends PureComponent {\r\n\trender() {\r\n  \tconst {level} = this.props;\r\n    if (!level) {\r\n      return null;\r\n    }\r\n  \treturn (\r\n    \t<g transform={`translate(22,22)`}>\r\n        <circle r={constants.cellSize * 0.15} fill={'#bbb'} stroke={'#111'} strokeWidth={2} />\r\n        <text\r\n          dominantBaseline={\"central\"}\r\n          textAnchor={\"middle\"}\r\n          style={{fontSize: `${constants.cellSize * 0.25}px`}}\r\n        >{level}</text>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicatorSubtle.propTypes = {\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\nclass LevelIndicatorObvious extends PureComponent {\r\n\trender() {\r\n  \tconst {level} = this.props;\r\n    if (!level) {\r\n      return null;\r\n    }\r\n  \treturn (\r\n    \t<g transform={`translate(${constants.cellSize / 2},${constants.cellSize / 2})`}>\r\n        <text\r\n          dominantBaseline={\"central\"}\r\n          textAnchor={\"middle\"}\r\n          stroke={'#eee'}\r\n          strokeWidth={constants.cellSize * 0.06}\r\n          paintOrder={'stroke'}\r\n          style={{fontSize: `${constants.cellSize * 0.45}px`}}\r\n        >{level}</text>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicatorObvious.propTypes = {\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\nclass LevelIndicator extends PureComponent {\r\n\tstatic indicatorMap = {\r\n    'very-subtle': LevelIndicatorVerySubtle,\r\n    'subtle': LevelIndicatorSubtle,\r\n    'obvious': LevelIndicatorObvious,\r\n  };\r\n\r\n\trender() {\r\n  \tconst {level, type} = this.props;\r\n    const Indicator = this.constructor.indicatorMap[type];\r\n    if (!Indicator) {\r\n    \treturn null;\r\n    }\r\n  \treturn (\r\n    \t<Indicator level={level} />\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicator.propTypes = {\r\n  type: PropTypes.oneOf(['very-subtle', 'subtle', 'obvious']).isRequired,\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\n\r\nexport default LevelIndicator;\r\n","import React, {PureComponent, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as constants from \"./constants\";\r\n\r\nclass BasePieceDefinition extends PureComponent {\r\n\trender() {\r\n  \tconst {name, path, dimensions, offset} = this.props;\r\n  \treturn (\r\n    \t<Fragment>\r\n        <g id={`piece-${name}-base`} transform={[\r\n      \t\t`translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n        \t`scale(${(constants.pieceScaling)},${(constants.pieceScaling)})`,\r\n        \t`translate(${-dimensions.x / 2 + offset.x},${-dimensions.y / 2 + offset.y})`,\r\n      \t].join(',')}>{path}</g>\r\n        <g id={`piece-${name}-white`}>\r\n          <use xlinkHref={`#piece-${name}-base`} strokeWidth={constants.pieceStrokeWidth} stroke={\"#111\"} />\r\n          <use xlinkHref={`#piece-${name}-base`} fill={'white'} />\r\n        </g>\r\n        <g id={`piece-${name}-black`}>\r\n          <use xlinkHref={`#piece-${name}-base`} strokeWidth={constants.pieceStrokeWidth} stroke={\"#bbb\"} />\r\n          <use xlinkHref={`#piece-${name}-base`} fill={'black'} />\r\n        </g>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nBasePieceDefinition.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  path: PropTypes.node.isRequired,\r\n  dimensions: PropTypes.object.isRequired,\r\n  offset: PropTypes.object.isRequired,\r\n};\r\n\r\nclass BasePiece extends PureComponent {\r\n\tstatic rotateTransform =\r\n  \t`rotate(180,${constants.cellSize / 2},${constants.cellSize / 2})`;\r\n\r\n\trender() {\r\n  \tconst {name, colour, rotated} = this.props;\r\n  \treturn (\r\n    \t<use\r\n        xlinkHref={`#piece-${name}-${colour}`}\r\n        transform={rotated ? this.constructor.rotateTransform : undefined}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nBasePiece.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  colour: PropTypes.oneOf(['white', 'black']),\r\n  rotated: PropTypes.bool.isRequired,\r\n};\r\n\r\nconst definePiece = (className, {path, dimensions, offset = {x: 0, y: 0}}) => {\r\n  class PieceDefinitionFor extends PureComponent {\r\n    render() {\r\n      return (\r\n        <BasePieceDefinition\r\n          name={className}\r\n          path={path}\r\n          dimensions={dimensions}\r\n          offset={offset}\r\n          />\r\n      );\r\n    }\r\n  }\r\n  PieceDefinitionFor.displayName = `${className}Definition`;\r\n\r\n  class PieceFor extends PureComponent {\r\n    static Definition = PieceDefinitionFor;\r\n\r\n    render() {\r\n      const {colour, rotated} = this.props;\r\n      return (\r\n        <BasePiece\r\n          name={className}\r\n          colour={colour}\r\n          rotated={rotated}\r\n        />\r\n      );\r\n    }\r\n  }\r\n  PieceFor.displayName = className;\r\n\r\n  return PieceFor;\r\n};\r\n\r\nconst PiecePawn = definePiece('PiecePawn', {\r\n  path: <path d=\"M105.1 224H80a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h16v5.49c0 44-4.14 86.6-24 122.51h176c-19.89-35.91-24-78.51-24-122.51V288h16a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-25.1c29.39-18.38 49.1-50.78 49.1-88a104 104 0 0 0-208 0c0 37.22 19.71 69.62 49.1 88zM304 448H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z\" />,\r\n  dimensions: {x: 320, y: 480},\r\n  offset: {x: 0, y: -38},\r\n});\r\n\r\nconst PieceKing = definePiece('PieceKing', {\r\n  path: <path d=\"M400 448H48a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h352a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm16-288H256v-48h40a8 8 0 0 0 8-8V56a8 8 0 0 0-8-8h-40V8a8 8 0 0 0-8-8h-48a8 8 0 0 0-8 8v40h-40a8 8 0 0 0-8 8v48a8 8 0 0 0 8 8h40v48H32a32 32 0 0 0-30.52 41.54L74.56 416h298.88l73.08-214.46A32 32 0 0 0 416 160z\" />,\r\n  dimensions: {x: 448, y: 512},\r\n});\r\n\r\nconst PieceCircle = definePiece('PieceCircle', {\r\n  path: <path d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceCertificate = definePiece('PieceCertificate', {\r\n  path: <path d=\"M458.622 255.92l45.985-45.005c13.708-12.977 7.316-36.039-10.664-40.339l-62.65-15.99 17.661-62.015c4.991-17.838-11.829-34.663-29.661-29.671l-61.994 17.667-15.984-62.671C337.085.197 313.765-6.276 300.99 7.228L256 53.57 211.011 7.229c-12.63-13.351-36.047-7.234-40.325 10.668l-15.984 62.671-61.995-17.667C74.87 57.907 58.056 74.738 63.046 92.572l17.661 62.015-62.65 15.99C.069 174.878-6.31 197.944 7.392 210.915l45.985 45.005-45.985 45.004c-13.708 12.977-7.316 36.039 10.664 40.339l62.65 15.99-17.661 62.015c-4.991 17.838 11.829 34.663 29.661 29.671l61.994-17.667 15.984 62.671c4.439 18.575 27.696 24.018 40.325 10.668L256 458.61l44.989 46.001c12.5 13.488 35.987 7.486 40.325-10.668l15.984-62.671 61.994 17.667c17.836 4.994 34.651-11.837 29.661-29.671l-17.661-62.015 62.65-15.99c17.987-4.302 24.366-27.367 10.664-40.339l-45.984-45.004z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceSun = definePiece('PieceSun', {\r\n  path: <path d=\"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceRocket = definePiece('PieceRocket', {\r\n  path: <path d=\"M505.05 19.1a15.89 15.89 0 0 0-12.2-12.2C460.65 0 435.46 0 410.36 0c-103.2 0-165.1 55.2-211.29 128H94.87A48 48 0 0 0 52 154.49l-49.42 98.8A24 24 0 0 0 24.07 288h103.77l-22.47 22.47a32 32 0 0 0 0 45.25l50.9 50.91a32 32 0 0 0 45.26 0L224 384.16V488a24 24 0 0 0 34.7 21.49l98.7-49.39a47.91 47.91 0 0 0 26.5-42.9V312.79c72.59-46.3 128-108.4 128-211.09.1-25.2.1-50.4-6.85-82.6zM384 168a40 40 0 1 1 40-40 40 40 0 0 1-40 40z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceBug = definePiece('PieceBug', {\r\n  path: <path d=\"M511.988 288.9c-.478 17.43-15.217 31.1-32.653 31.1H424v16c0 21.864-4.882 42.584-13.6 61.145l60.228 60.228c12.496 12.497 12.496 32.758 0 45.255-12.498 12.497-32.759 12.496-45.256 0l-54.736-54.736C345.886 467.965 314.351 480 280 480V236c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v244c-34.351 0-65.886-12.035-90.636-32.108l-54.736 54.736c-12.498 12.497-32.759 12.496-45.256 0-12.496-12.497-12.496-32.758 0-45.255l60.228-60.228C92.882 378.584 88 357.864 88 336v-16H32.666C15.23 320 .491 306.33.013 288.9-.484 270.816 14.028 256 32 256h56v-58.745l-46.628-46.628c-12.496-12.497-12.496-32.758 0-45.255 12.498-12.497 32.758-12.497 45.256 0L141.255 160h229.489l54.627-54.627c12.498-12.497 32.758-12.497 45.256 0 12.496 12.497 12.496 32.758 0 45.255L424 197.255V256h56c17.972 0 32.484 14.816 31.988 32.9zM257 0c-61.856 0-112 50.144-112 112h224C369 50.144 318.856 0 257 0z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceEye = definePiece('PieceEye', {\r\n  path: <path d=\"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceUser = definePiece('PieceUser', {\r\n  path: <path d=\"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nclass Piece extends PureComponent {\r\n\tstatic pieceStyleMap = {\r\n    'pawn': PiecePawn,\r\n    'king': PieceKing,\r\n    'circle': PieceCircle,\r\n    'certificate': PieceCertificate,\r\n    'sun': PieceSun,\r\n    'rocket': PieceRocket,\r\n    'bug': PieceBug,\r\n    'eye': PieceEye,\r\n    'user': PieceUser,\r\n  };\r\n\r\n\trender() {\r\n  \tconst {style, colour, rotated} = this.props;\r\n    const PieceStyle = this.constructor.pieceStyleMap[style];\r\n  \treturn (\r\n    \t<PieceStyle colour={colour} rotated={rotated} />\r\n    );\r\n  }\r\n}\r\n\r\nPiece.propTypes = {\r\n  style: PropTypes.oneOf(Object.keys(Piece.pieceStyleMap)).isRequired,\r\n  colour: PropTypes.oneOf(['white', 'black']).isRequired,\r\n  rotated: PropTypes.bool.isRequired,\r\n};\r\n\r\nclass PieceDefinitions extends PureComponent {\r\n\trender() {\r\n  \treturn Object.values(Piece.pieceStyleMap)\r\n    \t.map(PieceStyle => <PieceStyle.Definition key={PieceStyle.displayName || PieceStyle.name} />);\r\n  }\r\n}\r\nPiece.Definitions = PieceDefinitions;\r\n\r\nexport default Piece;\r\n","export const cellSize = 100;\r\nexport const pieceStrokeWidth = 0.8 * cellSize;\r\nexport const borderWidth = 5;\r\nexport const pieceScaling = 0.1;\r\n","import React, {Fragment, PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport * as constants from './constants';\r\nimport LevelIndicator from \"./LevelIndicator\";\r\nimport Piece from \"./Piece\";\r\nimport Game from \"../../../game/game\";\r\n\r\nclass CellDefinitions extends PureComponent {\r\n\trender() {\r\n  \treturn (\r\n    \t<Fragment>\r\n        <rect\r\n          id={`cell-border`}\r\n          width={constants.cellSize}\r\n          height={constants.cellSize}\r\n        />\r\n        <rect\r\n          id={`cell-0`}\r\n          width={constants.cellSize - constants.borderWidth * 2}\r\n          height={constants.cellSize - constants.borderWidth * 2}\r\n          transform={`translate(${(constants.borderWidth)},${(constants.borderWidth)})`}\r\n        />\r\n        <g id={`cell-1`}>\r\n          <rect\r\n            className={'border'}\r\n            width={constants.cellSize - constants.borderWidth * 2}\r\n            height={constants.cellSize - constants.borderWidth * 2}\r\n            transform={`translate(${(constants.borderWidth)},${(constants.borderWidth)})`}\r\n          />\r\n          <rect\r\n            className={'fill'}\r\n            width={constants.cellSize - constants.borderWidth * 4}\r\n            height={constants.cellSize - constants.borderWidth * 4}\r\n            transform={`translate(${constants.borderWidth * 2},${constants.borderWidth * 2})`}\r\n          />\r\n        </g>\r\n        <g id={`cell-2`}>\r\n          <rect\r\n            className={'border'}\r\n            width={constants.cellSize - constants.borderWidth * 4}\r\n            height={constants.cellSize - constants.borderWidth * 4}\r\n            transform={`translate(${constants.borderWidth * 2},${constants.borderWidth * 2})`}\r\n          />\r\n          <rect\r\n            className={'fill'}\r\n            width={constants.cellSize - constants.borderWidth * 6}\r\n            height={constants.cellSize - constants.borderWidth * 6}\r\n            transform={`translate(${constants.borderWidth * 3},${constants.borderWidth * 3})`}\r\n          />\r\n        </g>\r\n        <g id={`cell-3`}>\r\n          <rect\r\n            className={'border'}\r\n            width={constants.cellSize - constants.borderWidth * 6}\r\n            height={constants.cellSize - constants.borderWidth * 6}\r\n            transform={`translate(${constants.borderWidth * 3},${constants.borderWidth * 3})`}\r\n          />\r\n          <rect\r\n            className={'fill'}\r\n            width={constants.cellSize - constants.borderWidth * 8}\r\n            height={constants.cellSize - constants.borderWidth * 8}\r\n            transform={`translate(${constants.borderWidth * 4},${constants.borderWidth * 4})`}\r\n          />\r\n        </g>\r\n        <g id={`cell-4`}>\r\n          <rect\r\n            className={'border'}\r\n            width={constants.cellSize - constants.borderWidth * 8}\r\n            height={constants.cellSize - constants.borderWidth * 8}\r\n            transform={`translate(${constants.borderWidth * 4},${constants.borderWidth * 4})`}\r\n          />\r\n          <rect\r\n            className={'fill'}\r\n            width={constants.cellSize - constants.borderWidth * 10}\r\n            height={constants.cellSize - constants.borderWidth * 10}\r\n            transform={`translate(${constants.borderWidth * 5},${constants.borderWidth * 5})`}\r\n          />\r\n        </g>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nclass Cell extends PureComponent {\r\n  static Definitions = CellDefinitions;\r\n\r\n\tstatic levelMap = {\r\n    0: '#cell-0',\r\n    1: '#cell-1',\r\n    2: '#cell-2',\r\n    3: '#cell-3',\r\n    4: '#cell-4',\r\n  };\r\n\r\n\tstate = {\r\n\t  previousLevel: this.props.level,\r\n\t  currentLevel: this.props.level,\r\n  };\r\n\r\n\tlevelsAnimate = [0, 1, 2, 3, 4].map(i => React.createRef());\r\n\r\n\tstatic getDerivedStateFromProps(props, state) {\r\n    if (props.animated && props.level !== state.level) {\r\n      return {previousLevel: state.currentLevel, currentLevel: props.level};\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (this.props.animated && this.state.currentLevel !== this.state.previousLevel) {\r\n      setTimeout(() => {\r\n        this.levelsAnimate\r\n          .filter((levelAnimate, i) => (\r\n            (this.state.previousLevel <= i && i <= this.state.currentLevel)\r\n            || (this.state.currentLevel <= i && i <= this.state.previousLevel)\r\n          ))\r\n          .filter(levelAnimate => levelAnimate.current)\r\n          .map(levelAnimate => levelAnimate.current.beginElement());\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n\trender() {\r\n  \tconst {\r\n  \t  x, y, available, undoable, level, player, onClick, animated, allowControl,\r\n      theme: {pieces = 'king', rotateOpponent = true, numbers},\r\n    } = this.props;\r\n  \tconst {previousLevel, currentLevel} = this.state;\r\n  \tconst isPlayerAOpponent = !allowControl.includes(Game.PLAYER_A) && allowControl.includes(Game.PLAYER_B);\r\n  \tconst isPlayerBOpponent = !isPlayerAOpponent;\r\n  \treturn (\r\n    \t<g transform={`translate(${x * 100},${y * 100})`}>\r\n        <use\r\n          xlinkHref={`#cell-border`}\r\n          className={classNames({available, undoable})}\r\n          onClick={onClick}\r\n        />\r\n        <g className={'cell-contents'}>\r\n          {animated ? ([0, 1, 2, 3, 4].map(i => (\r\n            <use key={i} xlinkHref={`${this.constructor.levelMap[i]}`} opacity={i <= level ? 1 : 0}>\r\n              <animate\r\n                ref={this.levelsAnimate[i]}\r\n                attributeName={'opacity'}\r\n                attributeType={'XML'}\r\n                type={'translate'}\r\n                from={previousLevel < i ? 0 : 1}\r\n                to={currentLevel < i ? 0 : 1}\r\n                dur={'0.2s'}\r\n                repeatCount={1}\r\n                fill={'freeze'}\r\n              />\r\n            </use>\r\n          ))) : ([0, 1, 2, 3, 4].filter(i => i <= level).map(i => (\r\n            <Fragment key={i}>\r\n              <use xlinkHref={`${this.constructor.levelMap[i]}`} />\r\n              {player === Game.PLAYER_A ? <Piece style={pieces} colour={'white'} rotated={rotateOpponent && isPlayerAOpponent} /> : null}\r\n              {player === Game.PLAYER_B ? <Piece style={pieces} colour={'black'} rotated={rotateOpponent && isPlayerBOpponent} /> : null}\r\n            </Fragment>\r\n          )))}\r\n          {numbers ? <LevelIndicator level={level} type={numbers} /> : null}\r\n        </g>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nCell.propTypes = {\r\n  x: PropTypes.number.isRequired,\r\n  y: PropTypes.number.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  level: PropTypes.number.isRequired,\r\n  player: PropTypes.string,\r\n  onClick: PropTypes.func,\r\n  animated: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  theme: PropTypes.object.isRequired,\r\n};\r\n\r\nCell.defaultProps = {\r\n  animated: false,\r\n};\r\n\r\nexport default Cell;\r\n","import React, {Fragment, PureComponent} from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport * as constants from \"./constants\";\r\n\r\nclass ArrowDefinition extends PureComponent {\r\n  static arrowDimensions = {x: 215.81, y: 439.04};\r\n  static arrowOffset = {x: -20, y: -15};\r\n  static arrowScaling = 0.75;\r\n  static hammerDimensions = {x: 564.48, y: 501.76};\r\n  static hammerOffset = {x: 50, y: -50};\r\n  static hammerScaling = 0.75 * 0.75;\r\n\r\n  render() {\r\n    const {arrowDimensions, arrowOffset, arrowScaling, hammerDimensions, hammerOffset, hammerScaling} = this.constructor;\r\n\r\n    return (\r\n      <Fragment>\r\n        <path\r\n          id={\"arrow-move-base\"}\r\n          d={\"M168 345.941V44c0-6.627-5.373-12-12-12h-56c-6.627 0-12 5.373-12 12v301.941H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.569 9.373 33.941 0l86.059-86.059c15.119-15.119 4.411-40.971-16.971-40.971H168z\"}\r\n          transform={[\r\n            `translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n            `scale(${(constants.pieceScaling * arrowScaling)},${(constants.pieceScaling * arrowScaling)})`,\r\n            `translate(${-arrowDimensions.x / 2 + arrowOffset.x},${-arrowDimensions.y / 2 + arrowOffset.y})`,\r\n          ].join(',')}\r\n        />\r\n        <path\r\n          id={\"arrow-build-base\"}\r\n          d={\"M571.31 193.94l-22.63-22.63c-6.25-6.25-16.38-6.25-22.63 0l-11.31 11.31-28.9-28.9c5.63-21.31.36-44.9-16.35-61.61l-45.25-45.25c-62.48-62.48-163.79-62.48-226.28 0l90.51 45.25v18.75c0 16.97 6.74 33.25 18.75 45.25l49.14 49.14c16.71 16.71 40.3 21.98 61.61 16.35l28.9 28.9-11.31 11.31c-6.25 6.25-6.25 16.38 0 22.63l22.63 22.63c6.25 6.25 16.38 6.25 22.63 0l90.51-90.51c6.23-6.24 6.23-16.37-.02-22.62zm-286.72-15.2c-3.7-3.7-6.84-7.79-9.85-11.95L19.64 404.96c-25.57 23.88-26.26 64.19-1.53 88.93s65.05 24.05 88.93-1.53l238.13-255.07c-3.96-2.91-7.9-5.87-11.44-9.41l-49.14-49.14z\"}\r\n          transform={[\r\n            `translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n            `scale(${(constants.pieceScaling * hammerScaling)},${(constants.pieceScaling * hammerScaling)})`,\r\n            `rotate(135)`,\r\n            `translate(${-hammerDimensions.x / 2 + hammerOffset.x},${-hammerDimensions.y / 2 + hammerOffset.y})`,\r\n          ].join(',')}\r\n        />\r\n        <g id={\"arrow-move-white\"}>\r\n          <use xlinkHref={\"#arrow-move-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#111\"} />\r\n          <use xlinkHref={\"#arrow-move-base\"} fill={'white'} />\r\n        </g>\r\n        <g id={\"arrow-move-black\"}>\r\n          <use xlinkHref={\"#arrow-move-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#bbb\"} />\r\n          <use xlinkHref={\"#arrow-move-base\"} fill={'black'} />\r\n        </g>\r\n        <g id={\"arrow-build-white\"}>\r\n          <use xlinkHref={\"#arrow-build-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#111\"} />\r\n          <use xlinkHref={\"#arrow-build-base\"} fill={'white'} />\r\n        </g>\r\n        <g id={\"arrow-build-black\"}>\r\n          <use xlinkHref={\"#arrow-build-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#bbb\"} />\r\n          <use xlinkHref={\"#arrow-build-base\"} fill={'black'} />\r\n        </g>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nclass Arrow extends PureComponent {\r\n  static Definition = ArrowDefinition;\r\n  static offsetX = constants.cellSize * 0.10;\r\n  static smallScaling = 0.75;\r\n\r\n  static rotationMap = {\r\n    '0,1': 0,\r\n    '-1,1': 45,\r\n    '-1,0': 90,\r\n    '-1,-1': 135,\r\n    '0,-1': 180,\r\n    '1,-1': -135,\r\n    '1,0': -90,\r\n    '1,1': -45,\r\n  };\r\n\r\n  render() {\r\n    const {offsetX, smallScaling} = this.constructor;\r\n    const {from, to, colour, type, small} = this.props;\r\n    const diff = {x: to.x - from.x, y: to.y - from.y};\r\n    const rotation = this.constructor.rotationMap[`${diff.x},${diff.y}`];\r\n    const offsetYFactor = Math.sqrt(Math.abs(diff.x) + Math.abs(diff.y));\r\n\r\n    return (\r\n      <use\r\n        xlinkHref={`#arrow-${type}-${colour}`}\r\n        transform={[\r\n          `translate(${constants.cellSize * from.x},${constants.cellSize * from.y})`,\r\n          `rotate(${rotation},${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n          `translate(${offsetX},${constants.cellSize / 2 * offsetYFactor})`,\r\n          ...(small ? [\r\n            `translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n            `scale(${smallScaling})`,\r\n            `translate(${-constants.cellSize / 2},${-constants.cellSize / 2})`,\r\n          ] : []),\r\n        ].filter(transform => transform).join(',')}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nArrow.propTypes = {\r\n  from: PropTypes.object.isRequired,\r\n  to: PropTypes.object.isRequired,\r\n  colour: PropTypes.oneOf(['white', 'black']).isRequired,\r\n  type: PropTypes.oneOf(['move', 'build']).isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n};\r\n\r\nArrow.defaultProps = {\r\n  small: false,\r\n};\r\n\r\nexport default Arrow;\r\n","import React, {Fragment, PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport _ from \"lodash\";\r\nimport Game from \"../../../game/game\";\r\nimport * as constants from './constants';\r\nimport Cell from \"./Cell\";\r\nimport Piece from \"./Piece\";\r\nimport '../../../styles/svg-board.css';\r\nimport Arrow from \"./Arrow\";\r\n\r\nclass SvgBoardBackground extends PureComponent {\r\n  render() {\r\n    let {\r\n      className, clickable, undoable, isCellAvailable, isCellUndoable, small, medium, makeMove, onSelect, selected,\r\n      allowControl, settings, rowsAndColumns, transformation, animated, showArrows, game, arrows,\r\n    } = this.props;\r\n    const {theme} = settings;\r\n\r\n    className = classNames(\"board\", \"svg-board\", `board-theme-${theme.scheme || 'default'}`, {\r\n      'small-board': small,\r\n      'medium-board': medium,\r\n      editable: !!makeMove && (clickable || undoable),\r\n      selectable: !!onSelect,\r\n      selected,\r\n    }, className);\r\n    const rowCount = rowsAndColumns.length;\r\n    const columnCount= Math.max(...rowsAndColumns.map(row => row.cells.length)) || 0;\r\n\r\n    return (\r\n      <svg\r\n        className={className}\r\n        viewBox={`0 0 ${constants.cellSize * columnCount} ${constants.cellSize * rowCount}`}\r\n        style={{'--column-count': columnCount, '--row-count': rowCount}}\r\n        preserveAspectRatio={\"xMinYMin meet\"}\r\n        onClick={onSelect}\r\n      >\r\n        <g data-key={'rows'}>\r\n          {rowsAndColumns.map(row => (\r\n            <g data-key={`row-${row.y}`} key={`row-${row.y}`}>\r\n              {row.cells.map(cell => (\r\n                <SvgBoardCell\r\n                  key={`${cell.x}-${cell.y}`}\r\n                  cell={cell}\r\n                  clickable={clickable || (undoable && isCellUndoable(cell))}\r\n                  available={isCellAvailable(cell)}\r\n                  undoable={isCellUndoable(cell)}\r\n                  allowControl={allowControl}\r\n                  settings={settings}\r\n                  makeMove={this.props.makeMove}\r\n                  undo={this.props.undo}\r\n                  theme={theme}\r\n                  animated={animated}\r\n                />\r\n              ))}\r\n            </g>\r\n          ))}\r\n        </g>\r\n        {animated ? (\r\n          <SvgBoardPieces rowsAndColumns={rowsAndColumns} theme={theme} allowControl={allowControl} />\r\n        ) : null}\r\n        {showArrows ? (\r\n          arrows ? (\r\n            arrows.map((arrow, index) => (\r\n              <Arrow key={index} {...arrow} />\r\n            ))\r\n          ) : (\r\n            <Fragment>\r\n              <SvgBoardHistoryArrows game={game} transformation={transformation} />\r\n              {/*<SvgBoardAvailableMovesArrows game={game} isCellAvailable={isCellAvailable} transformation={transformation} />*/}\r\n            </Fragment>\r\n          )\r\n        ) : null}\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardBackground.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  transformation: PropTypes.func,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n  showArrows: PropTypes.bool.isRequired,\r\n  game: PropTypes.instanceOf(Game),\r\n  arrows: PropTypes.array,\r\n};\r\n\r\nSvgBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  animated: false,\r\n  showArrows: false,\r\n};\r\n\r\nclass SvgBoardBackgroundDefinitions extends PureComponent {\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <svg className={classNames('board', 'svg-board')} style={{display: 'none'}}>\r\n          <defs>\r\n            <Cell.Definitions />\r\n            <Piece.Definitions />\r\n            <Arrow.Definition />\r\n          </defs>\r\n        </svg>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\nSvgBoardBackground.Definitions = SvgBoardBackgroundDefinitions;\r\n\r\nclass SvgBoardHistoryArrows extends PureComponent {\r\n  getPlayerMoves() {\r\n    const {transformation} = this.props;\r\n    const {player, relevantHistory} = this.getRelevantHistory();\r\n    const gameWithPieceMove = relevantHistory\r\n      .find(game => Game.MOVE_TYPES_MOVE_WORKER.includes(game.thisMoveType));\r\n    const gameWithBuildMove = relevantHistory\r\n      .find(game => game.thisMoveType === Game.MOVE_TYPE_BUILD_AROUND_WORKER);\r\n\r\n    const {move, build} = {\r\n      move: gameWithPieceMove ? {\r\n        from: gameWithPieceMove.previous.lastMove,\r\n        to: gameWithPieceMove.lastMove,\r\n      } : null,\r\n      build: gameWithBuildMove ? {\r\n        from: gameWithBuildMove.previous.lastMove,\r\n        to: gameWithBuildMove.lastMove,\r\n      }: null,\r\n    };\r\n\r\n    if (transformation) {\r\n      if (move) {\r\n        move.from = transformation.reverseCoordinates(gameWithPieceMove.previous.rowsAndColumns, move.from);\r\n        move.to = transformation.reverseCoordinates(gameWithPieceMove.rowsAndColumns, move.to);\r\n        move.type = 'move';\r\n      }\r\n      if (build) {\r\n        build.from = transformation.reverseCoordinates(gameWithBuildMove.previous.rowsAndColumns, build.from);\r\n        build.to = transformation.reverseCoordinates(gameWithBuildMove.rowsAndColumns, build.to);\r\n        build.type = 'build';\r\n      }\r\n    }\r\n\r\n    return {player, move, build};\r\n  }\r\n\r\n  getRelevantHistory() {\r\n    const {game} = this.props;\r\n\r\n    const relevantHistory = [game];\r\n    const player = game.thisPlayer;\r\n    let iteratingGame = game;\r\n    while (iteratingGame.previous) {\r\n      iteratingGame = iteratingGame.previous;\r\n      if (iteratingGame.thisPlayer !== player) {\r\n        break;\r\n      }\r\n      relevantHistory.push(iteratingGame);\r\n    }\r\n\r\n    return {player, relevantHistory};\r\n  }\r\n\r\n  render() {\r\n    const {game} = this.props;\r\n    if (!game) {\r\n      return null;\r\n    }\r\n\r\n    const {player, move, build} = this.getPlayerMoves();\r\n    if (!move && !build) {\r\n      return null;\r\n    }\r\n    const colour = player === Game.PLAYER_A ? 'white' : 'black';\r\n\r\n    let moveArrow = null, buildArrow = null;\r\n    if (move) {\r\n      moveArrow = <Arrow key={'move'} from={move.from} to={move.to} colour={colour} type={'move'} />;\r\n    }\r\n    if (build) {\r\n      buildArrow = <Arrow key={'build'} from={build.from} to={build.to} colour={colour} type={'build'} />;\r\n    }\r\n\r\n    return [moveArrow, buildArrow];\r\n  }\r\n}\r\n\r\nSvgBoardHistoryArrows.propTypes = {\r\n  game: PropTypes.instanceOf(Game),\r\n  transformation: PropTypes.func,\r\n};\r\n\r\nclass SvgBoardAvailableMovesArrows extends PureComponent {\r\n  render() {\r\n    const {game, transformation, isCellAvailable} = this.props;\r\n    if (!game) {\r\n      return null;\r\n    }\r\n    if (!Game.MOVE_TYPES_MOVE_OR_BUILD.includes(game.moveType)) {\r\n      return null;\r\n    }\r\n\r\n    let from = game.lastMove;\r\n    let availableCells = game.findCells(isCellAvailable);\r\n    if (transformation) {\r\n      from = transformation.reverseCoordinates(game.rowsAndColumns, from);\r\n      availableCells = availableCells.map(cell => transformation.reverseCoordinates(game.rowsAndColumns, cell));\r\n    }\r\n    const colour = game.nextPlayer === Game.PLAYER_A ? 'white' : 'black';\r\n    const type = game.moveType === Game.MOVE_TYPE_BUILD_AROUND_WORKER ? 'build' : 'move';\r\n\r\n    return availableCells.map((cell, index) => (\r\n      <Arrow key={index} from={from} to={cell} colour={colour} type={type} small />\r\n    ));\r\n  }\r\n}\r\n\r\nSvgBoardAvailableMovesArrows.propTypes = {\r\n  game: PropTypes.instanceOf(Game),\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  transformation: PropTypes.func,\r\n};\r\n\r\nclass SvgBoardPieces extends PureComponent {\r\n  render() {\r\n    const {rowsAndColumns, theme, allowControl} = this.props;\r\n\r\n    const pieces = _.sortBy(Game.findCells(rowsAndColumns, cell => cell.player), ['player', 'worker']);\r\n\r\n    return (\r\n      <g data-key={'pieces'} style={{pointerEvents: 'none'}}>\r\n        {pieces.map(cell => (\r\n          <SvgBoardPiece\r\n            key={`${cell.player}-${cell.worker}`}\r\n            cell={cell}\r\n            theme={theme}\r\n            allowControl={allowControl}\r\n          />\r\n        ))}\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardPieces.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  theme: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nclass SvgBoardPiece extends PureComponent {\r\n  state = {\r\n    previousPosition: {x: this.props.cell.x, y: this.props.cell.y},\r\n    position: {x: this.props.cell.x, y: this.props.cell.y},\r\n  };\r\n\r\n  animateTransform = React.createRef();\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.cell.x !== state.position.x || props.cell.y !== state.position.y) {\r\n      return {previousPosition: state.position, position: {x: props.cell.x, y: props.cell.y}};\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (this.state.position !== prevState.position) {\r\n      setTimeout(() => {\r\n        if (this.animateTransform.current) {\r\n          this.animateTransform.current.beginElement();\r\n        }\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {cell, theme, allowControl} = this.props;\r\n    const {previousPosition, position} = this.state;\r\n  \tconst isPlayerAOpponent = !allowControl.includes(Game.PLAYER_A) && allowControl.includes(Game.PLAYER_B);\r\n  \tconst isPlayerBOpponent = !isPlayerAOpponent;\r\n    return (\r\n      <g transform={`translate(${position.x * 100},${position.y * 100})`}>\r\n        <Piece\r\n          style={theme.pieces || 'king'}\r\n          colour={cell.player === Game.PLAYER_A ? 'white' : 'black'}\r\n          rotated={theme.rotateOpponent && (cell.player === Game.PLAYER_A ? isPlayerAOpponent : isPlayerBOpponent)}\r\n        />\r\n        <animateTransform\r\n          ref={this.animateTransform}\r\n          attributeName={'transform'}\r\n          attributeType={'XML'}\r\n          type={'translate'}\r\n          from={`${previousPosition.x * 100} ${previousPosition.y * 100}`}\r\n          to={`${position.x * 100} ${position.y * 100}`}\r\n          dur={'0.1s'}\r\n          repeatCount={1}\r\n          fill={'freeze'}\r\n        />\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardPiece.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  theme: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nclass SvgBoardCell extends PureComponent {\r\n  makeMove = () => {\r\n    if (this.props.available && this.props.makeMove) {\r\n      this.props.makeMove(this.props.cell);\r\n    } else if (this.props.undoable && this.props.undo) {\r\n      this.props.undo();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {cell, clickable, available, undoable, settings: {theme}, makeMove, undo, animated, allowControl} = this.props;\r\n    return (\r\n      <Cell\r\n        x={cell.x}\r\n        y={cell.y}\r\n        available={available}\r\n        undoable={undoable}\r\n        level={cell.level}\r\n        player={cell.player}\r\n        allowControl={allowControl}\r\n        animated={animated}\r\n        theme={theme}\r\n        onClick={((makeMove && available) || (undo && undoable)) && clickable ? this.makeMove : null}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardCell.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  animated: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nSvgBoardCell.defaultProps = {\r\n  clickable: false,\r\n  available: false,\r\n  undoable: false,\r\n  animated: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n};\r\n\r\nexport default SvgBoardBackground;\r\n","import SvgBoardBackground from \"./SvgBoardBackground\";\r\n\r\nexport default SvgBoardBackground;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../../game/game\";\r\nimport HtmlBoardBackground from \"./HtmlBoardBackground\";\r\nimport SvgBoardBackground from \"./SvgBoardBackground\";\r\nimport \"../../styles/board.css\";\r\nimport \"../../styles/board-theme.css\";\r\n\r\nclass BoardBackground extends Component {\r\n  render() {\r\n    let {renderer = 'svg', ...props} = this.props;\r\n\r\n    const renderers = {\r\n      'html': HtmlBoardBackground,\r\n      'svg': SvgBoardBackground,\r\n    };\r\n    const Renderer = renderers[renderer];\r\n    return <Renderer {...props} />;\r\n  }\r\n}\r\n\r\nBoardBackground.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  transformation: PropTypes.func,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n  showArrows: PropTypes.bool.isRequired,\r\n  game: PropTypes.instanceOf(Game),\r\n  arrows: PropTypes.array,\r\n};\r\n\r\nBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  animated: false,\r\n  showArrows: false,\r\n};\r\n\r\nexport default BoardBackground;\r\n","import React, {PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport _  from 'lodash';\r\nimport Game from \"../../game/game\";\r\nimport BoardBackground from \"./BoardBackground\";\r\nimport {Menu} from \"semantic-ui-react\";\r\n\r\nclass Board extends PureComponent {\r\n  makeMove = (cell) => {\r\n    const {game: {rowsAndColumns}, transformation} = this.props;\r\n    if (transformation) {\r\n      cell = transformation.coordinates(rowsAndColumns, cell);\r\n    }\r\n    this.props.makeMove(this.props.game.makeMove({x: cell.x, y: cell.y}));\r\n  };\r\n\r\n  undo = () => {\r\n    this.props.makeMove(this.props.game.canUndo ? this.props.game.undo() : this.props.game.takeMoveBack());\r\n  };\r\n\r\n  onSelect = () => {\r\n    this.props.onSelect(this.props.game);\r\n  };\r\n\r\n  isCellAvailable = cell => {\r\n    const {game: {rowsAndColumns}, transformation} = this.props;\r\n    if (transformation) {\r\n      cell = transformation.coordinates(rowsAndColumns, cell);\r\n    }\r\n    return this.props.game.isMoveAvailable(cell);\r\n  };\r\n\r\n  isCellUndoable = cell => {\r\n    const {game: {rowsAndColumns}, transformation} = this.props;\r\n    if (transformation) {\r\n      cell = transformation.coordinates(rowsAndColumns, cell);\r\n    }\r\n    if (this.props.minChainCount === undefined || this.props.minChainCount === null) {\r\n      if (!this.props.game.canUndo) {\r\n        return false;\r\n      }\r\n    } else {\r\n      if (this.props.game.chainCount <= this.props.minChainCount) {\r\n        return false;\r\n      }\r\n    }\r\n    const lastMove = this.props.game.lastMove;\r\n    if (!lastMove) {\r\n      return false;\r\n    }\r\n    return lastMove.x === cell.x && lastMove.y === cell.y;\r\n  };\r\n\r\n  isGameUndoable() {\r\n    return !!this.props.game.findCell(this.isCellUndoable);\r\n  }\r\n\r\n  render() {\r\n    const {game, transformation, allowControl, onSelect, makeMove, animated} = this.props;\r\n    let rowsAndColumns = game.rowsAndColumns;\r\n    if (transformation) {\r\n      rowsAndColumns = transformation(rowsAndColumns);\r\n    }\r\n\r\n    return (\r\n      <BoardBackground\r\n        {...this.props}\r\n        isCellAvailable={animated ? this.isCellAvailable : () => false}\r\n        isCellUndoable={animated ? this.isCellUndoable : () => false}\r\n        clickable={allowControl.includes(game.nextPlayer)}\r\n        undoable={animated ? this.isGameUndoable() : false}\r\n        onSelect={onSelect ? this.onSelect : null}\r\n        makeMove={makeMove ? this.makeMove : null}\r\n        undo={makeMove ? this.undo : null}\r\n        rowsAndColumns={rowsAndColumns}\r\n        transformation={transformation}\r\n        game={game}\r\n        animated={animated}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nBoard.propTypes = {\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  transformation: PropTypes.func,\r\n  makeMove: PropTypes.func,\r\n  minChainCount: PropTypes.number,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n};\r\n\r\nBoard.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  animated: false,\r\n};\r\n\r\nclass BoardTransformation extends PureComponent {\r\n  state = {\r\n    rotations: 0,\r\n    flippedHorizontally: false,\r\n  };\r\n\r\n  // noinspection JSSuspiciousNameCombination\r\n  static transformationMap = {\r\n    '0,false': null,\r\n    // makeTransformRowsAndColumns({transpose:  false, flipX: false, flipY: false}),\r\n    '1,false': this.makeTransformRowsAndColumns({transpose: true, flipX: false, flipY: true}),\r\n    '2,false': this.makeTransformRowsAndColumns({transpose: false, flipX: true, flipY: true}),\r\n    '3,false': this.makeTransformRowsAndColumns({transpose: true, flipX: true, flipY: false}),\r\n    '0,true': this.makeTransformRowsAndColumns({transpose: false, flipX: true, flipY: false}),\r\n    '1,true': this.makeTransformRowsAndColumns({transpose: true, flipX: true, flipY: true}),\r\n    '2,true': this.makeTransformRowsAndColumns({transpose: false, flipX: false, flipY: true}),\r\n    '3,true': this.makeTransformRowsAndColumns({transpose: true, flipX: false, flipY: false}),\r\n  };\r\n\r\n  static makeTransformRowsAndColumns(config) {\r\n    const transformRowsAndColumns = rowsAndColumns => {\r\n      return this.transformRowsAndColumns(rowsAndColumns, config);\r\n    };\r\n    transformRowsAndColumns.coordinates = (rowsAndColumns, coordinates) => {\r\n      return this.reverseTransformCoordinates(rowsAndColumns, coordinates, config);\r\n    };\r\n    // We can tell if the board is flipped (horizontally or vertically)\r\n    const flipped = config.transpose ^ config.flipX ^ config.flipY;\r\n    const reverseConfig = config.transpose && !flipped ? {\r\n      transpose: config.transpose,\r\n      flipX: !config.flipX,\r\n      flipY: !config.flipY,\r\n    } : config;\r\n    transformRowsAndColumns.reverseCoordinates = (rowsAndColumns, coordinates) => {\r\n      return this.reverseTransformCoordinates(rowsAndColumns, coordinates, reverseConfig);\r\n    };\r\n\r\n    return transformRowsAndColumns;\r\n  }\r\n\r\n  static transformRowsAndColumns(rowsAndColumns, config) {\r\n    let {newRowCount, newColumnCount} = this.getNewRowAndColumnCount(rowsAndColumns, config);\r\n    const newXs = _.range(newColumnCount);\r\n    const newYs = _.range(newRowCount);\r\n\r\n    return newYs.map(newY => ({\r\n      y: newY,\r\n      cells: newXs.map(newX => {\r\n        let {oldX, oldY} = this.getOldCoordinates( {newX, newY}, {newRowCount, newColumnCount}, config);\r\n        return {\r\n        ...rowsAndColumns[oldY].cells[oldX],\r\n          x: newX, y: newY,\r\n        };\r\n      }),\r\n    }));\r\n  }\r\n\r\n  static reverseTransformCoordinates(rowsAndColumns, coordinates, config) {\r\n    let {newRowCount, newColumnCount} = this.getNewRowAndColumnCount(rowsAndColumns, config);\r\n    const {x: newX, y: newY} = coordinates;\r\n    const {oldX, oldY} = this.getOldCoordinates( {newX, newY}, {newRowCount, newColumnCount}, config);\r\n\r\n    return {x: oldX, y: oldY};\r\n  }\r\n\r\n  static getNewRowAndColumnCount(rowsAndColumns, config) {\r\n    const rowCount = rowsAndColumns.length;\r\n    const columnCount = Math.max(...rowsAndColumns.map(row => row.cells.length)) || 0;\r\n    const {transpose} = config;\r\n    let newRowCount, newColumnCount;\r\n    if (transpose) {\r\n      [newColumnCount, newRowCount] = [rowCount, columnCount];\r\n    } else {\r\n      [newColumnCount, newRowCount] = [columnCount, rowCount];\r\n    }\r\n    return {newRowCount, newColumnCount};\r\n  }\r\n\r\n  static getOldCoordinates({newX, newY}, {newColumnCount, newRowCount}, config) {\r\n    const {transpose, flipX, flipY} = config;\r\n    let oldX, oldY;\r\n    if (transpose) {\r\n      [oldX, oldY] = [newY, newX];\r\n    } else {\r\n      [oldX, oldY] = [newX, newY];\r\n    }\r\n    if (flipX) {\r\n      oldX = newColumnCount - 1 - oldX;\r\n    }\r\n    if (flipY) {\r\n      oldY = newRowCount - 1 - oldY;\r\n    }\r\n    return {oldX, oldY};\r\n  }\r\n\r\n   updateOrientation = method => {\r\n     this.setState(method, () => {\r\n       if (this.props.onChange) {\r\n         const {rotations, flippedHorizontally} = this.state;\r\n         const transformation = this.constructor.transformationMap[`${rotations},${flippedHorizontally}`];\r\n         this.props.onChange({rotations, flippedHorizontally, transformation});\r\n       }\r\n     });\r\n   };\r\n\r\n  rotateCounterClockwise = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: (state.rotations + 3) % 4,\r\n    }));\r\n  };\r\n\r\n  rotateClockwise = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: (state.rotations + 1) % 4,\r\n    }));\r\n  };\r\n\r\n  flipHorizontally = () => {\r\n    this.updateOrientation(state => ({\r\n      flippedHorizontally: !state.flippedHorizontally,\r\n    }));\r\n  };\r\n\r\n  flipVertically = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: (state.rotations + 2) % 4,\r\n      flippedHorizontally: !state.flippedHorizontally,\r\n    }));\r\n  };\r\n\r\n  reset = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: 0,\r\n      flippedHorizontally: false,\r\n    }));\r\n  };\r\n\r\n  render() {\r\n    const {rotations, flippedHorizontally} = this.state;\r\n\r\n    return (\r\n      <Menu size={'massive'} items={[\r\n        {key: 'rotate-counter-clockwise', icon: 'undo', onClick: this.rotateCounterClockwise},\r\n        {key: 'rotate-clockwise', icon: 'redo', onClick: this.rotateClockwise},\r\n        {key: 'flip-horizontal', icon: 'arrows alternate horizontal', onClick: this.flipHorizontally},\r\n        {key: 'flip-vertical', icon: 'arrows alternate vertical', onClick: this.flipVertically},\r\n        {key: 'home', icon: 'home', onClick: this.reset, disabled: !rotations && !flippedHorizontally},\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nBoardTransformation.propTypes = {\r\n  onChange: PropTypes.func,\r\n};\r\n\r\nexport {\r\n  BoardTransformation,\r\n};\r\n\r\nexport default Board;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../../game/game\";\r\nimport BoardBackground from \"./BoardBackground\";\r\n\r\nclass ThemeDemoBoard extends Component {\r\n  static demoRowsAndColumns = [\r\n    {\r\n      y: 0,\r\n      cells: [\r\n        {x: 0, y: 0, player: null, worker: null, level: 0},\r\n        {x: 1, y: 0, player: null, worker: null, level: 1},\r\n        {x: 2, y: 0, player: null, worker: null, level: 2},\r\n        {x: 3, y: 0, player: null, worker: null, level: 3},\r\n        {x: 4, y: 0, player: null, worker: null, level: 4},\r\n        {x: 5, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 0},\r\n        {x: 6, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n      ],\r\n    },\r\n  ];\r\n  static demoRowsAndColumnsAnimated = [\r\n    {\r\n      y: 0,\r\n      cells: [\r\n        {x: 0, y: 0, player: null, worker: null, level: 0},\r\n        {x: 1, y: 0, player: null, worker: null, level: 1},\r\n        {x: 2, y: 0, player: null, worker: null, level: 2},\r\n        {x: 3, y: 0, player: null, worker: null, level: 3},\r\n        {x: 4, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 3},\r\n        {x: 5, y: 0, player: null, worker: null, level: 0},\r\n        {x: 6, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n      ],\r\n    },\r\n  ];\r\n  static arrows = [\r\n    {from: {x: 5, y: 0}, to: {x: 4, y: 0}, colour: 'white', type: 'build'},\r\n    {from: {x: 4, y: 0}, to: {x: 5, y: 0}, colour: 'white', type: 'move'},\r\n  ];\r\n\r\n  state = {\r\n    rowsAndColumns: this.constructor.demoRowsAndColumns,\r\n  };\r\n\r\n  isCellAvailable = () => {\r\n    return false;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  animate = () => {\r\n    this.setState(state => ({\r\n      rowsAndColumns: state.rowsAndColumns === this.constructor.demoRowsAndColumns\r\n        ? this.constructor.demoRowsAndColumnsAnimated\r\n        : this.constructor.demoRowsAndColumns,\r\n    }));\r\n  };\r\n  animationInterval = this.props.settings.theme.animations ? setInterval(this.animate, 2000) : null;\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (this.props.settings.theme.animations !== prevProps.settings.theme.animations) {\r\n      if (this.props.settings.theme.animations) {\r\n        if (!this.animationInterval) {\r\n          this.animationInterval = setInterval(this.animate, 2000);\r\n        }\r\n      } else {\r\n        if (this.animationInterval) {\r\n          clearInterval(this.animationInterval);\r\n          this.animationInterval = null;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.animationInterval) {\r\n      clearInterval(this.animationInterval);\r\n      this.animationInterval = null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {small, medium, settings} = this.props;\r\n    const {rowsAndColumns} = this.state;\r\n\r\n    return (\r\n      <BoardBackground\r\n        small={small}\r\n        medium={medium}\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={rowsAndColumns}\r\n        undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        arrows={settings.theme.arrows ? this.constructor.arrows : undefined}\r\n        settings={settings}\r\n        animated={settings.theme.animations}\r\n        showArrows={settings.theme.arrows}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nThemeDemoBoard.propTypes = {\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n};\r\n\r\nThemeDemoBoard.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n};\r\n\r\nexport default ThemeDemoBoard;\r\n","import Board from './Board';\r\nimport ThemeDemoBoard from './ThemeDemoBoard';\r\n\r\nexport {\r\n  ThemeDemoBoard,\r\n};\r\n\r\nexport default Board;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../../game/game\";\r\nimport BoardBackground from \"./BoardBackground\";\r\n\r\nclass PlayerColourBoard extends Component {\r\n  static colours = {\r\n    [Game.PLAYER_A]: [\r\n      {\r\n        y: 0,\r\n        cells: [\r\n          {x: 0, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 0},\r\n        ],\r\n      },\r\n    ],\r\n    [Game.PLAYER_B]: [\r\n      {\r\n        y: 0,\r\n        cells: [\r\n          {x: 0, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n        ],\r\n      },\r\n    ],\r\n  };\r\n\r\n  isCellAvailable = () => {\r\n    return false;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  render() {\r\n    const {small, medium, player, settings, allowControl} = this.props;\r\n\r\n    return (\r\n      <BoardBackground\r\n        small={small}\r\n        medium={medium}\r\n        rowsAndColumns={this.constructor.colours[player]}\r\n        undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        settings={settings}\r\n        allowControl={allowControl}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nPlayerColourBoard.propTypes = {\r\n  settings: PropTypes.object.isRequired,\r\n  player: PropTypes.oneOf(Game.PLAYERS).isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n};\r\n\r\nPlayerColourBoard.defaultProps = {\r\n  small: false,\r\n  medium: false,\r\n};\r\n\r\nexport default PlayerColourBoard;\r\n","import React, {Component} from 'react';\r\nimport {client} from \"./client\";\r\n\r\nclass ClientWatcher extends Component {\r\n  static SubComponent = null;\r\n\r\n  static forComponent(Component) {\r\n    class ClientWatcherForComponent extends this {\r\n      static SubComponent = Component;\r\n    }\r\n\r\n    return ClientWatcherForComponent;\r\n  }\r\n\r\n  state = {\r\n    connected: client.connected,\r\n    available: client.available,\r\n    disconnected: client.disconnected,\r\n    user: client.user,\r\n    username: client.user ? client.user.name : null,\r\n    usersInfo: client.usersInfo,\r\n    gamesInfo: client.gamesInfo,\r\n    tournamentsInfo: client.tournamentsInfo,\r\n    challengesInfo: client.challengesInfo,\r\n  };\r\n\r\n  componentDidMount() {\r\n    client.subscribe({\r\n      onConnect: this.connectionChanged,\r\n      onDisconnect: this.connectionChanged,\r\n      onUser: this.gotUser,\r\n      onUsers: this.gotUsers,\r\n      onGames: this.gotGames,\r\n      onTournaments: this.gotTournaments,\r\n      onChallenges: this.gotChallenges,\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    client.unsubscribe({\r\n      onUser: this.gotUser,\r\n      onUsers: this.gotUsers,\r\n      onGames: this.gotGames,\r\n      onTournaments: this.gotTournaments,\r\n      onChallenges: this.gotChallenges,\r\n    });\r\n  }\r\n\r\n  connectionChanged = connected => {\r\n    this.setState({connected, disconnected: client.disconnected, available: client.available});\r\n  };\r\n\r\n  gotUser = user => {\r\n    this.setState({user});\r\n  };\r\n\r\n  gotUsers = usersInfo => {\r\n    this.setState({usersInfo});\r\n  };\r\n\r\n  gotGames = gamesInfo => {\r\n    this.setState({gamesInfo});\r\n  };\r\n\r\n  gotTournaments = tournamentsInfo => {\r\n    this.setState({tournamentsInfo});\r\n  };\r\n\r\n  gotChallenges = challengesInfo => {\r\n    this.setState({challengesInfo});\r\n  };\r\n\r\n  render() {\r\n    const {connected, disconnected, available, user, usersInfo, gamesInfo, tournamentsInfo, challengesInfo} = this.state;\r\n    const SubComponent = this.constructor.SubComponent;\r\n    return (\r\n      <SubComponent\r\n        {...this.props}\r\n        connected={connected}\r\n        disconnected={disconnected}\r\n        available={available}\r\n        client={client}\r\n        user={user}\r\n        usersInfo={usersInfo}\r\n        gamesInfo={gamesInfo}\r\n        tournamentsInfo={tournamentsInfo}\r\n        challengesInfo={challengesInfo}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport const withClient = Component => {\r\n  return ClientWatcher.forComponent(Component);\r\n};\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport jdenticon from \"jdenticon\";\r\nimport classNames from \"classnames\";\r\n\r\nclass HashedIcon extends Component {\r\n  ref = React.createRef();\r\n\r\n  componentDidMount() {\r\n    this.updateIcon();\r\n  }\r\n\r\n  updateIcon() {\r\n    if (this.ref.current) {\r\n      jdenticon.update(this.ref.current);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.hash !== this.props) {\r\n      this.updateIcon();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {hash, floated, size, textSized} = this.props;\r\n    return (\r\n      <svg\r\n        ref={this.ref}\r\n        className={classNames([\"ui\", \"mini\", \"right\", \"floated\", \"image\"], {floated: !!floated, [floated]: !!floated, [size]: !!size, 'text-sized': textSized})}\r\n        data-jdenticon-value={hash}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nHashedIcon.propTypes = {\r\n  hash: PropTypes.string.isRequired,\r\n  floated: PropTypes.oneOf(['left', 'right']),\r\n  size: PropTypes.oneOf(['mini', 'tiny', 'small', 'medium', 'large', 'big', 'huge', 'massive']),\r\n  textSized: PropTypes.bool.isRequired,\r\n};\r\n\r\nHashedIcon.defaultProps = {\r\n  textSized: false,\r\n};\r\n\r\nexport default HashedIcon;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Icon, Label, Card, Grid, Pagination} from \"semantic-ui-react\";\r\nimport moment from 'moment';\r\n\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport classNames from \"classnames\";\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nexport class GameCard extends Component {\r\n  selectLiveGame = () => {\r\n    this.props.selectLiveGame(this.props.game);\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, tournamentsById, game, terse, live, currentGameId} = this.props;\r\n\r\n    const tournament = tournamentsById[game.tournamentId];\r\n\r\n    const gameGame = Game.deserialize(game.game);\r\n    const playerA = usersById[game.userIds[0]];\r\n    const playerB = usersById[game.userIds[1]];\r\n    const nextPlayerUser = gameGame.nextPlayer === Game.PLAYER_A ? playerA : playerB;\r\n    const playerAToPlay = nextPlayerUser === playerA;\r\n    const playerBToPlay = nextPlayerUser === playerB;\r\n    const isUserPlayerA = user ? playerA.id === user.id : false;\r\n    const isUserPlayerB = user ? playerB.id === user.id : false;\r\n    const winnerUser = game.finished ? (game.winner === Game.PLAYER_A ? playerA : playerB) : null;\r\n    const isMyGame = isUserPlayerA || isUserPlayerB;\r\n    const isMyTurn = (isUserPlayerA && playerAToPlay) || (isUserPlayerB && playerBToPlay);\r\n    const showPlayerA = !terse || !isMyGame || isUserPlayerB;\r\n    const showPlayerB = !terse || !isMyGame || isUserPlayerA;\r\n\r\n    return (\r\n      <Card\r\n        as={NavLink}\r\n        to={`/game/${game.id}`}\r\n        onClick={this.selectLiveGame}\r\n        style={{\r\n          ...(!terse ? {} : {width: 'auto'}),\r\n          ...(game.id === currentGameId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n        className={classNames({attention: live && isMyTurn})}\r\n      >\r\n        <Card.Content>\r\n          {!terse ? (\r\n            <Board\r\n              className={'ui image floated right mini'}\r\n              game={gameGame}\r\n              small\r\n              settings={user ? user.settings : undefined}\r\n            />\r\n          ) : null}\r\n          <Card.Header>\r\n            {!(showPlayerA && showPlayerB) ? \" vs \" : null}\r\n            {showPlayerA ? (\r\n              <Label color={winnerUser === playerA || isMyTurn ? 'green' : undefined} >\r\n                {winnerUser === playerA ? <Icon name={'trophy'}/> : null}\r\n                {playerAToPlay ? <Icon name={'caret right'}/> : null}\r\n                {playerA.name}\r\n                <HashedIcon floated={'right'} size={'mini'} textSized hash={playerA.id} />\r\n              </Label>\r\n            ) : null}\r\n            {showPlayerA && showPlayerB ? \" vs \" : null}\r\n            {showPlayerB ? (\r\n              <Label color={winnerUser === playerB || isMyTurn ? 'green' : undefined} >\r\n                {winnerUser === playerB ? <Icon name={'trophy'}/> : null}\r\n                {playerBToPlay ? <Icon name={'caret right'} color={\"green\"}/> : null}\r\n                {playerB.name}\r\n                <HashedIcon floated={'right'} size={'mini'} textSized hash={playerB.id} />\r\n              </Label>\r\n            ) : null}\r\n          </Card.Header>\r\n          {!terse ? (\r\n            <Card.Meta>\r\n              {isMyGame ? <Label icon={{name: 'user', color: 'green'}} content={'My game'} /> : null}\r\n              {\" \"}\r\n              {!game.finished ? <Label icon={{name: 'circle', color: 'green'}} content={'Live'} /> : null}\r\n              {\" \"}\r\n              <Label content={`Move ${game.move}`} icon={'play'} />\r\n              {\" \"}\r\n              <Label content={moment(game.endDatetime || game.startDatetime).from()} icon={'calendar'} />\r\n              {\" \"}\r\n              {tournament ? <Label content={tournament.name} icon={'sitemap'} /> : null}\r\n            </Card.Meta>\r\n          ) : (\r\n            tournament ? <Label icon={'sitemap'} /> : null\r\n          )}\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nGameCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournamentsById: PropTypes.object.isRequired,\r\n  game: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  live: PropTypes.bool.isRequired,\r\n  currentGameId: PropTypes.string,\r\n};\r\n\r\nGameCard.defaultProps = {\r\n  terse: false,\r\n  live: false,\r\n};\r\n\r\nclass GameList extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, tournamentsById, games, terse, live, selectLiveGame, currentGameId, pageSize, reverse} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    let {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil(games.length / pageSize);\r\n    if (activePage > totalPages) {\r\n      activePage = totalPages;\r\n    }\r\n    let visibleGames = games\r\n      .slice((totalPages - activePage) * pageSize, (totalPages - activePage) * pageSize + pageSize);\r\n    if (reverse) {\r\n      visibleGames = visibleGames.reverse();\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group style={{maxHeight: '300px', overflowY: 'auto', flexWrap: !terse ? undefined : 'unset'}}>\r\n          {visibleGames.map(game => (\r\n            <GameCard\r\n              key={game.id}\r\n              user={user}\r\n              usersById={usersById}\r\n              tournamentsById={tournamentsById}\r\n              game={game}\r\n              selectLiveGame={selectLiveGame}\r\n              terse={terse}\r\n              live={live}\r\n              currentGameId={currentGameId}\r\n            />\r\n          ))}\r\n        </Card.Group>\r\n        {totalPages > 1 ? (\r\n          <Grid centered>\r\n            <Grid.Row>\r\n              <Pagination\r\n                totalPages={totalPages}\r\n                activePage={activePage}\r\n                onPageChange={this.onPageChange}\r\n                pointing\r\n                secondary\r\n              />\r\n            </Grid.Row>\r\n          </Grid>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nGameList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournamentsById: PropTypes.object.isRequired,\r\n  games: PropTypes.array.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  live: PropTypes.bool.isRequired,\r\n  currentGameId: PropTypes.string,\r\n  pageSize: PropTypes.number.isRequired,\r\n  reverse: PropTypes.bool.isRequired,\r\n};\r\n\r\nGameList.defaultProps = {\r\n  terse: false,\r\n  live: false,\r\n  pageSize: 10,\r\n  reverse: true,\r\n};\r\n\r\nexport default GameList;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Form, Input, Modal, Segment} from \"semantic-ui-react\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport Client from \"../client/client\";\r\n\r\nclass CreateTournament extends Component {\r\n  state = {\r\n    name: '',\r\n    gameCount: '1',\r\n  };\r\n\r\n  createTournament = () => {\r\n    const {client} = this.props;\r\n    const {name, gameCount} = this.state;\r\n    client.createTournament({name, gameCount: parseInt(gameCount, 10)});\r\n  };\r\n\r\n  onClose = () => {\r\n    this.setState({name: '', gameCount: 1});\r\n  };\r\n\r\n  setValue = (e, {name, value}) => {\r\n    this.setState({[name]: value});\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        size={'mini'}\r\n        trigger={<Button color={'yellow'} icon={'sitemap'} content={'Create tournament'} />}\r\n        header={'Create tournament'}\r\n        content={\r\n          <Segment>\r\n            <Form>\r\n              <Form.Field\r\n                name={'name'}\r\n                control={Input}\r\n                label={'Name'}\r\n                placeholder={'Tournament name'}\r\n                onChange={this.setValue}\r\n                required\r\n                defaultValue={this.state.name}\r\n              />\r\n              <Form.Field\r\n                name={'gameCount'}\r\n                control={Input}\r\n                label={`${this.state.gameCount} game(s) between each pair of players`}\r\n                placeholder={'Game count between each pair of players'}\r\n                onChange={this.setValue}\r\n                type={'range'}\r\n                min={1}\r\n                max={5}\r\n                defaultValue={this.state.gameCount}\r\n                required\r\n              />\r\n            </Form>\r\n          </Segment>\r\n        }\r\n        actions={[\r\n          {key: 'cancel', content: 'Cancel'},\r\n          {key: 'create', positive: true, content: 'Create Tournament', onClick: this.createTournament, disabled: !this.state.name},\r\n        ]}\r\n        onClose={this.onClose}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nCreateTournament.propTypes = {\r\n  client: PropTypes.instanceOf(Client),\r\n};\r\n\r\nexport default withClient(CreateTournament);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Label, Card, Grid, Pagination} from \"semantic-ui-react\";\r\nimport moment from 'moment';\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nclass TournamentCard extends Component {\r\n  selectLiveTournament = () => {\r\n    this.props.selectLiveTournament(this.props.tournament);\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, currentTournamentId, tournament, terse} = this.props;\r\n\r\n    const isMyTournament = user ? tournament.userIds.includes(user.id) : false;\r\n    const didUserCreated = user ? tournament.creatorUserId === user.id : false;\r\n    const didUserWin = tournament.finished ? tournament.winnerUserId === user.id : false;\r\n    const creator = usersById[tournament.creatorUserId];\r\n\r\n    const statusLabel = (\r\n      <Label\r\n        content={tournament.started ? (tournament.finished ? 'Finished' : `Round ${tournament.round}/${tournament.rounds}`) : 'Waiting'}\r\n        icon={{\r\n          name: tournament.started ? (tournament.finished ? 'trophy' : 'play') : 'hourglass',\r\n          colour: tournament.started ? 'green' : undefined,\r\n        }}\r\n      />\r\n    );\r\n\r\n    return (\r\n      <Card\r\n        as={NavLink}\r\n        to={`/tournament/${tournament.id}`}\r\n        // onClick={this.selectLiveTournament}\r\n        style={{\r\n          ...(!terse ? {} : {width: 'auto'}),\r\n          ...(tournament.id === currentTournamentId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n      >\r\n        <Card.Content>\r\n          <Card.Header>\r\n            <Label content={tournament.name} /> by\r\n            <Label color={didUserCreated ? 'green' : undefined} content={creator.name} />\r\n            {terse ? statusLabel : null}\r\n          </Card.Header>\r\n          {!terse ? (\r\n            <Card.Meta>\r\n              {isMyTournament ? <Label icon={{name: 'user', color: 'green'}} content={'Participating'} /> : null}\r\n              {\" \"}\r\n              {didUserWin ? <Label icon={{name: 'trophy', color: 'yellow'}} content={'Won'} /> : (\r\n                tournament.finished ? (\r\n                  <Label icon={'trophy'} content={usersById[tournament.winnerUserId] ? usersById[tournament.winnerUserId].name : tournament.winnerUserId} />\r\n                ) : null\r\n              )}\r\n              {\" \"}\r\n              {tournament.started && !tournament.finished ? <Label icon={{name: 'circle', color: 'green'}} content={'Live'} /> : null}\r\n              {\" \"}\r\n              {statusLabel}\r\n              {\" \"}\r\n              <Label content={`${tournament.userIds.length} players`} icon={'users'} />\r\n              {\" \"}\r\n              <Label content={moment(tournament.endDatetime || tournament.startDatetime || tournament.createdDatetime).from()} icon={'calendar'} />\r\n            </Card.Meta>\r\n          ) : null}\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nTournamentCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournament: PropTypes.object.isRequired,\r\n  currentTournamentId: PropTypes.string,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n};\r\n\r\nTournamentCard.defaultProps = {\r\n  terse: false,\r\n};\r\n\r\nclass TournamentList extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, tournaments, terse, selectLiveTournament, currentTournamentId, pageSize} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    let {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil(tournaments.length / pageSize);\r\n    if (activePage > totalPages) {\r\n      activePage = totalPages;\r\n    }\r\n    const visibleTournaments = tournaments\r\n      .slice((totalPages - activePage) * pageSize, (totalPages - activePage) * pageSize + pageSize)\r\n      .reverse();\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group style={{maxHeight: '300px', overflowY: 'auto', flexWrap: !terse ? undefined : 'unset'}}>\r\n          {visibleTournaments.map(tournament => (\r\n            <TournamentCard\r\n              key={tournament.id}\r\n              user={user}\r\n              usersById={usersById}\r\n              tournament={tournament}\r\n              currentTournamentId={currentTournamentId}\r\n              selectLiveTournament={selectLiveTournament}\r\n              terse={terse}\r\n            />\r\n          ))}\r\n        </Card.Group>\r\n        {totalPages > 1 ? (\r\n          <Grid centered>\r\n            <Grid.Row>\r\n              <Pagination\r\n                totalPages={totalPages}\r\n                activePage={activePage}\r\n                onPageChange={this.onPageChange}\r\n                pointing\r\n                secondary\r\n              />\r\n            </Grid.Row>\r\n          </Grid>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nTournamentList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournaments: PropTypes.array.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  currentTournamentId: PropTypes.string,\r\n  pageSize: PropTypes.number.isRequired,\r\n};\r\n\r\nTournamentList.defaultProps = {\r\n  terse: false,\r\n  pageSize: 10,\r\n};\r\n\r\nexport default TournamentList;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Label, Card, Grid, Pagination} from \"semantic-ui-react\";\r\n\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport {NavLink} from \"react-router-dom\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nexport class ChallengeCard extends Component {\r\n  selectChallenge = () => {\r\n    this.props.selectChallenge(this.props.challenge);\r\n  };\r\n\r\n  get userChallenge() {\r\n    const {user, challenge} = this.props;\r\n    if (!user) {\r\n      return null;\r\n    }\r\n    if (!challenge) {\r\n      return null;\r\n    }\r\n    return user.challenges[challenge.id] || null;\r\n  }\r\n\r\n  render() {\r\n    const {user, usersById, challenge, currentChallengeId} = this.props;\r\n    const userChallenge = this.userChallenge;\r\n\r\n    const creator = usersById[challenge.userId];\r\n    return (\r\n      <Card\r\n        as={NavLink}\r\n        to={`/challenge/${challenge.id}`}\r\n        onClick={this.selectChallenge}\r\n        style={{\r\n          ...(challenge.id === currentChallengeId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n      >\r\n        <Card.Content>\r\n          <Card.Header>\r\n            {challenge.options.type === 'mate'\r\n              ? `Find mate in ${challenge.options.typeOptions.mateIn}`\r\n              : 'Unknown challenge'}\r\n          </Card.Header>\r\n          <Card.Meta>\r\n            <Label\r\n              icon={{\r\n                name: {1: 'smile outline', 2: 'meh outline', 3: 'frown outline'}[challenge.meta.difficulty],\r\n                color: {1: 'green', 2: 'orange', 3: 'red'}[challenge.meta.difficulty],\r\n              }}\r\n              content={`${challenge.meta.difficulty}/${challenge.meta.maxDifficulty}`}\r\n              title={{1: 'Easy', 2: 'Medium', 3: 'Hard'}[challenge.meta.difficulty]}\r\n            />\r\n            <Label icon={'user'} content={`By ${creator.name}`} />\r\n            {userChallenge && userChallenge.meta.started && !userChallenge.meta.won ? (\r\n              <Label icon={{name: 'play', color: 'green'}} content={'Started'} />\r\n            ) : null}\r\n            {userChallenge && userChallenge.meta.won ? (\r\n              <Label icon={{name: 'trophy', color: 'green'}} content={'Solved'} />\r\n            ) : null}\r\n            {userChallenge && userChallenge.meta.mistakes ? (\r\n              <Label icon={{name: 'exclamation', color: 'red'}} content={`${userChallenge.meta.mistakes} mistakes`} />\r\n            ) : null}\r\n            {user && challenge.userId === user.id ? (\r\n              <Label\r\n                icon={(\r\n                  challenge.meta.public && challenge.meta.publishDatetime.isSameOrBefore()\r\n                    ? {name: 'check', color: 'green'} : (\r\n                      challenge.meta.public\r\n                        ? {name: 'pause', color: 'yellow'} : {name: 'x', color: 'red'}\r\n                    ))}\r\n                content={(\r\n                  challenge.meta.public && challenge.meta.publishDatetime.isSameOrBefore()\r\n                    ? challenge.meta.publishDatetime.fromNow() : (\r\n                      challenge.meta.public\r\n                        ? challenge.meta.publishDatetime.toNow() : \"Private\"\r\n                    ))}\r\n              />\r\n            ) : (\r\n              <Label\r\n                icon={'calendar'}\r\n                content={challenge.meta.publishDatetime.fromNow()}\r\n              />\r\n            )}\r\n            <Board\r\n              game={Game.fromCompressedPositionNotation(challenge.startingPosition.position)}\r\n              medium\r\n              settings={user ? user.settings : undefined}\r\n            />\r\n          </Card.Meta>\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  challenge: PropTypes.object.isRequired,\r\n  selectChallenge: PropTypes.func.isRequired,\r\n  currentChallengeId: PropTypes.string,\r\n};\r\n\r\nclass ChallengeList extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {user, usersInfo: {byId: usersById}, challenges, selectChallenge, currentChallengeId, pageSize} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    let {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil(challenges.length / pageSize);\r\n    if (activePage > totalPages) {\r\n      activePage = totalPages;\r\n    }\r\n    const visibleChallenges = challenges\r\n      .slice((totalPages - activePage) * pageSize, (totalPages - activePage) * pageSize + pageSize)\r\n      .reverse();\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group style={{maxHeight: '400px', overflowY: 'auto'}}>\r\n          {visibleChallenges.map(challenge => (\r\n            <ChallengeCard\r\n              key={challenge.id}\r\n              user={user}\r\n              usersById={usersById}\r\n              challenge={challenge}\r\n              selectChallenge={selectChallenge}\r\n              currentChallengeId={currentChallengeId}\r\n            />\r\n          ))}\r\n        </Card.Group>\r\n        {totalPages > 1 ? (\r\n          <Grid centered>\r\n            <Grid.Row>\r\n              <Pagination\r\n                totalPages={totalPages}\r\n                activePage={activePage}\r\n                onPageChange={this.onPageChange}\r\n                pointing\r\n                secondary\r\n              />\r\n            </Grid.Row>\r\n          </Grid>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  challenges: PropTypes.array.isRequired,\r\n  selectChallenge: PropTypes.func.isRequired,\r\n  currentChallengeId: PropTypes.string,\r\n  pageSize: PropTypes.number.isRequired,\r\n};\r\n\r\nChallengeList.defaultProps = {\r\n  pageSize: 10,\r\n};\r\n\r\nexport default withClient(ChallengeList);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport {Tab, Button, Icon, Input, Label, Card, Segment, Modal, Checkbox} from \"semantic-ui-react\";\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport GameList from \"./GameList\";\r\nimport CreateTournament from \"./CreateTournament\";\r\nimport TournamentList from \"./TournamentList\";\r\nimport ChallengeList, {ChallengeCard} from \"./ChallengeList\";\r\n\r\nclass UserList extends Component {\r\n  render() {\r\n    const {client, user, users, challengedUser, readyToPlayUsers, readyToPlayMeUsers} = this.props;\r\n    return (\r\n      <Card.Group style={{maxHeight: '300px', overflowY: 'auto'}}>\r\n        {users.map(otherUser => (\r\n          <UserCard\r\n            key={otherUser.id}\r\n            client={client}\r\n            user={user}\r\n            otherUser={otherUser}\r\n            challengedUser={challengedUser}\r\n            readyToPlayUsers={readyToPlayUsers}\r\n            readyToPlayMeUsers={readyToPlayMeUsers}\r\n          />\r\n        ))}\r\n      </Card.Group>\r\n    );\r\n  }\r\n}\r\n\r\nUserList.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  users: PropTypes.array.isRequired,\r\n  challengedUser: PropTypes.object,\r\n  readyToPlayUsers: PropTypes.array,\r\n  readyToPlayMeUsers: PropTypes.array,\r\n};\r\n\r\nclass ChallengeUserButton extends Component {\r\n  changeReadyToPlay = () => {\r\n    this.props.client.changeReadyToPlay(!this.props.user.readyToPlay);\r\n  };\r\n\r\n  challengeUser = () => {\r\n    this.props.client.changeReadyToPlay(this.props.user.readyToPlay === this.props.otherUser.id ? false : this.props.otherUser.id);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      client, user, otherUser,\r\n      usersInfo: {challengedUser, readyToPlay : readyToPlayUsers, readyToPlayMe : readyToPlayMeUsers},\r\n    } = this.props;\r\n    if (!client || !user || !otherUser.online) {\r\n      return null;\r\n    }\r\n\r\n    let playButtonColour, playButtonAttention, playButtonIcon, playButtonOnClick, playButtonLabel;\r\n    if (user.id === otherUser.id) {\r\n      playButtonOnClick = this.changeReadyToPlay;\r\n      if (user.readyToPlay) {\r\n        playButtonColour = 'green';\r\n        playButtonIcon = {loading: true, name: 'circle notch'};\r\n        if (challengedUser) {\r\n          playButtonLabel = `Waiting for ${challengedUser.name}...`;\r\n        } else {\r\n          playButtonLabel = 'Waiting for opponent...';\r\n        }\r\n      } else {\r\n        playButtonColour = 'yellow';\r\n        playButtonIcon = {name: 'play'};\r\n        if (readyToPlayMeUsers && readyToPlayMeUsers.length) {\r\n          if (readyToPlayMeUsers.length === 1) {\r\n            playButtonLabel = `${readyToPlayMeUsers[0].name} has challenged you`;\r\n            playButtonAttention = true;\r\n          } else {\r\n            playButtonLabel = `${readyToPlayMeUsers.length} users have challenged you`;\r\n            playButtonAttention = true;\r\n          }\r\n        } else if (readyToPlayUsers && readyToPlayUsers.length) {\r\n          if (readyToPlayUsers.length === 1) {\r\n            playButtonLabel = `Play ${readyToPlayUsers[0].name}`;\r\n          } else {\r\n            playButtonLabel = `${readyToPlayUsers.length} users ready to play`;\r\n          }\r\n        } else {\r\n          playButtonLabel = 'Play';\r\n        }\r\n      }\r\n    } else {\r\n      playButtonOnClick = this.challengeUser;\r\n      if (challengedUser && challengedUser.id === otherUser.id) {\r\n        playButtonColour = 'green';\r\n        playButtonIcon = {loading: true, name: 'circle notch'};\r\n        playButtonLabel = `Waiting for ${otherUser.name}...`;\r\n      } else {\r\n        playButtonColour = 'yellow';\r\n        playButtonIcon = {name: 'play'};\r\n        if (otherUser.readyToPlay === user.id) {\r\n          playButtonLabel = `${otherUser.name} has challenged you`;\r\n          playButtonAttention = true;\r\n        } else if (otherUser.readyToPlay === true) {\r\n          playButtonLabel = `${otherUser.name} is ready to Play`;\r\n        } else {\r\n          playButtonLabel = `Challenge ${otherUser.name}`;\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Button\r\n        className={classNames({attention: playButtonAttention})}\r\n        color={playButtonColour}\r\n        onClick={playButtonOnClick}\r\n      >\r\n        <Icon {...playButtonIcon} />\r\n        {playButtonLabel}\r\n      </Button>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeUserButton.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object.isRequired,\r\n  usersInfo: PropTypes.object.isRequired,\r\n};\r\n\r\nChallengeUserButton = withClient(ChallengeUserButton);\r\n\r\nclass UserCard extends Component {\r\n  render() {\r\n    const {client, user, otherUser} = this.props;\r\n\r\n    return (\r\n      <Card>\r\n        <Card.Content>\r\n          <HashedIcon floated={'right'} size={'mini'} hash={otherUser.id} />\r\n          <Card.Header>\r\n            {otherUser.name}\r\n            {\" \"}\r\n            {client && user && user.id === otherUser.id ? (\r\n              <EditUser client={client} user={user} trigger={<Label as={'a'} icon={'edit'} content={'Edit'}/>} />\r\n            ) : null}\r\n          </Card.Header>\r\n          <Card.Meta>\r\n            {user && otherUser.id === user.id ? <Label><Icon name={\"user\"} color={\"green\"} />Me</Label> : null}\r\n            {\" \"}\r\n            {user && otherUser.id === user.id ? <EditUser client={client} user={user} trigger={<Label as={'a'}><Icon name={\"lock\"} color={user.hasPassword ? \"green\" : \"red\"} />{user.hasPassword ? '' : 'No password'}</Label>} /> : null}\r\n            {\" \"}\r\n            {otherUser.readyToPlay ? <Label><Icon loading name={\"circle notch\"} color={\"green\"} />Ready</Label> : null}\r\n            {\" \"}\r\n            {otherUser.online ? <Label><Icon name={\"circle\"} color={\"green\"} />Online</Label> : null}\r\n            {\" \"}\r\n            <Label\r\n              title={`${otherUser.isUserRatingProvisional ? 'Provisional - ' : ''}Won ${otherUser.winCount} out of ${otherUser.gameCount}`}\r\n              color={{1: 'yellow', 2: 'grey', 3: 'brown'}[otherUser.rank]}\r\n            >\r\n              <Icon\r\n                name={otherUser.isUserRatingProvisional ? \"question\" : \"star outline\"}\r\n                color={otherUser.isUserRatingProvisional ? \"orange\" : undefined}\r\n              />\r\n              {\" \"}{otherUser.score}\r\n            </Label>\r\n            {\" \"}\r\n            <Label icon={'trophy'} content={` ${otherUser.winCount}/${otherUser.gameCount}`} />\r\n            {\" \"}\r\n            {otherUser.tournamentWinCount ? (\r\n              <Label\r\n                icon={{name: 'sitemap', color: 'yellow'}}\r\n                content={otherUser.tournamentWinCount}\r\n                title={`Won ${otherUser.tournamentWinCount}/${otherUser.tournamentCount} tournaments entered`}\r\n              />\r\n              ) : null}\r\n          </Card.Meta>\r\n        </Card.Content>\r\n        {client && user && otherUser.online ? <Card.Content extra>\r\n          <div className='ui two buttons'>\r\n            <ChallengeUserButton otherUser={otherUser} />\r\n          </div>\r\n        </Card.Content> : null}\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nUserCard.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object.isRequired,\r\n  changeReadyToPlay: PropTypes.func,\r\n  challengedUser: PropTypes.object,\r\n  readyToPlayUsers: PropTypes.array,\r\n  readyToPlayMeUsers: PropTypes.array,\r\n};\r\n\r\nclass EditUser extends Component {\r\n  state = {\r\n    user: this.props.user,\r\n    username: this.props.user.name,\r\n    password: '',\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.user !== state.user) {\r\n      return {\r\n        user: props.user,\r\n        username: props.user ? props.user.name : null,\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  changeUsername = ({target: {value}}) => {\r\n    this.setState({username: value});\r\n  };\r\n\r\n  changePassword = ({target: {value}}) => {\r\n    this.setState({password: value});\r\n  };\r\n\r\n  updateUsername = () => {\r\n    this.props.client.changeUsername(this.state.username);\r\n  };\r\n\r\n  updatePassword = () => {\r\n    this.props.client.changePassword(this.state.password);\r\n    this.setState({password: ''});\r\n  };\r\n\r\n  render() {\r\n    const {username, password} = this.state;\r\n    const {user, trigger} = this.props;\r\n\r\n    return (\r\n      <Modal\r\n        trigger={trigger}\r\n        size={'small'}\r\n        header={'Edit user'}\r\n        content={(\r\n          <Segment>\r\n            <Input label={'Name'} value={username} onChange={this.changeUsername} action={{content: 'Change', onClick: this.updateUsername}} />\r\n            <br />\r\n            <Input label={{content: user.hasPassword ? 'Password is set' : 'Set a password', color: user.hasPassword ? 'green' : 'red'}} value={password} onChange={this.changePassword} action={{content: 'Change', color: user.hasPassword ? undefined : 'green', onClick: this.updatePassword}} />\r\n          </Segment>\r\n        )}\r\n        actions={[\r\n          {key: 'cancel', negative: true, content: 'Cancel'},\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditUser.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object.isRequired,\r\n  trigger: PropTypes.node.isRequired,\r\n};\r\n\r\nexport class LogIn extends Component {\r\n  state = {\r\n    username: '',\r\n    password: '',\r\n    mergeUsers: false,\r\n  };\r\n\r\n  changeUsername = ({target: {value}}) => {\r\n    this.setState({username: value});\r\n  };\r\n\r\n  changePassword = ({target: {value}}) => {\r\n    this.setState({password: value});\r\n  };\r\n\r\n  changeMergeUsers = ({target: {checked}}) => {\r\n    this.setState({mergeUsers: checked});\r\n  };\r\n\r\n  logIn = () => {\r\n    this.props.client.logIn(this.state.username, this.state.password, this.mergeUsers);\r\n    this.setState({username: '', password: ''});\r\n  };\r\n\r\n  render() {\r\n    const {username, password, mergeUsers} = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        ref={this.modal}\r\n        trigger={<Label as={'a'} icon={'sign in'} content={'Log In'} float={'left'} />}\r\n        size={'small'}\r\n        header={'Log In'}\r\n        content={(\r\n          <Segment>\r\n            <Input label={'Name'} value={username} onChange={this.changeUsername}/>\r\n            <br />\r\n            <Input label={'Password'} value={password} onChange={this.changePassword} />\r\n            <br />\r\n            <Checkbox\r\n              label={'Merge users'}\r\n              checked={mergeUsers}\r\n              onChange={this.changeMergeUsers}\r\n            />\r\n          </Segment>\r\n        )}\r\n        actions={[\r\n          {key: 'cancel', negative: true, content: 'Cancel'},\r\n          {key: 'logIn', positive: true, content: 'Log In', onClick: this.logIn},\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nLogIn.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nexport class LogOut extends Component {\r\n  logOut = () => {\r\n    this.props.client.logOut();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Label as={'a'} icon={'log out'} content={'Log Out'} onClick={this.logOut} />\r\n    );\r\n  }\r\n}\r\n\r\nLogOut.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nclass Lobby extends Component {\r\n  changeReadyToPlay = () => {\r\n    this.props.client.changeReadyToPlay(!this.props.user.readyToPlay);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      client, user,\r\n      usersInfo: {byId: usersById, users, online, offline, challengedUser, readyToPlay, readyToPlayMe},\r\n      gamesInfo: {myLive, otherLive, myFinished, otherFinished}, selectLiveGame, selectLiveTournament,\r\n      challengesInfo: {otherUnsolved, challenges, otherStarted, otherNotStarted, otherSolved},\r\n      tournamentsInfo,\r\n    } = this.props;\r\n    const {byId: tournamentsById} = tournamentsInfo;\r\n\r\n    if (!user) {\r\n      return <Tab.Pane>Connecting to server...</Tab.Pane>;\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group centered>\r\n          {user ? (\r\n            <UserCard\r\n              client={client}\r\n              otherUser={user}\r\n              user={user}\r\n              challengedUser={challengedUser}\r\n              readyToPlayUsers={readyToPlay}\r\n              readyToPlayMeUsers={readyToPlayMe}\r\n            />\r\n          ) : null}\r\n          {otherUnsolved.length ? (\r\n            <ChallengeCard\r\n              user={user}\r\n              usersById={usersById}\r\n              challenge={otherUnsolved[0]}\r\n              selectChallenge={this.props.selectLiveChallenge}\r\n              currentChallengeId={null}\r\n            />\r\n          ) : null}\r\n        </Card.Group>\r\n        <Segment>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {key: 'my-live', label: \"My Live games\", items: myLive, color: 'green'},\r\n            {key: 'other-live', label: \"Other Live games\", items: otherLive, color: 'green'},\r\n            {key: 'my-past', label: \"My Past games\", items: myFinished},\r\n            {key: 'other-past', label: \"Other Past games\", items: otherFinished},\r\n          ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n            {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n              <GameList user={user} usersById={usersById} tournamentsById={tournamentsById} games={items} selectLiveGame={selectLiveGame} />\r\n            )}\r\n          ))} />\r\n        </Segment>\r\n        {challenges ? (<Segment>\r\n          <Tab menu={{pointing: true}} panes={(() => {\r\n            let challengesList = [\r\n              {key: 'other-started', label: \"Started Challenges\", items: otherStarted, color: 'green'},\r\n              {key: 'other-not-started', label: \"New Challenges\", items: otherNotStarted},\r\n              {key: 'other-solved', label: \"Solved Challenges\", items: otherSolved},\r\n            ].filter(({items}) => items.length);\r\n            if (!challengesList.length) {\r\n              challengesList = [\r\n                {key: 'challenges', label: \"Challenges\", items: challenges},\r\n              ];\r\n            }\r\n            return challengesList;\r\n          })().map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                  <ChallengeList selectChallenge={this.props.selectLiveChallenge} challenges={items} />\r\n                )}\r\n            ))\r\n          } />\r\n        </Segment>) : null}\r\n        <Segment>\r\n          <CreateTournament />\r\n          <br/><br/>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {key: 'my-live', label: \"My Future & Running tournaments\", items: tournamentsInfo.myFutureAndLive, color: 'green'},\r\n            {key: 'other-live', label: \"Other Future and Running tournaments\", items: tournamentsInfo.otherFutureAndLive, color: 'green'},\r\n            {key: 'my-past', label: \"My Past tournaments\", items: tournamentsInfo.myFinished},\r\n            {key: 'other-past', label: \"Other Past tournaments\", items: tournamentsInfo.otherFinished},\r\n          ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n            {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n              <TournamentList\r\n                user={user}\r\n                usersById={usersById}\r\n                tournaments={items}\r\n                selectLiveTournament={selectLiveTournament}\r\n              />\r\n            )}\r\n          ))} />\r\n        </Segment>\r\n        <Segment>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {key: 'online', label: \"Online Users\", items: online, color: 'green'},\r\n            {key: 'offline', label: \"Offline Users\", items: offline},\r\n            {key: 'all', label: \"All Users\", items: users},\r\n          ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n            {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n              <UserList\r\n                client={client}\r\n                users={items}\r\n                user={user}\r\n                challengedUser={challengedUser}\r\n                readyToPlayUsers={readyToPlay}\r\n                readyToPlayMeUsers={readyToPlayMe}\r\n              />\r\n            )}\r\n          ))} />\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nLobby.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  challengesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  selectLiveChallenge: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withClient(Lobby);\r\n\r\nexport {\r\n  ChallengeUserButton,\r\n  EditUser,\r\n};\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport '../styles/play.css';\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport {\r\n  Button,\r\n  Checkbox,\r\n  Grid,\r\n  Header,\r\n  Label,\r\n  Menu,\r\n  Modal,\r\n  Pagination, Responsive,\r\n  Segment,\r\n  Statistic\r\n} from \"semantic-ui-react\";\r\nimport classNames from 'classnames';\r\nimport {BoardTransformation} from \"./Board/Board\";\r\nimport keydown, {Keys} from \"react-keydown\";\r\nimport PlayerColourBoard from \"./Board/PlayerColourBoard\";\r\nimport {ChallengeUserButton} from \"./Lobby\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass Play extends Component {\r\n  static MOVE_TYPE_NAMES = {\r\n    [Game.MOVE_TYPE_PLACE_FIRST_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_PLACE_SECOND_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: \"Select a worker\",\r\n    [Game.MOVE_TYPE_MOVE_FIRST_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_MOVE_SECOND_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_BUILD_AROUND_WORKER]: \"Build\",\r\n  };\r\n\r\n  state = {\r\n    selectedGame: null,\r\n    game: this.props.game,\r\n    transformation: null,\r\n  };\r\n\r\n  autoSubmitModal = React.createRef();\r\n\r\n  makeMove = game => {\r\n    if (this.props.submit) {\r\n      this.setState({game})\r\n    } else {\r\n      this.props.makeMove(game);\r\n    }\r\n    if (this.props.onDisplayPositionChange) {\r\n      this.props.onDisplayPositionChange(game);\r\n    }\r\n  };\r\n\r\n  takeMoveBack = () => {\r\n    this.makeMove(this.state.game.takeMoveBack());\r\n  };\r\n\r\n  undo = () => {\r\n    this.makeMove(this.state.game.undo());\r\n  };\r\n\r\n  newGame = () => {\r\n    this.makeMove(Game.create());\r\n  };\r\n\r\n  selectGame = game => {\r\n    const selectedGame = game === this.state.game ? null : game;\r\n    this.setState({selectedGame});\r\n    if (this.props.onSelectedGameChange) {\r\n      this.props.onSelectedGameChange(selectedGame);\r\n    }\r\n  };\r\n\r\n  makeMoveToSelected = game => {\r\n    this.selectGame(game);\r\n  };\r\n\r\n  takeMoveBackToSelected = () => {\r\n    this.selectGame(this.state.selectedGame.takeMoveBack());\r\n  };\r\n\r\n  undoToSelected = () => {\r\n    this.selectGame(this.state.selectedGame.undo());\r\n  };\r\n\r\n  deselectGame = () => {\r\n    this.selectGame(null);\r\n  };\r\n\r\n  submit = () => {\r\n    const moves = this.getMovesToSubmit();\r\n    if (moves.length) {\r\n      this.props.submit(moves, this.state.game);\r\n    }\r\n  };\r\n\r\n  getMovesToSubmit() {\r\n    const {game: propsGame} = this.props;\r\n    const {game: stateGame} = this.state;\r\n    const history = stateGame.fullHistory;\r\n    const propsGameIndex = history.findIndex(\r\n      game => game.compressedFullNotation === propsGame.compressedFullNotation);\r\n    if (propsGameIndex < 0) {\r\n      console.error(\"Could not find live game in history\");\r\n      return [];\r\n    }\r\n    const newHistory = history.slice(propsGameIndex + 1);\r\n    const moves = newHistory.map(game => game.lastMove);\r\n\r\n    return moves;\r\n  }\r\n\r\n  resignOrAbort = () => {\r\n    this.props.submit(\"resign\");\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props.game !== prevProps.game) {\r\n      const gameChanged = (\r\n        !this.props.game\r\n        || !prevProps.game\r\n        || this.props.game.compressedFullNotation !== prevProps.game.compressedFullNotation\r\n        || this.props.game.positionNotation !== prevProps.game.positionNotation\r\n      );\r\n      if (gameChanged) {\r\n        this.selectGame(null);\r\n        this.setState({game: this.props.game, resigning: false});\r\n      }\r\n    }\r\n    if (this.props.user && this.props.user.settings.autoSubmitMoves) {\r\n      if (!this.canSubmit(prevProps, prevState) && this.canSubmit()) {\r\n        this.submit();\r\n      }\r\n    }\r\n  }\r\n\r\n  changeAutoSubmitMoves = () => {\r\n    if (!this.props.user.settings.autoSubmitMoves) {\r\n      this.autoSubmitModal.current.handleOpen();\r\n    } else {\r\n      this.props.changeSettings({...this.props.user.settings, autoSubmitMoves: false});\r\n    }\r\n  };\r\n\r\n  doAutoSubmitMoves = () => {\r\n    this.props.changeSettings({...this.props.user.settings, autoSubmitMoves: true});\r\n    if (this.canSubmit()) {\r\n      this.submit();\r\n    }\r\n  };\r\n\r\n  canSubmit(props = this.props, state = this.state) {\r\n    const {submit} = props;\r\n    const {selectedGame, game} = state;\r\n    return (\r\n      !!submit\r\n      && !selectedGame\r\n      && game !== props.game\r\n      && !!this.getMovesToSubmit().length\r\n      && (\r\n        game.finished\r\n        || game.nextPlayer !== props.game.nextPlayer\r\n      )\r\n    );\r\n  }\r\n\r\n  onTransformationChange = ({transformation}) => {\r\n    this.setState({transformation});\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      user, defaultSettings, names, allowControl, matchGame, children, usersInfo: {byId: usersById},\r\n    } = this.props;\r\n    const {selectedGame, game, transformation} = this.state;\r\n    const displayGame = selectedGame || game;\r\n    const isMyGame = allowControl.length > 0;\r\n    const canSubmit = this.canSubmit();\r\n    const tooShortToResign = matchGame ? matchGame.tooShortToResign : false;\r\n    const settings = user ? user.settings : defaultSettings;\r\n  \tconst isPlayerBOpponent = allowControl.includes(Game.PLAYER_A);\r\n    const canUndo = !selectedGame && (this.props.submit ? game.chainCount > this.props.game.chainCount : game.canUndo);\r\n    const canTakeBack = !this.props.submit && !selectedGame && game.previous;\r\n\r\n  \tconst controlsNode = (\r\n  \t  <Fragment>\r\n        <Grid.Row>\r\n          <PlayPlayer\r\n            player={isPlayerBOpponent ? Game.PLAYER_A : Game.PLAYER_B}\r\n            playerUser={matchGame ? usersById[matchGame.userIds[isPlayerBOpponent ? 0 : 1]] : null}\r\n            canSubmit={canSubmit}\r\n            canAnyPlayerSubmit={canSubmit}\r\n            canUndo={canUndo}\r\n            canTakeBack={canTakeBack}\r\n            submit={this.props.submit ? this.submit : null}\r\n            undo={this.props.submit ? this.takeMoveBack : this.undo}\r\n            takeBack={this.takeMoveBack}\r\n            changeAutoSubmitMoves={this.changeAutoSubmitMoves}\r\n            game={game}\r\n            settings={settings}\r\n            names={names}\r\n            allowControl={allowControl}\r\n          />\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <PlayPlayer\r\n            player={isPlayerBOpponent ? Game.PLAYER_B : Game.PLAYER_A}\r\n            playerUser={matchGame ? usersById[matchGame.userIds[isPlayerBOpponent ? 1 : 0]] : null}\r\n            canSubmit={false}\r\n            canAnyPlayerSubmit={canSubmit}\r\n            canUndo={canUndo}\r\n            canTakeBack={canTakeBack}\r\n            submit={this.props.submit ? this.submit : null}\r\n            undo={this.props.submit ? this.takeMoveBack : this.undo}\r\n            takeBack={this.takeMoveBack}\r\n            changeAutoSubmitMoves={this.changeAutoSubmitMoves}\r\n            game={game}\r\n            settings={settings}\r\n            names={names}\r\n            allowControl={allowControl}\r\n          />\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <PlayNavigation game={game} selectedGame={selectedGame} selectGame={this.selectGame} />\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <BoardTransformation onChange={this.onTransformationChange} />\r\n        </Grid.Row>\r\n        {children}\r\n      </Fragment>\r\n    );\r\n  \tconst boardNode = (\r\n      <Board\r\n        game={displayGame}\r\n        transformation={transformation}\r\n        makeMove={selectedGame ? this.makeMoveToSelected : this.makeMove}\r\n        minChainCount={displayGame === game ? (\r\n          this.props.submit ? this.props.game.chainCount : (\r\n            this.props.game.canUndo ? this.props.game.previous.chainCount : this.props.game.chainCount\r\n          )\r\n        ) : 0}\r\n        allowControl={displayGame === game ? allowControl : undefined}\r\n        settings={settings}\r\n        animated={settings.theme.animations}\r\n        showArrows={settings.theme.arrows}\r\n      />\r\n    );\r\n\r\n    return (\r\n      <Fragment>\r\n        <Segment style={{textAlign: \"center\"}}>\r\n          <Grid centered columns={'equal'} textAlign={'center'}>\r\n            <Responsive as={Grid.Row} minWidth={800}>\r\n              <Grid.Column>{controlsNode}</Grid.Column>\r\n              <Grid.Column>{boardNode}</Grid.Column>\r\n            </Responsive>\r\n            <Responsive as={Fragment} maxWidth={800}>\r\n              <Grid.Row>\r\n                <Grid.Column stretched={false} textAlign={'center'}>\r\n                  {boardNode}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column stretched={false} textAlign={'center'}>\r\n                  {controlsNode}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n            </Responsive>\r\n          </Grid>\r\n        </Segment>\r\n        {this.props.submit && isMyGame ? (\r\n          <Segment>\r\n            <Statistic.Group widths={\"two\"} size={\"tiny\"}>\r\n              <Statistic value={\r\n                <Modal\r\n                  trigger={<Button negative disabled={!!selectedGame || this.props.game.finished}>{tooShortToResign ? 'Abort' : 'Resign'}</Button>}\r\n                  header={tooShortToResign ? 'Abort?' : 'Resign?'}\r\n                  content={`Are you sure you want to ${tooShortToResign ? 'abort' : 'forfeit'}?${tooShortToResign ? ' This game is too short to resign.' : ''}`}\r\n                  actions={[{key: 'resign', content: tooShortToResign ? 'Abort' : 'Resign', negative: true, onClick: this.resignOrAbort}, { key: 'continue', content: 'Continue', inverted: true, secondary: true }]}\r\n                />\r\n              } />\r\n              <Statistic value={<Button negative onClick={this.props.submit ? this.takeMoveBack : this.undo} disabled={!canUndo}>Undo</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        {!this.props.submit ? (\r\n          <Segment>\r\n            <Statistic.Group widths={\"two\"} size={\"small\"}>\r\n              <Statistic value={<Button negative onClick={this.takeMoveBack} disabled={!canTakeBack}>Take Back a Move</Button>}/>\r\n              <Statistic value={<Button negative onClick={this.newGame} disabled={!!selectedGame || !game.previous}>New Game</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        <PlayHistory\r\n          game={game}\r\n          selectedGame={selectedGame}\r\n          selectGame={this.selectGame}\r\n          user={user}\r\n          defaultSettings={defaultSettings}\r\n        />\r\n        {selectedGame ? (\r\n          <Segment textAlign={\"center\"}>\r\n            <Header as={\"h2\"}>Reviewing previous move</Header>\r\n            <Statistic.Group widths={\"three\"} size={\"small\"}>\r\n              {selectedGame.finished ? (\r\n                <Statistic color={\"green\"} value={names[selectedGame.winner]} label={\"Won!\"} />\r\n              ) : (\r\n                <Statistic value={names[selectedGame.nextPlayer]} label={this.constructor.MOVE_TYPE_NAMES[selectedGame.moveType]} />\r\n              )}\r\n              <Statistic value={selectedGame.moveCount} label={\"Move\"} />\r\n              <Statistic value={<Button negative onClick={this.undoToSelected} disabled={!selectedGame.canUndo}>Undo</Button>} />\r\n            </Statistic.Group>\r\n            <Statistic.Group widths={\"two\"} size={\"small\"}>\r\n              <Statistic value={<Button negative onClick={this.takeMoveBackToSelected} disabled={!selectedGame.previous}>Take Back a Move</Button>}/>\r\n              <Statistic value={<Button negative onClick={this.deselectGame}>Stop reviewing</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        <Modal\r\n          ref={this.autoSubmitModal}\r\n          header={'Auto submit moves'}\r\n          content={'Are you sure you want to be auto submitting your moves?'}\r\n          actions={[\r\n            {key: 'yes', content: 'Auto submit', onClick: this.doAutoSubmitMoves, primary: true},\r\n            {key: 'no', content: 'No, manually submit moves', secondary: true},\r\n          ]}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nPlay.propTypes = {\r\n  user: PropTypes.object,\r\n  defaultSettings: PropTypes.object.isRequired,\r\n  otherUser: PropTypes.object,\r\n  settings: PropTypes.object,\r\n  changeSettings: PropTypes.func,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  matchGame: PropTypes.object,\r\n  makeMove: PropTypes.func,\r\n  submit: PropTypes.func,\r\n  challengeUser: PropTypes.func,\r\n  stopChallengeUser: PropTypes.func,\r\n  challengedUser: PropTypes.object,\r\n  names: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  children: PropTypes.node,\r\n  onSelectedGameChange: PropTypes.func,\r\n  onDisplayPositionChange: PropTypes.func,\r\n  usersInfo: PropTypes.object.isRequired,\r\n};\r\n\r\nPlay.defaultProps = {\r\n  names: {\r\n    [Game.PLAYER_A]: \"Player A\",\r\n    [Game.PLAYER_B]: \"Player B\",\r\n  },\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n};\r\n\r\nPlay = withClient(Play);\r\n\r\nclass PlayPlayer extends Component {\r\n  static MOVE_TYPE_NAMES = {\r\n    [Game.MOVE_TYPE_PLACE_FIRST_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_PLACE_SECOND_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: \"Select a worker\",\r\n    [Game.MOVE_TYPE_MOVE_FIRST_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_MOVE_SECOND_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_BUILD_AROUND_WORKER]: \"Build\",\r\n  };\r\n\r\n  submitAndDisableConfirm = () => {\r\n    this.props.submit();\r\n    this.props.client.updateSettings({...this.props.user.settings, confirmSubmitMoves: false});\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      game, player, allowControl, names, settings, changeAutoSubmitMoves, playerUser,\r\n      canSubmit, canAnyPlayerSubmit, canUndo, canTakeBack, submit, undo, takeBack,\r\n    } = this.props;\r\n    const isPlayerControlled = allowControl.includes(player);\r\n    const previousGame = canAnyPlayerSubmit ? game.previous : game;\r\n    const isPlayersTurn = previousGame.nextPlayer === player;\r\n    const playerWon = previousGame.winner === player;\r\n    const finished = previousGame.finished;\r\n\r\n    return (\r\n      <Menu\r\n        stackable\r\n        className={classNames({attention: !finished && isPlayerControlled && isPlayersTurn && !canSubmit})}\r\n        size={'massive'}\r\n        inverted={finished || player === Game.PLAYER_B}\r\n        color={finished ? (playerWon ? 'green' : 'red') : undefined}\r\n        items={[\r\n          {key: 'icon',\r\n            icon: finished ? (playerWon ? 'trophy' : 'thumbs down') : (isPlayersTurn ? 'play' : 'hourglass'),\r\n            content: (\r\n              <Fragment>\r\n                <PlayerColourBoard medium settings={settings} player={player} allowControl={allowControl} />\r\n                {names[player]}\r\n              </Fragment>\r\n            )},\r\n          {key: 'instructions', content: (\r\n            finished\r\n              ? (playerWon ? 'Won' : 'Lost')\r\n              : (\r\n                canSubmit\r\n                  ? (\r\n                    settings.autoSubmitMoves\r\n                      ? 'Auto-submitting'\r\n                      : (\r\n                        <Fragment>\r\n                          {settings.confirmSubmitMoves ? (\r\n                            <Modal\r\n                              size={'mini'}\r\n                              trigger={\r\n                                <Button\r\n                                  positive\r\n                                  className={'attention'}\r\n                                >\r\n                                  Preview\r\n                                </Button>\r\n                              }\r\n                              header={'Submit move'}\r\n                              content={\r\n                                <Modal.Content>\r\n                                  Are you sure you want to submit these moves?\r\n                                  <br />\r\n                                  <Board\r\n                                    game={game}\r\n                                    medium\r\n                                    settings={settings}\r\n                                    animated\r\n                                    showArrows\r\n                                  />\r\n                                </Modal.Content>\r\n                              }\r\n                              actions={[\r\n                                {key: 'never-ask-again', content: 'Never ask again', onClick: this.submitAndDisableConfirm},\r\n                                {key: 'cancel', negative: true, content: 'Cancel'},\r\n                                {key: 'ok', positive: true, content: 'Submit', onClick: submit},\r\n                              ]}\r\n                            />\r\n                          ) : (\r\n                            <Button\r\n                              positive\r\n                              className={'attention'}\r\n                              onClick={submit}\r\n                            >\r\n                              Submit\r\n                            </Button>\r\n                          )}\r\n                          {isPlayerControlled && canUndo ? (\r\n                            <Fragment>\r\n                              {\" or \"}<Button negative content={'Undo'} disabled={!canUndo} onClick={undo} />\r\n                            </Fragment>\r\n                          ) : null}\r\n                        </Fragment>\r\n                      )\r\n                  ) : (\r\n                    isPlayersTurn\r\n                      ? (\r\n                        isPlayerControlled && canUndo\r\n                          ? (\r\n                            <Fragment>\r\n                              {this.constructor.MOVE_TYPE_NAMES[previousGame.moveType]}\r\n                              {\" or \"}<Button negative content={'Undo'} disabled={!canUndo} onClick={undo} />\r\n                            </Fragment>\r\n                          )\r\n                          : this.constructor.MOVE_TYPE_NAMES[previousGame.moveType]\r\n                      )\r\n                      : `Waiting for ${names[Game.OTHER_PLAYER[player]]}`\r\n                  )\r\n              )\r\n          )},\r\n          !canUndo && canTakeBack && !isPlayersTurn ? (\r\n            <Button negative content={'Take move back'} onClick={takeBack} />\r\n          ) : null,\r\n          !finished && submit && allowControl.includes(player) ? {\r\n            key: 'auto-submit', content: (\r\n              <Checkbox\r\n                label={'Auto submit moves'}\r\n                toggle\r\n                checked={settings.autoSubmitMoves}\r\n                onChange={changeAutoSubmitMoves}\r\n              />\r\n            )\r\n          } : null,\r\n          finished && playerUser && playerUser.online ? {\r\n            key: 'challenge', content: (\r\n              <ChallengeUserButton otherUser={playerUser} />\r\n            ),\r\n          } : null,\r\n        ].filter(item => item)}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nPlayPlayer.propTypes = {\r\n  settings: PropTypes.object,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  names: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  player: PropTypes.oneOf(Game.PLAYERS).isRequired,\r\n  playerUser: PropTypes.object,\r\n  canSubmit: PropTypes.bool.isRequired,\r\n  canAnyPlayerSubmit: PropTypes.bool.isRequired,\r\n  canUndo: PropTypes.bool.isRequired,\r\n  canTakeBack: PropTypes.bool.isRequired,\r\n  submit: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  takeBack: PropTypes.func,\r\n  changeAutoSubmitMoves: PropTypes.func.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nPlayPlayer = withClient(PlayPlayer);\r\n\r\nclass PlayHistory extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {game, selectedGame, user, defaultSettings, selectGame, pageSize, moveNotation} = this.props;\r\n    const {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil((game.history.length - 1) / pageSize);\r\n    const visibleGames = [...game.history]\r\n      .slice(1 + (totalPages - activePage) * pageSize, 1 + (totalPages - activePage) * pageSize + pageSize)\r\n      .reverse();\r\n    const lastVisibleGame = visibleGames[visibleGames.length - 1];\r\n\r\n    return (\r\n      <Segment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <PlayNavigation game={game} selectedGame={selectedGame} selectGame={selectGame} />\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            {visibleGames.map(previousGame => (\r\n              <Fragment key={previousGame.chainCount}>\r\n                {previousGame.moveCount % 2 === 1 ? (\r\n                  <Label content={previousGame.moveCount - 1} />\r\n                ) : null}\r\n                <Board\r\n                  game={previousGame}\r\n                  small\r\n                  onSelect={selectGame}\r\n                  selected={previousGame === selectedGame}\r\n                  settings={user ? user.settings : defaultSettings}\r\n                />\r\n                {moveNotation ? (\r\n                  <Label color={'green'}>\r\n                    {previousGame.lastMovesInHistory.map(({x, y, resign}) => resign\r\n                      ? 'R' : `${['A', 'B', 'C', 'D', 'E'][x]}${y + 1}`).join('/')}\r\n                  </Label>\r\n                ) : null}\r\n              </Fragment>\r\n            ))}\r\n            {lastVisibleGame && (lastVisibleGame.moveCount % 2 === 0) ? (\r\n              <Label content={lastVisibleGame.moveCount - 2} />\r\n            ) : null}\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Pagination\r\n              totalPages={totalPages}\r\n              activePage={activePage}\r\n              onPageChange={this.onPageChange}\r\n              pointing\r\n              secondary\r\n            />\r\n          </Grid.Row>\r\n        </Grid>\r\n      </Segment>\r\n    );\r\n  }\r\n}\r\n\r\nPlayHistory.propTypes = {\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  selectedGame: PropTypes.instanceOf(Game),\r\n  user: PropTypes.object,\r\n  defaultSettings: PropTypes.object.isRequired,\r\n  selectGame: PropTypes.func,\r\n  pageSize: PropTypes.number.isRequired,\r\n  moveNotation: PropTypes.bool.isRequired,\r\n};\r\n\r\nPlayHistory.defaultProps = {\r\n  pageSize: 10,\r\n  moveNotation: false,\r\n};\r\n\r\nclass PlayNavigation extends Component {\r\n  static keys = [\r\n    'left', 'right', 'shift+left', 'shift+right', 'home', 'end',\r\n  ];\r\n\r\n  componentWillReceiveProps({keydown}) {\r\n    if (keydown.event) {\r\n      const {which, shiftKey} = keydown.event;\r\n      if (which === Keys.left && shiftKey) {\r\n        this.goToCurrentMove();\r\n      } else if (which === Keys.home) {\r\n        this.goToCurrentMove();\r\n      } else if (which === Keys.left && !shiftKey) {\r\n        this.goToNextMove();\r\n      } else if (which === Keys.right && !shiftKey) {\r\n        this.goToPreviousMove();\r\n      } else if (which === Keys.right && shiftKey) {\r\n        this.goToFirstMove();\r\n      } else if (which === Keys.home) {\r\n        this.goToFirstMove();\r\n      }\r\n    }\r\n  }\r\n\r\n  get gameIndexes() {\r\n    const {game, selectedGame} = this.props;\r\n    const selectedGameIndex = game.history.indexOf(selectedGame || game);\r\n    let mostRecentAncestorGameIndex = selectedGameIndex;\r\n    let ancestor = selectedGame;\r\n    while (mostRecentAncestorGameIndex === -1 && ancestor) {\r\n      ancestor = ancestor.previousInHistory;\r\n      mostRecentAncestorGameIndex = game.history.indexOf(ancestor);\r\n    }\r\n    const lastGameIndex = game.history.length - 1;\r\n\r\n    return {selectedGameIndex, lastGameIndex, mostRecentAncestorGameIndex};\r\n  }\r\n\r\n  canGoToCurrentMove() {\r\n    const {selectedGameIndex, lastGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex !== lastGameIndex;\r\n  }\r\n\r\n  goToCurrentMove = () => {\r\n    if (!this.canGoToCurrentMove()) {\r\n      return;\r\n    }\r\n    this.props.selectGame(this.props.game);\r\n  };\r\n\r\n  canGoToNextMove() {\r\n    const {selectedGameIndex, lastGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex >= 0 && selectedGameIndex !== lastGameIndex;\r\n  }\r\n\r\n  goToNextMove = () => {\r\n    if (!this.canGoToNextMove()) {\r\n      return;\r\n    }\r\n    const selectedGameIndex = this.props.game.history.indexOf(this.props.selectedGame || this.props.game);\r\n    this.props.selectGame(this.props.game.history[selectedGameIndex + 1]);\r\n  };\r\n\r\n  goToAncestor = () => {\r\n    const {mostRecentAncestorGameIndex} = this.gameIndexes;\r\n    this.props.selectGame(this.props.game.history[mostRecentAncestorGameIndex]);\r\n  };\r\n\r\n  canGoToPreviousMove() {\r\n    const {selectedGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex >= 0 && selectedGameIndex !== 0;\r\n  }\r\n\r\n  goToPreviousMove = () => {\r\n    if (!this.canGoToPreviousMove()) {\r\n      return;\r\n    }\r\n    this.props.selectGame((this.props.selectedGame || this.props.game).previousInHistory);\r\n  };\r\n\r\n  goToPreviousVariationMove = () => {\r\n    this.props.selectGame(this.props.selectedGame.previousInHistory);\r\n  };\r\n\r\n  canGoToFirstMove() {\r\n    const {selectedGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex !== 0;\r\n  }\r\n\r\n  goToFirstMove = () => {\r\n    if (!this.canGoToFirstMove()) {\r\n      return;\r\n    }\r\n    this.props.selectGame(this.props.game.history[0]);\r\n  };\r\n\r\n  render() {\r\n    const {game, selectedGame} = this.props;\r\n    const {selectedGameIndex, mostRecentAncestorGameIndex} = this.gameIndexes;\r\n\r\n    return (\r\n      <Menu size={'massive'} items={[\r\n        {key: 'current', icon: 'fast backward', onClick: this.goToCurrentMove, disabled: !this.canGoToCurrentMove()},\r\n        ...(selectedGameIndex >= 0 ? [\r\n          {key: 'previous', icon: 'backward', onClick: this.goToNextMove, disabled: !this.canGoToNextMove()},\r\n          {key: 'moveCount', content: selectedGameIndex >= 0 ? `${(selectedGame || game).moveCount}/${game.moveCount}` : selectedGame.moveCount, disabled: game.finished},\r\n          {key: 'next', icon: 'forward', onClick: this.goToPreviousMove, disabled: !this.canGoToPreviousMove()},\r\n        ] : [\r\n          {key: 'goToAncestor', content: `Return to ${mostRecentAncestorGameIndex}/${game.moveCount}`, onClick: this.goToAncestor},\r\n        ]),\r\n        {key: 'first', icon: 'fast forward', onClick: this.goToFirstMove, disabled: !this.canGoToFirstMove()},\r\n        ...(selectedGameIndex >= 0 ? [] : [\r\n          {key: 'ancestor', content: `Variation ${selectedGame.moveCount}/${mostRecentAncestorGameIndex}`, disabled: true},\r\n          {key: 'next', icon: 'forward', onClick: this.goToPreviousVariationMove, disabled: selectedGame.moveCount <= 1},\r\n        ]),\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nPlayNavigation.propTypes = {\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  selectedGame: PropTypes.instanceOf(Game),\r\n  selectGame: PropTypes.func.isRequired,\r\n};\r\n\r\nPlayNavigation = keydown(PlayNavigation.keys)(PlayNavigation);\r\n\r\nexport default Play;\r\n","export const copyToClipboard = text => {\r\n    const textArea = document.createElement(\"textarea\");\r\n    // This won't work\r\n    // textArea.style.display = 'none'\r\n    document.body.appendChild(textArea);\r\n    textArea.value = text;\r\n    textArea.select();\r\n    document.execCommand(\"copy\");\r\n    document.body.removeChild(textArea);\r\n};\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Play from \"./Play\";\r\nimport Game from \"../game/game\";\r\nimport {Grid, Modal, Menu} from \"semantic-ui-react\";\r\nimport * as utils from \"../utils\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass Hotseat extends Component {\r\n  state = {\r\n    selectedGame: null,\r\n    error: false,\r\n    ...this.constructor.getGameAndErrorFromUrlPosition(),\r\n  };\r\n\r\n  static getGameAndErrorFromUrlPosition() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const position = params.get('position');\r\n    if (position) {\r\n      let game, error;\r\n      try {\r\n        game = Game.fromCompressedMoveNotation(position);\r\n        if (!game) {\r\n          error = 'The position was not valid';\r\n        } else {\r\n          error = null;\r\n        }\r\n      } catch (e) {\r\n        game = null;\r\n        error = 'The series of moves where not valid';\r\n      }\r\n      if (!game) {\r\n        return {game: Game.create(), error};\r\n      }\r\n      return {game, error: false};\r\n    } else {\r\n      return {game: Game.create(), error: false};\r\n    }\r\n  }\r\n\r\n  dismissUrlPositionError = () =>{\r\n    this.setState({error: null});\r\n  };\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  share = () => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const game = this.state.game;\r\n      navigator.share({\r\n        title: `Thyra Online - Game after ${game.moveCount} moves`,\r\n        text: `Review Santorini game between after ${game.moveCount} moves`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n  };\r\n\r\n  onSelectedGameChange = selectedGame => {\r\n    this.setState({selectedGame});\r\n  };\r\n\r\n  render() {\r\n    const {game, error, selectedGame} = this.state;\r\n    const {user, client} = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Modal\r\n          open={error}\r\n          size={'mini'}\r\n          onClose={this.dismissUrlPositionError}\r\n          header={'Could not load shared position'}\r\n          content={`${error}. Please check that you copied the full URL`}\r\n          actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n        />\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu inverted size={'massive'} items={[\r\n              {key: 'share', icon: 'share', content: 'Share position', color: 'green', active: true, as: 'a',\r\n                href: `?position=${(selectedGame || game).compressedFullNotation}`,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to game'}\r\n            ]} />\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Play\r\n          user={user}\r\n          defaultSettings={client.settings}\r\n          game={game}\r\n          makeMove={this.makeMove}\r\n          onSelectedGameChange={this.onSelectedGameChange}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nHotseat.propTypes = {\r\n  user: PropTypes.object,\r\n};\r\n\r\nexport default withClient(Hotseat);\r\n","import React, {Component} from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport {Checkbox, Form, Grid, Header, Label, Modal, Segment, Tab} from \"semantic-ui-react\";\r\nimport Client from \"../client/client\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport {ThemeDemoBoard} from \"./Board\";\r\n\r\nclass SettingsContent extends Component {\r\n  themeSchemeOptions = [\r\n    {value: '', label: 'Default'},\r\n    {value: 'subtle', label: 'Subtle'},\r\n    {value: 'pastel', label: 'Pastel'},\r\n    {value: 'green', label: 'Green'},\r\n  ];\r\n  themePiecesOptions = [\r\n    {value: 'pawn', label: 'Pawn'},\r\n    {value: 'king', label: 'King'},\r\n    {value: 'circle', label: 'Circle'},\r\n    {value: 'certificate', label: 'Star'},\r\n    {value: 'sun', label: 'Sun'},\r\n    {value: 'rocket', label: 'Rocket'},\r\n    {value: 'bug', label: 'Bug'},\r\n    {value: 'eye', label: 'Eye'},\r\n    {value: 'user', label: 'User'},\r\n  ];\r\n  themeNumbersOptions = [\r\n    {value: '', label: 'None'},\r\n    {value: 'obvious', label: 'Obvious'},\r\n    {value: 'subtle', label: 'Subtle'},\r\n    {value: 'very-subtle', label: 'Very subtle'},\r\n  ];\r\n\r\n  themeDemoBoard = overrides => {\r\n    const {settings: {theme}} = this.props;\r\n    return (\r\n      <ThemeDemoBoard medium settings={{theme: {...theme, animations: false, ...overrides}}}/>\r\n    );\r\n  };\r\n\r\n  updateAutoSubmitMove = (e, {checked}) => {\r\n    this.props.updateSettings({autoSubmitMoves: checked});\r\n  };\r\n\r\n  updateConfirmSubmitMoves = (e, {checked}) => {\r\n    this.props.updateSettings({confirmSubmitMoves: checked});\r\n  };\r\n\r\n  updateEnableNotifications = (e, {checked}) => {\r\n    this.props.updateSettings({enableNotifications: checked});\r\n  };\r\n\r\n  updateThemeRotateOpponent = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {rotateOpponent: checked}});\r\n  };\r\n\r\n  updateAnimations = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {animations: checked}});\r\n  };\r\n\r\n  updateArrows = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {arrows: checked}});\r\n  };\r\n\r\n  updateThemeNumbers = (e, {value}) => {\r\n    this.props.updateSettings({theme: {numbers: value}});\r\n  };\r\n\r\n  updateThemeScheme = (e, {value}) => {\r\n    this.props.updateSettings({theme: {scheme: value}});\r\n  };\r\n\r\n  updateThemePieces = (e, {value}) => {\r\n    this.props.updateSettings({theme: {pieces: value}});\r\n  };\r\n\r\n  render() {\r\n    const {settings: {autoSubmitMoves, confirmSubmitMoves, enableNotifications, theme}} = this.props;\r\n    const {pieces = 'king', scheme, rotateOpponent, animations, arrows, numbers} = theme;\r\n\r\n    return (\r\n      <Tab menu={{pointing: true, attached: false}} panes={[\r\n        {menuItem: 'Playing', render: () => (\r\n          <Segment>\r\n            <Form>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Auto-submit online moves'}\r\n                  name={'autoSubmitMoves'}\r\n                  checked={autoSubmitMoves}\r\n                  onChange={this.updateAutoSubmitMove}\r\n                />\r\n              </Form.Group>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Confirm before submitting online moves'}\r\n                  name={'confirmSubmitMoves'}\r\n                  checked={confirmSubmitMoves}\r\n                  onChange={this.updateConfirmSubmitMoves}\r\n                />\r\n              </Form.Group>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Enable notifications'}\r\n                  name={'enableNotifications'}\r\n                  checked={enableNotifications}\r\n                  onChange={this.updateEnableNotifications}\r\n                />\r\n              </Form.Group>\r\n            </Form>\r\n          </Segment>\r\n        )},\r\n        {menuItem: 'Theme', render: () => (\r\n          <Segment>\r\n            <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n              <Grid.Row>\r\n                <Grid.Column textAlign={'center'}>\r\n                  {this.themeDemoBoard({animations: theme.animations})}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Tab menu={{pointing: true, attached: false}} panes={[\r\n                  {menuItem: 'Pieces', render: () => (\r\n                    <Tab.Pane>\r\n                    <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n                      <Grid.Row>\r\n                        <Grid.Column width={4}>\r\n                          <Checkbox\r\n                            label={'Rotate Opponent'}\r\n                            name={'theme.rotateOpponent'}\r\n                            checked={rotateOpponent}\r\n                            onChange={this.updateThemeRotateOpponent}\r\n                          />\r\n                        </Grid.Column>\r\n                        <Grid.Column floated={'right'} textAlign={'right'}>\r\n                          {this.themeDemoBoard({rotateOpponent: true})}\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      <Grid.Row>\r\n                        <Grid.Column width={4}>\r\n                          <Checkbox\r\n                            label={'Animation'}\r\n                            name={'theme.animations'}\r\n                            checked={animations}\r\n                            onChange={this.updateAnimations}\r\n                          />\r\n                        </Grid.Column>\r\n                        <Grid.Column floated={'right'} textAlign={'right'}>\r\n                          {this.themeDemoBoard({animations: true})}\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      <Grid.Row>\r\n                        <Grid.Column width={4}>\r\n                          <Checkbox\r\n                            label={'Arrows'}\r\n                            name={'theme.arrows'}\r\n                            checked={arrows}\r\n                            onChange={this.updateArrows}\r\n                          />\r\n                        </Grid.Column>\r\n                        <Grid.Column floated={'right'} textAlign={'right'}>\r\n                          {this.themeDemoBoard({arrows: true})}\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      <Grid.Row>\r\n                        <Grid.Column textAlign={'center'}>\r\n                          <Form.Field><Header as={'h2'}>Pieces:</Header></Form.Field>\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      {this.themePiecesOptions.map(option => (\r\n                        <Grid.Row key={`theme-pieces-${option.value}`}>\r\n                          <Grid.Column width={4}>\r\n                            <Checkbox\r\n                              radio\r\n                              label={option.label}\r\n                              name={'theme.pieces'}\r\n                              value={option.value}\r\n                              checked={pieces === option.value}\r\n                              onChange={this.updateThemePieces}\r\n                            />\r\n                          </Grid.Column>\r\n                          <Grid.Column floated={'right'} textAlign={'right'}>\r\n                            {this.themeDemoBoard({pieces: option.value})}\r\n                          </Grid.Column>\r\n                        </Grid.Row>\r\n                      ))}\r\n                    </Grid>\r\n                  </Tab.Pane>\r\n                  )},\r\n                  {menuItem: 'Board', render: () => (\r\n                    <Tab.Pane>\r\n                      <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n                        {this.themeSchemeOptions.map(option => (\r\n                          <Grid.Row key={`theme-scheme-${option.value}`}>\r\n                            <Grid.Column width={4}>\r\n                              <Checkbox\r\n                                radio\r\n                                label={option.label}\r\n                                name={'theme.scheme'}\r\n                                value={option.value}\r\n                                checked={scheme === option.value}\r\n                                onChange={this.updateThemeScheme}\r\n                              />\r\n                            </Grid.Column>\r\n                            <Grid.Column floated={'right'} textAlign={'right'}>\r\n                              {this.themeDemoBoard({scheme: option.value})}\r\n                            </Grid.Column>\r\n                          </Grid.Row>\r\n                        ))}\r\n                      </Grid>\r\n                    </Tab.Pane>\r\n                  )},\r\n                  {menuItem: 'Level Indicators', render: () => (\r\n                    <Tab.Pane>\r\n                      <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n                        {this.themeNumbersOptions.map(option => (\r\n                          <Grid.Row key={`theme-numbers-${option.value}`}>\r\n                            <Grid.Column width={4}>\r\n                              <Checkbox\r\n                                radio\r\n                                label={option.label}\r\n                                name={'theme.numbers'}\r\n                                value={option.value}\r\n                                checked={numbers === option.value}\r\n                                onChange={this.updateThemeNumbers}\r\n                              />\r\n                            </Grid.Column>\r\n                            <Grid.Column floated={'right'} textAlign={'right'}>\r\n                              {this.themeDemoBoard({numbers: option.value})}\r\n                            </Grid.Column>\r\n                          </Grid.Row>\r\n                        ))}\r\n                      </Grid>\r\n                    </Tab.Pane>\r\n                  )}\r\n                ]} />\r\n              </Grid.Row>\r\n            </Grid>\r\n          </Segment>\r\n        )},\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nSettingsContent.propTypes = {\r\n  settings: PropTypes.object.isRequired,\r\n  updateSettings: PropTypes.func.isRequired,\r\n};\r\n\r\nclass Settings extends Component {\r\n  state = {\r\n    user: null,\r\n    settings: Client.getDefaultSettings(),\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.user && props.user !== state.user) {\r\n      return {\r\n        user: props.user,\r\n        settings: props.user.settings || Client.getDefaultSettings(),\r\n      };\r\n    }\r\n\r\n    return {};\r\n  }\r\n\r\n  updateSettings = update => {\r\n    this.setState(state => ({\r\n      settings: {\r\n        ...state.settings,\r\n        ...update,\r\n        theme: {\r\n          ...state.settings.theme,\r\n          ...update.theme,\r\n        },\r\n      },\r\n    }));\r\n  };\r\n\r\n  save = () => {\r\n    this.props.client.updateSettings(this.state.settings);\r\n  };\r\n\r\n  render() {\r\n    const {settings} = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        trigger={<Label as={'a'} icon={'cog'} content={'Settings'} />}\r\n        size={'small'}\r\n        header={'Settings'}\r\n        actions={[\r\n          {key: 'cancel', content: 'Cancel'},\r\n          {key: 'save', content: 'Save', positive: true, onClick: this.save},\r\n        ]}\r\n        content={{scrolling: true, content: <SettingsContent settings={settings} updateSettings={this.updateSettings} />}}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nSettings.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n};\r\n\r\nexport default withClient(Settings);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Grid, Icon, Label, Menu, Modal, Responsive, Segment, Tab} from \"semantic-ui-react\";\r\nimport { createSelector } from 'reselect';\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport Game from \"../game/game\";\r\nimport Play from \"./Play\";\r\nimport {NavLink, Route, Switch, withRouter} from \"react-router-dom\";\r\nimport * as utils from \"../utils\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport Settings from \"./Settings\";\r\nimport GameList from \"./GameList\";\r\nimport {ChallengeUserButton} from \"./Lobby\";\r\n\r\nclass OnlineGamePlayer extends Component {\r\n  render() {\r\n    const {game, player} = this.props;\r\n    let initialPlayer, resultingPlayerScore;\r\n    if (game) {\r\n      if (game.initialPlayerA.id === player.id) {\r\n        initialPlayer = game.initialPlayerA;\r\n        resultingPlayerScore = game.resultingPlayerAScore;\r\n      } else if (game.initialPlayerB.id === player.id) {\r\n        initialPlayer = game.initialPlayerB;\r\n        resultingPlayerScore = game.resultingPlayerBScore;\r\n      } else {\r\n        initialPlayer = null;\r\n        resultingPlayerScore = null;\r\n      }\r\n    } else {\r\n      initialPlayer = null;\r\n      resultingPlayerScore = null;\r\n    }\r\n    const isWinner = game && game.winnerUserId === player.id;\r\n    return (\r\n      <Fragment>\r\n        {isWinner ? <Icon name={'trophy'} color={\"green\"} /> : null}{\" \"}\r\n        <span style={isWinner ? {color: '#21BA45'} : undefined}>\r\n          {player.name}\r\n          {initialPlayer && !game.tournamentId ? (\r\n            <Fragment>\r\n              {\" \"}({resultingPlayerScore ? (\r\n                <Fragment>\r\n                  {isWinner ? `+${initialPlayer.winPoints}` : initialPlayer.losePoints}\r\n                  {\" \"}<Icon name={'long arrow alternate right'} />{\" \"}\r\n                  {resultingPlayerScore}\r\n                </Fragment>\r\n              ) : (\r\n                <Fragment>\r\n                  {initialPlayer.score}\r\n                  {\" \"}+{initialPlayer.winPoints}/{initialPlayer.losePoints}\r\n                </Fragment>\r\n              )})\r\n            </Fragment>\r\n          ) : null}\r\n        </span>\r\n        <HashedIcon floated={'right'} size={'mini'} hash={player.id} />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineGamePlayer.propTypes = {\r\n  game: PropTypes.object,\r\n  player: PropTypes.object.isRequired,\r\n};\r\n\r\nclass ChosenOnlineGame extends Component {\r\n  state = {\r\n    selectedGame: null,\r\n  };\r\n\r\n  gameSelector = createSelector([\r\n    props => props.match.params.id,\r\n    props => props.gamesInfo.byId,\r\n  ], (gameId, gamesById) => gamesById[gameId]);\r\n\r\n  get game() {\r\n    return this.gameSelector(this.props);\r\n  }\r\n\r\n  playersInfoSelector = createSelector([\r\n    props => props.user,\r\n    props => props.usersInfo,\r\n    () => this.game,\r\n  ], (user, {byId: usersById}, game) => {\r\n    const playerA = usersById[game.userIds[0]];\r\n    const playerB = usersById[game.userIds[1]];\r\n    const isUserPlayerA = user ? playerA.id === user.id : false;\r\n    const isUserPlayerB = user ? playerB.id === user.id : false;\r\n    const userPlayer = isUserPlayerA ? Game.PLAYER_A : isUserPlayerB ? Game.PLAYER_B : null;\r\n    const otherUser = isUserPlayerA ? playerB : isUserPlayerB ? playerA : null;\r\n\r\n    return {\r\n      playerA, playerB,\r\n      isUserPlayerA, isUserPlayerB,\r\n      userPlayer, otherUser,\r\n    };\r\n  });\r\n\r\n  get playersInfo() {\r\n    return this.playersInfoSelector(this.props);\r\n  }\r\n\r\n  gameGameSelector = createSelector([\r\n    () => this.game,\r\n  ], game => game ? Game.deserialize(game.game) : null);\r\n\r\n  get gameGame() {\r\n    return this.gameGameSelector(this.props);\r\n  }\r\n\r\n  dismissUrlGameError = () => {\r\n    this.props.selectLiveGame(null);\r\n  };\r\n\r\n  submit = moves => {\r\n    this.props.client.submitGameMove(this.game, moves);\r\n  };\r\n\r\n  componentDidMount() {\r\n    const game = this.game;\r\n    if (game) {\r\n      this.props.selectLiveGame(game);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const game = this.game;\r\n    if (game) {\r\n      this.props.selectLiveGame(game);\r\n    }\r\n  }\r\n\r\n  close = () => {\r\n    this.props.selectLiveGame(null);\r\n  };\r\n\r\n  changeSettings = settings => {\r\n    this.props.client.updateSettings(settings);\r\n  };\r\n\r\n  shareGame = e => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const game = this.game;\r\n      const {playerA, playerB} = this.playersInfo;\r\n      navigator.share({\r\n        title: `Thyra Online - ${game.finished ? 'Review' : 'Live'} ${playerA.name} vs ${playerB.name}`,\r\n        text: `${game.finished? 'Review finished': 'Watch live'} Santorini game between ${playerA.name} and ${playerB.name}`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  challengeUser = () => {\r\n    const {otherUser} = this.playersInfo;\r\n    if (otherUser) {\r\n      this.props.client.changeReadyToPlay(otherUser.id);\r\n    }\r\n  };\r\n\r\n  stopChallengeUser = () => {\r\n    this.props.client.changeReadyToPlay(false);\r\n  };\r\n\r\n  onSelectedGameChange = selectedGame => {\r\n    this.setState({selectedGame});\r\n  };\r\n\r\n  copyPlayPosition = () => {\r\n    utils.copyToClipboard((this.state.selectedGame || this.state.game).positionNotation);\r\n    alert('Play position copied to clipboard');\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      location, user, client, game, selectLiveGame,\r\n      usersInfo: {challengedUser, byId: usersById}, gamesInfo: {otherLive: otherLiveGames, myLive: myLiveGames},\r\n      tournamentsInfo: {byId: tournamentsById},\r\n    } = this.props;\r\n    const {selectedGame} = this.state;\r\n    const {gameGame} = this;\r\n\r\n    if (!gameGame) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlGameError}\r\n            header={'Could not find game'}\r\n            content={'This game cannot be found. Please check that you copied the full URL, or perhaps the game was aborted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find game\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const {otherUser, playerA, playerB, isUserPlayerA, isUserPlayerB, userPlayer} = this.playersInfo;\r\n    if (!playerA || !playerB) {\r\n      return null;\r\n    }\r\n\r\n    const gamesNode = (\r\n      <Segment>\r\n        <ChallengeUserButton otherUser={user} />\r\n        <br />\r\n        <br />\r\n        <GameList\r\n          user={user}\r\n          selectLiveGame={selectLiveGame}\r\n          games={myLiveGames.concat(otherLiveGames)}\r\n          usersById={usersById}\r\n          tournamentsById={tournamentsById}\r\n          terse\r\n          live\r\n          currentGameId={game ? game.id : null}\r\n          reverse={false}\r\n        />\r\n      </Segment>\r\n    );\r\n    const tournament = game ? tournamentsById[game.tournamentId] : null;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Settings/>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} inverted items={[\r\n              {key: 'close', content: 'Close', icon: 'x', onClick: this.close, color: 'red', active: true},\r\n              {key: 'share', content: 'Share Game', icon: 'share', onClick: this.shareGame, as: NavLink,\r\n                to: location.pathname, color: 'green', active: true,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to game'},\r\n              {key: 'play', content: 'Play position', icon: 'retweet', as: NavLink,\r\n                to: `/hotseat?position=${(selectedGame || gameGame).compressedFullNotation}`, color: 'green', active: true,\r\n                title: 'Click to open hotseat with this game', target: '_blank'},\r\n              process.env.REACT_APP_DEBUG ? {key: 'edit', content: 'Edit position', icon: 'edit', as: NavLink,\r\n                to: `/challenge/create?position=${(selectedGame || gameGame).positionNotation}`, color: 'green', active: true,\r\n                title: 'Click to edit the position for this game', target: '_blank'} : null,\r\n              process.env.REACT_APP_DEBUG ? {key: 'copy-play', icon: 'clipboard', content: 'Copy play position', color: 'green', active: true,\r\n                title: 'Click to copy play position to position', onClick: this.copyPlayPosition} : null,\r\n            ].filter(item => item)} />\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} items={[\r\n              {key: 'player-a', content: (\r\n                <Fragment>\r\n                  {isUserPlayerA ? <Label color={'green'} icon={\"user\"} content={'Me'} /> : null}\r\n                  <OnlineGamePlayer game={game} player={playerA} />\r\n                </Fragment>\r\n              ), color: isUserPlayerA ? 'green' : undefined},\r\n              {key: 'player-b', content: (\r\n                <Fragment>\r\n                  {isUserPlayerB ? <Label color={'green'} icon={\"user\"} content={'Me'} /> : null}\r\n                  <OnlineGamePlayer game={game} player={playerB} />\r\n                </Fragment>\r\n              ), color: isUserPlayerB ? 'green' : undefined},\r\n              tournament ? {key: 'tournament', content: (\r\n                <NavLink to={`/tournament/${tournament.id}`}>\r\n                  <Icon name={'sitemap'} /> {tournament.name}\r\n                </NavLink>\r\n              ), as: 'span'} : null,\r\n            ].filter(item => item)}/>\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Responsive as={Fragment} maxWidth={800}>\r\n          {gamesNode}\r\n        </Responsive>\r\n        <Play\r\n          user={user}\r\n          defaultSettings={client.settings}\r\n          otherUser={otherUser}\r\n          changeSettings={this.changeSettings}\r\n          game={gameGame}\r\n          matchGame={game}\r\n          names={{[Game.PLAYER_A]: playerA.name, [Game.PLAYER_B]: playerB.name}}\r\n          allowControl={[userPlayer].filter(player => player)}\r\n          submit={this.submit}\r\n          challengeUser={this.challengeUser}\r\n          stopChallengeUser={this.stopChallengeUser}\r\n          challengedUser={challengedUser}\r\n          onSelectedGameChange={this.onSelectedGameChange}\r\n        >\r\n          <Responsive as={Grid.Row} minWidth={800}>\r\n            {gamesNode}\r\n          </Responsive>\r\n        </Play>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChosenOnlineGame.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  game: PropTypes.object,\r\n};\r\n\r\nChosenOnlineGame = withRouter(withClient(ChosenOnlineGame));\r\n\r\nclass OnlineGame extends Component {\r\n  gameGameSelector = createSelector([\r\n    props => props.game,\r\n  ], game => game ? Game.deserialize(game.game) : null);\r\n\r\n  get gameGame() {\r\n    return this.gameGameSelector(this.props);\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      selectLiveGame, game, user, usersInfo: {byId}, gamesInfo: {games, myLive, otherLive, myFinished, otherFinished},\r\n      tournamentsInfo: {byId: tournamentsById},\r\n    } = this.props;\r\n    if (!Object.values(byId).length) {\r\n      return null;\r\n    }\r\n    const gameGame = this.gameGame;\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Segment>\r\n            <Tab menu={{pointing: true}} panes={[\r\n              {key: 'my-live', label: \"My Live games\", items: myLive, color: 'green'},\r\n              {key: 'other-live', label: \"Other Live games\", items: otherLive, color: 'green'},\r\n              {key: 'my-past', label: \"My Past games\", items: myFinished},\r\n              {key: 'other-past', label: \"Other Past games\", items: otherFinished},\r\n              {key: 'all', label: \"All games\", items: games},\r\n            ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                <GameList user={user} usersById={byId} tournamentsById={tournamentsById} games={items} selectLiveGame={selectLiveGame} />\r\n              )}\r\n            ))} />\r\n          </Segment>\r\n        </Route>\r\n        <Route path={`${this.props.match.path}/:id`}>\r\n          <ChosenOnlineGame game={game} gameGame={gameGame} selectLiveGame={selectLiveGame} />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineGame.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  game: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(OnlineGame));\r\n","import notifications from './notifications';\r\n\r\nexport default {\r\n  notifications,\r\n};\r\n","import {client} from \"../client/client\";\r\n\r\nclass Notifications {\r\n  constructor() {\r\n    this.user = client.user;\r\n    client.subscribe({onUser: this.onUser});\r\n  }\r\n\r\n  onUser = user => {\r\n    this.user = user;\r\n  };\r\n\r\n  async requestPermission() {\r\n    if (window.Notification && window.Notification.permission !== 'denied') {\r\n      await window.Notification.requestPermission();\r\n    }\r\n  }\r\n\r\n  async notify() {\r\n    if (!this.user || !this.user.settings.enableNotifications) {\r\n      return;\r\n    }\r\n    await this.requestPermission();\r\n    if (window.Notification && window.Notification.permission === \"granted\") {\r\n      try {\r\n        new Notification(...arguments);\r\n      } catch (e) {\r\n        console.error(\"Could not send notification\", e);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst notifications = new Notifications();\r\n\r\nexport default notifications;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport _ from 'lodash';\r\nimport classNames from 'classnames';\r\nimport {Button, Grid, Icon, Label, Menu, Modal, Segment, Statistic, Tab, Table} from \"semantic-ui-react\";\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport {NavLink, Route, Switch, withRouter} from \"react-router-dom\";\r\nimport * as utils from \"../utils\";\r\nimport HashedIcon from \"./HashedIcon\";\r\n// import TournamentList from \"./TournamentList\";\r\nimport {GameCard} from \"./GameList\";\r\nimport {createSelector} from \"reselect\";\r\nimport '../styles/tournament.css';\r\nimport CreateTournament from \"./CreateTournament\";\r\nimport TournamentList from \"./TournamentList\";\r\n\r\nclass ChosenOnlineTournament extends Component {\r\n  tournamentSelector = createSelector([\r\n    props => props.match.params.id,\r\n    props => props.tournamentsInfo.byId,\r\n  ], (tournamentId, tournamentsById) => tournamentsById[tournamentId]);\r\n\r\n  get tournament() {\r\n    return this.tournamentSelector(this.props);\r\n  }\r\n\r\n  dismissUrlTournamentError = () => {\r\n    this.props.selectLiveTournament(null);\r\n  };\r\n\r\n  componentDidMount() {\r\n    const {tournament} = this;\r\n    if (tournament) {\r\n      this.props.selectLiveTournament(tournament);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const {tournament} = this;\r\n    if (tournament) {\r\n      this.props.selectLiveTournament(tournament);\r\n    }\r\n  }\r\n\r\n  close = () => {\r\n    this.props.selectLiveTournament(null);\r\n  };\r\n\r\n  shareTournament = e => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const {tournament} = this;\r\n      navigator.share({\r\n        title: `Thyra Online - ${tournament.started ? (tournament.finished ? 'Past' : 'Live') : 'Future'} tournament ${tournament.name}`,\r\n        text: `${tournament.started ? (tournament.finished ? 'Review Past' : 'Watch Live') : 'Future'} Santorini tournament ${tournament.name}`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  toggleParticipation = () => {\r\n    const {tournament} = this;\r\n    this.props.toggleParticipation(tournament);\r\n  };\r\n\r\n  startTournament = () => {\r\n    const {tournament} = this;\r\n    this.props.startTournament(tournament);\r\n  };\r\n\r\n  abortTournament = () => {\r\n    const {tournament} = this;\r\n    this.props.abortTournament(tournament);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      location, user, selectLiveGame,\r\n      usersInfo: {byId: usersById}, gamesInfo: {byId: gamesById}, tournamentsInfo,\r\n    } = this.props;\r\n    const {byId: tournamentsById} = tournamentsInfo;\r\n    const {tournament} = this;\r\n\r\n    if (!tournament) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlTournamentError}\r\n            header={'Could not find tournament'}\r\n            content={'This tournament cannot be found. Please check that you copied the full URL, or perhaps the tournament was aborted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find tournament\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const players = _.orderBy(tournament.userIds.map(otherUserId => usersById[otherUserId]), [\r\n      user => tournament.userStats ? tournament.userStats[user.id].points : 0,\r\n      user => tournament.userStats ? tournament.userStats[user.id].initialScore.score : 0,\r\n      'id',\r\n    ], ['desc', 'desc', 'desc']);\r\n    const isMyTournament = user ? tournament.userIds.includes(user.id) : false;\r\n    const didUserCreated = user ? tournament.creatorUserId === user.id : false;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} inverted items={[\r\n              {key: 'close', content: 'Close', icon: 'x', onClick: this.close, color: 'red', active: true},\r\n              {key: 'share', content: 'Share Tournament', icon: 'share', onClick: this.shareTournament, as: NavLink,\r\n                to: location.pathname, color: 'green', active: true,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to tournament'},\r\n            ]} />\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Segment>\r\n          <Statistic.Group widths={\"three\"} size={\"tiny\"}>\r\n            <Statistic\r\n              value={tournament.started ? (tournament.finished ? 'Finished' : `${tournament.round}/${tournament.rounds}`) : 'Waiting'}\r\n              label={tournament.started ? (tournament.finished ? 'Status' : 'Rounds') : 'Status'}\r\n            />\r\n            <Statistic\r\n              value={tournament.userIds.length}\r\n              label={'Users'}\r\n            />\r\n            <Statistic\r\n              value={tournament.gameCount}\r\n              label={'Games between each pair'}\r\n            />\r\n          </Statistic.Group>\r\n          <Grid columns={'equal'}>\r\n            <Grid.Column textAlign={'left'}><Button negative onClick={this.close}>Close</Button></Grid.Column>\r\n            <Grid.Column>\r\n              <Button\r\n                positive\r\n                icon\r\n                onClick={this.shareTournament}\r\n                style={{width: '100%'}}\r\n                as={NavLink}\r\n                to={location.pathname}\r\n                title={navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to tournament'}\r\n              >\r\n                <Icon name={'share'}/> Share Tournament\r\n              </Button>\r\n            </Grid.Column>\r\n          </Grid>\r\n        </Segment>\r\n        {!tournament.started ? (\r\n          <Segment>\r\n            <Grid columns={'equal'}>\r\n              <Grid.Column textAlign={'left'}>\r\n                <Button\r\n                  disabled={tournament.started}\r\n                  style={{width: '100%'}}\r\n                  color={isMyTournament ? 'yellow' : 'green'}\r\n                  onClick={this.toggleParticipation}\r\n                >\r\n                  {tournament.started ? null : <Icon name={isMyTournament ? 'hourglass' : 'play'} />}\r\n                  {isMyTournament ? 'Participating' : (\r\n                    tournament.started ? (\r\n                      tournament.finished ? 'Tournament finished' : 'Tournament started'\r\n                    ) : 'Join the tournament'\r\n                  )}\r\n                </Button>\r\n              </Grid.Column>\r\n              <Grid.Column>\r\n                <Button\r\n                  disabled={!didUserCreated || players.length < 2 || tournament.started}\r\n                  positive\r\n                  icon\r\n                  onClick={this.startTournament}\r\n                  style={{width: '100%'}}\r\n                  color={players.length >= 2 ? (didUserCreated ? 'green' : 'yellow') : 'yellow'}\r\n                >\r\n                  {tournament.finished  ? null : (\r\n                    <Icon name={players.length >= 2 ? (didUserCreated ? 'play' : 'hourglass') : 'play'}/>\r\n                  )}\r\n                  {tournament.started ? (\r\n                    tournament.finished ? 'Finished' : 'Started'\r\n                  ) : (\r\n                    players.length >= 2 ? (\r\n                      didUserCreated ? 'Start tournament' : 'Waiting for tournament to start'\r\n                    ) : 'Needs at least participants'\r\n                  )}\r\n                </Button>\r\n              </Grid.Column>\r\n            </Grid>\r\n          </Segment>\r\n        ) : null }\r\n        <Segment>\r\n          {tournament.started ? (\r\n            <Tab menu={{pointing: true, attached: false}} panes={[\r\n              {menuItem: 'Rankings', render: () => (\r\n                <Table celled collapsing unstackable>\r\n                  <Table.Header>\r\n                    <Table.Row>\r\n                      {tournament.finished ? <Table.HeaderCell> </Table.HeaderCell> : null}\r\n                      <Table.HeaderCell>Rank</Table.HeaderCell>\r\n                      <Table.HeaderCell>User</Table.HeaderCell>\r\n                      <Table.HeaderCell>Score (TB)</Table.HeaderCell>\r\n                      <Table.HeaderCell>Expected Score</Table.HeaderCell>\r\n                      {tournament.started && !tournament.finished ? <Table.HeaderCell>Game</Table.HeaderCell> : null}\r\n                      {tournament.finished ? <Table.HeaderCell>Score difference</Table.HeaderCell> : null}\r\n                    </Table.Row>\r\n                  </Table.Header>\r\n                  <Table.Body>\r\n                    {players.map(player => {\r\n                      const stats = tournament.userStats[player.id];\r\n                      return (\r\n                        <Table.Row key={player.id}>\r\n                          {tournament.finished ? (\r\n                            <Table.Cell>{stats.rank <= 3 ? (\r\n                              <Icon\r\n                                name={{1: 'trophy', 2: 'certificate', 3: 'certificate'}[stats.rank]}\r\n                                color={{1: 'yellow', 2: 'grey', 3: 'brown'}[stats.rank]}\r\n                              />\r\n                            ) : null}</Table.Cell>\r\n                          ) : null}\r\n                          <Table.Cell>{stats.rank}</Table.Cell>\r\n                          <Table.Cell>\r\n                            <HashedIcon floated={'left'} size={'mini'} hash={player.id} />\r\n                            {player.name}\r\n                          </Table.Cell>\r\n                          <Table.Cell>{stats.points === stats.ratedPoints ? stats.points : `${stats.ratedPoints} (${stats.points})`}</Table.Cell>\r\n                          <Table.Cell>{stats.initialScore.expectedPoints.toFixed(1)}</Table.Cell>\r\n                          {tournament.started && !tournament.finished ? (\r\n                            <Table.Cell>{stats.waitingForNextRound ? 'Waiting for next round' : (\r\n                              stats.currentGameId ? (\r\n                                <GameCard\r\n                                  user={null}\r\n                                  usersById={usersById}\r\n                                  tournamentsById={tournamentsById}\r\n                                  game={gamesById[stats.currentGameId]}\r\n                                  selectLiveGame={selectLiveGame}\r\n                                  terse\r\n                                  live\r\n                                />\r\n                              ) : 'Finished'\r\n                            )}</Table.Cell>\r\n                          ) : null}\r\n                          {tournament.finished ? (\r\n                            <Table.Cell>{stats.scoreDifference > 0 ? `+${stats.scoreDifference}` : stats.scoreDifference}</Table.Cell>\r\n                          ) : null}\r\n                        </Table.Row>\r\n                      );\r\n                    })}\r\n                  </Table.Body>\r\n                </Table>\r\n              )},\r\n              {menuItem: 'Games', render: () => (\r\n                <Table celled collapsing unstackable>\r\n                  <Table.Header>\r\n                    <Table.Row>\r\n                      <Table.HeaderCell colSpan={2}>White</Table.HeaderCell>\r\n                      <Table.HeaderCell colSpan={2}>Black</Table.HeaderCell>\r\n                      <Table.HeaderCell>Game</Table.HeaderCell>\r\n                    </Table.Row>\r\n                  </Table.Header>\r\n                  {tournament.schedule.map((round, roundIndex) => (\r\n                    <Fragment key={roundIndex}>\r\n                      <Table.Header>\r\n                        <Table.Row>\r\n                          <Table.HeaderCell colSpan={5}>{round.type === 'playoff' ? 'Playoffs - ' : null}Round {round.round}</Table.HeaderCell>\r\n                        </Table.Row>\r\n                      </Table.Header>\r\n                      <Table.Body>\r\n                        {round.pairings.map(({userIds: [playerAId, playerBId], gameId}, gameIndex) => {\r\n                          const game = gamesById[gameId];\r\n                          const playerAWon = game && game.finished && game.winnerUserId === playerAId;\r\n                          const playerBWon = game && game.finished && game.winnerUserId === playerBId;\r\n                          return (\r\n                            <Table.Row key={gameIndex}>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-a', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {playerAId ? (\r\n                                  <Fragment>\r\n                                    <HashedIcon floated={'left'} size={'mini'} hash={playerAId} />\r\n                                    {usersById[playerAId].name}\r\n                                  </Fragment>\r\n                                ) : 'Sitting out this round'}\r\n                              </Table.Cell>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-a', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {game && game.finished ? (game.winnerUserId === playerAId ? '1' : '0') : '-'}\r\n                              </Table.Cell>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-b', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {playerBId ? (\r\n                                  <Fragment>\r\n                                    <HashedIcon floated={'left'} size={'mini'} hash={playerBId} />\r\n                                    {usersById[playerBId].name}\r\n                                  </Fragment>\r\n                                ) : 'Sitting out this round'}\r\n                              </Table.Cell>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-b', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {game && game.finished ? (game.winnerUserId === playerBId ? '1' : '0') : '-'}\r\n                              </Table.Cell>\r\n                              <Table.Cell>\r\n                                {playerAId && playerBId ? (\r\n                                  game ? (\r\n                                    <GameCard\r\n                                      user={null}\r\n                                      usersById={usersById}\r\n                                      tournamentsById={tournamentsById}\r\n                                      game={game}\r\n                                      selectLiveGame={selectLiveGame}\r\n                                      terse\r\n                                      live\r\n                                    />\r\n                                  ) : 'Not started yet'\r\n                                ) : null}\r\n                              </Table.Cell>\r\n                            </Table.Row>\r\n                          )\r\n                        })}\r\n                      </Table.Body>\r\n                    </Fragment>\r\n                  ))}\r\n                </Table>\r\n              )},\r\n            ]} />\r\n          ) : (\r\n            <Table celled collapsing unstackable>\r\n              <Table.Header>\r\n                <Table.Row>\r\n                  <Table.HeaderCell>User</Table.HeaderCell>\r\n                  <Table.HeaderCell>Rating</Table.HeaderCell>\r\n                </Table.Row>\r\n              </Table.Header>\r\n              <Table.Body>\r\n                {players.map(player => (\r\n                  <Table.Row key={player.id}>\r\n                    <Table.Cell>\r\n                      <HashedIcon floated={'left'} size={'mini'} hash={player.id} />\r\n                      {player.name}\r\n                    </Table.Cell>\r\n                    <Table.Cell>{player.score}</Table.Cell>\r\n                  </Table.Row>\r\n                ))}\r\n              </Table.Body>\r\n            </Table>\r\n          )}\r\n        </Segment>\r\n        {didUserCreated && !tournament.started ? (\r\n          <Segment>\r\n            <Grid columns={'equal'}>\r\n              <Grid.Column textAlign={'left'}>\r\n              </Grid.Column>\r\n              <Grid.Column>\r\n                <Modal\r\n                  size={'mini'}\r\n                  trigger={\r\n                    <Button\r\n                      disabled={!didUserCreated}\r\n                      negative\r\n                      icon\r\n                      style={{width: '100%'}}\r\n                    >\r\n                      <Icon name={'stop'}/>\r\n                      {'Abort tournament'}\r\n                    </Button>\r\n                  }\r\n                  header={'Abort tournament'}\r\n                  content={'Are you sure you want to abort the tournament?'}\r\n                  actions={[\r\n                    {key: 'yes', content: 'Abort', onClick: this.abortTournament, negative: true},\r\n                    {key: 'no', content: 'No, keep tournament', secondary: true},\r\n                  ]}\r\n                />\r\n              </Grid.Column>\r\n            </Grid>\r\n          </Segment>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChosenOnlineTournament.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  tournament: PropTypes.object,\r\n  toggleParticipation: PropTypes.func.isRequired,\r\n  startTournament: PropTypes.func.isRequired,\r\n  abortTournament: PropTypes.func.isRequired,\r\n};\r\n\r\nChosenOnlineTournament = withRouter(withClient(ChosenOnlineTournament));\r\n\r\nclass OnlineTournament extends Component {\r\n  render() {\r\n    const {\r\n      selectLiveGame, selectLiveTournament, toggleParticipation, startTournament, abortTournament, tournament, user,\r\n      usersInfo: {byId: usersById}, tournamentsInfo,\r\n    } = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Segment>\r\n            <CreateTournament />\r\n            <br/><br/>\r\n            <Tab menu={{pointing: true}} panes={[\r\n              {key: 'my-live', label: \"My Future & Running tournaments\", items: tournamentsInfo.myFutureAndLive, color: 'green'},\r\n              {key: 'other-live', label: \"Other Future and Running tournaments\", items: tournamentsInfo.otherFutureAndLive, color: 'green'},\r\n              {key: 'my-past', label: \"My Past tournaments\", items: tournamentsInfo.myFinished},\r\n              {key: 'other-past', label: \"Other Past tournaments\", items: tournamentsInfo.otherFinished},\r\n            ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                <TournamentList\r\n                  user={user}\r\n                  usersById={usersById}\r\n                  tournaments={items}\r\n                  selectLiveTournament={selectLiveTournament}\r\n                />\r\n              )}\r\n            ))} />\r\n          </Segment>\r\n        </Route>\r\n        <Route path={`${this.props.match.path}/:id`}>\r\n          <ChosenOnlineTournament\r\n            tournament={tournament}\r\n            selectLiveGame={selectLiveGame}\r\n            selectLiveTournament={selectLiveTournament}\r\n            toggleParticipation={toggleParticipation}\r\n            startTournament={startTournament}\r\n            abortTournament={abortTournament}\r\n          />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineTournament.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  tournament: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  toggleParticipation: PropTypes.func.isRequired,\r\n  startTournament: PropTypes.func.isRequired,\r\n  abortTournament: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(OnlineTournament));\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Grid, Label, Menu, Message} from \"semantic-ui-react\";\r\nimport BoardBackground from \"./Board/BoardBackground\";\r\nimport Game from \"../game/game\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport Client from \"../client/client\";\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nclass LearnBoard extends Component {\r\n  state = {\r\n    rowsAndColumns: this.props.rowsAndColumns,\r\n    arrows: null,\r\n    selectedMoveCell: null,\r\n    movedFromCell: null,\r\n    selectedBuildCell: null,\r\n    won: false,\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.rowsAndColumns !== this.props.rowsAndColumns) {\r\n      this.reset();\r\n    }\r\n  }\r\n\r\n  isCellAvailable = cell => {\r\n    const {canMove, canBuild} = this.props;\r\n    if (!canMove && !canBuild) {\r\n      return false;\r\n    }\r\n    const {selectedMoveCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return false;\r\n    }\r\n    if (canMove && !canBuild) {\r\n      return this.isCellAvailableForMoving(cell, selectedMoveCell);\r\n    } else if (canBuild && !canMove) {\r\n      return this.isCellAvailableForBuilding(cell, selectedBuildCell);\r\n    } else if (canMove && canBuild) {\r\n      if (!selectedMoveCell && !selectedBuildCell) {\r\n        return this.isCellAvailableForMoving(cell, selectedMoveCell);\r\n      } else if (selectedMoveCell) {\r\n        return this.isCellAvailableForMoving(cell, selectedMoveCell);\r\n      } else if (selectedBuildCell) {\r\n        return this.isCellAvailableForBuilding(cell, selectedBuildCell);\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  isCellAvailableForMoving(cell, selectedMoveCell) {\r\n    if (!selectedMoveCell) {\r\n      return cell.player === Game.PLAYER_A;\r\n    }\r\n    if (selectedMoveCell.level === 3) {\r\n      return false;\r\n    }\r\n    if (Math.max(Math.abs(cell.x - selectedMoveCell.x), Math.abs(cell.y - selectedMoveCell.y)) !== 1) {\r\n      return false;\r\n    }\r\n    if ((cell.level - selectedMoveCell.level) > 1) {\r\n      return false;\r\n    }\r\n    if (cell.player) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  isCellAvailableForBuilding(cell, selectedBuildCell) {\r\n    if (!selectedBuildCell) {\r\n      return cell.player === Game.PLAYER_A;\r\n    }\r\n    if (Math.max(Math.abs(cell.x - selectedBuildCell.x), Math.abs(cell.y - selectedBuildCell.y)) !== 1) {\r\n      return false;\r\n    }\r\n    if (cell.level > 3) {\r\n      return false;\r\n    }\r\n    if (cell.player) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  makeMove = cell => {\r\n    const {selectedMoveCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return;\r\n    }\r\n    const {canMove, canBuild} = this.props;\r\n    if (canMove && !canBuild) {\r\n      this.makeMoveMoving(cell, selectedMoveCell);\r\n    } else if (canBuild && !canMove) {\r\n      this.makeMoveBuilding(cell, selectedBuildCell);\r\n    } else if (canMove && canBuild) {\r\n      if (!selectedMoveCell && !selectedBuildCell) {\r\n        this.makeMoveMoving(cell, selectedMoveCell);\r\n      } else if (selectedMoveCell) {\r\n        this.makeMoveMoving(cell, selectedMoveCell);\r\n        if (cell.level !== 3) {\r\n          this.setState({movedFromCell: selectedMoveCell});\r\n          this.makeMoveBuilding(cell, selectedBuildCell);\r\n        }\r\n      } else if (selectedBuildCell) {\r\n        this.makeMoveBuilding(cell, selectedBuildCell);\r\n        this.setState({movedFromCell: null});\r\n      }\r\n    }\r\n  };\r\n\r\n  makeMoveMoving(cell, selectedMoveCell) {\r\n    if (selectedMoveCell) {\r\n      this.setState(({rowsAndColumns}) => ({\r\n        selectedMoveCell: null,\r\n        rowsAndColumns: Game.updateCells(rowsAndColumns, ...[\r\n          {x: selectedMoveCell.x, y: selectedMoveCell.y, player: null, worker: null},\r\n          {x: cell.x, y: cell.y, player: selectedMoveCell.player, worker: selectedMoveCell.worker},\r\n        ]),\r\n        arrows: [\r\n          {from: selectedMoveCell, to: cell, type: 'move', colour: 'white'},\r\n        ],\r\n        won: cell.level === 3,\r\n      }));\r\n    } else {\r\n      this.setState({selectedMoveCell: cell});\r\n    }\r\n  }\r\n\r\n  makeMoveUndoMoving(movedFromCell, selectedBuildCell) {\r\n    this.setState(({rowsAndColumns}) => ({\r\n      selectedMoveCell: movedFromCell,\r\n      selectedBuildCell: null,\r\n      rowsAndColumns: Game.updateCells(rowsAndColumns, ...[\r\n        {x: selectedBuildCell.x, y: selectedBuildCell.y, player: null, worker: null},\r\n        {x: movedFromCell.x, y: movedFromCell.y, player: movedFromCell.player, worker: movedFromCell.worker},\r\n      ]),\r\n      arrows: null,\r\n      won: false,\r\n    }));\r\n  }\r\n\r\n  makeMoveBuilding(cell, selectedBuildCell) {\r\n    if (selectedBuildCell) {\r\n      this.setState(({rowsAndColumns}) => ({\r\n        selectedBuildCell: null,\r\n        rowsAndColumns: Game.updateCells(rowsAndColumns, {\r\n          x: cell.x, y: cell.y, level: rowsAndColumns[cell.y].cells[cell.x].level + 1,\r\n        }),\r\n        arrows: [\r\n          {from: selectedBuildCell, to: cell, type: 'build', colour: 'white'},\r\n        ],\r\n      }));\r\n    } else {\r\n      this.setState({selectedBuildCell: cell});\r\n    }\r\n  }\r\n\r\n  isCellUndoable = cell => {\r\n    if (!this.props.canMove && !this.props.canBuild) {\r\n      return false;\r\n    }\r\n    const {selectedMoveCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return false;\r\n    }\r\n    const {canMove, canBuild} = this.props;\r\n    if (canMove && !canBuild) {\r\n      return selectedMoveCell !== null && selectedMoveCell.x === cell.x && selectedMoveCell.y === cell.y;\r\n    } else if (canBuild && !canMove) {\r\n      return selectedBuildCell !== null && selectedBuildCell.x === cell.x && selectedBuildCell.y === cell.y;\r\n    } else if (canMove && canBuild) {\r\n      if (selectedMoveCell) {\r\n        return selectedMoveCell.x === cell.x && selectedMoveCell.y === cell.y;\r\n      } else if (selectedBuildCell) {\r\n        return selectedBuildCell.x === cell.x && selectedBuildCell.y === cell.y;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  undo = () => {\r\n    const {canMove, canBuild} = this.props;\r\n    const {selectedMoveCell, movedFromCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return;\r\n    }\r\n    if (canMove && !canBuild) {\r\n      this.setState({selectedMoveCell: null});\r\n    } else if (canBuild && !canMove) {\r\n      this.setState({selectedBuildCell: null});\r\n    } else if (canMove && canBuild) {\r\n      if (selectedMoveCell) {\r\n        this.setState({selectedMoveCell: null});\r\n      } else if (selectedBuildCell) {\r\n        this.makeMoveUndoMoving(movedFromCell, selectedBuildCell);\r\n      }\r\n    }\r\n  };\r\n\r\n  reset = () => {\r\n    const {rowsAndColumns} = this.props;\r\n    this.setState({\r\n      rowsAndColumns, arrows: null, won: false, selectedMoveCell: null, movedFromCell: null, selectedBuildCell: null,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {user, board, canMove, canBuild, rowsAndColumns: originalRowsAndColumns} = this.props;\r\n    const {rowsAndColumns, arrows, won, selectedMoveCell, selectedBuildCell} = this.state;\r\n    const rawSettings = user ? user.settings : Client.getDefaultSettings();\r\n    const settings = {...rawSettings, theme: {...rawSettings.theme, numbers: 'obvious'}};\r\n\r\n    return (\r\n      <Fragment>\r\n        {canMove || canBuild ? (\r\n          <Fragment>\r\n            <br />\r\n            <Label color={won ? 'green' : 'blue'} icon={won ? 'trophy' : undefined} content={(\r\n              won ? \"You won! Press reset to start again\" : (\r\n                !selectedMoveCell && !selectedBuildCell ? \"Select one of your pieces\" : (\r\n                  selectedMoveCell ? \"Select a square to move to, or click on your piece to do something else\" : (\r\n                    \"Select a square to build on, or click on your piece to do something else\"\r\n                  )\r\n                )\r\n              )\r\n            )} />\r\n            <br />\r\n          </Fragment>\r\n        ) : null}\r\n        <BoardBackground\r\n          medium\r\n          allowControl={[]}\r\n          clickable={canMove || canBuild}\r\n          undoable={canMove || canBuild}\r\n          isCellAvailable={this.isCellAvailable}\r\n          isCellUndoable={this.isCellUndoable}\r\n          makeMove={this.makeMove}\r\n          undo={this.undo}\r\n          settings={settings}\r\n          animated showArrows\r\n          rowsAndColumns={rowsAndColumns}\r\n          {...(arrows ? {...board, arrows} : board)}\r\n        />\r\n        {canMove || canBuild ? (\r\n          <div>\r\n            <Button onClick={this.reset} disabled={rowsAndColumns === originalRowsAndColumns} primary>Reset</Button>\r\n          </div>\r\n        ) : null}\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nLearnBoard.propTypes = {\r\n  user: PropTypes.object,\r\n  board: PropTypes.object,\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  canMove: PropTypes.bool.isRequired,\r\n  canBuild: PropTypes.bool.isRequired,\r\n};\r\n\r\nLearnBoard.defaultProps = {\r\n  canMove: false,\r\n  canBuild: false,\r\n};\r\n\r\nLearnBoard = withClient(LearnBoard);\r\n\r\nclass LearnToPlay extends Component {\r\n  static steps = [\r\n    {title: 'Introduction', body: <Fragment>\r\n      <div>\r\n        In this website, you can play <strong>Santorini©</strong> games with people around the world.\r\n      </div>\r\n      <div>\r\n        The board consists of a <strong>5x5 square grid</strong>, and each player, <strong>black</strong> and\r\n        <strong>white</strong>, has two <strong>pieces</strong> each:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <div>\r\n        The <strong>objective</strong> of the game is to move one of your pieces to the <strong>3rd level</strong>,\r\n        and of course, to <strong>prevent your opponent</strong> from doing so before you:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Moving', body: <Fragment>\r\n      <div>\r\n        You can <strong>move 1 square</strong> in any direction, <strong>horizontally</strong>,\r\n        <strong>vertically</strong>, or <strong>diagonally</strong>.\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        But you <strong>can't move in a square that has another piece</strong>, your's or the opponent's:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Beneath, you can <strong>try moving your pieces</strong>. Notice that you need to <strong>click on a piece to\r\n        select it</strong>, and then <strong>click on the target square</strong> to move it.\r\n        To <strong>deselect</strong> a selected piece <strong>click on it again</strong>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        canMove\r\n      />\r\n    </Fragment>},\r\n    {title: 'Levels', body:<Fragment>\r\n      <div>\r\n        In the game there are <strong>five levels</strong>: <Label color={'green'}>ground</Label>,\r\n        <Label color={'grey'}>level 1</Label>, <Label color={'yellow'}>level 2</Label>,\r\n        <Label color={'red'}>level 3</Label>, and the <Label color={'blue'}>blocked level (level 4)</Label>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n            {x: 2, y: 0, level: 2, player: null, worker: null},\r\n            {x: 3, y: 0, level: 3, player: null, worker: null},\r\n            {x: 4, y: 0, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <div>\r\n        You can go <strong>up one level</strong>, go <strong>down any number of levels</strong>, and <strong>move to\r\n        the same level</strong>. You can <strong>never move to a blocked level</strong>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Try it yourself below:\r\n      </div>\r\n      <LearnBoard\r\n        canMove\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Building', body:<Fragment>\r\n      <div>\r\n        After you've moved one of your pieces, you <strong>must build on 1 nearby square</strong>, horizontally,\r\n        vertically, or diagonally:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 2}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        You can <strong>build at any square</strong> next to the piece you moved: it <strong>doesn't matter which\r\n        level your are</strong>, and which level you want to build. But you can never build more than the blocked\r\n        level:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n            {x: 2, y: 0, level: 2, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 2, player: null, worker: null},\r\n            {x: 1, y: 2, level: 3, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Try it yourself below, by selecting your player and then building:\r\n      </div>\r\n      <LearnBoard\r\n        canBuild\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n            {x: 2, y: 0, level: 2, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 2, player: null, worker: null},\r\n            {x: 1, y: 2, level: 3, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Winning', body:<Fragment>\r\n      <div>\r\n        If there was no opponent on the board (you wish!), you would do something like the following\r\n        moves <strong>to win</strong>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 2, y: 1}, to: {x: 1, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 2, y: 1}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 1, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <br/>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 3, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: null, worker: null},\r\n            {x: 1, y: 1, level: 3, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Why don't you try this below?\r\n      </div>\r\n      <LearnBoard\r\n        canMove canBuild\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Good starting positions', body:<Fragment>\r\n      <div>\r\n        To start the game, the first player puts their pieces anywhere on the board, and then second player does the\r\n        same. Here are some good examples:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Disadvantaged starting positions', body:<Fragment>\r\n      <div>\r\n        In these starting positions the both players have their pieces near the center, and they can move easily to\r\n        any square on the board. In contrast, these starting positions would probably put the black players at a\r\n        disadvantage, since his pieces are too far away from the opponent's:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'You\\'re ready to play!', body: <Fragment>\r\n      <div>\r\n        You're now ready to play! You can now <NavLink to={'./hotseat'}>play with a friend on the same\r\n        screen</NavLink> or play online <NavLink to={'./lobby'}>at the lobby</NavLink>.\r\n      </div>\r\n    </Fragment>}\r\n  ];\r\n\r\n  state = {\r\n    stepIndex: 0,\r\n  };\r\n\r\n  goToFirstStep = () => {\r\n    this.setState({stepIndex: 0});\r\n  };\r\n\r\n  goToPreviousStep = () => {\r\n    this.setState(state => ({stepIndex: state.stepIndex - 1}));\r\n  };\r\n\r\n  goToNextStep = () => {\r\n    this.setState(state => ({stepIndex: state.stepIndex + 1}));\r\n  };\r\n\r\n  goToLastStep = () => {\r\n    this.setState({stepIndex: this.constructor.steps.length - 1});\r\n  };\r\n\r\n  render() {\r\n    const {stepIndex} = this.state;\r\n    const steps = this.constructor.steps;\r\n    const step = steps[stepIndex];\r\n\r\n    return (\r\n      <Message>\r\n        <Message.Content>\r\n          <Grid columns={'equal'} verticalAlign={'middle'} textAlign={'center'}>\r\n            <Grid.Row>\r\n              <Menu size={'massive'} items={[\r\n                {key: 'first', icon: 'fast backward', onClick: this.goToFirstStep, disabled: stepIndex === 0},\r\n                {key: 'previous', icon: 'backward', onClick: this.goToPreviousStep, disabled: stepIndex === 0},\r\n                {key: 'next', icon: 'forward', onClick: this.goToNextStep, disabled: stepIndex === steps.length - 1},\r\n                {key: 'last', icon: 'fast forward', onClick: this.goToLastStep, disabled: stepIndex === steps.length - 1},\r\n              ]}/>\r\n            </Grid.Row>\r\n            <Grid.Row><Message.Header>{stepIndex + 1}.  {step.title}</Message.Header></Grid.Row>\r\n            <Grid.Row><Message content={<Fragment key={stepIndex}>{step.body}</Fragment>} /></Grid.Row>\r\n            <Grid.Row>\r\n              {stepIndex < steps.length - 1 ? (\r\n                <Button primary onClick={this.goToNextStep} icon={'forward'} content={'Go to next step'} />\r\n              ) : (\r\n                <Fragment>\r\n                  <Button positive as={NavLink} to={'/lobby'} icon={'play'} content={'Play with someone online'} />\r\n                  <Button positive as={NavLink} to={'/hotseat'} icon={'retweet'} content={'Play with a friend on the same screen'} />\r\n                </Fragment>\r\n              )}\r\n            </Grid.Row>\r\n          </Grid>\r\n        </Message.Content>\r\n      </Message>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LearnToPlay;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport BoardBackground from \"./Board/BoardBackground\";\r\nimport Game from \"../game/game\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport {Button, Grid, Menu, Message, Modal, Segment} from \"semantic-ui-react\";\r\nimport keydown from \"react-keydown\";\r\nimport Play from \"./Play\";\r\nimport * as utils from \"../utils\";\r\n\r\nclass EditPosition extends Component {\r\n  static initialPositionNotation = Game.getPositionNotation(Game.getInitialRowsAndColumns());\r\n\r\n  state = {\r\n    paletteSelectedItem: {x: 0, y: 1},\r\n    paletteUpdate: {player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n    position: Game.getInitialRowsAndColumns(),\r\n    positionError: null,\r\n    urlError: false,\r\n    ...this.getGameAndErrorFromUrlPosition(),\r\n    selectedGame: null,\r\n    previousPosition: null,\r\n  };\r\n\r\n  getGameAndErrorFromUrlPosition() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const position = params.get('position') || this.props.initialPositionNotation;\r\n    if (position) {\r\n      let game, urlError;\r\n      try {\r\n        game = Game.fromCompressedPositionNotation(position);\r\n        if (!game) {\r\n          urlError = 'The position was not valid';\r\n        }\r\n      } catch (e) {\r\n        game = null;\r\n        urlError = `The board position was not valid: ${e.message}`;\r\n      }\r\n      if (!game) {\r\n        return {game: Game.create(), urlError, position: Game.getInitialRowsAndColumns()};\r\n      }\r\n      return {game, urlError: false, position: game.rowsAndColumns};\r\n    } else {\r\n      return {game: Game.create(), urlError: false, position: Game.getInitialRowsAndColumns()};\r\n    }\r\n  }\r\n\r\n  dismissUrlPositionError = () =>{\r\n    this.setState({error: null});\r\n  };\r\n\r\n  onPaletteSelectedItemChange = (paletteSelectedItem, paletteUpdate) => {\r\n    this.setState({paletteSelectedItem, paletteUpdate});\r\n  };\r\n\r\n  onPositionChange = position => {\r\n    let game, positionError;\r\n    try {\r\n      game = Game.fromPosition(position);\r\n      positionError = null;\r\n    } catch (e) {\r\n      game = Game.create();\r\n      positionError = e.message;\r\n    }\r\n    this.setState(state => ({\r\n      position,\r\n      game,\r\n      positionError,\r\n      previousPosition: state.position,\r\n    }));\r\n  };\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  onSelectedGameChange = selectedGame => {\r\n    this.setState({selectedGame});\r\n  };\r\n\r\n  copyGame = () => {\r\n    const {game, selectedGame} = this.state;\r\n    const visibleGame = selectedGame || game;\r\n    this.onPositionChange(visibleGame.rowsAndColumns);\r\n  };\r\n\r\n  resetBoard = () => {\r\n    this.onPositionChange(Game.getInitialRowsAndColumns());\r\n  };\r\n\r\n  undo = () => {\r\n    this.onPositionChange(this.state.previousPosition);\r\n  };\r\n\r\n  resetGame = () => {\r\n    this.onPositionChange(this.state.position);\r\n  };\r\n\r\n  copyPosition = () => {\r\n    utils.copyToClipboard(Game.getPositionNotation(this.state.position));\r\n    alert('Position copied to clipboard');\r\n  };\r\n\r\n  copyPlayPosition = () => {\r\n    utils.copyToClipboard((this.state.selectedGame || this.state.game).positionNotation);\r\n    alert('Play position copied to clipboard');\r\n  };\r\n\r\n  usePosition = () => {\r\n    this.props.usePosition(Game.fromPosition(this.state.position).positionNotation);\r\n  };\r\n\r\n  render() {\r\n    const {user, client, keydown, usePosition} = this.props;\r\n    const {paletteSelectedItem, position, paletteUpdate, positionError, urlError, game, selectedGame, previousPosition} = this.state;\r\n    const settings = user ? user.settings : client.settings;\r\n\r\n    const positionNotation = Game.getPositionNotation(position);\r\n    return (\r\n      <Fragment>\r\n        <Modal\r\n          open={!!urlError}\r\n          size={'mini'}\r\n          onClose={this.dismissUrlPositionError}\r\n          header={'Could not load shared position'}\r\n          content={`${urlError}. Please check that you copied the full URL`}\r\n          actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n        />\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu inverted size={'massive'} items={[\r\n              {key: 'share', icon: 'share', content: 'Share position', color: 'green', active: true, as: 'a',\r\n                href: `?position=${positionNotation}`,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to position'},\r\n              {key: 'copy', icon: 'clipboard', content: 'Copy position', color: 'green', active: true,\r\n                title: 'Click to copy position to position', onClick: this.copyPosition},\r\n              {key: 'copy-play', icon: 'clipboard', content: 'Copy play position', color: 'green', active: true,\r\n                title: 'Click to copy play position to position', onClick: this.copyPlayPosition},\r\n            ]} />\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Segment>\r\n          {positionError ? <Message error content={positionError} /> : null}\r\n          <Play\r\n            user={user}\r\n            settings={settings}\r\n            defaultSettings={client.settings}\r\n            game={game}\r\n            makeMove={this.makeMove}\r\n            onSelectedGameChange={this.onSelectedGameChange}\r\n          >\r\n            <div>\r\n              <Button\r\n                content={'Reset game'}\r\n                primary\r\n                onClick={this.resetGame}\r\n              />\r\n            </div>\r\n            <EditPositionPalette\r\n              selectedItem={paletteSelectedItem}\r\n              onSelectedItemChange={this.onPaletteSelectedItemChange}\r\n              keydown={keydown}\r\n            />\r\n            <div>\r\n              <Button\r\n                content={'Copy from game'}\r\n                primary\r\n                disabled={(selectedGame || game).positionNotation === positionNotation}\r\n                onClick={this.copyGame}\r\n              />\r\n              <Button\r\n                content={'Reset'}\r\n                negative\r\n                disabled={positionNotation === this.constructor.initialPositionNotation}\r\n                onClick={this.resetBoard}\r\n              />\r\n              <Button\r\n                content={'Undo'}\r\n                secondary\r\n                disabled={!previousPosition}\r\n                onClick={this.undo}\r\n              />\r\n            </div>\r\n            <EditPositionBoard\r\n              position={position}\r\n              update={paletteUpdate}\r\n              onPositionChange={this.onPositionChange}\r\n            />\r\n            {usePosition ? (\r\n              <div>\r\n                <Button\r\n                  content={'Use position'}\r\n                  primary\r\n                  onClick={this.usePosition}\r\n                  disabled={!!positionError}\r\n                />\r\n              </div>\r\n            ) : null}\r\n          </Play>\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nEditPosition.propTypes = {\r\n  keydown: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  usePosition: PropTypes.func,\r\n  initialPositionNotation: PropTypes.string,\r\n};\r\n\r\nclass EditPositionPalette extends Component {\r\n  static rowsAndColumns = [\r\n    {y: 0, cells: [\r\n      {x: 0, y: 0, level: 0, player: null, worker: null},\r\n      {x: 1, y: 0, level: 1, player: null, worker: null},\r\n      {x: 2, y: 0, level: 2, player: null, worker: null},\r\n      {x: 3, y: 0, level: 3, player: null, worker: null},\r\n      {x: 4, y: 0, level: 4, player: null, worker: null},\r\n    ]},\r\n    {y: 1, cells: [\r\n      {x: 0, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n      {x: 1, y: 1, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n      {x: 2, y: 1, level: 0, player: null, worker: null},\r\n      {x: 3, y: 1, level: 0, player: null, worker: null},\r\n      {x: 4, y: 1, level: 0, player: null, worker: null},\r\n    ]},\r\n  ];\r\n  static keys = [\r\n    'q', '0', '1', '2', '3', '4', 'a', 'b',\r\n  ];\r\n  static moveFromKey = {\r\n    'q': {x: 0, y: 0},\r\n    0: {x: 0, y: 0},\r\n    1: {x: 1, y: 0},\r\n    2: {x: 2, y: 0},\r\n    3: {x: 3, y: 0},\r\n    4: {x: 4, y: 0},\r\n    a: {x: 0, y: 1},\r\n    b: {x: 1, y: 1},\r\n  };\r\n\r\n  state = {\r\n    selectedItem: {x: 0, y: 1},\r\n  };\r\n\r\n  componentWillReceiveProps({keydown}) {\r\n    if (keydown.event) {\r\n      const {key} = keydown.event;\r\n      const coordinates = this.constructor.moveFromKey[key];\r\n      if (coordinates) {\r\n        const {x, y} = coordinates;\r\n        const move = this.constructor.rowsAndColumns[y].cells[x];\r\n        this.makeMove(move);\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.selectedItem !== undefined && this.props.selectedItem === undefined) {\r\n      this.setState({selectedItem: prevProps.selectedItem});\r\n    }\r\n  }\r\n\r\n  get selectedItem() {\r\n    if (this.props.selectedItem === undefined) {\r\n      return this.state.selectedItem;\r\n    } else {\r\n      return this.props.selectedItem;\r\n    }\r\n  }\r\n\r\n  isCellAvailable = cell => {\r\n    return !this.isCellUndoable(cell) && (cell.y === 0 || cell.x <= 1);\r\n  };\r\n\r\n  isCellUndoable = cell => {\r\n    const {selectedItem} = this;\r\n    return cell.x === selectedItem.x && cell.y === selectedItem.y;\r\n  };\r\n\r\n  makeMove = cell => {\r\n    const selectedItem = {x: cell.x, y: cell.y};\r\n    if (this.props.selectedItem === undefined) {\r\n      this.setState({selectedItem: selectedItem});\r\n    }\r\n    if (this.props.onSelectedItemChange) {\r\n      const update = cell.player ? {player: cell.player} : {level: cell.level};\r\n      this.props.onSelectedItemChange(selectedItem, update);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {user, client} = this.props;\r\n    const settings = user ? user.settings : client.settings;\r\n\r\n    return (\r\n      <BoardBackground\r\n        medium\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={this.constructor.rowsAndColumns}\r\n        clickable undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        makeMove={this.makeMove}\r\n        settings={settings}\r\n        animated={false}\r\n        showArrows={false}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditPositionPalette.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  selectedItem: PropTypes.object,\r\n  onSelectedItemChange: PropTypes.func,\r\n  keydown: PropTypes.object.isRequired,\r\n};\r\n\r\nEditPositionPalette = withClient(EditPositionPalette);\r\n\r\nclass EditPositionBoard extends Component {\r\n  state = {\r\n    position: Game.getInitialRowsAndColumns(),\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.position !== undefined && this.props.position === undefined) {\r\n      this.setState({position: prevProps.position});\r\n    }\r\n  }\r\n\r\n  get position() {\r\n    if (this.props.position === undefined) {\r\n      return this.state.position;\r\n    } else {\r\n      return this.props.position;\r\n    }\r\n  }\r\n\r\n  isCellAvailable = () => {\r\n    return true;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  makeMove = cell => {\r\n    const {update} = this.props;\r\n    if ('level' in update) {\r\n      if (cell.level !== update.level) {\r\n        this.updatePosition({x: cell.x, y: cell.y, level: update.level});\r\n      }\r\n    } else if ('player' in update) {\r\n      if (cell.player !== update.player) {\r\n        this.updatePosition({x: cell.x, y: cell.y, player: update.player, worker: Game.WORKER_FIRST});\r\n      } else {\r\n        this.updatePosition({x: cell.x, y: cell.y, player: null, worker: null});\r\n      }\r\n    }\r\n  };\r\n\r\n  updatePosition = newCell => {\r\n    const newPosition = Game.updateCells(this.position, newCell);\r\n\r\n    if (this.props.position === undefined) {\r\n      this.setState({position: newPosition});\r\n    }\r\n    if (this.props.onPositionChange) {\r\n      this.props.onPositionChange(newPosition);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {position} = this;\r\n    const {user, client} = this.props;\r\n    const settings = user ? user.settings : client.settings;\r\n\r\n    return (\r\n      <BoardBackground\r\n        medium\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={position}\r\n        clickable undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        makeMove={this.makeMove}\r\n        settings={settings}\r\n        animated={false}\r\n        showArrows={false}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditPositionBoard.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  position: PropTypes.array,\r\n  update: PropTypes.object.isRequired,\r\n  onPositionChange: PropTypes.func,\r\n};\r\n\r\nEditPositionBoard = withClient(EditPositionBoard);\r\n\r\nexport default keydown(EditPositionPalette.SubComponent.keys)(withClient(EditPosition));\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Checkbox, Form, Grid, Header, Icon, Input, Segment} from \"semantic-ui-react\";\r\nimport Game from \"../game/game\";\r\nimport _ from \"lodash\";\r\nimport Board from \"./Board\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport Play from \"./Play\";\r\nimport EditPosition from \"./EditPosition\";\r\nimport moment from \"moment\";\r\n\r\nclass CreateChallenge extends Component {\r\n  state = {\r\n    editing: true,\r\n    challenge: null,\r\n    currentStep: null,\r\n    tree: null,\r\n    game: null,\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.props.initialChallenge) {\r\n      this.onCreateChallenge(this.fillGames(this.props.initialChallenge));\r\n    }\r\n  }\r\n\r\n  fillGames(challengeStep) {\r\n    challengeStep = {...challengeStep};\r\n    if (!challengeStep.game && challengeStep.position) {\r\n      challengeStep.game = Game.fromCompressedPositionNotation(challengeStep.position);\r\n    }\r\n    if (challengeStep.startingPosition) {\r\n      challengeStep.startingPosition = this.fillGames(challengeStep.startingPosition);\r\n    } else if (challengeStep.playerResponses) {\r\n      challengeStep.playerResponses = challengeStep.playerResponses.map(this.fillGames);\r\n    } else if (challengeStep.challengeResponse) {\r\n      challengeStep.challengeResponse = this.fillGames(challengeStep.challengeResponse);\r\n    }\r\n\r\n    return challengeStep;\r\n  }\r\n\r\n  onCreateChallenge = challenge => {\r\n    this.setState({\r\n      editing: false,\r\n      challenge,\r\n      currentStep: challenge.startingPosition,\r\n      tree: this.getTree(challenge.startingPosition),\r\n      game: challenge.startingPosition.game,\r\n    });\r\n  };\r\n\r\n  getDifficultyStars(difficulty, maxDifficulty) {\r\n    return _.range(maxDifficulty).map(index => (\r\n      <Icon\r\n        key={index}\r\n        name={difficulty > index ? 'star' : 'star outline'}\r\n        color={'yellow'}\r\n      />\r\n    ));\r\n  }\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  getExistingResponse(newGame) {\r\n    const {currentStep} = this.state;\r\n    if (currentStep.playerResponses) {\r\n      return currentStep.playerResponses\r\n        .find(response => response.position === newGame.positionNotation);\r\n    } else {\r\n      if (currentStep.challengeResponse && currentStep.challengeResponse.position === newGame.positionNotation) {\r\n        return currentStep.challengeResponse;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  getPathIndexes() {\r\n    const {currentStep, tree} = this.state;\r\n    let treePath = tree.find(treePath => treePath.find(treePathStep => treePathStep === currentStep));\r\n    treePath = treePath.slice(0, treePath.findIndex(treePathStep => treePathStep === currentStep) + 1);\r\n    const pathIndexes = treePath.map((treePathStep, index) =>\r\n      index === 0\r\n        ? ['challenge', 'startingPosition']\r\n        : (\r\n          treePath[index - 1].playerResponses\r\n            ? ['playerResponses', treePath[index - 1].playerResponses.indexOf(treePathStep)]\r\n            : ['challengeResponse']\r\n        )\r\n    );\r\n\r\n    return pathIndexes;\r\n  }\r\n\r\n  duplicateChallenge(pathIndexes) {\r\n    const {challenge} = this.state;\r\n\r\n    const newChallenge = {\r\n      ...challenge,\r\n      startingPosition: {...challenge.startingPosition},\r\n    };\r\n    let newModifyingStep = newChallenge.startingPosition;\r\n    for (const index of _.flatten(pathIndexes.slice(1))) {\r\n      const oldStep = newModifyingStep[index];\r\n      const newStep = Array.isArray(oldStep) ? oldStep.slice() : {...oldStep};\r\n      newModifyingStep[index] = newStep;\r\n      newModifyingStep = newStep;\r\n    }\r\n\r\n    return {newChallenge, newModifyingStep};\r\n  }\r\n\r\n  addGameToStep(newModifyingStep, newGame) {\r\n    let newStep = null;\r\n    if (newModifyingStep.playerResponses) {\r\n      newModifyingStep.playerResponses = newModifyingStep.playerResponses.slice();\r\n      newModifyingStep = newModifyingStep.playerResponses;\r\n      newStep = {\r\n        position: newGame.positionNotation,\r\n        moves: newGame.lastMovesInHistory,\r\n        game: newGame,\r\n        challengeResponse: null,\r\n      };\r\n      newModifyingStep.push(newStep);\r\n    } else {\r\n      newStep = {\r\n        position: newGame.positionNotation,\r\n        moves: newGame.lastMovesInHistory,\r\n        game: newGame,\r\n        playerResponses: [],\r\n      };\r\n      newModifyingStep.challengeResponse = newStep;\r\n    }\r\n\r\n    return newStep;\r\n  }\r\n\r\n  removeStep(newModifyingStep, step) {\r\n    if (newModifyingStep.playerResponses) {\r\n      newModifyingStep.playerResponses = newModifyingStep.playerResponses.filter(response => response !== step);\r\n    } else {\r\n      newModifyingStep.challengeResponse = null;\r\n    }\r\n\r\n    return newModifyingStep;\r\n  }\r\n\r\n  submit = moves => {\r\n    const {currentStep} = this.state;\r\n    const newGame = currentStep.game.makeMoves(moves);\r\n\r\n    const existingResponse = this.getExistingResponse(newGame);\r\n    if (existingResponse) {\r\n      this.setState({\r\n        currentStep: existingResponse,\r\n        game: existingResponse.game,\r\n      });\r\n      return;\r\n    }\r\n\r\n    const pathIndexes = this.getPathIndexes();\r\n    let {newChallenge, newModifyingStep} = this.duplicateChallenge(pathIndexes);\r\n    let newStep = this.addGameToStep(newModifyingStep, newGame);\r\n    this.setState({\r\n      challenge: newChallenge,\r\n      currentStep: newStep,\r\n      tree: this.getTree(newChallenge.startingPosition),\r\n      game: newStep.game,\r\n    });\r\n  };\r\n\r\n  getTree(startingPosition = this.state.challenge.startingPosition) {\r\n    let tree = [[startingPosition]];\r\n    while (tree !== (tree = this.getNextTree(tree))) {}\r\n\r\n    return tree;\r\n  }\r\n\r\n  getNextTree(tree) {\r\n    const nextTree = _.flatten(tree.map(this.getNextTreePath));\r\n    if (nextTree.length !== tree.length) {\r\n      return nextTree;\r\n    }\r\n    if (tree.find((treePath, index) => treePath !== nextTree[index])) {\r\n      return nextTree;\r\n    }\r\n\r\n    return tree;\r\n  }\r\n\r\n  getNextTreePath = treePath => {\r\n    const lastTreeStep = treePath[treePath.length - 1];\r\n    if (lastTreeStep.playerResponses) {\r\n      if (lastTreeStep.playerResponses.length) {\r\n        return lastTreeStep.playerResponses.map(nextStep => treePath.concat(nextStep));\r\n      } else {\r\n        return [treePath];\r\n      }\r\n    } else {\r\n      if (lastTreeStep.challengeResponse) {\r\n        return [treePath.concat(lastTreeStep.challengeResponse)];\r\n      } else {\r\n        return [treePath];\r\n      }\r\n    }\r\n  };\r\n\r\n  deleteCurrentStep = () => {\r\n    const {currentStep} = this.state;\r\n    const pathIndexes = this.getPathIndexes().slice(0, -1);\r\n    let {newChallenge, newModifyingStep} = this.duplicateChallenge(pathIndexes);\r\n    let newStep = this.removeStep(newModifyingStep, currentStep);\r\n    this.setState({\r\n      challenge: newChallenge,\r\n      currentStep: newStep,\r\n      tree: this.getTree(newChallenge.startingPosition),\r\n      game: newStep.game,\r\n    });\r\n  };\r\n\r\n  editChallenge = () => {\r\n    this.setState({editing: true});\r\n  };\r\n\r\n  createChallenge = () => {\r\n    const cleanedChallenge = JSON.parse(JSON.stringify(this.state.challenge, (key, value) => {\r\n      if (value instanceof Game) {\r\n        return undefined;\r\n      } else {\r\n        return value;\r\n      }\r\n    }));\r\n    this.props.client.createChallenge(cleanedChallenge);\r\n  };\r\n\r\n  discardChallenge = () => {\r\n    this.setState({\r\n      editing: true,\r\n      challenge: null,\r\n      currentStep: null,\r\n      tree: null,\r\n      game: null,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {user, client} = this.props;\r\n    const {editing, challenge, game, tree, currentStep} = this.state;\r\n    const settings = user ? user.settings : client.settings;\r\n\r\n    if (editing) {\r\n      return (\r\n        <ChallengeForm initialChallenge={challenge} onCreateChallenge={this.onCreateChallenge} />\r\n      )\r\n    }\r\n    const challengePrompt = challenge.options.type === 'mate' ? `Find mate in ${challenge.options.typeOptions.mateIn}` : 'Unknown challenge';\r\n\r\n    return (\r\n      <Fragment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Segment>\r\n              <Header as={'h1'}>{challengePrompt}</Header>\r\n              <Header as={'h4'} className={'difficulty-header'}>{this.getDifficultyStars(challenge.meta.difficulty, challenge.meta.maxDifficulty)}</Header>\r\n              <Header as={'h4'}>{challenge.meta.source}</Header>\r\n            </Segment>\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Button secondary onClick={this.editChallenge}>Edit</Button>\r\n            <Button positive onClick={this.createChallenge}>Create</Button>\r\n            <Button negative onClick={this.discardChallenge}>Discard</Button>\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Segment>\r\n          <Header as={'h3'}>Tree</Header>\r\n          <table>\r\n            <tbody>\r\n            {tree.map((treePath, rowIndex) => (\r\n              <tr key={rowIndex}>\r\n                {treePath.map((treePathStep, columnIndex) => (\r\n                  <td key={columnIndex}>\r\n                    {rowIndex === 0 || treePathStep !== tree[rowIndex - 1][columnIndex] ? (\r\n                      <Board\r\n                        small\r\n                        selected={game === treePathStep.game}\r\n                        onSelect={() => {\r\n                          this.setState({\r\n                            currentStep: treePathStep,\r\n                            game: treePathStep.game,\r\n                          });\r\n                        }}\r\n                        settings={settings}\r\n                        game={treePathStep.game}\r\n                      />\r\n                    ) : null}\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n            </tbody>\r\n          </table>\r\n        </Segment>\r\n        {currentStep.game ? <Segment>\r\n          <Header as={'h3'}>Current step</Header>\r\n          <Play\r\n            user={user}\r\n            defaultSettings={client.settings}\r\n            changeSettings={this.changeSettings}\r\n            game={game}\r\n            allowControl={[currentStep.game.nextPlayer]}\r\n            names={{[challenge.options.initialPlayer]: 'Player', [Game.OTHER_PLAYER[challenge.options.initialPlayer]]: 'Challenge'}}\r\n            submit={this.submit}\r\n            onDisplayPositionChange={this.onDisplayPositionChange}\r\n            makeMove={this.makeMove}\r\n          >\r\n            <Button negative disabled={currentStep === challenge} onClick={this.deleteCurrentStep}>\r\n              <Icon name={'delete'}/>Delete response\r\n            </Button>\r\n          </Play>\r\n        </Segment> : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nCreateChallenge.propTypes = {\r\n  initialChallenge: PropTypes.object,\r\n};\r\n\r\nclass ChallengeForm extends Component {\r\n  static valueConversion = {\r\n    'options.typeOptions.mateIn': parseInt,\r\n    'meta.difficulty': parseInt,\r\n    'meta.publishDatetime': timestamp => timestamp ? moment(timestamp) : null,\r\n  };\r\n\r\n  state = {\r\n    challenge: this.props.initialChallenge || {\r\n      options: {\r\n        initialPlayer: null,\r\n        type: 'mate',\r\n        typeOptions: {\r\n          mateIn: 1,\r\n        },\r\n      },\r\n      meta: {\r\n        source: '',\r\n        difficulty: 1,\r\n        maxDifficulty: 3,\r\n        public: true,\r\n        publishDatetime: null,\r\n      },\r\n      startingPosition: {\r\n        position: Game.create().positionNotation,\r\n        game: Game.create(),\r\n        playerResponses: [],\r\n      },\r\n    },\r\n    error: {\r\n      position: null,\r\n    },\r\n    editingPosition: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (!this.props.initialChallenge) {\r\n      const params = new URLSearchParams(window.location.search);\r\n      const position = params.get('position');\r\n      if (position) {\r\n        this.setValue(null, {name: 'startingPosition.position', value: position});\r\n        this.setState({editingPosition: true});\r\n      }\r\n    }\r\n  }\r\n\r\n  setValue = (e, {name, value, checked}) => {\r\n    if (value === undefined && typeof checked === typeof true) {\r\n      value = checked;\r\n    }\r\n    let convertedValue = value;\r\n    if (name in this.constructor.valueConversion) {\r\n      convertedValue = this.constructor.valueConversion[name](convertedValue);\r\n    }\r\n    this.setState(state => {\r\n      const challenge = {\r\n        ...state.challenge,\r\n      };\r\n      let newChallengeToChange = challenge;\r\n      const parts = name.split('.');\r\n      for (const part of parts.slice(0, parts.length - 1)) {\r\n        newChallengeToChange = newChallengeToChange[part] || {};\r\n      }\r\n      newChallengeToChange[parts[parts.length - 1]] = convertedValue;\r\n      return {challenge};\r\n    });\r\n    this.onValueSet(name, convertedValue);\r\n  };\r\n\r\n  onValueSet = name => {\r\n    if (name === 'startingPosition.position') {\r\n      this.setState(state => {\r\n        const position = state.challenge.startingPosition.position;\r\n        const isPositionValid = position\r\n          ? Game.isValidCompressedPositionNotation(position) : false;\r\n        const game = isPositionValid ? Game.fromCompressedPositionNotation(position) : null;\r\n        return {\r\n          error: {\r\n            ...state.error,\r\n            position: !position || isPositionValid ? null : 'This is not a valid position',\r\n          },\r\n          challenge: {\r\n            ...state.challenge,\r\n            options: {\r\n              ...state.challenge.options,\r\n              initialPlayer: game ? game.nextPlayer : null,\r\n            },\r\n            startingPosition: {\r\n              ...state.challenge.startingPosition,\r\n              game,\r\n            }\r\n          },\r\n        };\r\n      });\r\n    }\r\n  };\r\n\r\n  createChallenge = () => {\r\n    const {challenge, error} = this.state;\r\n    if (error.position) {\r\n      return;\r\n    }\r\n    this.props.onCreateChallenge(challenge);\r\n  };\r\n\r\n  usePosition = positionNotation => {\r\n    this.setState({\r\n      editingPosition: false,\r\n    });\r\n    this.setValue(null, {name: 'startingPosition.position', value: positionNotation});\r\n  };\r\n\r\n  editPosition = () => {\r\n    this.setState({editingPosition: true});\r\n  };\r\n\r\n  render() {\r\n    const {user, client, initialChallenge} = this.props;\r\n    const {editingPosition, challenge, error} = this.state;\r\n    const settings = user ? user.settings : client.settings;\r\n\r\n    if (editingPosition) {\r\n      return (\r\n        <EditPosition\r\n          usePosition={this.usePosition}\r\n          initialPositionNotation={challenge.startingPosition.position}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Header>Create a challenge</Header>\r\n        <Segment>\r\n          <Form onSubmit={this.createChallenge}>\r\n            <Form.Group>\r\n              <Form.Field\r\n                name={'startingPosition.position'}\r\n                control={Input}\r\n                label={'Initial position'}\r\n                placeholder={'Game position'}\r\n                onChange={this.setValue}\r\n                value={challenge.startingPosition.position}\r\n                required\r\n                error={error.position}\r\n              />\r\n              <Button\r\n                content={'Edit position'}\r\n                secondary\r\n                onClick={this.editPosition}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group inline>\r\n              <label>Starting player</label>\r\n              <Form.Radio\r\n                name={'options.initialPlayer'}\r\n                label={'Player A'}\r\n                onChange={this.setValue}\r\n                value={Game.PLAYER_A}\r\n                checked={challenge.options.initialPlayer === Game.PLAYER_A}\r\n                disabled={challenge.options.initialPlayer !== Game.PLAYER_A}\r\n              />\r\n              <Form.Radio\r\n                name={'options.initialPlayer'}\r\n                label={'Player B'}\r\n                onChange={this.setValue}\r\n                value={Game.PLAYER_B}\r\n                checked={challenge.options.initialPlayer === Game.PLAYER_B}\r\n                disabled={challenge.options.initialPlayer !== Game.PLAYER_B}\r\n              />\r\n            </Form.Group>\r\n            {challenge.startingPosition.game ? (\r\n              <Board\r\n                medium\r\n                settings={settings}\r\n                game={challenge.startingPosition.game}\r\n              />\r\n            ) : null}\r\n            <Form.Select\r\n              options={[\r\n                {key: 'mate', value: 'mate', text: 'Mate'},\r\n              ]}\r\n              name={'options.type'}\r\n              label={'Type'}\r\n              onChange={this.setValue}\r\n              required\r\n              value={challenge.options.type}\r\n            />\r\n            <Form.Group>\r\n              <Form.Field\r\n                control={Input}\r\n                type={'range'}\r\n                label={`Mate In: ${challenge.options.typeOptions.mateIn}`}\r\n                min={1}\r\n                max={10}\r\n                name={'options.typeOptions.mateIn'}\r\n                onChange={this.setValue}\r\n                required\r\n                value={challenge.options.typeOptions.mateIn}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Field\r\n                control={Input}\r\n                label={'Source'}\r\n                name={'meta.source'}\r\n                onChange={this.setValue}\r\n                value={challenge.meta.source}\r\n              />\r\n              <Form.Field\r\n                control={Input}\r\n                type={'range'}\r\n                label={`Difficulty: ${challenge.meta.difficulty}/${challenge.meta.maxDifficulty}`}\r\n                min={1}\r\n                max={challenge.meta.maxDifficulty}\r\n                name={'meta.difficulty'}\r\n                onChange={this.setValue}\r\n                required\r\n                value={challenge.meta.difficulty}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Field\r\n                control={Checkbox}\r\n                label={'Public'}\r\n                name={'meta.public'}\r\n                onChange={this.setValue}\r\n                checked={challenge.meta.public}\r\n              />\r\n              <Form.Field\r\n                control={Input}\r\n                type={'datetime-local'}\r\n                label={'Publish On'}\r\n                name={'meta.publishDatetime'}\r\n                onChange={this.setValue}\r\n                value={challenge.meta.publishDatetime ? challenge.meta.publishDatetime.format(\"YYYY-MM-DDTHH:mm\") : ''}\r\n              />\r\n            </Form.Group>\r\n            <Form.Button primary content={initialChallenge ? 'Update' : 'Create'} />\r\n          </Form>\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeForm.propTypes = {\r\n  initialChallenge: PropTypes.object,\r\n  onCreateChallenge: PropTypes.func.isRequired,\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nChallengeForm = withClient(ChallengeForm);\r\n\r\nexport default withClient(CreateChallenge);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withRouter} from \"react-router-dom\";\r\nimport {Modal} from \"semantic-ui-react\";\r\nimport CreateChallenge from \"./CreateChallenge\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass EditChallenge extends Component {\r\n  get challenge() {\r\n    const {match, challengesInfo: {byId}} = this.props;\r\n    const challenge = byId[match.params.id];\r\n    return challenge;\r\n  }\r\n\r\n  dismissUrlChallengeError = () => {\r\n    this.props.history.push('/challenge');\r\n  };\r\n\r\n  render() {\r\n    const challenge = this.challenge;\r\n    if (!challenge) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlChallengeError}\r\n            header={'Could not find challenge'}\r\n            content={'This challenge cannot be found. Please check that you copied the full URL, or perhaps the challenge was deleted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find challenge\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <CreateChallenge initialChallenge={challenge} />\r\n    );\r\n  }\r\n}\r\n\r\nEditChallenge.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  history: PropTypes.object.isRequired,\r\n  challengesInfo: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(EditChallenge));\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../game/game\";\r\nimport {Button, Grid, Header, Icon, Label, Menu, Message, Modal, Segment, Tab} from \"semantic-ui-react\";\r\nimport Play from \"./Play\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport _ from 'lodash';\r\nimport \"../styles/challenges.css\";\r\nimport ChallengeList from \"./ChallengeList\";\r\nimport {Link, NavLink, Route, Switch, withRouter} from \"react-router-dom\";\r\nimport CreateChallenge from \"./CreateChallenge\";\r\nimport EditChallenge from \"./EditChallenge\";\r\nimport * as utils from \"../utils\";\r\n\r\nclass Challenges extends Component {\r\n  render() {\r\n    const {challengesInfo: {otherStarted, otherNotStarted, otherSolved, mine}} = this.props;\r\n\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Fragment>\r\n            <Segment>\r\n              <Link to={`${this.props.match.path}/create`}><Button content={'Create Challenge'} /></Link>\r\n            </Segment>\r\n            <Tab menu={{pointing: true}} panes={[\r\n              {key: 'other-started', label: \"Started Challenges\", items: otherStarted, color: 'green'},\r\n              {key: 'other-not-started', label: \"New Challenges\", items: otherNotStarted},\r\n              {key: 'other-solved', label: \"Solved Challenges\", items: otherSolved},\r\n              {key: 'mine', label: \"My Challenges\", items: mine},\r\n            ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                <ChallengeList selectChallenge={this.props.selectLiveChallenge} challenges={items} />\r\n              )}\r\n            ))} />\r\n          </Fragment>\r\n        </Route>\r\n        {process.env.REACT_APP_DEBUG ? (\r\n          <Route exact path={`${this.props.match.path}/create`}>\r\n            <CreateChallenge />\r\n          </Route>\r\n        ) : null}\r\n        {process.env.REACT_APP_DEBUG ? (\r\n          <Route exact path={`${this.props.match.path}/:id/edit`}>\r\n            <EditChallenge />\r\n          </Route>\r\n        ) : null}\r\n        <Route exact path={`${this.props.match.path}/:id`}>\r\n          <ChallengePlayer selectLiveChallenge={this.props.selectLiveChallenge} />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nChallenges.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  liveChallenge: PropTypes.object,\r\n  selectLiveChallenge: PropTypes.func.isRequired,\r\n};\r\n\r\nclass ChallengePlayer extends Component {\r\n  state = {\r\n    challengeId: this.challenge ? this.challenge.id : null,\r\n    game: this.getResumedChallengeGame(),\r\n    submittedGame: null,\r\n    path: this.challenge ? [] : null,\r\n    wrongMove: false,\r\n    won: false,\r\n  };\r\n\r\n  get challenge() {\r\n    const {match, challengesInfo: {byId}} = this.props;\r\n    const challenge = byId[match.params.id];\r\n    return challenge;\r\n  }\r\n\r\n  get userChallenge() {\r\n    const challenge = this.challenge;\r\n    if (!challenge) {\r\n      return null;\r\n    }\r\n    const {user} = this.props;\r\n    return user.challenges[challenge.id] || {\r\n      meta: {\r\n        started: false,\r\n        mistakes: 0,\r\n        won: false,\r\n      },\r\n      startingPosition: {\r\n        position: challenge.startingPosition.position,\r\n        invalidPlayerPositions: [],\r\n        playerResponses: [],\r\n      },\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const challenge = this.challenge;\r\n\r\n    if (challenge) {\r\n      this.props.selectLiveChallenge(challenge);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    const challenge = this.challenge;\r\n\r\n    if (challenge && prevState.challengeId !== challenge.id) {\r\n      this.props.selectLiveChallenge(challenge);\r\n      this.setState({\r\n        challengeId: challenge.id,\r\n        game: this.getResumedChallengeGame(),\r\n        submittedGame: null,\r\n        path: [],\r\n        wrongMove: false,\r\n        won: false,\r\n      });\r\n    }\r\n    if (!challenge && this.state.challengeId) {\r\n      this.setState({\r\n          challengeId: null,\r\n          game: null,\r\n          submittedGame: null,\r\n          path: [],\r\n          wrongMove: false,\r\n          won: false,\r\n      });\r\n    }\r\n    if (challenge && this.props.user && this.state.submittedGame) {\r\n      this.updateChallenge(this.state.submittedGame, {askServer: false});\r\n    }\r\n  }\r\n\r\n  submit = (moves, newGame) => {\r\n    if (this.state.won) {\r\n      return;\r\n    }\r\n\r\n    this.updateChallenge(newGame, {askServer: true});\r\n  };\r\n\r\n  getResumedChallengeGame() {\r\n    const userChallenge = this.userChallenge;\r\n    if (!userChallenge) {\r\n      return null;\r\n    }\r\n    let resultingGame = Game.fromCompressedPositionNotation(userChallenge.startingPosition.position);\r\n    let userChallengeStep = userChallenge.startingPosition;\r\n    while (userChallengeStep) {\r\n      const lastPlayerResponse = userChallengeStep.playerResponses[userChallengeStep.playerResponses.length - 1];\r\n      if (!lastPlayerResponse) {\r\n        break;\r\n      }\r\n      resultingGame = resultingGame.makeMoves(lastPlayerResponse.moves);\r\n      if (!lastPlayerResponse.challengeResponse) {\r\n        break;\r\n      }\r\n      resultingGame = resultingGame.makeMoves(lastPlayerResponse.challengeResponse.moves);\r\n      userChallengeStep = lastPlayerResponse.challengeResponse;\r\n    }\r\n\r\n    return resultingGame;\r\n  }\r\n\r\n  updateChallenge(gameToUpdate, {askServer = true} = {}) {\r\n    const {user} = this.props;\r\n    if (!user) {\r\n      return;\r\n    }\r\n    const challenge = this.challenge;\r\n    const userChallenge = this.userChallenge;\r\n\r\n    const history = gameToUpdate.history;\r\n    let userChallengeStep = userChallenge.startingPosition;\r\n    let remainingHistory = history.slice(1).filter((game, index) => index % 2 === 0);\r\n    if (!remainingHistory.length) {\r\n      return;\r\n    }\r\n    while (remainingHistory.length) {\r\n      const historyGame = remainingHistory.shift();\r\n      if (userChallengeStep.invalidPlayerPositions.includes(historyGame.positionNotation)) {\r\n        this.setState({\r\n          wrongMove: true,\r\n          won: false,\r\n          submittedGame: null,\r\n        });\r\n        return;\r\n      }\r\n      const validPlayerResponse = userChallengeStep.playerResponses\r\n        .find(response => response.position === historyGame.positionNotation);\r\n      if (!validPlayerResponse) {\r\n        if (askServer) {\r\n          this.props.client.submitChallengeMove(challenge, gameToUpdate.path.filter((item, index) => index % 2 === 0));\r\n          this.setState({submittedGame: gameToUpdate});\r\n        }\r\n        return;\r\n      }\r\n      if (!validPlayerResponse.challengeResponse) {\r\n        this.setState({\r\n          wrongMove: false,\r\n          won: true,\r\n          game: historyGame.positionNotation !== this.state.game.positionNotation ? historyGame : this.state.game,\r\n          submittedGame: null,\r\n        });\r\n        return;\r\n      }\r\n      userChallengeStep = validPlayerResponse.challengeResponse;\r\n    }\r\n\r\n    this.setState({\r\n      game: gameToUpdate.makeMoves(userChallengeStep.moves),\r\n      wrongMove: false,\r\n      won: false,\r\n      submittedGame: null,\r\n    });\r\n  }\r\n\r\n  onDisplayPositionChange = () => {\r\n    if (this.state.wrongMove) {\r\n      this.setState({wrongMove: false, submittedGame: null});\r\n    }\r\n  };\r\n\r\n  getDifficultyStars(difficulty, maxDifficulty) {\r\n    return _.range(maxDifficulty).map(index => (\r\n      <Icon\r\n        key={index}\r\n        name={difficulty > index ? 'star' : 'star outline'}\r\n        color={'yellow'}\r\n      />\r\n    ));\r\n  }\r\n\r\n  dismissUrlChallengeError = () => {\r\n    this.props.selectLiveChallenge(null);\r\n  };\r\n\r\n  close = () => {\r\n    this.props.selectLiveChallenge(null);\r\n  };\r\n\r\n  shareChallenge = e => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const challenge = this.challenge;\r\n      navigator.share({\r\n        title: `Thyra Online - Solve challenge${challenge.options.type === 'mate' ? `: Find mate in ${challenge.options.typeOptions.mateIn}` : ''}`,\r\n        text: `Solve Santorini challenge`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  render() {\r\n    if (!this.props.user) {\r\n      return null;\r\n    }\r\n    const challenge = this.challenge;\r\n    if (!challenge) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlChallengeError}\r\n            header={'Could not find challenge'}\r\n            content={'This challenge cannot be found. Please check that you copied the full URL, or perhaps the challenge was removed'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find challenge\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const {game, wrongMove, won} = this.state;\r\n    if (!game) {\r\n      return null;\r\n    }\r\n\r\n    const {user, client, location} = this.props;\r\n    const challengePrompt = challenge.options.type === 'mate'\r\n      ? `Find mate in ${challenge.options.typeOptions.mateIn}`\r\n      : 'Unknown challenge';\r\n    const message = (\r\n      wrongMove ? (\r\n        <Message error icon={'warning'} content={\"That's not the right answer\"} />\r\n      ) : won ? (\r\n        <Message success icon={'check'} content={\"Correct! You solved it!\"} />\r\n      ) : (\r\n        <Message content={challengePrompt} />\r\n      )\r\n    );\r\n    return (\r\n      <Fragment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} inverted items={[\r\n              {key: 'close', content: 'Close', icon: 'x', onClick: this.close, color: 'red', active: true},\r\n              {key: 'share', content: 'Share Game', icon: 'share', onClick: this.shareChallenge, as: NavLink,\r\n                to: location.pathname, color: 'green', active: true,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to challenge'},\r\n              process.env.REACT_APP_DEBUG && challenge.userId === user.id ? {key: 'edit', content: 'Edit challenge', icon: 'edit', as: NavLink,\r\n                to: `/challenge/${challenge.id}/edit`, color: 'green', active: true,\r\n                title: 'Click to edit the challenge'} : null,\r\n            ].filter(item => item)} />\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Segment>\r\n              <Header as={'h1'}>{challengePrompt}</Header>\r\n              <Header as={'h4'} className={'difficulty-header'}>{this.getDifficultyStars(challenge.meta.difficulty, challenge.meta.maxDifficulty)}</Header>\r\n              <Header as={'h4'}>{challenge.meta.source}</Header>\r\n            </Segment>\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            {message}\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Play\r\n          user={user}\r\n          defaultSettings={client.settings}\r\n          changeSettings={this.changeSettings}\r\n          game={game}\r\n          allowControl={[challenge.options.initialPlayer]}\r\n          names={{[challenge.options.initialPlayer]: 'You', [Game.OTHER_PLAYER[challenge.options.initialPlayer]]: 'Challenge'}}\r\n          submit={this.submit}\r\n          onDisplayPositionChange={this.onDisplayPositionChange}\r\n        >\r\n          {message}\r\n        </Play>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChallengePlayer.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  selectLiveChallenge: PropTypes.func.isRequired\r\n};\r\n\r\nChallengePlayer = withRouter(withClient(ChallengePlayer));\r\n\r\nexport default withRouter(withClient(Challenges));\r\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport 'fomantic-ui-css/semantic.css';\nimport {Container, Header, Label, Message, Segment, Tab} from 'semantic-ui-react';\nimport './styles/App.css';\nimport './styles/semantic-ui.css';\nimport {client} from \"./client/client\";\nimport NavigationalTab from \"./components/NavigationalTab\";\nimport {withRouter} from \"react-router-dom\";\nimport Hotseat from \"./components/Hotseat\";\nimport Lobby, {EditUser, LogIn, LogOut} from \"./components/Lobby\";\nimport OnlineGame from \"./components/OnlineGame\";\nimport {withClient} from \"./client/withClient\";\nimport services from \"./services\";\nimport SvgBoardBackground from \"./components/Board/SvgBoardBackground\";\nimport OnlineTournament from \"./components/OnlineTournament\";\nimport Settings from \"./components/Settings\";\nimport LearnToPlay from \"./components/LearnToPlay\";\nimport Challenges from \"./components/Challenges\";\n\nclass App extends Component {\n  state = {\n    liveGame: null,\n    liveTournament: null,\n    liveChallenge: null,\n  };\n\n  selectLiveGame = liveGame => {\n    let gameUrl;\n    if (liveGame) {\n      gameUrl = `/game/${liveGame.id}`;\n    } else {\n      gameUrl = '/lobby';\n    }\n    if (gameUrl !== this.props.location.pathname) {\n      this.props.history.push(gameUrl);\n    }\n    if (this.state.liveGame === liveGame) {\n      return;\n    }\n    this.setState({liveGame});\n  };\n\n  selectLiveTournament = liveTournament => {\n    let tournamentUrl;\n    if (liveTournament) {\n      tournamentUrl = `/tournament/${liveTournament.id}`;\n    } else {\n      tournamentUrl = `/lobby`;\n    }\n    if (tournamentUrl !== this.props.location.pathname) {\n      this.props.history.push(tournamentUrl);\n    }\n    if (this.state.liveTournament === liveTournament) {\n      return;\n    }\n    this.setState({liveTournament});\n  };\n\n  selectLiveChallenge = liveChallenge => {\n    let challengeUrl;\n    if (liveChallenge) {\n      challengeUrl = `/challenge/${liveChallenge.id}`;\n    } else {\n      challengeUrl = `/lobby`;\n    }\n    if (challengeUrl !== this.props.location.pathname) {\n      this.props.history.push(challengeUrl);\n    }\n    if (this.state.liveChallenge === liveChallenge) {\n      return;\n    }\n    this.setState({liveChallenge});\n  };\n\n  toggleParticipation = tournament => {\n    const {user, client} = this.props;\n\n    if (tournament.userIds.includes(user.id)) {\n      client.leaveTournament(tournament);\n    } else {\n      client.joinTournament(tournament);\n    }\n  };\n\n  startTournament = tournament => {\n    const {client} = this.props;\n\n    client.startTournament(tournament);\n  };\n\n  abortTournament = tournament => {\n    const {client} = this.props;\n\n    client.abortTournament(tournament);\n  };\n\n  componentDidUpdate(prevProps) {\n    this.askForNotificationPermissionOnWaitForGame(prevProps);\n    this.navigateToMyNewGame(prevProps);\n    this.notifyAboutMyMove(prevProps);\n  }\n\n  askForNotificationPermissionOnWaitForGame(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return;\n    }\n    if ((!prevProps.user || !prevProps.user.readyToPlay) && (user && user.readyToPlay) && user.settings.enableNotifications) {\n      services.notifications.requestPermission();\n    }\n  }\n\n  navigateToMyNewGame(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return\n    }\n\n    if (prevProps.gamesInfo.myLive === this.props.gamesInfo.myLive) {\n      return;\n    }\n\n    if (this.state.liveGame && !this.state.liveGame.finished) {\n      return;\n    }\n\n    const previousMyLiveGameIds = new Set(prevProps.gamesInfo.myLive.map(game => game.id));\n    const myLiveGameIds = this.props.gamesInfo.myLive.map(game => game.id);\n    const newMyLiveGameIds = myLiveGameIds.filter(id => !previousMyLiveGameIds.has(id));\n    if (newMyLiveGameIds.length !== 1) {\n      return;\n    }\n\n    const newGame = this.props.gamesInfo.byId[newMyLiveGameIds[0]];\n    if (newGame.move === 1) {\n      const otherUserId = newGame.userIds[0] === user.id ? newGame.userIds[1] : (newGame.userIds[1] === user.id ? newGame.userIds[0] : null);\n      const otherUser = this.props.usersInfo.byId[otherUserId];\n      services.notifications.notify(otherUser ? `New game vs ${otherUser.name} started` : `New game started`);\n    }\n    if (newGame.move === 1) {\n      this.selectLiveGame(newGame);\n    }\n  }\n\n  notifyAboutMyMove(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return;\n    }\n    if (!this.props.gamesInfo.myLive.length) {\n      return;\n    }\n    const gamesThatChangedToMyTurn = this.props.gamesInfo.myLive\n      .filter(game => game.nextUserId === user.id)\n      .filter(game => {\n        const prevGame = prevProps.gamesInfo.byId[game.id];\n        return prevGame && prevGame.nextUserId !== user.id;\n      });\n    if (!gamesThatChangedToMyTurn.length) {\n      return;\n    }\n\n    const otherUsers = gamesThatChangedToMyTurn.map(game => {\n      const otherUserId = game.userIds[0] === user.id ? game.userIds[1] : (game.userIds[1] === user.id ? game.userIds[0] : null);\n      const otherUser = this.props.usersInfo.byId[otherUserId];\n      return otherUser;\n    });\n    const otherUser = otherUsers.length === 1 ? otherUsers[0] : null;\n    services.notifications.notify(otherUser ? `Your turn at game vs ${otherUser.name}` : `It's your turn to play in ${gamesThatChangedToMyTurn.length}`, {\n      tag: 'your-turn',\n      body: `It's your turn to play in ${gamesThatChangedToMyTurn.length} games`,\n    });\n  }\n\n  render() {\n    const {liveGame, liveTournament, liveChallenge} = this.state;\n    const {connected, disconnected, available, user, usersInfo: {byId: usersById}} = this.props;\n    const playerA = liveGame ? usersById[liveGame.userIds[0]] : null;\n    const playerB = liveGame ? usersById[liveGame.userIds[1]] : null;\n    const isUserPlayerA = (user && playerA) ? playerA.id === user.id : false;\n    const isUserPlayerB = (user && playerB) ? playerB.id === user.id : false;\n    const isMyGame = isUserPlayerA || isUserPlayerB;\n    const onlineGameLabel = (liveGame && playerA && playerB)\n      ? (liveGame.finished\n        ? `Review ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`\n        : (isMyGame\n          ? `Live Play ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`\n          : `Spectate ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`))\n      : 'Live Play/Spectate/Review';\n    const isMyTournament = (liveTournament && user) ? liveTournament.userIds.includes(user.id) : false;\n    const onlineTournamentLabel = liveTournament\n      ? (liveTournament.finished\n        ? `Review tournament ${liveTournament.name}`\n        : (isMyTournament\n          ? `Live tournament ${liveTournament.name}`\n          : `Spectate tournament ${liveTournament.name}`))\n      : 'Tournaments';\n    return (\n      <Container>\n        <SvgBoardBackground.Definitions />\n        <Segment textAlign={\"center\"}>\n          <Header as={\"h1\"}>Thyra Online</Header>\n          <Settings/>\n          <LogIn client={client} />\n          {user ? <EditUser client={client} user={user} trigger={<Label as={'a'} icon={'edit'} content={'Edit'}/>} /> : null}\n          <LogOut client={client} />\n        </Segment>\n        {!connected ? (\n          (disconnected || !available) ? (\n            <Message\n              negative\n              header={'Trying to connect ot server...'}\n              content={<p>The server seems to be experiencing problems, or maybe it's a bit slow. It will connect as soon as possible</p>}\n            />\n          ) : (\n            <Message\n              header={'Connecting to server...'}\n              content={<p>Please sit tight as we're trying to connect to the server</p>}\n            />\n          )\n        ) : null}\n        <NavigationalTab menu={{pointing: true, attached: false, stackable: true}} panes={[\n          client.available ? {menuItem: {icon: 'users', content: 'Lobby'}, path: 'lobby', render: () => (\n            <Tab.Pane><Lobby selectLiveGame={this.selectLiveGame} selectLiveTournament={this.selectLiveTournament} selectLiveChallenge={this.selectLiveChallenge} /></Tab.Pane>\n          )} : null,\n          client.available ? {menuItem: {icon: 'play', content: onlineGameLabel}, path: 'game', navigate: liveGame ? `game/${liveGame.id}` : 'game', render: () => (\n            <Tab.Pane><OnlineGame game={liveGame} selectLiveGame={this.selectLiveGame} /></Tab.Pane>\n          )} : null,\n          client.available ? {menuItem: {icon: 'sitemap', content: onlineTournamentLabel}, path: 'tournament', navigate: liveTournament ? `tournament/${liveTournament.id}` : 'tournament', render: () => (\n            <Tab.Pane>\n              <OnlineTournament\n                tournament={liveTournament}\n                selectLiveTournament={this.selectLiveTournament}\n                selectLiveGame={this.selectLiveGame}\n                toggleParticipation={this.toggleParticipation}\n                startTournament={this.startTournament}\n                abortTournament={this.abortTournament}\n              />\n            </Tab.Pane>\n          )} : null,\n          {menuItem: {icon: 'retweet', content: 'Hotseat'}, path: 'hotseat', render: () => (\n            <Tab.Pane><Hotseat /></Tab.Pane>\n          )},\n          process.env.REACT_APP_DEBUG ? {menuItem: {icon: 'shield', content: liveChallenge ? (\n            liveChallenge.options.type === 'mate'\n              ? `Find mate in ${liveChallenge.options.typeOptions.mateIn}`\n              : 'Unknown challenge'\n          ) : 'Challenges'}, path: 'challenge', navigate: liveChallenge ? `challenge/${liveChallenge.id}` : 'challenge', render: () => (\n            <Tab.Pane><Challenges challenge={liveChallenge} selectLiveChallenge={this.selectLiveChallenge} /></Tab.Pane>\n          )} : null,\n          {menuItem: {icon: 'book', content: 'Learn To Play'}, path: 'learn-to-play', render: () => (\n            <Tab.Pane><LearnToPlay /></Tab.Pane>\n          )},\n        ]} />\n        <Header as={\"h6\"} style={{color: '#dddddd'}}>{process.env.REACT_APP_VERSION || '?'}</Header>\n      </Container>\n    );\n  }\n}\n\nApp.propTypes = {\n  location: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  user: PropTypes.object,\n  usersInfo: PropTypes.object.isRequired,\n};\n\nexport default withRouter(withClient(App));\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {BrowserRouter, Route, Switch} from \"react-router-dom\";\n\nReactDOM.render((\n  <BrowserRouter basename={process.env.REACT_APP_PAGE_BASE_PATH}>\n    <Switch>\n      <Route>\n        <App />\n      </Route>\n    </Switch>\n  </BrowserRouter>\n), document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}