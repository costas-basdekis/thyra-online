{"version":3,"sources":["utils.js","client/client.js","components/NavigationalTab.js","game/game.js","components/Board/HtmlBoardBackground.js","components/Board/SvgBoardBackground/LevelIndicator.js","components/Board/SvgBoardBackground/Piece.js","components/Board/SvgBoardBackground/constants.js","components/Board/SvgBoardBackground/Cell.js","components/Board/SvgBoardBackground/Arrow.js","components/Board/SvgBoardBackground/SvgBoardBackground.js","components/Board/SvgBoardBackground/index.js","components/Board/BoardBackground.js","components/Board/Board.js","components/Board/ThemeDemoBoard.js","components/Board/index.js","components/Board/PlayerColourBoard.js","client/withClient.js","components/HashedIcon.js","components/GameList.js","components/CreateTournament.js","components/TournamentList.js","components/ChallengeList.js","components/Lobby.js","components/Play.js","components/Hotseat.js","components/Settings.js","components/OnlineGame.js","services/index.js","services/notifications.js","components/OnlineTournament.js","components/LearnToPlay.js","components/EditPosition.js","components/CreateChallenge.js","components/EditChallenge.js","components/Challenges.js","App.js","serviceWorker.js","index.js"],"names":["copyToClipboard","text","textArea","document","createElement","body","appendChild","value","select","execCommand","removeChild","topicalThemes","from","moment","until","name","override","theme","cells","pieces","scheme","getApplicableSettingsAndNextUpdateDate","settings","on","_getTopicalThemeOverr","arguments","length","undefined","matchingTopicalTheme","find","topicalTheme","isSameOrBefore","isSameOrAfter","nextUpdatedDate","nextTopicalTheme","getTopicalThemeOverrideAndNextUpdateDate","useTopicalTheme","_","merge","applicableSettings","Client","_this","this","Object","classCallCheck","scriptIoReloadInterval","reloadScriptIo","window","io","unavailable","clearInterval","bindSocket","console","log","oldScriptEl","getElementById","newScriptEl","id","type","src","remove","head","append","warn","reload","location","justConnected","getUser","connected","onConnect","map","callback","justDisconnected","disconnected","onDisconnect","gotUser","user","username","token","setSettings","localStorage","setItem","JSON","stringify","onUser","gotUsers","usersInfo","users","orderBy","isUserRatingProvisional","forEach","index","rank","prepareUsers","onUsers","gotGames","games","sortBy","gamesInfo","prepareGames","onGames","gotTournaments","tournaments","tournamentsInfo","prepareTournaments","onTournaments","gotChallenges","challenges","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","challenge","meta","publishDatetime","err","return","challengesInfo","prepareChallenges","onChallenges","gotPersonalChallenges","personalChallenges","concat","other","getItem","password","removeItem","localSettings","parse","e","updateApplicableSettingsTimeout","emit","setInterval","autoSubmitMoves","confirmSubmitMoves","enableNotifications","rotateOpponent","animations","arrows","numbers","_this2","constructor","getDefaultSettings","_utils$getApplicableS","utils","applicableSettingsName","applicableSettingsOverride","clearTimeout","millisecondsUntilUpdate","diff","setTimeout","socket","process","available","callbacks","_i","_arr","push","_i2","_arr2","pull","appVersion","mergeUsers","readyToPlay","otherUsers","_this3","myIndex","findIndex","slice","toConsumableArray","byId","fromPairs","online","filter","includes","offline","readyToPlayMe","challengedUser","_this4","live","game","finished","myLive","userIds","otherLive","myFinished","otherFinished","mine","moves","data","tournament","_this5","future","started","futureAndLive","myFuture","myFutureAndLive","otherFuture","otherFutureAndLive","path","_this6","otherChallenges","userId","public","private","isAfter","otherSolved","won","otherUnsolved","otherStarted","otherNotStarted","client","NavigationalTab","match","props","url","endsWith","_this$props","panes","defaultIndex","defaultTo","activeIndex","activeTo","preparedPanes","pane","originalIndex","_ref","slicedToArray","_ref3","_ref4","to","constructUrl","navigate","pathname","startsWith","menuItem","content","objectSpread","react_default","a","Menu","Item","assign","key","as","NavLink","icon","preparedPane","_this$props2","tab","menu","renderActiveOnly","className","_this$getPreparedPane","getPreparedPanesDefaultToAndActiveIndex","react","react_router","exact","Tab","Component","defaultProps","withRouter","InvalidMoveError","Error","Game","rowsAndColumns","status","previous","lastMove","isNextMove","_this7","history","canUndo","previousInHistory","fullHistory","moveCount","chainCount","resignedPlayer","resign","lastMovesInHistory","indexOf","missingStatusKeys","join","nextPlayer","moveType","availableMovesMatrix","thisPlayer","PLAYER_A","thisMoveType","canTakeMoveBack","moveNotation","MOVE_RESIGNED_NOTATION","MOVE_NOTATION","y","x","fullNotation","compressedFullNotation","split","part","MOVE_NOTATION_COMPRESSION","positionNotation","getPositionNotation","winner","getWinner","hasAvailableMove","OTHER_PLAYER","noMovesAreAvailable","getInitialRowsAndColumns","getInitialStatus","create","makeMoves","row","cell","findCell","player","PLAYERS","worker","WORKERS","level","playerACount","findCells","playerBCount","PLAYER_B","Math","max","apply","flatten","MOVE_TYPE_PLACE_FIRST_WORKER","allMovesAreAvailableMatrix","MOVE_TYPE_PLACE_SECOND_WORKER","getEmptyCellsAvailableMovesMatrix","playerAFirstWorker","WORKER_FIRST","playerASecondWorker","WORKER_SECOND","playerBFirstWorker","playerBSecondWorker","MOVE_TYPE_SELECT_WORKER_TO_MOVE","getPlayerAvailableMovesMatrix","sum","MOVE_REVERSE_NOTATION","move","fromMoves","MOVE_NOTATION_DECOMPRESSION","POSITION_NOTATION_COMPRESSION","notation","ROWS","COLUMNS","POSITION_REVERSE_NOTATION","fromPosition","POSITION_NOTATION_DECOMPRESSION","fromCompressedPositionNotation","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","fromRowsAndColumns","_Game$PLAYER_A","_Game$PLAYER_B","_printMap","_nextPlayerMap","_winnerMap","printMap","defineProperty","chalk","bgWhite","bgYellow","bgRed","bgBlue","cellsPrintout","nextPlayerPrintout","winnerPrintout","black","_ref2","floor","condition","winningCell","canPlayerWin","expectedMoveType","coordinates","targetCoordinates","checkCoordinatesAreValid","createStep","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","makeMove","_makeMoveMethods","makeMoveMethod","placeFirstWorker","placeSecondWorker","selectWorkerToMove","MOVE_TYPE_MOVE_FIRST_WORKER","moveFirstWorker","MOVE_TYPE_MOVE_SECOND_WORKER","moveSecondWorker","MOVE_TYPE_BUILD_AROUND_WORKER","buildAroundWorker","bind","checkCanMakeMove","updateCells","_ref5","createNext","_ref6","getMovableAvailableMovesMatrix","_this$constructor","_this8","fromCell","toCell","getBuildableAvailableMovesMatrix","_ref7","moveWorker","_ref8","_ref9","_ref10","_this9","getAvailableMoves","playerCells","playerCell","abs","_this10","_this11","getAvailableMovesMatrix","_this12","_this13","maximumLevel","_this14","isMoveAvailable","updates","_len","newCells","Array","_key","_newCells","update","MOVE_TYPES_START_OF_TURN","MOVE_TYPES_PLACE_WORKER","MOVE_TYPES_MOVE_WORKER","MOVE_TYPES_MOVE_OR_BUILD","RA","RB","keys","sort","String","fromCharCode","POSITION_NOTATION","entries","_ref11","_ref12","levelStr","notations","_ref13","_ref14","playerStr","parseInt","POSITION_NOTATION_COMPRESSION_MAP","_ref15","_ref17","_ref19","_ref20","_ref21","_ref22","_ref23","_ref24","HtmlBoardBackground","clickable","undoable","isCellAvailable","isCellUndoable","small","medium","onSelect","selected","_settings$theme","classNames","small-board","medium-board","editable","selectable","board-theme-default","board-theme-subtle","board-theme-pastel","board-theme-green","numbered-levels","obvious-levels","subtle-levels","very-subtle-levels","onClick","HtmlBoardBackground_HtmlBoardCell","undo","animated","HtmlBoardCell","displayLevel","LevelIndicatorVerySubtle","transform","constants","dominantBaseline","textAnchor","style","fontSize","PureComponent","LevelIndicatorSubtle","r","fill","stroke","strokeWidth","LevelIndicatorObvious","paintOrder","LevelIndicator","Indicator","indicatorMap","very-subtle","subtle","obvious","BasePieceDefinition","dimensions","offset","xlinkHref","BasePiece","colour","rotated","rotateTransform","definePiece","_ref$offset","PieceDefinitionFor","_PureComponent3","possibleConstructorReturn","getPrototypeOf","inherits","createClass","Piece_BasePieceDefinition","displayName","PieceFor","_PureComponent4","_this$props3","Piece_BasePiece","Definition","PiecePawn","d","PieceKing","PieceCircle","PieceCertificate","PieceSun","PieceRocket","PieceBug","PieceEye","PieceUser","PieceHalloweenWitchHat","PieceHalloweenCauldron","PieceHalloweenBat","PieceHalloweenSpider","PieceHalloweenCat","PieceHalloweenTombstone","PieceHalloweenPumpkin","PieceHalloweenGhost","Piece","_this$props4","PieceStyle","pieceStyleMap","pawn","king","circle","certificate","sun","rocket","bug","eye","halloween-witch-hat","halloween-cauldron","halloween-bat","halloween-spider","halloween-cat","halloween-tombstone","halloween-pumpkin","halloween-ghost","PieceDefinitions","values","Definitions","BaseCellDefinitions","paths","border","level0","level1","level2","level3","level4","defaultBorder","width","height","defineCellDefinitions","CellDefinitionsFor","_PureComponent2","Cell_BaseCellDefinitions","OriginalCellDefinitions","HalloweenCellDefinitions","CellDefinitions","cellDefinitionsStyleMap","CellDefinitionsStyle","original","halloween","Cell","state","previousLevel","currentLevel","levelsAnimate","i","React","createRef","prevProps","prevState","snapshot","levelAnimate","current","beginElement","allowControl","_this$props2$theme","_this$props2$theme$ce","_this$props2$theme$pi","_this$props2$theme$ro","_this$state","isPlayerAOpponent","isPlayerBOpponent","opacity","ref","attributeName","attributeType","dur","repeatCount","SvgBoardBackground_Piece","SvgBoardBackground_LevelIndicator","ArrowDefinition","arrowDimensions","arrowOffset","arrowScaling","hammerDimensions","hammerOffset","hammerScaling","Arrow","_this$constructor2","offsetX","smallScaling","rotation","rotationMap","offsetYFactor","sqrt","0,1","-1,1","-1,0","-1,-1","0,-1","1,-1","1,0","1,1","SvgBoardBackground","transformation","showArrows","rowCount","columnCount","viewBox","--column-count","--row-count","preserveAspectRatio","data-key","SvgBoardBackground_SvgBoardCell","SvgBoardBackground_SvgBoardPieces","arrow","SvgBoardBackground_Arrow","SvgBoardBackground_SvgBoardHistoryArrows","SvgBoardBackgroundDefinitions","display","SvgBoardBackground_Cell","SvgBoardHistoryArrows","_this$getRelevantHist","getRelevantHistory","relevantHistory","gameWithPieceMove","gameWithBuildMove","_move$build","build","reverseCoordinates","iteratingGame","_this$getPlayerMoves","getPlayerMoves","moveArrow","buildArrow","SvgBoardPieces","pointerEvents","SvgBoardBackground_SvgBoardPiece","SvgBoardPiece","previousPosition","position","animateTransform","SvgBoardCell","_this$props5","BoardBackground","_this$props$renderer","renderer","objectWithoutProperties","Renderer","html","svg","Board","takeMoveBack","minChainCount","Board_BoardBackground","isGameUndoable","BoardTransformation","rotations","flippedHorizontally","updateOrientation","method","setState","onChange","_this2$state","transformationMap","rotateCounterClockwise","rotateClockwise","flipHorizontally","flipVertically","reset","size","items","disabled","config","transformRowsAndColumns","reverseTransformCoordinates","flipped","transpose","flipX","flipY","reverseConfig","_this$getNewRowAndCol","getNewRowAndColumnCount","newRowCount","newColumnCount","newXs","range","newY","newX","_this4$getOldCoordina","getOldCoordinates","oldX","oldY","_this$getNewRowAndCol2","_this$getOldCoordinat","0,false","1,false","makeTransformRowsAndColumns","2,false","3,false","0,true","1,true","2,true","3,true","ThemeDemoBoard","demoRowsAndColumns","animate","demoRowsAndColumnsAnimated","animationInterval","PlayerColourBoard","colours","ClientWatcher","connectionChanged","subscribe","unsubscribe","SubComponent","ClientWatcherForComponent","withClient","forComponent","HashedIcon","updateIcon","jdenticon","hash","_classNames","floated","textSized","data-jdenticon-value","GameCard","_Component","_getPrototypeOf2","args","call","selectLiveGame","usersById","tournamentsById","terse","currentGameId","tournamentId","gameGame","deserialize","playerA","playerB","nextPlayerUser","playerAToPlay","playerBToPlay","isUserPlayerA","isUserPlayerB","winnerUser","isMyGame","isMyTurn","showPlayerA","showPlayerB","Card","backgroundColor","attention","Content","components_Board","Header","Label","color","Icon","components_HashedIcon","Meta","endDatetime","startDatetime","GameList","activePage","onPageChange","pageSize","reverse","totalPages","ceil","visibleGames","Group","maxHeight","overflowY","flexWrap","GameList_GameCard","Grid","centered","Row","Pagination","pointing","secondary","gameCount","createTournament","onClose","setValue","Modal","trigger","Button","header","Segment","Form","Field","control","Input","label","placeholder","required","defaultValue","min","actions","positive","TournamentCard","selectLiveTournament","currentTournamentId","isMyTournament","didUserCreated","creatorUserId","didUserWin","winnerUserId","creator","statusLabel","round","rounds","createdDatetime","TournamentList","visibleTournaments","TournamentList_TournamentCard","ChallengeCard","selectChallenge","currentChallengeId","userChallenge","options","typeOptions","mateIn","1","2","3","difficulty","maxDifficulty","title","mistakes","isMyChallenge","fromNow","toNow","startingPosition","get","ChallengeList","visibleChallenges","ChallengeList_ChallengeCard","UserList","readyToPlayUsers","readyToPlayMeUsers","otherUser","Lobby_UserCard","ChallengeUserButton","changeReadyToPlay","challengeUser","playButtonColour","playButtonAttention","playButtonIcon","playButtonOnClick","playButtonLabel","_this$props2$usersInf","loading","UserCard","Lobby_EditUser","hasPassword","winCount","score","tournamentWinCount","tournamentCount","extra","Lobby_ChallengeUserButton","EditUser","changeUsername","target","changePassword","updateUsername","updatePassword","action","negative","LogIn","_Component5","_getPrototypeOf4","_len3","_key3","changeMergeUsers","checked","logIn","_this$state2","modal","float","Checkbox","LogOut","_Component6","_getPrototypeOf5","_len4","_key4","logOut","_this$props5$usersInf","_this$props5$gamesInf","_this$props5$challeng","selectLiveChallenge","render","components_GameList","challengesList","components_ChallengeList","components_CreateTournament","components_TournamentList","Lobby_UserList","Pane","Play","selectedGame","autoSubmitModal","submit","onDisplayPositionChange","newGame","selectGame","onSelectedGameChange","makeMoveToSelected","takeMoveBackToSelected","undoToSelected","deselectGame","getMovesToSubmit","resignOrAbort","changeAutoSubmitMoves","changeSettings","handleOpen","doAutoSubmitMoves","canSubmit","onTransformationChange","propsGame","propsGameIndex","error","resigning","names","matchGame","children","displayGame","tooShortToResign","canTakeBack","controlsNode","Play_PlayPlayer","playerUser","canAnyPlayerSubmit","takeBack","Play_PlayNavigation","Board_BoardTransformation","boardNode","textAlign","columns","Responsive","minWidth","Column","Fragment","maxWidth","stretched","Statistic","widths","inverted","Play_PlayHistory","MOVE_TYPE_NAMES","primary","_names","PlayPlayer","submitAndDisableConfirm","updateSettings","isPlayerControlled","previousGame","isPlayersTurn","playerWon","stackable","Board_PlayerColourBoard","toggle","item","PlayHistory","lastVisibleGame","PlayNavigation","goToCurrentMove","canGoToCurrentMove","goToNextMove","canGoToNextMove","selectedGameIndex","goToAncestor","mostRecentAncestorGameIndex","gameIndexes","goToPreviousMove","canGoToPreviousMove","goToPreviousVariationMove","goToFirstMove","canGoToFirstMove","keydown","event","_keydown$event","which","shiftKey","Keys","left","home","right","_this$gameIndexes","lastGameIndex","_this$gameIndexes2","_this$gameIndexes3","ancestor","getGameAndErrorFromUrlPosition","dismissUrlPositionError","share","href","navigator","catch","alert","open","active","components_Play","URLSearchParams","search","fromCompressedMoveNotation","SettingsContent","themeSchemeOptions","themeCellsOptions","themePiecesOptions","themeNumbersOptions","themeDemoBoard","overrides","Board_ThemeDemoBoard","updateAutoSubmitMove","updateConfirmSubmitMoves","updateEnableNotifications","updateThemeUseTopicalTheme","updateThemeRotateOpponent","updateAnimations","updateArrows","updateThemeNumbers","updateThemeScheme","updateThemePieces","updateThemeCells","_this$props$settings","_theme$cells","_theme$pieces","attached","verticalAlign","option","radio","save","scrolling","Settings_SettingsContent","OnlineGamePlayer","initialPlayer","resultingPlayerScore","initialPlayerA","resultingPlayerAScore","initialPlayerB","resultingPlayerBScore","isWinner","winPoints","losePoints","ChosenOnlineGame","gameSelector","createSelector","params","gameId","gamesById","playersInfoSelector","userPlayer","gameGameSelector","dismissUrlGameError","submitGameMove","close","shareGame","_this$playersInfo","playersInfo","preventDefault","stopChallengeUser","copyPlayPosition","_this$props2$gamesInf","otherLiveGames","myLiveGames","_this$playersInfo2","gamesNode","components_Settings","REACT_APP_DEBUG","admin","OnlineGame_OnlineGamePlayer","react_router_dom","OnlineGame","_this$props3$gamesInf","OnlineGame_ChosenOnlineGame","services","notifications","Notification","permission","requestPermission","construct","prototype","_args2","ChosenOnlineTournament","tournamentSelector","dismissUrlTournamentError","shareTournament","assertThisInitialized","toggleParticipation","startTournament","abortTournament","players","otherUserId","userStats","points","initialScore","Table","celled","collapsing","unstackable","HeaderCell","Body","stats","ratedPoints","expectedPoints","toFixed","waitingForNextRound","scoreDifference","colSpan","schedule","roundIndex","pairings","gameIndex","_ref$userIds","playerAId","playerBId","playerAWon","playerBWon","player-a-won","player-b-won","OnlineTournament","OnlineTournament_ChosenOnlineTournament","LearnBoard","selectedMoveCell","movedFromCell","selectedBuildCell","canMove","canBuild","isCellAvailableForMoving","isCellAvailableForBuilding","makeMoveMoving","makeMoveBuilding","_this$state3","_this$state4","makeMoveUndoMoving","board","originalRowsAndColumns","_this$state5","rawSettings","LearnToPlay","stepIndex","goToFirstStep","goToPreviousStep","goToNextStep","goToLastStep","steps","step","Message","LearnToPlay_LearnBoard","EditPosition","paletteSelectedItem","paletteUpdate","positionError","urlError","onPaletteSelectedItemChange","onPositionChange","message","copyGame","visibleGame","resetBoard","resetGame","copyPosition","usePosition","initialPositionNotation","EditPosition_EditPositionPalette","selectedItem","onSelectedItemChange","EditPosition_EditPositionBoard","EditPositionPalette","moveFromKey","q","0","4","b","EditPositionBoard","updatePosition","newCell","newPosition","CreateChallenge","editing","currentStep","tree","onCreateChallenge","getTree","existingResponse","getExistingResponse","pathIndexes","getPathIndexes","_this$duplicateChalle","duplicateChallenge","newChallenge","newModifyingStep","newStep","addGameToStep","getNextTreePath","treePath","lastTreeStep","playerResponses","nextStep","challengeResponse","deleteCurrentStep","_this$duplicateChalle2","removeStep","editChallenge","createChallenge","cleanedChallenge","updateChallenge","createOrUpdateChallenge","discardChallenge","initialChallenge","fillGames","challengeStep","response","treePathStep","oldStep","isArray","getNextTree","nextTree","CreateChallenge_ChallengeForm","challengePrompt","getDifficultyStars","source","rowIndex","columnIndex","ChallengeForm","editingPosition","convertedValue","valueConversion","newChallengeToChange","parts","onValueSet","isPositionValid","isValidCompressedPositionNotation","_this4$state","editPosition","components_EditPosition","onSubmit","inline","Radio","Select","format","options.typeOptions.mateIn","meta.difficulty","meta.publishDatetime","timestamp","EditChallenge","dismissUrlChallengeError","components_CreateChallenge","Challenges","_this$props$challenge","components_EditChallenge","Challenges_ChallengePlayer","ChallengePlayer","challengeId","getResumedChallengeGame","submittedGame","wrongMove","askServer","shareChallenge","resultingGame","userChallengeStep","lastPlayerResponse","gameToUpdate","_ref3$askServer","remainingHistory","_loop","historyGame","shift","invalidPlayerPositions","v","validPlayerResponse","submitChallengeMove","_ret","success","App","liveGame","liveTournament","liveChallenge","gameUrl","tournamentUrl","challengeUrl","leaveTournament","joinTournament","askForNotificationPermissionOnWaitForGame","navigateToMyNewGame","notifyAboutMyMove","previousMyLiveGameIds","Set","newMyLiveGameIds","has","notify","gamesThatChangedToMyTurn","nextUserId","prevGame","tag","onlineGameLabel","onlineTournamentLabel","Container","Board_SvgBoardBackground","Lobby_LogIn","Lobby_LogOut","components_NavigationalTab","components_Lobby","components_OnlineGame","components_OnlineTournament","components_Hotseat","components_Challenges","components_LearnToPlay","Boolean","hostname","ReactDOM","basename","src_App","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.a18ae62a.chunk.js","sourcesContent":["import moment from \"moment\";\r\nimport _ from \"lodash\";\r\n\r\nexport const copyToClipboard = text => {\r\n  const textArea = document.createElement(\"textarea\");\r\n  // This won't work\r\n  // textArea.style.display = 'none'\r\n  document.body.appendChild(textArea);\r\n  textArea.value = text;\r\n  textArea.select();\r\n  document.execCommand(\"copy\");\r\n  document.body.removeChild(textArea);\r\n};\r\n\r\nexport const topicalThemes = [\r\n  {\r\n    from: moment(\"2019-10-28T12:30:00\"),\r\n    until: moment(\"2019-11-01T00:00:00\"),\r\n    name: 'Halloween',\r\n    override: {\r\n      theme: {\r\n        cells: 'halloween',\r\n        pieces: 'halloween-ghost',\r\n        scheme: 'halloween',\r\n      },\r\n    },\r\n  },\r\n];\r\n\r\nconst getTopicalThemeOverrideAndNextUpdateDate = (on = moment()) => {\r\n  const matchingTopicalTheme = topicalThemes.find(topicalTheme => (\r\n    topicalTheme.from.isSameOrBefore(on) && topicalTheme.until.isSameOrAfter(on)\r\n  ));\r\n  if (matchingTopicalTheme) {\r\n    return {\r\n      override: matchingTopicalTheme.override,\r\n      nextUpdatedDate: matchingTopicalTheme.until,\r\n      name: matchingTopicalTheme.name,\r\n    };\r\n  }\r\n\r\n  const nextTopicalTheme = topicalThemes.find(topicalTheme => (\r\n    topicalTheme.from.isSameOrAfter(on)\r\n  ));\r\n  if (nextTopicalTheme) {\r\n    return {override: null, nextUpdatedDate: nextTopicalTheme.from, name: null};\r\n  }\r\n\r\n  return {override: null, nextUpdatedDate: null, name: null};\r\n};\r\n\r\nexport const getApplicableSettingsAndNextUpdateDate = (settings, on) => {\r\n  const {override, nextUpdatedDate, name} = getTopicalThemeOverrideAndNextUpdateDate(on);\r\n  if (settings.theme.useTopicalTheme && override) {\r\n    settings = _.merge({}, settings, override);\r\n  }\r\n\r\n  return {applicableSettings: settings, nextUpdatedDate, override, name};\r\n};\r\n","import _ from \"lodash\";\r\nimport moment from \"moment\";\r\nimport * as utils from \"../utils\";\r\n\r\nconst appVersion = 8;\r\n\r\nclass Client {\r\n  static getDefaultSettings() {\r\n    return {\r\n      autoSubmitMoves: false,\r\n      confirmSubmitMoves: true,\r\n      enableNotifications: false,\r\n      theme: {\r\n        useTopicalTheme: true,\r\n        cells: 'original',\r\n        pieces: 'king',\r\n        scheme: '',\r\n        rotateOpponent: true,\r\n        animations: true,\r\n        arrows: true,\r\n        numbers: 'obvious',\r\n      },\r\n    };\r\n  }\r\n\r\n  scriptIoReloadInterval = null;\r\n\r\n  constructor() {\r\n    this.id = localStorage.getItem('user-id') || null;\r\n    this.username = localStorage.getItem('user-name') || null;\r\n    const password = localStorage.getItem('user-password') || null;\r\n    localStorage.removeItem('user-password');\r\n    this.token = localStorage.getItem('user-token') || password;\r\n    const localSettings = localStorage.getItem('user-settings') || 'null';\r\n    let settings;\r\n    try {\r\n      settings = JSON.parse(localSettings);\r\n    } catch (e) {\r\n      settings = null;\r\n    }\r\n    this.updateApplicableSettingsTimeout = null;\r\n    this.setSettings(settings);\r\n    if (!window.io) {\r\n      window.io = () => ({\r\n        on: () => console.warn(\"Socket script was missing\"),\r\n        emit: () => console.warn(\"Socket script was missing\"),\r\n        unavailable: true,\r\n      });\r\n      window.io.unavailable = true;\r\n      this.scriptIoReloadInterval = setInterval(this.reloadScriptIo, 1000);\r\n    }\r\n\r\n    this.disconnected = false;\r\n\r\n    this.onConnect = [];\r\n    this.onDisconnect = [];\r\n    this.onUser = [];\r\n    this.onUsers = [];\r\n    this.onGames = [];\r\n    this.onTournaments = [];\r\n    this.onChallenges = [];\r\n\r\n    this.bindSocket();\r\n  }\r\n\r\n  setSettings(settings) {\r\n    if (settings) {\r\n      this.settings = _.merge(this.constructor.getDefaultSettings(), settings);\r\n    } else {\r\n      this.settings = this.constructor.getDefaultSettings();\r\n    }\r\n    const {applicableSettings, nextUpdatedDate, override, name} = utils.getApplicableSettingsAndNextUpdateDate(this.settings);\r\n    this.applicableSettings = applicableSettings;\r\n    this.applicableSettingsName = name;\r\n    this.applicableSettingsOverride = override;\r\n    if (this.updateApplicableSettingsTimeout) {\r\n      clearTimeout(this.updateApplicableSettingsTimeout);\r\n      this.updateApplicableSettingsTimeout = null;\r\n    }\r\n    if (nextUpdatedDate) {\r\n      const millisecondsUntilUpdate = nextUpdatedDate.diff(moment());\r\n      this.updateApplicableSettingsTimeout = setTimeout(() => {\r\n        this.setSettings(this.settings);\r\n        this.onUser.map(callback => callback(this.user));\r\n      }, millisecondsUntilUpdate);\r\n    }\r\n  }\r\n\r\n  bindSocket() {\r\n    this.socket = window.io(process.env.REACT_APP_SERVER_URL);\r\n    this.available = !this.socket.unavailable;\r\n    this.connected = false;\r\n    this.socket.on('connect', this.justConnected);\r\n    this.socket.on('disconnect', this.justDisconnected);\r\n    this.socket.on(\"reload\", this.reload);\r\n\r\n    this.user = null;\r\n    this.socket.on(\"user\", this.gotUser);\r\n\r\n    this.usersInfo = this.prepareUsers([]);\r\n    this.socket.on(\"users\", this.gotUsers);\r\n\r\n    this.gamesInfo = this.prepareGames([]);\r\n    this.socket.on(\"games\", this.gotGames);\r\n\r\n    this.tournamentsInfo = this.prepareTournaments([]);\r\n    this.socket.on(\"tournaments\", this.gotTournaments);\r\n\r\n    this.challengesInfo = this.prepareChallenges([]);\r\n    this.socket.on(\"challenges\", this.gotChallenges);\r\n    this.socket.on(\"personal-challenges\", this.gotPersonalChallenges);\r\n\r\n    this.getUser();\r\n  }\r\n\r\n  reloadScriptIo = () => {\r\n    if (!window.io.unavailable) {\r\n      clearInterval(this.scriptIoReloadInterval);\r\n      this.scriptIoReloadInterval = null;\r\n      this.bindSocket();\r\n      console.log('Loaded script.io!');\r\n      return;\r\n    }\r\n    const oldScriptEl = document.getElementById('socket-io-script');\r\n    const newScriptEl = document.createElement('script');\r\n    newScriptEl.id = oldScriptEl.id;\r\n    newScriptEl.type = oldScriptEl.type;\r\n    newScriptEl.src = oldScriptEl.src;\r\n    oldScriptEl.remove();\r\n    document.head.append(newScriptEl);\r\n    console.warn('Retrying socket.io script download...');\r\n  };\r\n\r\n  subscribe(callbacks) {\r\n    for (const name of ['onConnect', 'onDisconnect', 'onUser', 'onUsers', 'onGames', 'onTournaments', 'onChallenges']) {\r\n      const callback = callbacks[name];\r\n      if (callback) {\r\n        this[name].push(callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  unsubscribe(callbacks) {\r\n    for (const name of ['onConnect', 'onDisconnect', 'onUser', 'onUsers', 'onGames', 'onChallenges']) {\r\n      const callback = callbacks[name];\r\n      if (callback) {\r\n        _.pull(this[name], callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  getUser() {\r\n    this.socket.emit(\"create-user\", {\r\n      appVersion,\r\n      id: this.id,\r\n      name: this.username,\r\n      token: this.token,\r\n      settings: this.settings,\r\n    });\r\n  }\r\n\r\n  logIn(name, password, mergeUsers) {\r\n    this.socket.emit(\"log-in\", {appVersion, name, password, mergeUsers});\r\n  }\r\n\r\n  logOut() {\r\n    this.socket.emit(\"log-out\");\r\n  }\r\n\r\n  reload = () => {\r\n    window.location.reload(true);\r\n  };\r\n\r\n  justConnected = () => {\r\n    this.getUser();\r\n    this.connected = true;\r\n    this.onConnect.map(callback => callback(this.connected));\r\n  };\r\n\r\n  justDisconnected = () => {\r\n    this.connected = false;\r\n    this.disconnected = true;\r\n    this.onDisconnect.map(callback => callback(this.connected));\r\n  };\r\n\r\n  gotUser = user => {\r\n    if (user) {\r\n      this.id = user.id;\r\n      this.username = user.name;\r\n      this.token = user.token;\r\n      this.setSettings(user.settings);\r\n      localStorage.setItem('user-id', this.id);\r\n      localStorage.setItem('user-name', this.username);\r\n      localStorage.setItem('user-token', this.token);\r\n      localStorage.setItem('user-settings', JSON.stringify(this.settings));\r\n    }\r\n    this.user = user;\r\n    this.onUser.map(callback => callback(user));\r\n    this.gotUsers(this.usersInfo.users);\r\n  };\r\n\r\n  changeUsername(name) {\r\n    this.socket.emit(\"change-username\", name);\r\n  }\r\n\r\n  changePassword(password) {\r\n    this.socket.emit(\"change-password\", password);\r\n  }\r\n\r\n  updateSettings(settings) {\r\n    this.socket.emit(\"update-settings\", settings);\r\n  }\r\n\r\n  changeReadyToPlay(readyToPlay) {\r\n    this.socket.emit(\"change-ready-to-play\", readyToPlay);\r\n  }\r\n\r\n  gotUsers = users => {\r\n    users = _.orderBy(users, [user => user.isUserRatingProvisional ? 1 : 0, 'score', 'maxScore'], ['asc', 'desc', 'desc']);\r\n    users.forEach((user, index) => {\r\n      user.rank = index + 1;\r\n    });\r\n    this.usersInfo = this.prepareUsers(users);\r\n    this.onUsers.map(callback => callback(this.usersInfo));\r\n  };\r\n\r\n  prepareUsers(users) {\r\n    let otherUsers;\r\n    if (this.user) {\r\n      const myIndex = users.findIndex(user => user.id === this.user.id);\r\n      if (myIndex >= 0) {\r\n        otherUsers = users.slice(0, myIndex).concat(users.slice(myIndex + 1));\r\n        users = [users[myIndex], ...otherUsers];\r\n      } else {\r\n        otherUsers = users;\r\n      }\r\n    } else {\r\n      otherUsers = users;\r\n    }\r\n    const byId = _.fromPairs(users.map(user => [user.id, user]));\r\n    const online = users.filter(user => user.online);\r\n    const readyToPlay = online.filter(user => [true, this.user ? this.user.id : true].includes(user.readyToPlay));\r\n    return {\r\n      users,\r\n      byId,\r\n      other: otherUsers,\r\n      online,\r\n      offline: users.filter(user => !user.online),\r\n      readyToPlay,\r\n      readyToPlayMe: readyToPlay.filter(user => this.user && this.user.id === user.readyToPlay),\r\n      challengedUser: this.user ? (byId[this.user.readyToPlay] || null ): null,\r\n    };\r\n  }\r\n\r\n  gotGames = games => {\r\n    games = _.sortBy(games, ['startDatetime', 'id'], ['desc', 'desc']);\r\n    this.gamesInfo = this.prepareGames(games);\r\n    this.onGames.map(callback => callback(this.gamesInfo));\r\n  };\r\n\r\n  prepareGames(games) {\r\n    const live = games.filter(game => !game.finished);\r\n    const finished = games.filter(game => game.finished);\r\n    return {\r\n      games,\r\n      byId: _.fromPairs(games.map(game => [game.id, game])),\r\n      live,\r\n      myLive: this.user ? live.filter(game => game.userIds.includes(this.user.id)) : [],\r\n      otherLive: this.user ? live.filter(game => !game.userIds.includes(this.user.id)) : live,\r\n      finished,\r\n      myFinished: this.user ? finished.filter(game => game.userIds.includes(this.user.id)) : [],\r\n      otherFinished: this.user ? finished.filter(game => !game.userIds.includes(this.user.id)) : live,\r\n      mine: this.user ? games.filter(game => game.userIds.includes(this.user.id)) : [],\r\n    };\r\n  }\r\n\r\n  submitGameMove(game, moves) {\r\n    this.socket.emit(\"submit-game-moves\", {id: game.id, moves});\r\n  }\r\n\r\n  createTournament(data) {\r\n    this.socket.emit(\"create-tournament\", data);\r\n  }\r\n\r\n  joinTournament(tournament) {\r\n    this.socket.emit(\"join-tournament\", tournament.id);\r\n  }\r\n\r\n  leaveTournament(tournament) {\r\n    this.socket.emit(\"leave-tournament\", tournament.id);\r\n  }\r\n\r\n  startTournament(tournament) {\r\n    this.socket.emit(\"start-tournament\", tournament.id);\r\n  }\r\n\r\n  abortTournament(tournament) {\r\n    this.socket.emit(\"abort-tournament\", tournament.id);\r\n  }\r\n\r\n  gotTournaments = tournaments => {\r\n    tournaments = _.sortBy(tournaments, ['startDatetime', 'endDatetime', 'createdDatetime', 'id'], ['desc', 'desc', 'desc', 'desc']);\r\n    this.tournamentsInfo = this.prepareTournaments(tournaments);\r\n    this.onTournaments.map(callback => callback(this.tournamentsInfo));\r\n  };\r\n\r\n  prepareTournaments(tournaments) {\r\n    const future = tournaments.filter(tournament => !tournament.started);\r\n    const live = tournaments.filter(tournament => tournament.started && !tournament.finished);\r\n    const futureAndLive = future.concat(live);\r\n    const finished = tournaments.filter(tournament => tournament.finished);\r\n    return {\r\n      tournaments,\r\n      byId: _.fromPairs(tournaments.map(game => [game.id, game])),\r\n      future, live, futureAndLive, finished,\r\n      myFuture: this.user ? future.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      myLive: this.user ? live.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      myFutureAndLive: this.user ? futureAndLive.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      myFinished: this.user ? finished.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n      otherFuture: this.user ? live.filter(tournament => !tournament.userIds.includes(this.user.id)) : live,\r\n      otherLive: this.user ? future.filter(tournament => !tournament.userIds.includes(this.user.id)) : future,\r\n      otherFutureAndLive: this.user ? futureAndLive.filter(tournament => !tournament.userIds.includes(this.user.id)) : future,\r\n      otherFinished: this.user ? finished.filter(tournament => !tournament.userIds.includes(this.user.id)) : finished,\r\n      mine: this.user ? tournaments.filter(tournament => tournament.userIds.includes(this.user.id)) : [],\r\n    };\r\n  }\r\n\r\n  createChallenge(challenge) {\r\n    this.socket.emit('create-challenge', challenge);\r\n  }\r\n\r\n  updateChallenge(challenge) {\r\n    this.socket.emit('update-challenge', challenge);\r\n  }\r\n\r\n  submitChallengeMove(challenge, path) {\r\n    this.socket.emit(\"submit-challenge-moves\", {id: challenge.id, path});\r\n  }\r\n\r\n  gotChallenges = challenges => {\r\n    for (const challenge of challenges) {\r\n      challenge.meta.publishDatetime = moment(challenge.meta.publishDatetime);\r\n    }\r\n    challenges = _.sortBy(challenges, ['startDatetime', 'endDatetime', 'createdDatetime', 'id'], ['desc', 'desc', 'desc', 'desc']);\r\n    this.challengesInfo = this.prepareChallenges(challenges);\r\n    this.onChallenges.map(callback => callback(this.challengesInfo));\r\n  };\r\n\r\n  gotPersonalChallenges = personalChallenges => {\r\n    this.gotChallenges(personalChallenges.concat(this.challengesInfo.other));\r\n  };\r\n\r\n  prepareChallenges(challenges) {\r\n    const otherChallenges = this.user ? challenges.filter(challenge => challenge.userId !== this.user.id) : challenges;\r\n    return {\r\n      challenges,\r\n      public: challenges.filter(challenge => challenge.meta.public && challenge.meta.publishDatetime.isSameOrBefore()),\r\n      private: challenges.filter(challenge => !challenge.meta.public || challenge.meta.publishDatetime.isAfter()),\r\n      byId: _.fromPairs(challenges.map(game => [game.id, game])),\r\n      mine: this.user ? challenges.filter(challenge => challenge.userId === this.user.id) : [],\r\n      other: otherChallenges,\r\n      otherSolved: this.user ? otherChallenges.filter(challenge => this.user.challenges[challenge.id] && this.user.challenges[challenge.id].meta.won) : [],\r\n      otherUnsolved: this.user ? otherChallenges.filter(challenge => !this.user.challenges[challenge.id] || !this.user.challenges[challenge.id].meta.won) : otherChallenges,\r\n      otherStarted: this.user ? otherChallenges.filter(challenge => this.user.challenges[challenge.id] && this.user.challenges[challenge.id].meta.started && !this.user.challenges[challenge.id].meta.won) : [],\r\n      otherNotStarted: this.user ? otherChallenges.filter(challenge => !this.user.challenges[challenge.id] || !this.user.challenges[challenge.id].meta.started) : otherChallenges,\r\n    };\r\n  }\r\n}\r\n\r\nexport const client = new Client();\r\nwindow.client = client;\r\n\r\nexport default Client;\r\n","import PropTypes from \"prop-types\";\r\nimport React, { Component, Fragment } from 'react';\r\nimport {\r\n  NavLink,\r\n  Redirect, Route,\r\n  Switch,\r\n  withRouter\r\n} from \"react-router-dom\";\r\nimport { Menu, Tab } from 'semantic-ui-react';\r\n\r\nclass NavigationalTab extends Component {\r\n  constructUrl(path) {\r\n    const {match} = this.props;\r\n    return `${match.url.endsWith('/') ? match.url.slice(0, -1) : match.url}${path ? `/${path}` : ''}`;\r\n  }\r\n\r\n  getPreparedPanesDefaultToAndActiveIndex() {\r\n    const {panes, defaultIndex, match, location} = this.props;\r\n    let defaultTo = null;\r\n    let activeIndex = null;\r\n    let activeTo = match.url;\r\n\r\n    const preparedPanes = panes\r\n      .map((pane, originalIndex) => [pane, originalIndex])\r\n      .filter(([pane]) => pane)\r\n      .map(([pane, originalIndex], index) => {\r\n        if (!pane) {\r\n          return null;\r\n        }\r\n\r\n        const to = this.constructUrl(pane.path);\r\n        if (originalIndex === defaultIndex) {\r\n          defaultTo = to;\r\n        }\r\n        const navigate = pane.navigate !== undefined ? this.constructUrl(pane.navigate) : to;\r\n        if (location.pathname.startsWith(navigate)) {\r\n          activeIndex = index;\r\n          activeTo = to;\r\n        }\r\n\r\n        const menuItem = (\r\n          typeof pane.menuItem === typeof \"\"\r\n            ? {content: pane.menuItem}\r\n            : pane.menuItem\r\n        );\r\n        return {\r\n          to,\r\n          ...pane,\r\n          menuItem: (\r\n            <Menu.Item\r\n              key={pane.path}\r\n              as={NavLink}\r\n              to={navigate}\r\n              {...menuItem}\r\n              icon={pane.icon || menuItem.icon}\r\n            />\r\n          ),\r\n        };\r\n      })\r\n      .filter(preparedPane => preparedPane);\r\n    return {preparedPanes, defaultTo, activeIndex, activeTo}\r\n  }\r\n\r\n  render() {\r\n    const {tab, menu, match, renderActiveOnly, className} = this.props;\r\n    const {preparedPanes, defaultTo, activeIndex, activeTo} = this.getPreparedPanesDefaultToAndActiveIndex();\r\n\r\n    return (\r\n      <Fragment>\r\n        {defaultTo !== null ? (\r\n          <Switch>\r\n            <Redirect exact from={match.url} to={defaultTo} />\r\n          </Switch>\r\n        ) : null}\r\n        <Route path={activeTo}>\r\n          <Tab\r\n            menu={menu}\r\n            renderActiveOnly={renderActiveOnly}\r\n            {...tab}\r\n            panes={preparedPanes}\r\n            activeIndex={activeIndex}\r\n            className={className}\r\n          />\r\n        </Route>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nNavigationalTab.propTypes = {\r\n  panes: PropTypes.arrayOf(PropTypes.shape({\r\n    ...Menu.Item.propTypes,\r\n    path: PropTypes.string,\r\n    menuItem: PropTypes.oneOfType([PropTypes.string, PropTypes.object]).isRequired,\r\n  })).isRequired,\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  tab: PropTypes.object,\r\n  menu: PropTypes.object,\r\n  renderActiveOnly: PropTypes.bool.isRequired,\r\n  defaultIndex: PropTypes.number.isRequired,\r\n};\r\n\r\nNavigationalTab.defaultProps = {\r\n  renderActiveOnly: true,\r\n  defaultIndex: 0,\r\n};\r\n\r\nexport default withRouter(NavigationalTab);\r\n","import _ from \"lodash\";\r\nimport chalk from 'chalk';\r\n\r\nclass InvalidMoveError extends Error {}\r\n\r\nclass Game {\r\n  static PLAYER_A = 'player-a';\r\n  static PLAYER_B = 'player-b';\r\n  static PLAYERS = [\r\n    this.PLAYER_A,\r\n    this.PLAYER_B,\r\n  ];\r\n  static OTHER_PLAYER = {\r\n    [this.PLAYER_A]: this.PLAYER_B,\r\n    [this.PLAYER_B]: this.PLAYER_A,\r\n  };\r\n\r\n  static WORKER_FIRST = 'first-worker';\r\n  static WORKER_SECOND = 'second-worker';\r\n  static WORKERS = [this.WORKER_FIRST, this.WORKER_SECOND];\r\n\r\n  static MOVE_TYPE_PLACE_FIRST_WORKER = 'place-first-worker';\r\n  static MOVE_TYPE_PLACE_SECOND_WORKER = 'place-second-worker';\r\n  static MOVE_TYPE_SELECT_WORKER_TO_MOVE = 'select-worker-to-move';\r\n  static MOVE_TYPE_MOVE_FIRST_WORKER = 'move-first-worker';\r\n  static MOVE_TYPE_MOVE_SECOND_WORKER = 'move-second-worker';\r\n  static MOVE_TYPE_BUILD_AROUND_WORKER = 'build-around-worker';\r\n\r\n  static MOVE_TYPES_START_OF_TURN = [this.MOVE_TYPE_PLACE_FIRST_WORKER, this.MOVE_TYPE_SELECT_WORKER_TO_MOVE];\r\n  static MOVE_TYPES_PLACE_WORKER = [this.MOVE_TYPE_PLACE_FIRST_WORKER, this.MOVE_TYPE_PLACE_SECOND_WORKER];\r\n  static MOVE_TYPES_MOVE_WORKER = [this.MOVE_TYPE_MOVE_FIRST_WORKER, this.MOVE_TYPE_MOVE_SECOND_WORKER];\r\n  static MOVE_TYPES_MOVE_OR_BUILD = [...this.MOVE_TYPES_MOVE_WORKER, this.MOVE_TYPE_BUILD_AROUND_WORKER];\r\n\r\n  static ROWS = Array.from({length: 5}, (value, index) => index);\r\n  static COLUMNS = Array.from({length: 5}, (value, index) => index);\r\n  static MOVE_NOTATION = this.ROWS.map(y => this.COLUMNS.map(x =>\r\n    `${['A', 'B', 'C', 'D', 'E'][x]}${['1', '2', '3', '4', '5'][y]}`));\r\n  static MOVE_RESIGNED_NOTATION = {\r\n    [this.PLAYER_A]: 'RA',\r\n    [this.PLAYER_B]: 'RB',\r\n  };\r\n  static MOVE_REVERSE_NOTATION = {\r\n    ..._.fromPairs(_.flatten(this.ROWS.map(y => this.COLUMNS.map(x =>\r\n      [`${['A', 'B', 'C', 'D', 'E'][x]}${['1', '2', '3', '4', '5'][y]}`, {x, y}])))),\r\n    'RA': [{resign: this.PLAYER_A}],\r\n    'RB': [{resign: this.PLAYER_B}],\r\n  };\r\n  static MOVE_NOTATION_COMPRESSION = _.fromPairs(Object.keys(this.MOVE_REVERSE_NOTATION).sort().map((value, index) =>\r\n    [value, String.fromCharCode(index < 26 ? 65 + index : 48 + (index - 26))]));\r\n  static MOVE_NOTATION_DECOMPRESSION = _.fromPairs(Object.keys(this.MOVE_REVERSE_NOTATION).sort().map((value, index) =>\r\n    [String.fromCharCode(index < 26 ? 65 + index : 48 + (index - 26)), this.MOVE_REVERSE_NOTATION[value]]));\r\n\r\n  static POSITION_NOTATION = _.fromPairs([0, 1, 2, 3, 4].map(\r\n    level => [level, _.fromPairs([null, this.PLAYER_A, this.PLAYER_B].map(\r\n      player => [player, `${level}-${player}`]))]));\r\n  static POSITION_REVERSE_NOTATION = _.fromPairs(_.flatten(Object.entries(this.POSITION_NOTATION).map(\r\n    ([levelStr, notations]) => Object.entries(notations).map(\r\n      ([playerStr, notation]) => [notation, {level: parseInt(levelStr), player: playerStr === \"null\" ? null : playerStr}]))));\r\n  static POSITION_NOTATION_COMPRESSION_MAP = _.fromPairs(_.flatten(Object.entries(this.POSITION_NOTATION).map(\r\n    ([, notations]) => Object.entries(notations).map(\r\n      ([, notation]) => notation))).map((notation, index) => [notation, String.fromCharCode(65 + index)]));\r\n  static POSITION_NOTATION_COMPRESSION = _.fromPairs(Object.entries(this.POSITION_NOTATION).map(\r\n    ([levelStr, notations]) => [levelStr, _.fromPairs(Object.entries(notations).map(\r\n      ([playerStr, notation]) => [playerStr, this.POSITION_NOTATION_COMPRESSION_MAP[notation]]))]));\r\n  static POSITION_NOTATION_DECOMPRESSION = _.fromPairs(Object.entries(this.POSITION_NOTATION_COMPRESSION_MAP).map(\r\n    ([notation, compressedNotation]) => [compressedNotation, this.POSITION_REVERSE_NOTATION[notation]]));\r\n\r\n  static create() {\r\n    const rowsAndColumns = this.getInitialRowsAndColumns();\r\n    const status = this.getInitialStatus();\r\n    return new this(rowsAndColumns, status, null, null, false);\r\n  }\r\n\r\n  static fromMoves(moves) {\r\n    let game = this.create();\r\n    game = game.makeMoves(moves);\r\n\r\n    return game;\r\n  }\r\n\r\n  static fromRowsAndColumns(rowsAndColumns) {\r\n    if (rowsAndColumns.length !== 5) {\r\n      throw new Error(`Expected 5 rows but got ${rowsAndColumns.length}`);\r\n    }\r\n    if (rowsAndColumns.find(row => row.cells.length !== 5)) {\r\n      throw new Error(`Expected 5 columns but some rows had a different number`);\r\n    }\r\n    if (rowsAndColumns.find((row, y) => row.y !== y)) {\r\n      throw new Error(`Some rows had invalid \\`y\\``);\r\n    }\r\n    if (rowsAndColumns.find(row => row.cells.find((cell, x) => cell.x !== x || cell.y !== row.y))) {\r\n      throw new Error(`Some cells had invalid \\`x\\` or \\`y\\``);\r\n    }\r\n    const hasInvalidPlayerOrWorker = cell => (\r\n      (cell.player && !this.PLAYERS.includes(cell.player))\r\n      || (cell.worker && !this.WORKERS.includes(cell.worker))\r\n    );\r\n    if (this.findCell(rowsAndColumns, hasInvalidPlayerOrWorker)) {\r\n      throw new Error(`Some cells had invalid player or worker`);\r\n    }\r\n    if (this.findCell(rowsAndColumns, cell => ![0, 1, 2, 3, 4].includes(cell.level))) {\r\n      throw new Error(`Some cells have invalid level`);\r\n    }\r\n    const playerACount = this.findCells(rowsAndColumns, cell => cell.player === this.PLAYER_A).length;\r\n    const playerBCount = this.findCells(rowsAndColumns, cell => cell.player === this.PLAYER_B).length;\r\n    if (playerACount > 2 || playerBCount > 2) {\r\n      throw new Error(\r\n        `Players can have at most 2 workers, but player A has ${playerACount} and player B has ${playerBCount}`);\r\n    }\r\n    let status;\r\n    const maxLevel = Math.max(..._.flatten(rowsAndColumns.map(row => row.cells.map(cell => cell.level))));\r\n    if (maxLevel === 0) {\r\n      if (playerBCount === 0) {\r\n        if (playerACount === 0) {\r\n          status = {\r\n            nextPlayer: this.PLAYER_A,\r\n            moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n            availableMovesMatrix: this.allMovesAreAvailableMatrix(),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        } else if (playerACount === 1) {\r\n          status = {\r\n            nextPlayer: this.PLAYER_A,\r\n            moveType: this.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n            availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        } else {\r\n          const playerAFirstWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_A && cell.worker === this.WORKER_FIRST);\r\n          const playerASecondWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_A && cell.worker === this.WORKER_SECOND);\r\n          if (!playerAFirstWorker || !playerASecondWorker) {\r\n            throw new Error(`Could not find both workers of player A`);\r\n          }\r\n          status = {\r\n            nextPlayer: this.PLAYER_B,\r\n            moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n            availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        }\r\n      } else {\r\n        if (playerACount !== 2) {\r\n          throw new Error(`Player A must put both of their workers before player B can place theirs`);\r\n        }\r\n        if (playerBCount === 1) {\r\n          status = {\r\n            nextPlayer: this.PLAYER_B,\r\n            moveType: this.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n            availableMovesMatrix: this.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        } else {\r\n          const playerBFirstWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_B && cell.worker === this.WORKER_FIRST);\r\n          const playerBSecondWorker = this.findCell(rowsAndColumns,\r\n            cell => cell.player === this.PLAYER_B && cell.worker === this.WORKER_SECOND);\r\n          if (!playerBFirstWorker || !playerBSecondWorker) {\r\n            throw new Error(`Could not find both workers of player B`);\r\n          }\r\n          status = {\r\n            nextPlayer: this.PLAYER_A,\r\n            moveType: this.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n            availableMovesMatrix: this.getPlayerAvailableMovesMatrix(rowsAndColumns, this.PLAYER_A),\r\n            canUndo: false,\r\n            resignedPlayer: null,\r\n          };\r\n        }\r\n      }\r\n    } else {\r\n      if (playerACount !== 2 || playerBCount !== 2) {\r\n        throw new Error(`Both players must have placed both of their workers before they can move and build`);\r\n      }\r\n\r\n      if (this.findCell(rowsAndColumns, cell => cell.level === 4 && cell.player)) {\r\n        throw new Error(`Some workers are on the 4th level`);\r\n      }\r\n      const wonWorkers = this.findCells(rowsAndColumns, cell => cell.level === 3 && cell.player);\r\n      if (wonWorkers.length > 1) {\r\n        throw new Error(`Too many workers have won`);\r\n      }\r\n      const buildCount = _.sum(_.flatten(rowsAndColumns.map(row => row.cells.map(cell => cell.level))));\r\n      if (buildCount % 2 === 0) {\r\n        status = {\r\n          nextPlayer: this.PLAYER_A,\r\n          moveType: this.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n          availableMovesMatrix: this.getPlayerAvailableMovesMatrix(rowsAndColumns, this.PLAYER_A),\r\n          canUndo: false,\r\n          resignedPlayer: null,\r\n        };\r\n      } else {\r\n        status = {\r\n          nextPlayer: this.PLAYER_B,\r\n          moveType: this.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n          availableMovesMatrix: this.getPlayerAvailableMovesMatrix(rowsAndColumns, this.PLAYER_B),\r\n          canUndo: false,\r\n          resignedPlayer: null,\r\n        };\r\n      }\r\n    }\r\n    return new this(rowsAndColumns, status, null, null, false);\r\n  }\r\n\r\n  static fromMoveNotation(fullNotation) {\r\n    const moves = fullNotation\r\n      .split('')\r\n      .map(part => this.MOVE_REVERSE_NOTATION[part]);\r\n    if (moves.filter(move => !move).length) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      return this.fromMoves(moves, true);\r\n    } catch (e) {\r\n      return this.fromMoves(moves, false);\r\n    }\r\n  }\r\n\r\n  static fromCompressedMoveNotation(compressedFullNotation) {\r\n    const moves = compressedFullNotation\r\n      .split('')\r\n      .map(part => this.MOVE_NOTATION_DECOMPRESSION[part]);\r\n    if (moves.filter(move => !move).length) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      return this.fromMoves(moves, true);\r\n    } catch (e) {\r\n      return this.fromMoves(moves, false);\r\n    }\r\n  }\r\n\r\n  static getPositionNotation(rowsAndColumns) {\r\n    return _.flatten(rowsAndColumns.map(\r\n      row => row.cells.map(\r\n        cell => this.POSITION_NOTATION_COMPRESSION[cell.level][cell.player])))\r\n      .join('');\r\n  }\r\n\r\n  static fromPositionNotation(notation) {\r\n    const rowsAndColumns = this.ROWS.map(y => ({\r\n      y, cells: this.COLUMNS.map(x => ({\r\n        x, y, ...this.POSITION_REVERSE_NOTATION[notation[y * 5 + x]],\r\n      })),\r\n    }));\r\n    return this.fromPosition(rowsAndColumns);\r\n  }\r\n\r\n  static fromCompressedPositionNotation(notation) {\r\n    const rowsAndColumns = this.ROWS.map(y => ({\r\n      y, cells: this.COLUMNS.map(x => ({\r\n        x, y, ...this.POSITION_NOTATION_DECOMPRESSION[notation[y * 5 + x]],\r\n      })),\r\n    }));\r\n    return this.fromPosition(rowsAndColumns);\r\n  }\r\n\r\n  static isValidCompressedPositionNotation(notation) {\r\n    try {\r\n      this.fromCompressedPositionNotation(notation);\r\n      return true;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  static fromPosition(rowsAndColumns) {\r\n    let playerACount = 0, playerBCount = 0;\r\n    for (const x of this.ROWS) {\r\n      for (const y of this.COLUMNS) {\r\n        const cell = rowsAndColumns[y].cells[x];\r\n        if (cell.player === this.PLAYER_A) {\r\n          cell.worker = this.WORKERS[playerACount % 2];\r\n          playerACount += 1;\r\n        } else if (cell.player === this.PLAYER_B) {\r\n          cell.worker = this.WORKERS[playerBCount % 2];\r\n          playerBCount += 1;\r\n        }\r\n      }\r\n    }\r\n    return this.fromRowsAndColumns(rowsAndColumns);\r\n  }\r\n\r\n  createStep(rowsAndColumns, status, lastMove) {\r\n    return new this.constructor(rowsAndColumns, status, this, lastMove, false);\r\n  }\r\n\r\n  createNext(rowsAndColumns, status, lastMove) {\r\n    return new this.constructor(rowsAndColumns, status, this, lastMove, true);\r\n  }\r\n\r\n  constructor(rowsAndColumns, status, previous, lastMove, isNextMove) {\r\n    if (!rowsAndColumns || !status) {\r\n      throw new Error(\"You need to pass rowsAndColumns, status, and previous game\");\r\n    }\r\n    this.previous = previous;\r\n    this.history = (this.previous ? this.previous.history : [])\r\n      .filter(game => !game.canUndo)\r\n      .concat([this]);\r\n    this.previousInHistory = this.history[this.history.length - 2];\r\n    this.fullHistory = (this.previous ? this.previous.fullHistory : []).concat(this);\r\n    this.isNextMove = isNextMove;\r\n    this.moveCount = this.previous ? (isNextMove ? this.previous.moveCount + 1 : this.previous.moveCount) : 1;\r\n    this.chainCount = this.previous ? this.previous.chainCount + 1 : 0;\r\n    this.lastMove = lastMove ? lastMove : (status.resignedPlayer ? {resign: status.resignedPlayer} : lastMove);\r\n    this.moves = this.previous ? this.previous.moves.concat([this.lastMove]) : [];\r\n    this.lastMovesInHistory = this.fullHistory\r\n      .slice(this.fullHistory.indexOf(this.previousInHistory) + 1)\r\n      .map(game => game.lastMove);\r\n    this.path = this.previousInHistory\r\n      ? this.previousInHistory.path.concat([this.lastMovesInHistory])\r\n      : [];\r\n\r\n    this.rowsAndColumns = rowsAndColumns;\r\n\r\n    const missingStatusKeys =\r\n      ['nextPlayer', 'moveType', 'availableMovesMatrix', 'canUndo', 'resignedPlayer']\r\n      .filter(key => status[key] === undefined);\r\n    if (missingStatusKeys.length) {\r\n      throw new Error(`Some status keys were missing: ${missingStatusKeys.join(', ')}`);\r\n    }\r\n    const {nextPlayer, moveType, availableMovesMatrix, canUndo, resignedPlayer} = status;\r\n    this.thisPlayer = previous ? previous.nextPlayer : Game.PLAYER_A;\r\n    this.nextPlayer = nextPlayer;\r\n    this.thisMoveType = previous ? previous.moveType : null;\r\n    this.moveType = moveType;\r\n    this.availableMovesMatrix = availableMovesMatrix;\r\n    this.canUndo = canUndo;\r\n    this.canTakeMoveBack = !!this.previous;\r\n    this.resignedPlayer = resignedPlayer;\r\n    this.moveNotation = resignedPlayer\r\n      ? this.constructor.MOVE_RESIGNED_NOTATION[resignedPlayer]\r\n      : (lastMove\r\n        ? this.constructor.MOVE_NOTATION[lastMove.y][lastMove.x]\r\n        : '');\r\n    this.fullNotation = `${this.previous ? this.previous.fullNotation : ''}${this.moveNotation}`;\r\n    this.compressedFullNotation = this.fullNotation\r\n      .split(/(..)/)\r\n      .filter(part => part)\r\n      .map(part => this.constructor.MOVE_NOTATION_COMPRESSION[part])\r\n      .join('');\r\n    this.positionNotation = this.constructor.getPositionNotation(this.rowsAndColumns);\r\n\r\n    this.winner = this.getWinner();\r\n    if (this.winner) {\r\n      this.finished = true;\r\n    } else if (!this.constructor.hasAvailableMove(this.availableMovesMatrix)) {\r\n      this.finished = true;\r\n      this.winner = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    } else {\r\n      this.finished = false;\r\n    }\r\n\r\n    if (this.finished) {\r\n      this.availableMovesMatrix = this.constructor.noMovesAreAvailable();\r\n    }\r\n  }\r\n\r\n  static getAvailableMoves(availableMovesMatrix) {\r\n    return _.flatten(availableMovesMatrix\r\n      .map((row, y) => row\r\n        .map((available, x) => available ? {x, y} : null)))\r\n      .filter(move => move);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      moves: this.moves,\r\n    };\r\n  }\r\n\r\n  static deserialize({moves}) {\r\n    return this.fromMoves(moves);\r\n  }\r\n\r\n  static getInitialRowsAndColumns() {\r\n    return this.ROWS.map(y => ({\r\n      y, cells: this.COLUMNS.map(x => ({\r\n        x, y, level: 0, player: null, worker: null,\r\n      })),\r\n    }));\r\n  }\r\n\r\n  static getInitialStatus() {\r\n    return  {\r\n      nextPlayer: this.PLAYER_A,\r\n      moveType: this.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n      availableMovesMatrix: this.allMovesAreAvailableMatrix(),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    };\r\n  }\r\n\r\n  getPrintout() {\r\n    /* eslint-disable no-useless-computed-key */\r\n    const printMap = {\r\n      [Game.PLAYER_A]: {[0]: 'a', [1]: chalk.bgWhite('b'), [2]: chalk.bgYellow('c'), [3]: chalk.bgRed('d')},\r\n      [Game.PLAYER_B]: {[0]: 'w', [1]: chalk.bgWhite('x'), [2]: chalk.bgYellow('y'), [3]: chalk.bgRed('z')},\r\n      [null]: {[0]: ' ', [1]: chalk.bgWhite(' '), [2]: chalk.bgYellow(' '), [3]: chalk.bgRed(' '), [4]: chalk.bgBlue(' ')},\r\n    };\r\n    /* eslint-enable no-useless-computed-key */\r\n    const cellsPrintout = this.rowsAndColumns\r\n      .map(row => row.cells\r\n        .map(cell => printMap[cell.player][cell.level])\r\n        .join(''))\r\n      .join('\\n');\r\n    const nextPlayerMap = {\r\n      [Game.PLAYER_A]: 'A', [Game.PLAYER_B]: 'B',\r\n    };\r\n    const nextPlayerPrintout = nextPlayerMap[this.nextPlayer];\r\n    const winnerMap = {\r\n      [Game.PLAYER_A]: 'A', [Game.PLAYER_B]: 'B', [null]: '+',\r\n    };\r\n    const winnerPrintout = winnerMap[this.winner];\r\n    return (\r\n      `${nextPlayerPrintout}-----${winnerPrintout}\\n`\r\n      + cellsPrintout.split('\\n').map(row => `|${chalk.black(row)}|`).join('\\n')\r\n      + '\\n+-----+'\r\n    );\r\n  }\r\n\r\n  checkCoordinatesAreValid({x, y}) {\r\n    if (Math.floor(x) !== x || Math.floor(y) !== y) {\r\n      throw new InvalidMoveError(`Coordinates '${JSON.stringify({x, y})}' are not valid`);\r\n    }\r\n    if (this.availableMovesMatrix[y] === undefined || this.availableMovesMatrix[y][x] === undefined) {\r\n      throw new InvalidMoveError(`Coordinates '${JSON.stringify({x, y})}' are out of bounds`);\r\n    }\r\n  }\r\n\r\n  static hasAvailableMove(availableMovesMatrix) {\r\n    return this.getAvailableMoves(availableMovesMatrix).length > 0;\r\n  }\r\n\r\n  isMoveAvailable({x, y}) {\r\n    return this.availableMovesMatrix[y][x];\r\n  }\r\n\r\n  static findCell(rowsAndColumns, condition) {\r\n    return rowsAndColumns.map(row => row.cells.find(condition)).find(cell => cell);\r\n  }\r\n\r\n  static findCells(rowsAndColumns, condition) {\r\n    return _.flatten(rowsAndColumns.map(row => row.cells.filter(condition)));\r\n  }\r\n\r\n  findCell(condition) {\r\n    return this.constructor.findCell(this.rowsAndColumns, condition);\r\n  }\r\n\r\n  findCells(condition) {\r\n    return this.constructor.findCells(this.rowsAndColumns, condition);\r\n  }\r\n\r\n  static canPlayerWin(rowsAndColumns, player) {\r\n    const playerCells = this.findCells(rowsAndColumns, cell => cell.player === player && cell.level === 2);\r\n    if (!playerCells.length) {\r\n      return false;\r\n    }\r\n    const playerWinningMoves = this.findCells(rowsAndColumns, cell => (\r\n      cell.level === 3\r\n      && playerCells.find(playerCell => (\r\n        Math.abs(cell.x - playerCell.x) <= 1\r\n        && Math.abs(cell.y - playerCell.y) <= 1\r\n      ))\r\n    ));\r\n\r\n    return playerWinningMoves.length > 0;\r\n  }\r\n\r\n  getWinner() {\r\n    if (this.resignedPlayer) {\r\n      return this.constructor.OTHER_PLAYER[this.resignedPlayer];\r\n    }\r\n\r\n    const winningCell = this.findCell(cell => cell.player && cell.level === 3);\r\n    if (winningCell) {\r\n      return winningCell.player;\r\n    }\r\n\r\n    if (!this.canUndo && this.constructor.canPlayerWin(this.rowsAndColumns, this.nextPlayer)) {\r\n      return this.nextPlayer;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  static allMovesAreAvailableMatrix() {\r\n    return this.ROWS.map(() => this.COLUMNS.map(() => true));\r\n  }\r\n\r\n  static noMovesAreAvailable() {\r\n    return this.ROWS.map(() => this.COLUMNS.map(() => false));\r\n  }\r\n\r\n  static getEmptyCellsAvailableMovesMatrix(rowsAndColumns) {\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => !cell.player);\r\n  }\r\n\r\n  static getPlayerAvailableMovesMatrix(rowsAndColumns, player) {\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => {\r\n      if (cell.player !== player) {\r\n        return false;\r\n      }\r\n\r\n      return this.hasAvailableMove(this.getMovableAvailableMovesMatrix(rowsAndColumns, cell));\r\n    });\r\n  }\r\n\r\n  static getMovableAvailableMovesMatrix(rowsAndColumns, coordinates) {\r\n    const fromCell = rowsAndColumns[coordinates.y].cells[coordinates.x];\r\n    const maximumLevel = fromCell.level + 1;\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => (\r\n      Math.abs(cell.x - coordinates.x) <= 1\r\n      && Math.abs(cell.y - coordinates.y) <= 1\r\n      && !cell.player\r\n      && cell.level <= 3\r\n      && cell.level <= maximumLevel\r\n      && (this.hasAvailableMove(this.getBuildableAvailableMovesMatrix(this.updateCells(rowsAndColumns, ...[\r\n        {x: fromCell.x, y: fromCell.y, player: null, worker: null},\r\n        {x: cell.x, y: cell.y, player: fromCell.player, worker: fromCell.worker}\r\n      ]), cell)))\r\n    ));\r\n  }\r\n\r\n  static getBuildableAvailableMovesMatrix(rowsAndColumns, coordinates) {\r\n    const fromCell = rowsAndColumns[coordinates.y].cells[coordinates.x];\r\n    return this.getAvailableMovesMatrix(rowsAndColumns, cell => (\r\n      Math.abs(cell.x - coordinates.x) <= 1\r\n      && Math.abs(cell.y - coordinates.y) <= 1\r\n      && !cell.player\r\n      && cell.level < 4\r\n      && (!this.canPlayerWin(this.updateCells(rowsAndColumns, ...[\r\n        {x: cell.x, y: cell.y, level: cell.level + 1},\r\n      ]), this.OTHER_PLAYER[fromCell.player]))\r\n    ));\r\n  }\r\n\r\n  static getAvailableMovesMatrix(rowsAndColumns, isMoveAvailable) {\r\n    return rowsAndColumns.map(row => row.cells.map(isMoveAvailable));\r\n  }\r\n\r\n  checkCanMakeMove(expectedMoveType, coordinates, targetCoordinates) {\r\n    if (this.finished) {\r\n      throw new InvalidMoveError(\"The game has already finished\");\r\n    }\r\n    if (this.moveType !== expectedMoveType) {\r\n      throw new InvalidMoveError(`You cannot perform move of type \"${expectedMoveType}\": you need to perform \"${this.moveType}\"`);\r\n    }\r\n    this.checkCoordinatesAreValid(coordinates);\r\n    if (targetCoordinates) {\r\n      this.checkCoordinatesAreValid(targetCoordinates);\r\n    }\r\n    if (!this.availableMovesMatrix[coordinates.y][coordinates.x]) {\r\n      throw new Error(`Move ${JSON.stringify(coordinates)} is not one of the available ones`);\r\n    }\r\n  }\r\n\r\n  resign(player) {\r\n    return this.createStep(this.rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.moveType,\r\n      availableMovesMatrix: this.availableMovesMatrix,\r\n      canUndo: false,\r\n      resignedPlayer: player,\r\n    }, {resign: player});\r\n  }\r\n\r\n  static updateCells(rowsAndColumns, ...newCells) {\r\n    const updates = {};\r\n    for (const update of newCells) {\r\n      updates[update.y] = updates[update.y] || {};\r\n      updates[update.y][update.x] = update;\r\n    }\r\n    return rowsAndColumns.map(row => !updates[row.y] ? row : ({\r\n      ...row,\r\n      cells: row.cells.map(cell => !updates[cell.y][cell.x] ? cell : ({\r\n        ...cell,\r\n        ...updates[cell.y][cell.x],\r\n      })),\r\n    }));\r\n  }\r\n\r\n  makeMoves(moves) {\r\n    let game = this;\r\n    for (const move of moves) {\r\n      game = game.makeMove(move);\r\n    }\r\n\r\n    return game;\r\n  }\r\n\r\n  makeMove(coordinates) {\r\n    if (coordinates.resign) {\r\n      return this.resign(coordinates.resign);\r\n    }\r\n    const makeMoveMethods = {\r\n      [this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER]: this.placeFirstWorker,\r\n      [this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER]: this.placeSecondWorker,\r\n      [this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: this.selectWorkerToMove,\r\n      [this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER]: this.moveFirstWorker,\r\n      [this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER]: this.moveSecondWorker,\r\n      [this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER]: this.buildAroundWorker,\r\n    };\r\n    const makeMoveMethod = makeMoveMethods[this.moveType];\r\n    if (!makeMoveMethod) {\r\n      throw new InvalidMoveError(`Don't know how to perform move of type \"${this.moveType}\"`);\r\n    }\r\n    return makeMoveMethod.bind(this)(coordinates);\r\n  }\r\n\r\n  undo() {\r\n    if (!this.canUndo) {\r\n      throw new Error(\"Cannot undo\");\r\n    }\r\n\r\n    return this.previous;\r\n  }\r\n\r\n  takeMoveBack() {\r\n    if (!this.canTakeMoveBack) {\r\n      throw new Error(\"Cannot take move back\");\r\n    }\r\n\r\n    return this.previous;\r\n  }\r\n\r\n  placeFirstWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER, {x, y});\r\n\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, {\r\n      x, y,\r\n      player: this.nextPlayer,\r\n      worker: this.constructor.WORKER_FIRST,\r\n    });\r\n    return this.createStep(rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER,\r\n      availableMovesMatrix: this.constructor.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  placeSecondWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_PLACE_SECOND_WORKER, {x, y});\r\n\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, {\r\n      x, y,\r\n      player: this.nextPlayer,\r\n      worker: this.constructor.WORKER_SECOND,\r\n    });\r\n    const nextPlayer = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    return this.createNext(rowsAndColumns, {\r\n      nextPlayer: nextPlayer,\r\n      moveType: nextPlayer === this.constructor.PLAYER_A\r\n        ? this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE\r\n        : this.constructor.MOVE_TYPE_PLACE_FIRST_WORKER,\r\n      availableMovesMatrix: nextPlayer === this.constructor.PLAYER_A\r\n        ? this.constructor.getPlayerAvailableMovesMatrix(rowsAndColumns, nextPlayer)\r\n        : this.constructor.getEmptyCellsAvailableMovesMatrix(rowsAndColumns),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  selectWorkerToMove({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE, {x, y});\r\n\r\n    const cell = this.rowsAndColumns[y].cells[x];\r\n    return this.createStep(this.rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: cell.worker === this.constructor.WORKER_FIRST\r\n        ? this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER\r\n        : this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER,\r\n      availableMovesMatrix: this.constructor.getMovableAvailableMovesMatrix(this.rowsAndColumns, {x, y}),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n\r\n  moveWorker(to, worker) {\r\n    const fromCell = this.findCell(cell => cell.player === this.nextPlayer && cell.worker === worker);\r\n    const toCell = this.rowsAndColumns[to.y].cells[to.x];\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, ...[\r\n      {x: fromCell.x, y: fromCell.y, player: null, worker: null},\r\n      {x: toCell.x, y: toCell.y, player: fromCell.player, worker: fromCell.worker},\r\n    ]);\r\n    return this.createStep(rowsAndColumns, {\r\n      nextPlayer: this.nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER,\r\n      availableMovesMatrix: this.constructor.getBuildableAvailableMovesMatrix(rowsAndColumns, to),\r\n      canUndo: true,\r\n      resignedPlayer: null,\r\n    }, {x: to.x, y: to.y});\r\n  }\r\n\r\n  moveFirstWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_FIRST_WORKER, {x, y});\r\n\r\n    return this.moveWorker({x, y}, this.constructor.WORKER_FIRST)\r\n  }\r\n\r\n  moveSecondWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_MOVE_SECOND_WORKER, {x, y});\r\n\r\n    return this.moveWorker({x, y}, this.constructor.WORKER_SECOND)\r\n  }\r\n\r\n  buildAroundWorker({x, y}) {\r\n    this.checkCanMakeMove(this.constructor.MOVE_TYPE_BUILD_AROUND_WORKER, {x, y});\r\n\r\n    const rowsAndColumns = this.constructor.updateCells(this.rowsAndColumns, {\r\n      x, y, level: this.rowsAndColumns[y].cells[x].level + 1,\r\n    });\r\n    const nextPlayer = this.constructor.OTHER_PLAYER[this.nextPlayer];\r\n    return this.createNext(rowsAndColumns, {\r\n      nextPlayer: nextPlayer,\r\n      moveType: this.constructor.MOVE_TYPE_SELECT_WORKER_TO_MOVE,\r\n      availableMovesMatrix: this.constructor.getPlayerAvailableMovesMatrix(rowsAndColumns, nextPlayer),\r\n      canUndo: false,\r\n      resignedPlayer: null,\r\n    }, {x, y});\r\n  }\r\n}\r\n\r\nexport {\r\n  InvalidMoveError,\r\n};\r\n\r\nexport default Game;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport \"../../styles/html-board.css\";\r\n\r\nclass HtmlBoardBackground extends Component {\r\n  render() {\r\n    let {\r\n      className, clickable, undoable, isCellAvailable, isCellUndoable, small, medium, makeMove, onSelect, selected,\r\n      settings, rowsAndColumns,\r\n    } = this.props;\r\n    const {theme: {scheme, numbers}} = settings;\r\n\r\n    className = classNames(\"board\", \"html-board\", {\r\n      'small-board': small,\r\n      'medium-board': medium,\r\n      editable: !!makeMove && (clickable || undoable),\r\n      selectable: !!onSelect,\r\n      selected,\r\n      'board-theme-default': scheme === '',\r\n      'board-theme-subtle': scheme === 'subtle',\r\n      'board-theme-pastel': scheme === 'pastel',\r\n      'board-theme-green': scheme === 'green',\r\n      'numbered-levels': ['obvious', 'subtle', 'very-subtle'].includes(numbers),\r\n      'obvious-levels': numbers === 'obvious',\r\n      'subtle-levels': numbers === 'subtle',\r\n      'very-subtle-levels': numbers === 'very-subtle',\r\n    }, className);\r\n\r\n    return (\r\n      <div className={className} onClick={onSelect}>\r\n        {rowsAndColumns.map(row => (\r\n          <div key={`row-${row.y}`} className={\"row\"}>\r\n            {row.cells.map(cell => (\r\n              <HtmlBoardCell\r\n                key={`${cell.x}-${cell.y}`}\r\n                cell={cell}\r\n                clickable={clickable || (undoable && isCellUndoable(cell))}\r\n                available={isCellAvailable(cell)}\r\n                undoable={isCellUndoable(cell)}\r\n                settings={settings}\r\n                makeMove={this.props.makeMove}\r\n                undo={this.props.undo}\r\n              />\r\n            ))}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nHtmlBoardBackground.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n};\r\n\r\nHtmlBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  animated: false,\r\n};\r\n\r\nclass HtmlBoardCell extends Component {\r\n  makeMove = () => {\r\n    if (this.props.available && this.props.makeMove) {\r\n      this.props.makeMove(this.props.cell);\r\n    } else if (this.props.undoable && this.props.undo) {\r\n      this.props.undo();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {cell, clickable, available, undoable, settings: {theme: {numbers}}, makeMove, undo} = this.props;\r\n    const displayLevel = (\r\n      ['obvious', 'subtle', 'very-subtle'].includes(numbers)\r\n      && cell.level > 0\r\n      && cell.level <4\r\n    ) ? cell.level : null;\r\n    return (\r\n      <div\r\n        key={`row-${cell.x}-${cell.y}`}\r\n        className={classNames(\"cell\", `level-${cell.level}`, {available, undoable})}\r\n        onClick={((makeMove && available) || (undo && undoable)) && clickable ? this.makeMove : null}\r\n      >\r\n        <div className={classNames(\"level\", \"level-1\")}>\r\n          <div className={classNames(\"level\", \"level-2\")}>\r\n            <div className={classNames(\"level\", \"level-3\")}>\r\n              {cell.player ? (\r\n                <div className={classNames(\"worker\", `player-${cell.player}`)}>\r\n                  {displayLevel}\r\n                </div>\r\n              ) : cell.level === 4 ? (\r\n                <div className={classNames(\"level\", \"level-4\")} />\r\n              ) : displayLevel}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nHtmlBoardCell.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n};\r\n\r\nHtmlBoardCell.defaultProps = {\r\n  clickable: false,\r\n  available: false,\r\n  undoable: false,\r\n};\r\n\r\nexport default HtmlBoardBackground;\r\n","import React, {PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as constants from './constants';\r\n\r\nclass LevelIndicatorVerySubtle extends PureComponent {\r\n\trender() {\r\n    const {level} = this.props;\r\n    if (!level) {\r\n      return null;\r\n    }\r\n  \treturn (\r\n    \t<g transform={`translate(${constants.cellSize / 10},${constants.cellSize / 10})`}>\r\n        <text\r\n          dominantBaseline={\"central\"}\r\n          textAnchor={\"middle\"}\r\n          style={{fontSize: `${constants.cellSize * 0.15}px`}}\r\n        >{level}</text>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicatorVerySubtle.propTypes = {\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\nclass LevelIndicatorSubtle extends PureComponent {\r\n\trender() {\r\n  \tconst {level} = this.props;\r\n    if (!level) {\r\n      return null;\r\n    }\r\n  \treturn (\r\n    \t<g transform={`translate(22,22)`}>\r\n        <circle r={constants.cellSize * 0.15} fill={'#bbb'} stroke={'#111'} strokeWidth={2} />\r\n        <text\r\n          dominantBaseline={\"central\"}\r\n          textAnchor={\"middle\"}\r\n          style={{fontSize: `${constants.cellSize * 0.25}px`}}\r\n        >{level}</text>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicatorSubtle.propTypes = {\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\nclass LevelIndicatorObvious extends PureComponent {\r\n\trender() {\r\n  \tconst {level} = this.props;\r\n    if (!level) {\r\n      return null;\r\n    }\r\n  \treturn (\r\n    \t<g transform={`translate(${constants.cellSize / 2},${constants.cellSize / 2})`}>\r\n        <text\r\n          dominantBaseline={\"central\"}\r\n          textAnchor={\"middle\"}\r\n          stroke={'#eee'}\r\n          strokeWidth={constants.cellSize * 0.06}\r\n          paintOrder={'stroke'}\r\n          style={{fontSize: `${constants.cellSize * 0.45}px`}}\r\n        >{level}</text>\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicatorObvious.propTypes = {\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\nclass LevelIndicator extends PureComponent {\r\n\tstatic indicatorMap = {\r\n    'very-subtle': LevelIndicatorVerySubtle,\r\n    'subtle': LevelIndicatorSubtle,\r\n    'obvious': LevelIndicatorObvious,\r\n  };\r\n\r\n\trender() {\r\n  \tconst {level, type} = this.props;\r\n    const Indicator = this.constructor.indicatorMap[type];\r\n    if (!Indicator) {\r\n    \treturn null;\r\n    }\r\n  \treturn (\r\n    \t<Indicator level={level} />\r\n    );\r\n  }\r\n}\r\n\r\nLevelIndicator.propTypes = {\r\n  type: PropTypes.oneOf(['very-subtle', 'subtle', 'obvious']).isRequired,\r\n  level: PropTypes.oneOf([0, 1, 2, 3, 4]).isRequired,\r\n};\r\n\r\n\r\nexport default LevelIndicator;\r\n","import React, {PureComponent, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as constants from \"./constants\";\r\n\r\nclass BasePieceDefinition extends PureComponent {\r\n\trender() {\r\n  \tconst {name, path, dimensions, offset} = this.props;\r\n  \treturn (\r\n    \t<Fragment>\r\n        <g id={`piece-${name}-base`} transform={[\r\n      \t\t`translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n        \t`scale(${(constants.pieceScaling)},${(constants.pieceScaling)})`,\r\n        \t`translate(${-dimensions.x / 2 + offset.x},${-dimensions.y / 2 + offset.y})`,\r\n      \t].join(',')}>{path}</g>\r\n        <g id={`piece-${name}-white`}>\r\n          <use xlinkHref={`#piece-${name}-base`} strokeWidth={constants.pieceStrokeWidth} stroke={\"#111\"} />\r\n          <use xlinkHref={`#piece-${name}-base`} fill={'white'} />\r\n        </g>\r\n        <g id={`piece-${name}-black`}>\r\n          <use xlinkHref={`#piece-${name}-base`} strokeWidth={constants.pieceStrokeWidth} stroke={\"#bbb\"} />\r\n          <use xlinkHref={`#piece-${name}-base`} fill={'black'} />\r\n        </g>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nBasePieceDefinition.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  path: PropTypes.node.isRequired,\r\n  dimensions: PropTypes.object.isRequired,\r\n  offset: PropTypes.object.isRequired,\r\n};\r\n\r\nclass BasePiece extends PureComponent {\r\n\tstatic rotateTransform =\r\n  \t`rotate(180,${constants.cellSize / 2},${constants.cellSize / 2})`;\r\n\r\n\trender() {\r\n  \tconst {name, colour, rotated} = this.props;\r\n  \treturn (\r\n    \t<use\r\n        xlinkHref={`#piece-${name}-${colour}`}\r\n        transform={rotated ? this.constructor.rotateTransform : undefined}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nBasePiece.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  colour: PropTypes.oneOf(['white', 'black']),\r\n  rotated: PropTypes.bool.isRequired,\r\n};\r\n\r\nconst definePiece = (className, {path, dimensions, offset = {x: 0, y: 0}}) => {\r\n  class PieceDefinitionFor extends PureComponent {\r\n    render() {\r\n      return (\r\n        <BasePieceDefinition\r\n          name={className}\r\n          path={path}\r\n          dimensions={dimensions}\r\n          offset={offset}\r\n          />\r\n      );\r\n    }\r\n  }\r\n  PieceDefinitionFor.displayName = `${className}Definition`;\r\n\r\n  class PieceFor extends PureComponent {\r\n    static Definition = PieceDefinitionFor;\r\n\r\n    render() {\r\n      const {colour, rotated} = this.props;\r\n      return (\r\n        <BasePiece\r\n          name={className}\r\n          colour={colour}\r\n          rotated={rotated}\r\n        />\r\n      );\r\n    }\r\n  }\r\n  PieceFor.displayName = className;\r\n\r\n  return PieceFor;\r\n};\r\n\r\nconst PiecePawn = definePiece('PiecePawn', {\r\n  path: <path d=\"M105.1 224H80a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h16v5.49c0 44-4.14 86.6-24 122.51h176c-19.89-35.91-24-78.51-24-122.51V288h16a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-25.1c29.39-18.38 49.1-50.78 49.1-88a104 104 0 0 0-208 0c0 37.22 19.71 69.62 49.1 88zM304 448H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z\" />,\r\n  dimensions: {x: 320, y: 480},\r\n  offset: {x: 0, y: -38},\r\n});\r\n\r\nconst PieceKing = definePiece('PieceKing', {\r\n  path: <path d=\"M400 448H48a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h352a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm16-288H256v-48h40a8 8 0 0 0 8-8V56a8 8 0 0 0-8-8h-40V8a8 8 0 0 0-8-8h-48a8 8 0 0 0-8 8v40h-40a8 8 0 0 0-8 8v48a8 8 0 0 0 8 8h40v48H32a32 32 0 0 0-30.52 41.54L74.56 416h298.88l73.08-214.46A32 32 0 0 0 416 160z\" />,\r\n  dimensions: {x: 448, y: 512},\r\n});\r\n\r\nconst PieceCircle = definePiece('PieceCircle', {\r\n  path: <path d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceCertificate = definePiece('PieceCertificate', {\r\n  path: <path d=\"M458.622 255.92l45.985-45.005c13.708-12.977 7.316-36.039-10.664-40.339l-62.65-15.99 17.661-62.015c4.991-17.838-11.829-34.663-29.661-29.671l-61.994 17.667-15.984-62.671C337.085.197 313.765-6.276 300.99 7.228L256 53.57 211.011 7.229c-12.63-13.351-36.047-7.234-40.325 10.668l-15.984 62.671-61.995-17.667C74.87 57.907 58.056 74.738 63.046 92.572l17.661 62.015-62.65 15.99C.069 174.878-6.31 197.944 7.392 210.915l45.985 45.005-45.985 45.004c-13.708 12.977-7.316 36.039 10.664 40.339l62.65 15.99-17.661 62.015c-4.991 17.838 11.829 34.663 29.661 29.671l61.994-17.667 15.984 62.671c4.439 18.575 27.696 24.018 40.325 10.668L256 458.61l44.989 46.001c12.5 13.488 35.987 7.486 40.325-10.668l15.984-62.671 61.994 17.667c17.836 4.994 34.651-11.837 29.661-29.671l-17.661-62.015 62.65-15.99c17.987-4.302 24.366-27.367 10.664-40.339l-45.984-45.004z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceSun = definePiece('PieceSun', {\r\n  path: <path d=\"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceRocket = definePiece('PieceRocket', {\r\n  path: <path d=\"M505.05 19.1a15.89 15.89 0 0 0-12.2-12.2C460.65 0 435.46 0 410.36 0c-103.2 0-165.1 55.2-211.29 128H94.87A48 48 0 0 0 52 154.49l-49.42 98.8A24 24 0 0 0 24.07 288h103.77l-22.47 22.47a32 32 0 0 0 0 45.25l50.9 50.91a32 32 0 0 0 45.26 0L224 384.16V488a24 24 0 0 0 34.7 21.49l98.7-49.39a47.91 47.91 0 0 0 26.5-42.9V312.79c72.59-46.3 128-108.4 128-211.09.1-25.2.1-50.4-6.85-82.6zM384 168a40 40 0 1 1 40-40 40 40 0 0 1-40 40z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceBug = definePiece('PieceBug', {\r\n  path: <path d=\"M511.988 288.9c-.478 17.43-15.217 31.1-32.653 31.1H424v16c0 21.864-4.882 42.584-13.6 61.145l60.228 60.228c12.496 12.497 12.496 32.758 0 45.255-12.498 12.497-32.759 12.496-45.256 0l-54.736-54.736C345.886 467.965 314.351 480 280 480V236c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v244c-34.351 0-65.886-12.035-90.636-32.108l-54.736 54.736c-12.498 12.497-32.759 12.496-45.256 0-12.496-12.497-12.496-32.758 0-45.255l60.228-60.228C92.882 378.584 88 357.864 88 336v-16H32.666C15.23 320 .491 306.33.013 288.9-.484 270.816 14.028 256 32 256h56v-58.745l-46.628-46.628c-12.496-12.497-12.496-32.758 0-45.255 12.498-12.497 32.758-12.497 45.256 0L141.255 160h229.489l54.627-54.627c12.498-12.497 32.758-12.497 45.256 0 12.496 12.497 12.496 32.758 0 45.255L424 197.255V256h56c17.972 0 32.484 14.816 31.988 32.9zM257 0c-61.856 0-112 50.144-112 112h224C369 50.144 318.856 0 257 0z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceEye = definePiece('PieceEye', {\r\n  path: <path d=\"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceUser = definePiece('PieceUser', {\r\n  path: <path d=\"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceHalloweenWitchHat = definePiece('PieceHalloweenWitchHat', {\r\n  path: <path d=\"m503.15112,306.14207c-0.08158,-19.00159 -17.54216,-60.97152 -168.51607,-65.22834l-56.26328,-124.83471l76.29825,31.88264l-114.45191,-123.15047c-15.62768,-10.96294 -68.47535,146.47597 -90.00964,213.1728l0,0c-15.14543,2.38948 -62.92045,11.0826 -99.71439,30.45222c-35.89653,18.84568 -54.83104,35.48317 -49.64961,58.60561c-3.7637,26.02861 5.74707,103.14994 246.53844,113.09401c77.45129,3.20712 270.97346,-48.42768 255.7682,-133.99376zm-240.39978,5.43162c-121.8814,8.58253 -132.04665,-25.29799 -132.04665,-25.29799l11.06991,-24.04705c0,0 33.36383,22.50785 101.67601,21.3258c68.31218,-1.19474 96.66319,-31.58713 96.66319,-31.58713l17.99721,21.89507c-4.4073,28.55043 -95.35967,37.7113 -95.35967,37.7113z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceHalloweenCauldron = definePiece('PieceHalloweenCauldron', {\r\n  path: <path d=\"M403.886,427.092c31.805-31.675,51.156-72.843,51.156-117.982c0-39.184-14.643-75.351-39.282-104.954 c2.02-6.265,3.149-12.751,3.149-19.456c0-37.186-32.559-68.257-83.059-85.193l28.483-65.848c5.268-12.211-0.35-26.389-12.568-31.673 c-12.2-5.284-26.376,0.345-31.663,12.554l-32.024,74.065c-13.741-1.849-28.121-2.939-43.145-2.939 c-99.2,0-173.995,42.572-173.995,99.034c0,6.705,1.129,13.191,3.15,19.456c-24.64,29.604-39.289,65.771-39.289,104.954 c0,45.14,19.371,86.317,51.175,117.988l-17.909,24.225c-7.902,10.695-5.643,25.775,5.053,33.689 c4.297,3.184,9.314,4.721,14.299,4.721c7.374,0,14.668-3.379,19.39-9.772l17.154-23.22c34.224,20.78,75.895,33.1,120.973,33.1 c45.072,0,86.731-12.32,120.935-33.09l17.155,23.21c4.74,6.393,12.016,9.772,19.401,9.772c4.974,0,9.99-1.537,14.306-4.715 c10.696-7.911,12.968-22.99,5.065-33.695L403.886,427.092z M244.915,236c-78.418,0-125.798-29.477-125.798-51.3 c0-20.734,49.014-50.853,125.816-50.853c8.044,0,15.73,0.399,23.128,1.01l-12.19,28.209c-3.218,7.447-2.473,16.014,1.983,22.794 c4.456,6.78,12.024,10.862,20.138,10.862c9.611,0,18.303-5.711,22.118-14.532l16.543-38.252 c34.191,10.619,54.079,27.573,54.079,40.762C370.731,207.889,320.981,236,244.915,236z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceHalloweenBat = definePiece('PieceHalloweenBat', {\r\n  path: <path d=\"m520.84272,171.44399c-8.83353,-12.69106 -16.6399,-27.11688 -22.85989,-42.92364c-9.91775,-25.0968 -14.56277,-50.31915 -14.5057,-73.25893c0.01141,-8.66234 -10.44274,-13.31877 -16.87957,-7.50964c-28.86304,25.99842 -77.48168,46.1763 -136.24632,55.95709c5.66076,-27.88153 5.47816,-60.38526 -10.4998,-91.3825c-2.86462,-5.55805 -10.62534,-6.19716 -14.28886,-1.14128c-4.65643,6.42542 -9.55254,15.94372 -9.55254,27.61904l-68.13457,0c0,-11.67532 -4.88469,-21.19362 -9.54112,-27.61904c-3.66352,-5.06729 -11.41283,-4.42818 -14.28886,1.14128c-15.97796,30.98582 -16.14915,63.4439 -10.48839,91.32544c-58.76464,-9.78079 -107.3947,-29.94726 -136.24632,-55.93426c-6.43683,-5.79772 -16.87957,-1.12987 -16.87957,7.53247c0.06848,22.93978 -4.58796,48.17354 -14.5057,73.25893c-6.21999,15.80676 -14.02636,30.24399 -22.85989,42.92364c-6.6765,9.56395 -1.92877,22.98543 9.19874,26.50058c10.19165,3.207 20.60015,7.74931 30.81463,13.60409c35.3227,20.23494 56.25382,50.76425 60.5108,76.28333c1.17552,7.0303 3.62928,9.74655 13.30736,8.19441c24.05824,-3.90319 56.71033,-1.27824 88.11843,16.71979c17.29043,9.91775 31.5907,22.26642 41.93072,35.25422c3.36678,4.22275 7.79496,6.99606 15.00787,6.99606c7.07595,0 11.54978,-2.79614 14.90515,-7.00748c10.35143,-12.99921 24.69736,-25.32506 41.9992,-35.23139c31.41951,-18.00944 64.07161,-20.63439 88.15267,-16.7312c9.67808,1.56356 12.12042,-1.17552 13.30736,-8.20582c4.25698,-25.50767 25.19952,-56.03698 60.52222,-76.28333c10.22589,-5.86619 20.65722,-10.39708 30.81463,-13.60409c11.11609,-3.49232 15.85242,-16.91381 9.18733,-26.47776z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n  offset: {x: 0, y: 100},\r\n});\r\n\r\nconst PieceHalloweenSpider = definePiece('PieceHalloweenSpider', {\r\n  path: <path d=\"M392.236,256.85c-3.204-3.473-7.704-5.451-12.436-5.451h-20.374c-3.501-15.538-8.927-30.108-16.075-43.152 l44.043-13.528l68.976,73.267c3.34,3.542,7.826,5.325,12.339,5.325c4.169,0,8.332-1.528,11.608-4.603 c6.798-6.41,7.109-17.127,0.712-23.938l-76.206-80.945c-4.416-4.697-11.13-6.464-17.299-4.581l-65.142,20.012 c-6.842-7.334-14.321-13.819-22.387-19.144l79.475-60.708l63.803,37.227c8.073,4.703,18.425,1.968,23.151-6.096 c4.713-8.08,1.987-18.447-6.086-23.161l-73.59-42.94c-5.917-3.447-13.362-2.994-18.82,1.176l-61.323,46.84 c-2.544-8.789-7.769-16.651-14.916-23.168l9.129-19.879c3.903-8.5,0.168-18.554-8.333-22.448c-8.532-3.92-18.554-0.182-22.445,8.325 l-8.448,18.416c-5.988-1.463-12.204-2.49-18.769-2.49s-12.786,1.026-18.768,2.49l-8.455-18.416 c-3.885-8.507-13.938-12.23-22.439-8.325c-8.501,3.894-12.236,13.948-8.338,22.448l9.135,19.879 c-6.785,6.177-11.744,13.593-14.405,21.838l-61.835-47.231c-5.456-4.151-12.901-4.629-18.82-1.167l-73.597,42.94 c-8.066,4.713-10.798,15.085-6.085,23.161c4.713,8.08,15.085,10.814,23.157,6.095l63.802-37.227l80.732,61.669 c-8.054,5.166-15.577,11.384-22.439,18.555l-66.347-20.384c-6.17-1.884-12.87-0.107-17.298,4.58L4.613,243.058 c-6.402,6.814-6.085,17.528,0.712,23.938c3.27,3.086,7.439,4.607,11.608,4.607c4.5,0,8.993-1.787,12.333-5.326l68.981-73.271 l44.916,13.794c-7.296,12.955-12.916,27.402-16.586,42.888h-20.736c-4.733,0-9.232,1.978-12.437,5.451L4.496,351.453 c-6.35,6.872-5.923,17.587,0.958,23.927c3.256,3.006,7.375,4.49,11.478,4.49c4.565,0,9.11-1.835,12.45-5.447l83.879-90.868h8.72 c-0.103,2.606-0.317,5.17-0.317,7.808c0,82.225,54.247,148.879,121.156,148.879c66.91,0,121.156-66.654,121.156-148.879 c0-2.059-0.181-4.06-0.252-6.095h8.649l83.878,90.867c3.341,3.612,7.892,5.448,12.456,5.448c4.098,0,8.215-1.489,11.478-4.49 c6.876-6.341,7.31-17.059,0.959-23.928L392.236,256.85z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceHalloweenCat = definePiece('PieceHalloweenCat', {\r\n  path: <path d=\"M535.892,69.273c-1.147-7.46-7.924-12.77-15.396-12.135c-18.883,1.568-36.254,5.171-53.12,11.036 c-26.556,9.215-50.526,22.663-71.3,39.987l-0.308-0.086c-14.421-3.867-29.328-7.866-44.305-11.164 c-22.579-4.957-45.793-7.843-68.993-8.569c-21.208-0.665-43.206,0.343-67.381,3.097c-24.638,2.791-49.336,8.058-73.413,15.628 c-0.21,0.065-0.397,0.119-0.567,0.166c-1.97-1.857-3.953-3.192-5.603-4.301c-0.621-0.429-1.265-0.84-1.849-1.304 c-21.19-16.97-46.129-29.802-74.134-38.137c-13.444-4.004-26.71-6.356-40.545-7.206C11.8,55.825,5.42,60.755,4.011,67.791 c-0.182,0.913-0.383,1.801-0.574,2.681c-0.497,2.28-1.013,4.632-1.363,7.236c-3.068,22.953-2.728,46.419,0.99,69.745 c4.587,28.742,13.229,55.232,25.692,78.808c-6.198,14.209-10.097,30.103-11.889,48.472c-3.624,37.075,3.206,72.854,20.302,106.335 c13.562,26.546,33.085,49.106,58.047,67.047c22.906,16.461,44.463,24.021,70.319,31.83c25.86,7.812,52.794-18.394,103.458-18.053 c47.781,0.304,59.902,19.845,93.234,19.845c0,0,1.218-0.275,1.204-0.275c18.337-5.021,34.737-11.397,50.143-19.49 c27.872-14.626,51.054-34.909,68.896-60.294c19.695-28.012,31.298-59.897,34.504-94.77c2.525-27.56-1.115-54.252-10.889-79.539 l1.956-4.331c5.596-12.405,11.383-25.219,16.186-38.447c7.761-21.406,12.134-44.354,13.366-70.146 C538.166,102.325,538.497,86.233,535.892,69.273z M228.288,339.606c0,0-55.298,5.619-85.933-25.015 c-30.635-30.645-25.013-85.936-25.013-85.936s55.293-5.612,85.928,25.022C233.909,284.311,228.288,339.606,228.288,339.606z  M401.251,314.591c-30.635,30.634-85.93,25.015-85.93,25.015s-5.614-55.295,25.02-85.928 c30.631-30.635,85.926-25.022,85.926-25.022S431.891,283.957,401.251,314.591z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceHalloweenTombstone = definePiece('PieceHalloweenTombstone', {\r\n  path: <g>\r\n   <path d=\"m310.57959,214.18901c18.11361,-19.31361 -3.7406,-43.37905 -25.98583,-38.09752l0,42.67408c9.2552,1.74895 18.77428,3.11653 25.98583,-4.57656z\"/>\r\n   <path d=\"m129.70544,175.71203l0,42.67408c1.4138,0.01734 2.82568,0.04045 4.23563,0.07705c40.18933,0.00193 36.10009,-50.48851 -4.23563,-42.75112z\"/>\r\n   <path d=\"m413.15147,392.28371l-16.74989,0l0,-215.12898c0,-40.68243 -13.72389,-78.15395 -36.78388,-108.06144l-22.93479,7.21154l9.8003,27.57684l0.81284,2.2748l-1.54285,1.56597l-23.05228,23.42789c-1.05361,1.07287 -2.77752,1.08443 -3.85232,0.03274c-1.02472,-1.01509 -1.07865,-2.65617 -0.13676,-3.7329l20.04555,-22.91938l-12.48344,-29.52418l-1.64687,-3.89277l4.24718,-2.15345l21.51906,-10.90592c-32.4115,-35.66478 -79.16711,-58.05447 -131.15032,-58.05447c-47.67246,0 -90.9398,18.83399 -122.78115,49.45994l25.07861,12.71458l2.53097,1.28282l0.31589,2.24205l7.99742,56.33826c0.2138,1.48892 -0.8244,2.86613 -2.31332,3.07993c-1.42151,0.20032 -2.74285,-0.74542 -3.04333,-2.12841l-11.27574,-52.83457l-30.02113,-9.43818c-27.17619,31.13831 -43.64679,71.86504 -43.64679,116.44023l0,215.12898l-16.75181,0c-10.63818,0 -19.2616,8.62342 -19.2616,19.2616l0,18.9226c0,10.63433 8.62342,19.2616 19.2616,19.2616l387.82079,0c10.63818,0 19.2616,-8.62727 19.2616,-19.2616l0,-18.9226c-0.00193,-10.63818 -8.62535,-19.26353 -19.26353,-19.26353zm-144.04211,-222.43298c5.59164,-0.28122 11.37783,-0.57207 17.23143,-0.57207c13.94155,0 31.1229,1.44847 40.31261,12.73577c0.00385,0.00385 0.0077,0.0077 0.01156,0.01156l0.0077,0.01541c0.00385,0.00578 0.01156,0.01156 0.01541,0.01734c0.0077,0.0077 0.01541,0.01541 0.01926,0.02504c0.00385,0.00578 0.0077,0.01156 0.01541,0.01926c6.75697,8.36531 8.55408,16.01602 5.34124,22.74025c-5.38362,11.27959 -23.59931,17.36819 -37.99736,17.36819c-3.28025,0 -9.09533,-0.89374 -9.09533,-0.89374s-4.54959,37.16719 2.2382,44.46541c1.52745,1.63724 3.37078,2.8199 5.51267,3.54221l-32.98549,0c10.84621,-4.50721 15.75406,-26.9778 15.75406,-49.26732c0,-22.61312 -4.91171,-45.40923 -15.76947,-49.79509c2.96629,-0.09246 6.11556,-0.2504 9.3881,-0.4122zm-59.43938,0.48154l34.88854,0c-3.75794,1.56019 -7.90881,5.69758 -11.09468,15.3149c-2.9085,8.77944 -3.1069,20.6677 -3.1069,33.48244c0,22.0006 3.46516,45.50553 14.04749,50.19381l-34.89624,0c3.74253,-1.55826 7.88955,-5.69373 11.05616,-15.3149c2.89117,-8.77173 3.13001,-20.66192 3.13001,-33.46896c0.00385,-22.00831 -3.48635,-45.51709 -14.02437,-50.20729zm-104.76,-0.05201c3.66741,-0.07705 7.46002,-0.23692 11.41443,-0.40257c5.73803,-0.23884 11.6629,-0.48732 17.50109,-0.48732c11.63979,0 20.4173,1.0305 27.62114,3.24558c11.07542,3.40545 17.20446,10.95407 16.81538,20.71393c-0.47769,12.00961 -10.52647,23.21986 -23.3701,26.07636c-0.59518,0.13098 -1.08443,0.55088 -1.29823,1.1191c-0.2138,0.56629 -0.13483,1.20578 0.22151,1.69887l21.18006,29.4298c6.29854,8.78714 12.74155,15.2263 22.73062,17.64748l-21.625,0l-34.1932,-47.22752c-0.35056,-0.48732 -0.92263,-0.76276 -1.5313,-0.74542c-1.7374,0.06742 -3.79646,0.13676 -5.89598,0.13676c-1.68154,0 -3.20898,-0.04238 -4.66516,-0.13483c-0.48924,-0.02889 -0.98619,0.14446 -1.35024,0.48539c-0.36212,0.34286 -0.56822,0.81862 -0.56822,1.31749c0,2.50016 -0.22921,5.6398 -0.46228,8.96435c-0.84558,11.75536 -1.89919,26.37876 4.88667,33.66735c1.52359,1.63531 3.36308,2.81605 5.50304,3.53643l-32.95275,0c10.89051,-4.50721 15.8157,-26.97973 15.8157,-49.27118c0,-22.57652 -4.91363,-45.33411 -15.77718,-49.77005z\"/>\r\n  </g>,\r\n  dimensions: {x: 512, y: 512},\r\n  offset: {x: 50, y: 50},\r\n});\r\n\r\nconst PieceHalloweenPumpkin = definePiece('PieceHalloweenPumpkin', {\r\n  path: <path d=\"m468.74161,145.38332c-25.52721,-31.3253 -52.92613,-46.95841 -82.22343,-46.95841c-20.72406,0 -40.16348,8.29877 -58.36017,25.00115c-12.62923,-9.61583 -26.26865,-16.44316 -40.93732,-20.48009c-3.03246,-39.3801 -20.45722,-67.93597 -52.29333,-85.65997l-33.33805,23.54115c21.70947,14.12736 34.34823,33.82218 37.88389,59.08636c-21.72472,2.535 -41.93416,10.61267 -60.63213,24.23112c-18.68273,-17.16363 -38.64438,-25.72163 -59.85448,-25.72163c-29.81764,0 -56.60092,15.63311 -80.33839,46.95841c-25.77309,32.32024 -38.6482,70.49765 -38.6482,114.44265c0,11.10824 1.014,22.26984 3.01722,33.35139c7.58211,45.47172 28.81127,85.15297 63.6646,118.97324c31.32339,30.84689 60.38435,46.24556 87.16381,46.24556c0.6328,0 1.28465,-0.02287 1.93651,-0.06671c30.65438,-9.40998 63.19572,-14.48378 96.93403,-14.48378c28.17847,0 55.52974,3.54137 81.64019,10.18954l-0.14104,-0.18679l0.61564,0.30496c4.98994,1.27703 9.93032,2.67604 14.82877,4.17988c0.66329,0.04003 1.32658,0.0629 1.98797,0.0629c26.78518,0 55.56786,-15.39867 86.39569,-46.24556l0,-0.00191c33.84124,-33.82027 55.57167,-73.49962 65.16463,-118.97324c2.55406,-12.61017 3.79296,-25.00115 3.79296,-37.12911c0.00191,-42.46213 -12.76075,-79.34345 -38.25937,-110.66113zm-373.25996,61.40407l108.37772,37.1577c-9.0993,24.7305 -25.51387,37.10433 -49.26277,37.10433c-6.56812,0 -12.38717,-1.0159 -17.42666,-3.03056l0,0c-32.34883,-13.12289 -46.2284,-36.88323 -41.68828,-71.23146zm96.2574,231.91396c0.50509,-0.51081 1.26559,-1.27322 2.26244,-2.27578l0.75859,0.77193c-0.50509,0.49938 -1.50956,0.99303 -3.02103,1.50384zm184.91743,-70.48812l-249.34824,0l-18.17954,-50.80093l48.5099,32.62139l39.39535,-32.62139l53.07289,37.14054l55.32199,-39.37439l43.19022,37.12911l50.78568,-31.82467l-22.74825,47.73034zm0.00191,-90.19437c-5.56555,2.01275 -11.36364,3.03056 -17.42095,3.03056c-24.25781,0 -40.68953,-12.37383 -49.27421,-37.10433l108.3701,-37.1596c4.05218,34.34823 -9.8617,58.11048 -41.67494,71.23337z\" />,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nconst PieceHalloweenGhost = definePiece('PieceHalloweenGhost', {\r\n  path: <g>\r\n    <path d={\"m201.144531 256c-17.300781 0-36.574219 30.042969-36.574219 73.144531-.179687 13.222657.574219 26.441407 2.25 39.558594 20.023438-16.175781 48.621094-16.175781 68.644532 0 1.675781-13.117187 2.429687-26.335937 2.25-39.558594 0-43.101562-19.273438-73.144531-36.570313-73.144531zm0 0\"}/>\r\n    <path d={\"m201.144531 374.855469c-11.320312-.027344-22.007812 5.222656-28.902343 14.199219 6.390624 13.230468 16.449218 13.230468 28.902343 13.230468 12.449219 0 22.507813 0 28.898438-13.230468-6.894531-8.976563-17.582031-14.226563-28.898438-14.199219zm0 0\"}/>\r\n    <path d={\"m146.285156 178.285156c0-22.722656-8.1875-41.140625-18.285156-41.140625s-18.285156 18.417969-18.285156 41.140625 8.1875 41.144532 18.285156 41.144532 18.285156-18.421876 18.285156-41.144532zm0 0\"}/>\r\n    <path d={\"m9.390625 137.398438c-6.011719 5.988281-9.390625 14.125-9.390625 22.609374 0 8.488282 3.378906 16.621094 9.390625 22.613282l27.179687 27.234375v-22.691407c.042969-19.089843 2.753907-38.082031 8.046876-56.421874-12.015626-5.023438-25.871094-2.40625-35.226563 6.65625zm0 0\"}/>\r\n    <path d={\"m292.570312 178.285156c0-22.722656-8.1875-41.140625-18.285156-41.140625s-18.285156 18.417969-18.285156 41.140625 8.1875 41.144532 18.285156 41.144532 18.285156-18.421876 18.285156-41.144532zm0 0\"}/>\r\n    <path d={\"m434.707031 387.328125c-9.484375-16.925781-14.359375-36.042969-14.136719-55.441406v-66.40625c-2.863281-1.125-4.96875-3.617188-5.601562-6.632813-.632812-3.011718.296875-6.140625 2.464844-8.324218l67.886718-67.886719c12.472657-12.507813 12.472657-32.75 0-45.257813-12.667968-12.078125-32.589843-12.078125-45.257812 0l-67.882812 67.886719c-3.589844 3.464844-9.292969 3.414063-12.816407-.109375-3.527343-3.527344-3.578125-9.230469-.113281-12.816406l55.351562-55.351563c-20.773437-80.652343-93.511718-137.0117185-176.796874-136.988281h-2.832032c-78.738281 1.859375-147.5 53.765625-170.863281 128.976562-6.140625 18.785157-9.261719 38.425782-9.253906 58.1875v178.550782c.078125 14.484375 3.398437 28.769531 9.71875 41.800781 29.476562 61.511719 121.363281 104.484375 223.425781 104.484375 100.761719 0 178.148438-32.171875 215.863281-88.960938-28.007812 2.40625-54.90625-11.484374-69.15625-35.710937zm-343.277343-209.042969c0-33.882812 15.722656-59.429687 36.570312-59.429687 20.84375 0 36.570312 25.546875 36.570312 59.429687 0 33.882813-15.726562 59.429688-36.570312 59.429688-20.847656 0-36.570312-25.546875-36.570312-59.429688zm157.859374 210.960938c-.171874 1.1875-.578124 2.324218-1.199218 3.347656-9.296875 25.070312-26.128906 27.976562-46.945313 27.976562-20.820312 0-37.652343-2.90625-46.949219-27.976562-.621093-1.023438-1.027343-2.160156-1.199218-3.347656-5.195313-19.589844-7.457032-39.847656-6.710938-60.101563 0-51.265625 24.101563-91.429687 54.859375-91.429687 30.753907 0 54.855469 40.164062 54.855469 91.429687.75 20.253907-1.511719 40.511719-6.710938 60.101563zm24.996094-151.53125c-20.84375 0-36.570312-25.546875-36.570312-59.429688 0-33.882812 15.726562-59.429687 36.570312-59.429687 20.847656 0 36.570313 25.546875 36.570313 59.429687 0 33.882813-15.722657 59.429688-36.570313 59.429688zm0 0\"}/>\r\n  </g>,\r\n  dimensions: {x: 512, y: 512},\r\n});\r\n\r\nclass Piece extends PureComponent {\r\n\tstatic pieceStyleMap = {\r\n    'pawn': PiecePawn,\r\n    'king': PieceKing,\r\n    'circle': PieceCircle,\r\n    'certificate': PieceCertificate,\r\n    'sun': PieceSun,\r\n    'rocket': PieceRocket,\r\n    'bug': PieceBug,\r\n    'eye': PieceEye,\r\n    'user': PieceUser,\r\n    'halloween-witch-hat': PieceHalloweenWitchHat,\r\n    'halloween-cauldron': PieceHalloweenCauldron,\r\n    'halloween-bat': PieceHalloweenBat,\r\n    'halloween-spider': PieceHalloweenSpider,\r\n    'halloween-cat': PieceHalloweenCat,\r\n    'halloween-tombstone': PieceHalloweenTombstone,\r\n    'halloween-pumpkin': PieceHalloweenPumpkin,\r\n    'halloween-ghost': PieceHalloweenGhost,\r\n  };\r\n\r\n\trender() {\r\n  \tconst {style, colour, rotated} = this.props;\r\n    const PieceStyle = this.constructor.pieceStyleMap[style];\r\n  \treturn (\r\n    \t<PieceStyle colour={colour} rotated={rotated} />\r\n    );\r\n  }\r\n}\r\n\r\nPiece.propTypes = {\r\n  style: PropTypes.oneOf(Object.keys(Piece.pieceStyleMap)).isRequired,\r\n  colour: PropTypes.oneOf(['white', 'black']).isRequired,\r\n  rotated: PropTypes.bool.isRequired,\r\n};\r\n\r\nclass PieceDefinitions extends PureComponent {\r\n\trender() {\r\n  \treturn Object.values(Piece.pieceStyleMap)\r\n    \t.map(PieceStyle => <PieceStyle.Definition key={PieceStyle.displayName || PieceStyle.name} />);\r\n  }\r\n}\r\nPiece.Definitions = PieceDefinitions;\r\n\r\nexport default Piece;\r\n","export const cellSize = 100;\r\nexport const pieceStrokeWidth = 0.8 * cellSize;\r\nexport const borderWidth = 5;\r\nexport const pieceScaling = 0.1;\r\n","import React, {Fragment, PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport * as constants from './constants';\r\nimport LevelIndicator from \"./LevelIndicator\";\r\nimport Piece from \"./Piece\";\r\nimport Game from \"../../../game/game\";\r\n\r\nclass BaseCellDefinitions extends PureComponent {\r\n  static defaultBorder = (\r\n    <g>\r\n      <rect\r\n        fill={\"transparent\"}\r\n        width={constants.cellSize}\r\n        height={constants.cellSize}\r\n      />\r\n      <path className={\"border\"} d={`M0,0h${constants.cellSize}v${constants.cellSize}h-${constants.cellSize}z M${constants.borderWidth},${constants.borderWidth}v${constants.cellSize - constants.borderWidth * 2}h${constants.cellSize - constants.borderWidth * 2}v-${constants.cellSize - constants.borderWidth * 2}z`} />\r\n    </g>\r\n  );\r\n\r\n\trender() {\r\n\t  const {name, paths} = this.props;\r\n  \treturn (\r\n    \t<Fragment>\r\n        <g id={`cell-${name}-border`} className={\"cell-border\"}>\r\n          {paths.border}\r\n        </g>\r\n        <g id={`cell-${name}-0`} className={\"cell-0\"}>\r\n          {paths.level0}\r\n        </g>\r\n        <g id={`cell-${name}-1`} className={\"cell-1\"}>\r\n          {paths.level1}\r\n        </g>\r\n        <g id={`cell-${name}-2`} className={\"cell-2\"}>\r\n          {paths.level2}\r\n        </g>\r\n        <g id={`cell-${name}-3`} className={\"cell-3\"}>\r\n          {paths.level3}\r\n        </g>\r\n        <g id={`cell-${name}-4`} className={\"cell-4\"}>\r\n          {paths.level4}\r\n        </g>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nBaseCellDefinitions.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  paths: PropTypes.shape({\r\n    border: PropTypes.node.isRequired,\r\n    level0: PropTypes.node.isRequired,\r\n    level1: PropTypes.node.isRequired,\r\n    level2: PropTypes.node.isRequired,\r\n    level3: PropTypes.node.isRequired,\r\n    level4: PropTypes.node.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nconst defineCellDefinitions = (className, name, paths) => {\r\n  class CellDefinitionsFor extends PureComponent {\r\n    render() {\r\n      return (\r\n        <BaseCellDefinitions name={name} paths={paths} />\r\n      );\r\n    }\r\n  }\r\n  CellDefinitionsFor.displayName = className;\r\n\r\n  return CellDefinitionsFor;\r\n};\r\n\r\nconst OriginalCellDefinitions = defineCellDefinitions('OriginalCellDefinitions', 'original', {\r\n  border: BaseCellDefinitions.defaultBorder,\r\n  level0: (\r\n    <rect\r\n      className={'border fill'}\r\n      width={constants.cellSize - constants.borderWidth * 2}\r\n      height={constants.cellSize - constants.borderWidth * 2}\r\n      transform={`translate(${(constants.borderWidth)},${(constants.borderWidth)})`}\r\n    />\r\n  ),\r\n  level1: (\r\n    <g>\r\n      <rect\r\n        className={'border'}\r\n        width={constants.cellSize - constants.borderWidth * 2}\r\n        height={constants.cellSize - constants.borderWidth * 2}\r\n        transform={`translate(${(constants.borderWidth)},${(constants.borderWidth)})`}\r\n      />\r\n      <rect\r\n        className={'fill'}\r\n        width={constants.cellSize - constants.borderWidth * 4}\r\n        height={constants.cellSize - constants.borderWidth * 4}\r\n        transform={`translate(${constants.borderWidth * 2},${constants.borderWidth * 2})`}\r\n      />\r\n    </g>\r\n  ),\r\n  level2: (\r\n    <g>\r\n      <rect\r\n        className={'border'}\r\n        width={constants.cellSize - constants.borderWidth * 4}\r\n        height={constants.cellSize - constants.borderWidth * 4}\r\n        transform={`translate(${constants.borderWidth * 2},${constants.borderWidth * 2})`}\r\n      />\r\n      <rect\r\n        className={'fill'}\r\n        width={constants.cellSize - constants.borderWidth * 6}\r\n        height={constants.cellSize - constants.borderWidth * 6}\r\n        transform={`translate(${constants.borderWidth * 3},${constants.borderWidth * 3})`}\r\n      />\r\n    </g>\r\n  ),\r\n  level3: (\r\n    <g>\r\n      <rect\r\n        className={'border'}\r\n        width={constants.cellSize - constants.borderWidth * 6}\r\n        height={constants.cellSize - constants.borderWidth * 6}\r\n        transform={`translate(${constants.borderWidth * 3},${constants.borderWidth * 3})`}\r\n      />\r\n      <rect\r\n        className={'fill'}\r\n        width={constants.cellSize - constants.borderWidth * 8}\r\n        height={constants.cellSize - constants.borderWidth * 8}\r\n        transform={`translate(${constants.borderWidth * 4},${constants.borderWidth * 4})`}\r\n      />\r\n    </g>\r\n  ),\r\n  level4: (\r\n    <g>\r\n      <rect\r\n        className={'border'}\r\n        width={constants.cellSize - constants.borderWidth * 8}\r\n        height={constants.cellSize - constants.borderWidth * 8}\r\n        transform={`translate(${constants.borderWidth * 4},${constants.borderWidth * 4})`}\r\n      />\r\n      <rect\r\n        className={'fill'}\r\n        width={constants.cellSize - constants.borderWidth * 10}\r\n        height={constants.cellSize - constants.borderWidth * 10}\r\n        transform={`translate(${constants.borderWidth * 5},${constants.borderWidth * 5})`}\r\n      />\r\n    </g>\r\n  ),\r\n});\r\n\r\nconst HalloweenCellDefinitions = defineCellDefinitions('HalloweenCellDefinitions', 'halloween', {\r\n  border: BaseCellDefinitions.defaultBorder,\r\n  level0: (\r\n    <path className={\"fill\"} transform={\"scale(0.21)\"} d={\"m475.484375 292.628906h18.285156c8.34375.027344 15.640625-5.609375 17.71875-13.691406 2.074219-8.082031-1.605469-16.539062-8.933593-20.53125.082031-.433594.132812-.875.148437-1.316406.09375-.339844.164063-.683594.210937-1.035156v-171.820313c6.503907-11.746094 9.664063-25.046875 9.140626-38.464844 0-27.902343-10.832032-45.7148435-18.285157-45.7148435-7.449219 0-18.285156 17.8125005-18.285156 45.7148435-.523437 13.417969 2.636719 26.71875 9.144531 38.464844v109.511719c-11.957031-32.042969-32.140625-60.375-58.515625-82.148438-4.039062-3.027344-9.769531-2.210937-12.800781 1.828125-3.027344 4.042969-2.210938 9.773438 1.828125 12.800781 49.691406 37.265626 67 117.863282 69.332031 129.828126h-27.273437c0-2.53125-.492188-62.117188-43.492188-72.867188-3.179687-.820312-6.550781.125-8.839843 2.476562-2.289063 2.355469-3.140626 5.753907-2.230469 8.90625.90625 3.15625 3.4375 5.578126 6.625 6.355469 29.121093 7.277344 29.652343 54.527344 29.652343 55.128907h-173.488281c2.828125-12.214844 22.457031-88.640626 77.449219-120.0625 4.253906-2.566407 5.679688-8.054688 3.21875-12.363282-2.464844-4.3125-7.917969-5.871094-12.285156-3.507812-33.832032 19.34375-55.425782 52.480468-68.574219 81.003906v-116.890625c6.492187-11.75 9.640625-25.050781 9.105469-38.464844 0-27.902343-10.832032-45.7148435-18.285156-45.7148435-7.449219 0-18.285157 17.8125005-18.285157 45.7148435-.523437 13.417969 2.640625 26.71875 9.144531 38.464844v120.339844c-15.261718-33.203125-38.578124-62.0625-67.832031-83.960938-4.109375-2.933593-9.820312-1.980469-12.753906 2.128907-2.933594 4.113281-1.980469 9.824218 2.128906 12.757812 55.167969 39.402344 75.054688 108.496094 78.171875 120.554688h-173.429687c0-.601563.53125-47.851563 29.648437-55.128907 4.867188-1.257812 7.804688-6.203125 6.585938-11.074219-1.222656-4.875-6.144532-7.851562-11.027344-6.664062-43 10.75-43.492188 70.335938-43.492188 72.867188h-27.429687c.714844-7.988282 9.4375-91.675782 60.34375-129.828126 2.613281-1.960937 3.980469-5.164062 3.589844-8.40625-.390625-3.242187-2.480469-6.03125-5.484375-7.316406-3.003906-1.28125-6.464844-.863281-9.078125 1.09375-22.324219 17.949219-39.382813 41.597656-49.371094 68.445313v-95.808594c6.503906-11.746094 9.667969-25.046875 9.144531-38.464844 0-27.902343-10.835937-45.7148435-18.289062-45.7148435-7.449219 0-18.2851565 17.8125005-18.2851565 45.7148435-.5234375 13.417969 2.6406245 26.71875 9.1445315 38.464844v171.820313c.054687.488281.152343.96875.292969 1.4375 0 .292968 0 .601562.109374.914062-7.320312 3.988281-11 12.433594-8.9375 20.507812 2.0625 8.078126 9.34375 13.722657 17.675782 13.714844h54.859375c20.199219 0 36.570312 16.371094 36.570312 36.570313s-16.371093 36.570312-36.570312 36.570312h-36.570313c-10.101562 0-18.289062 8.1875-18.289062 18.285157 0 10.101562 8.1875 18.285156 18.289062 18.285156h128c20.195313 0 36.570313 16.375 36.570313 36.574218 0 20.195313-16.375 36.570313-36.570313 36.570313h-118.859375c-10.097656 0-18.285156 8.1875-18.285156 18.285156 0 10.101563 8.1875 18.285157 18.285156 18.285157h448c10.101563 0 18.285157-8.183594 18.285157-18.285157 0-10.097656-8.183594-18.285156-18.285157-18.285156h-36.570312c-20.199219 0-36.570313-16.375-36.570313-36.570313 0-20.199218 16.371094-36.574218 36.570313-36.574218h36.570312c10.101563 0 18.285157-8.183594 18.285157-18.285156 0-10.097657-8.183594-18.285157-18.285157-18.285157h-18.285156c-20.199219 0-36.570313-16.371093-36.570313-36.570312s16.371094-36.570313 36.570313-36.570313zm-338.285156 0c0-5.050781 4.09375-9.144531 9.140625-9.144531h64c5.050781 0 9.144531 4.09375 9.144531 9.144531 0 5.046875-4.09375 9.140625-9.144531 9.140625h-64c-5.046875 0-9.140625-4.09375-9.140625-9.140625zm27.429687 54.855469c-5.050781 0-9.144531-4.09375-9.144531-9.144531 0-5.046875 4.09375-9.140625 9.144531-9.140625h228.570313c5.050781 0 9.140625 4.09375 9.140625 9.140625 0 5.050781-4.089844 9.144531-9.140625 9.144531zm27.425782 36.570313c0-5.046876 4.09375-9.140626 9.144531-9.140626h54.855469c5.050781 0 9.144531 4.09375 9.144531 9.140626 0 5.050781-4.09375 9.144531-9.144531 9.144531h-54.855469c-5.050781 0-9.144531-4.09375-9.144531-9.144531zm182.859374 36.574218c5.046876 0 9.140626 4.09375 9.140626 9.140625 0 5.050781-4.09375 9.144531-9.140626 9.144531h-118.859374c-5.046876 0-9.140626-4.09375-9.140626-9.144531 0-5.046875 4.09375-9.140625 9.140626-9.140625zm-64 64h-91.429687c-5.050781 0-9.144531-4.09375-9.144531-9.144531s4.09375-9.144531 9.144531-9.144531h91.429687c5.046876 0 9.140626 4.09375 9.140626 9.144531s-4.09375 9.144531-9.140626 9.144531zm91.425782 0h-54.855469c-5.050781 0-9.144531-4.09375-9.144531-9.144531s4.09375-9.144531 9.144531-9.144531h54.855469c5.050781 0 9.144531 4.09375 9.144531 9.144531s-4.09375 9.144531-9.144531 9.144531zm0-91.429687h-109.710938c-5.050781 0-9.144531-4.09375-9.144531-9.144531 0-5.046876 4.09375-9.140626 9.144531-9.140626h109.710938c5.050781 0 9.144531 4.09375 9.144531 9.140626 0 5.050781-4.09375 9.144531-9.144531 9.144531zm0-91.429688h-82.285156c-5.046876 0-9.140626-4.09375-9.140626-9.140625 0-5.050781 4.09375-9.144531 9.140626-9.144531h82.285156c5.050781 0 9.144531 4.09375 9.144531 9.144531 0 5.046875-4.09375 9.140625-9.144531 9.140625zm0 0\"}/>\r\n  ),\r\n  level1: (\r\n    <g className={\"fill\"} transform={\"translate(-1,6),scale(0.33,0.33)\"}>\r\n      <path d={\"m221.30057,128.34535c12.80287,-11.57301 -2.64389,-25.9934 -18.36703,-22.82862l0,25.57096c6.54166,1.048 13.26984,1.86747 18.36703,-2.74234z\"}/>\r\n      <path d={\"m93.457,105.28936l0,25.57096c0.99929,0.01039 1.99722,0.02424 2.99378,0.04617c28.4062,0.00115 25.51589,-30.25349 -2.99378,-25.61713z\"}/>\r\n      <path d={\"m293.79936,235.06243l-11.83898,0l0,-128.90859c0,-24.37754 -9.70018,-46.83105 -25.9992,-64.75208l-16.21053,4.32127l6.92695,16.52446l0.57452,1.36309l-1.0905,0.93835l-16.29357,14.03835c-0.7447,0.64288 -1.96318,0.64981 -2.72286,0.01962c-0.72428,-0.60826 -0.7624,-1.59162 -0.09666,-2.23681l14.16839,-13.73365l-8.82342,-17.69134l-1.16402,-2.33261l3.00195,-1.29038l15.20988,-6.53499c-22.90876,-21.37089 -55.95607,-34.78713 -92.6983,-34.78713c-33.69535,0 -64.27712,11.28562 -86.78289,29.63716l17.7258,7.61877l1.78892,0.76869l0.22327,1.34347l5.65265,33.75875c0.15112,0.89218 -0.58269,1.71743 -1.63508,1.84554c-1.00473,0.12004 -1.93867,-0.44667 -2.15106,-1.27537l-7.9698,-31.65929l-21.21922,-5.65551c-19.20839,18.65855 -30.84997,43.06264 -30.84997,69.77278l0,128.90859l-11.84034,0c-7.51917,0 -13.61428,5.16729 -13.61428,11.54185l0,11.33871c0,6.37225 6.09511,11.54185 13.61428,11.54185l274.11544,0c7.51917,0 13.61428,-5.16959 13.61428,-11.54185l0,-11.33871c-0.00136,-6.37456 -6.09648,-11.543 -13.61565,-11.543zm-101.81034,-133.28526c3.95223,-0.16851 8.04196,-0.34279 12.17934,-0.34279c9.85402,0 21.99796,0.86795 28.49333,7.63147c0.00272,0.00231 0.00545,0.00462 0.00817,0.00693l0.00545,0.00923c0.00272,0.00346 0.00817,0.00693 0.01089,0.01039c0.00545,0.00462 0.01089,0.00923 0.01361,0.015c0.00272,0.00346 0.00545,0.00693 0.01089,0.01154c4.77589,5.01262 6.0461,9.59705 3.77524,13.62631c-3.80519,6.75891 -16.68022,10.40728 -26.8569,10.40728c-2.31851,0 -6.42866,-0.53554 -6.42866,-0.53554s-3.21569,22.27115 1.58198,26.64436c1.07961,0.98106 2.3825,1.68973 3.89641,2.12255l-23.31446,0c7.6662,-2.70079 11.13512,-16.16551 11.13512,-29.52174c0,-13.55013 -3.47164,-27.20991 -11.14601,-29.83799c2.0966,-0.0554 4.32254,-0.15004 6.6356,-0.247zm-42.01232,0.28855l24.65955,0c-2.65615,0.93489 -5.59002,3.41408 -7.84183,9.17692c-2.05576,5.26077 -2.19598,12.3844 -2.19598,20.06319c0,13.1831 2.44921,27.26762 9.9289,30.0769l-24.665,0c2.64526,-0.93374 5.57641,-3.41177 7.8146,-9.17692c2.0435,-5.25616 2.21232,-12.38094 2.21232,-20.05512c0.00272,-13.18772 -2.46419,-27.27454 -9.91256,-30.08498zm-74.04537,-0.03116c2.59216,-0.04617 5.27281,-0.14196 8.06782,-0.24122c4.0557,-0.14312 8.24345,-0.29201 12.36994,-0.29201c8.22711,0 14.43114,0.61749 19.52288,1.9448c7.82821,2.0406 12.16028,6.56385 11.88527,12.4121c-0.33763,7.19634 -7.44021,13.9137 -16.51821,15.62535c-0.42068,0.07848 -0.76648,0.3301 -0.9176,0.67058c-0.15112,0.33933 -0.0953,0.72252 0.15656,1.01799l14.97027,17.63479c4.45187,5.26539 9.00585,9.12383 16.06622,10.57464l-15.28476,0l-24.16808,-28.29946c-0.24778,-0.29201 -0.65212,-0.45706 -1.08234,-0.44667c-1.22801,0.0404 -2.68338,0.08195 -4.16733,0.08195c-1.18853,0 -2.26814,-0.02539 -3.29738,-0.08079c-0.3458,-0.01731 -0.69705,0.08656 -0.95436,0.29085c-0.25595,0.20544 -0.40162,0.49053 -0.40162,0.78946c0,1.49813 -0.16201,3.37945 -0.32674,5.37158c-0.59767,7.04399 -1.34237,15.80656 3.45394,20.174c1.07689,0.9799 2.37705,1.68742 3.8896,2.11908l-23.29132,0c7.69752,-2.70079 11.17869,-16.16667 11.17869,-29.52405c0,-13.5282 -3.473,-27.16489 -11.15146,-29.82298z\"}/>\r\n    </g>\r\n  ),\r\n  level2: (\r\n    <path className={\"fill\"} transform={\"translate(9,7),scale(0.3,0.3)\"} d={\"M245.928,84.493c-13.393-16.435-27.768-24.637-43.139-24.637c-10.873,0-21.072,4.354-30.619,13.117   c-6.626-5.045-13.782-8.627-21.478-10.745c-1.591-20.661-10.733-35.643-27.436-44.942l-17.491,12.351   c11.39,7.412,18.021,17.745,19.876,31c-11.398,1.33-22.001,5.568-31.811,12.713c-9.802-9.005-20.275-13.495-31.403-13.495   c-15.644,0-29.696,8.202-42.15,24.637C6.755,101.449,0,121.479,0,144.535c0,5.828,0.532,11.684,1.583,17.498   c3.978,23.857,15.116,44.676,33.402,62.42c16.434,16.184,31.681,24.263,45.731,24.263c0.332,0,0.674-0.012,1.016-0.035   c16.083-4.937,33.156-7.599,50.857-7.599c14.784,0,29.134,1.858,42.833,5.346l-0.074-0.098l0.323,0.16   c2.618,0.67,5.21,1.404,7.78,2.193c0.348,0.021,0.696,0.033,1.043,0.033c14.053,0,29.154-8.079,45.328-24.263v-0.001   c17.755-17.744,29.156-38.562,34.189-62.42c1.34-6.616,1.99-13.117,1.99-19.48C266.002,120.274,259.306,100.924,245.928,84.493z\"}/>\r\n  ),\r\n  level3: (\r\n    <path className={\"fill\"} transform={\"translate(18,10),scale(0.13,0.13)\"} d={\"M403.886,427.092c31.805-31.675,51.156-72.843,51.156-117.982c0-39.184-14.643-75.351-39.282-104.954  c2.02-6.265,3.149-12.751,3.149-19.456c0-37.186-32.559-68.257-83.059-85.193l28.483-65.848c5.268-12.211-0.35-26.389-12.568-31.673  c-12.2-5.284-26.376,0.345-31.663,12.554l-32.024,74.065c-13.741-1.849-28.121-2.939-43.145-2.939  c-99.2,0-173.995,42.572-173.995,99.034c0,6.705,1.129,13.191,3.15,19.456c-24.64,29.604-39.289,65.771-39.289,104.954  c0,45.14,19.371,86.317,51.175,117.988l-17.909,24.225c-7.902,10.695-5.643,25.775,5.053,33.689  c4.297,3.184,9.314,4.721,14.299,4.721c7.374,0,14.668-3.379,19.39-9.772l17.154-23.22c34.224,20.78,75.895,33.1,120.973,33.1  c45.072,0,86.731-12.32,120.935-33.09l17.155,23.21c4.74,6.393,12.016,9.772,19.401,9.772c4.974,0,9.99-1.537,14.306-4.715  c10.696-7.911,12.968-22.99,5.065-33.695L403.886,427.092z\"}/>\r\n  ),\r\n  level4: (\r\n    <path className={\"fill\"} transform={\"translate(15,0),scale(0.25)\"} d={\"M277.531,179.745c-0.045-10.481-9.676-33.631-92.951-35.979l-31.034-68.857l42.085,17.586 l-63.13-67.928c-8.62-6.047-37.77,80.794-49.648,117.583l0,0c-8.354,1.318-34.706,6.113-55.001,16.797 c-19.8,10.395-30.244,19.572-27.386,32.326c-2.076,14.357,3.17,56.896,135.987,62.381 C179.174,255.423,285.918,226.942,277.531,179.745z M144.93,182.741c-67.228,4.734-72.835-13.954-72.835-13.954l6.106-13.264 c0,0,18.403,12.415,56.083,11.763c37.68-0.659,53.318-17.423,53.318-17.423l9.927,12.077 C195.098,177.688,144.93,182.741,144.93,182.741z\"}/>\r\n  ),\r\n});\r\n\r\nclass CellDefinitions extends PureComponent {\r\n  static cellDefinitionsStyleMap = {\r\n    'original': OriginalCellDefinitions,\r\n    'halloween': HalloweenCellDefinitions,\r\n  };\r\n\r\n\trender() {\r\n  \treturn Object.values(this.constructor.cellDefinitionsStyleMap)\r\n    \t.map(CellDefinitionsStyle =>\r\n        <CellDefinitionsStyle key={CellDefinitionsStyle.displayName || CellDefinitionsStyle.name} />);\r\n  }\r\n}\r\n\r\nclass Cell extends PureComponent {\r\n  static Definitions = CellDefinitions;\r\n\r\n\tstate = {\r\n\t  previousLevel: this.props.level,\r\n\t  currentLevel: this.props.level,\r\n  };\r\n\r\n\tlevelsAnimate = [0, 1, 2, 3, 4].map(i => React.createRef());\r\n\r\n\tstatic getDerivedStateFromProps(props, state) {\r\n    if (props.animated && props.level !== state.level) {\r\n      return {previousLevel: state.currentLevel, currentLevel: props.level};\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (this.props.animated && this.state.currentLevel !== this.state.previousLevel) {\r\n      setTimeout(() => {\r\n        this.levelsAnimate\r\n          .filter((levelAnimate, i) => (\r\n            (this.state.previousLevel <= i && i <= this.state.currentLevel)\r\n            || (this.state.currentLevel <= i && i <= this.state.previousLevel)\r\n          ))\r\n          .filter(levelAnimate => levelAnimate.current)\r\n          .map(levelAnimate => levelAnimate.current.beginElement());\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n\trender() {\r\n  \tconst {\r\n  \t  x, y, available, undoable, level, player, onClick, animated, allowControl,\r\n      theme: {cells = 'original', pieces = 'king', rotateOpponent = true, numbers},\r\n    } = this.props;\r\n  \tconst {previousLevel, currentLevel} = this.state;\r\n  \tconst isPlayerAOpponent = !allowControl.includes(Game.PLAYER_A) && allowControl.includes(Game.PLAYER_B);\r\n  \tconst isPlayerBOpponent = !isPlayerAOpponent;\r\n  \treturn (\r\n    \t<g transform={`translate(${x * 100},${y * 100})`}>\r\n        <g className={'cell-contents'}>\r\n          {animated ? ([0, 1, 2, 3, 4].map(i => (\r\n            <use key={i} xlinkHref={`#cell-${cells}-${i}`} opacity={i <= level ? 1 : 0}>\r\n              <animate\r\n                ref={this.levelsAnimate[i]}\r\n                attributeName={'opacity'}\r\n                attributeType={'XML'}\r\n                type={'translate'}\r\n                from={previousLevel < i ? 0 : 1}\r\n                to={currentLevel < i ? 0 : 1}\r\n                dur={'0.2s'}\r\n                repeatCount={1}\r\n                fill={'freeze'}\r\n              />\r\n            </use>\r\n          ))) : ([0, 1, 2, 3, 4].filter(i => i <= level).map(i => (\r\n            <Fragment key={i}>\r\n              <use xlinkHref={`#cell-${cells}-${i}`} />\r\n              {player === Game.PLAYER_A ? <Piece style={pieces} colour={'white'} rotated={rotateOpponent && isPlayerAOpponent} /> : null}\r\n              {player === Game.PLAYER_B ? <Piece style={pieces} colour={'black'} rotated={rotateOpponent && isPlayerBOpponent} /> : null}\r\n            </Fragment>\r\n          )))}\r\n          {numbers ? <LevelIndicator level={level} type={numbers} /> : null}\r\n        </g>\r\n        <use\r\n          xlinkHref={`#cell-${cells}-border`}\r\n          className={classNames({available, undoable})}\r\n          onClick={onClick}\r\n        />\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nCell.propTypes = {\r\n  x: PropTypes.number.isRequired,\r\n  y: PropTypes.number.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  level: PropTypes.number.isRequired,\r\n  player: PropTypes.string,\r\n  onClick: PropTypes.func,\r\n  animated: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  theme: PropTypes.object.isRequired,\r\n};\r\n\r\nCell.defaultProps = {\r\n  animated: false,\r\n};\r\n\r\nexport default Cell;\r\n","import React, {Fragment, PureComponent} from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport * as constants from \"./constants\";\r\n\r\nclass ArrowDefinition extends PureComponent {\r\n  static arrowDimensions = {x: 215.81, y: 439.04};\r\n  static arrowOffset = {x: -20, y: -15};\r\n  static arrowScaling = 0.75;\r\n  static hammerDimensions = {x: 564.48, y: 501.76};\r\n  static hammerOffset = {x: 50, y: -50};\r\n  static hammerScaling = 0.75 * 0.75;\r\n\r\n  render() {\r\n    const {arrowDimensions, arrowOffset, arrowScaling, hammerDimensions, hammerOffset, hammerScaling} = this.constructor;\r\n\r\n    return (\r\n      <Fragment>\r\n        <path\r\n          id={\"arrow-move-base\"}\r\n          d={\"M168 345.941V44c0-6.627-5.373-12-12-12h-56c-6.627 0-12 5.373-12 12v301.941H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.569 9.373 33.941 0l86.059-86.059c15.119-15.119 4.411-40.971-16.971-40.971H168z\"}\r\n          transform={[\r\n            `translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n            `scale(${(constants.pieceScaling * arrowScaling)},${(constants.pieceScaling * arrowScaling)})`,\r\n            `translate(${-arrowDimensions.x / 2 + arrowOffset.x},${-arrowDimensions.y / 2 + arrowOffset.y})`,\r\n          ].join(',')}\r\n        />\r\n        <path\r\n          id={\"arrow-build-base\"}\r\n          d={\"M571.31 193.94l-22.63-22.63c-6.25-6.25-16.38-6.25-22.63 0l-11.31 11.31-28.9-28.9c5.63-21.31.36-44.9-16.35-61.61l-45.25-45.25c-62.48-62.48-163.79-62.48-226.28 0l90.51 45.25v18.75c0 16.97 6.74 33.25 18.75 45.25l49.14 49.14c16.71 16.71 40.3 21.98 61.61 16.35l28.9 28.9-11.31 11.31c-6.25 6.25-6.25 16.38 0 22.63l22.63 22.63c6.25 6.25 16.38 6.25 22.63 0l90.51-90.51c6.23-6.24 6.23-16.37-.02-22.62zm-286.72-15.2c-3.7-3.7-6.84-7.79-9.85-11.95L19.64 404.96c-25.57 23.88-26.26 64.19-1.53 88.93s65.05 24.05 88.93-1.53l238.13-255.07c-3.96-2.91-7.9-5.87-11.44-9.41l-49.14-49.14z\"}\r\n          transform={[\r\n            `translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n            `scale(${(constants.pieceScaling * hammerScaling)},${(constants.pieceScaling * hammerScaling)})`,\r\n            `rotate(135)`,\r\n            `translate(${-hammerDimensions.x / 2 + hammerOffset.x},${-hammerDimensions.y / 2 + hammerOffset.y})`,\r\n          ].join(',')}\r\n        />\r\n        <g id={\"arrow-move-white\"}>\r\n          <use xlinkHref={\"#arrow-move-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#111\"} />\r\n          <use xlinkHref={\"#arrow-move-base\"} fill={'white'} />\r\n        </g>\r\n        <g id={\"arrow-move-black\"}>\r\n          <use xlinkHref={\"#arrow-move-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#bbb\"} />\r\n          <use xlinkHref={\"#arrow-move-base\"} fill={'black'} />\r\n        </g>\r\n        <g id={\"arrow-build-white\"}>\r\n          <use xlinkHref={\"#arrow-build-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#111\"} />\r\n          <use xlinkHref={\"#arrow-build-base\"} fill={'white'} />\r\n        </g>\r\n        <g id={\"arrow-build-black\"}>\r\n          <use xlinkHref={\"#arrow-build-base\"} strokeWidth={constants.pieceStrokeWidth} stroke={\"#bbb\"} />\r\n          <use xlinkHref={\"#arrow-build-base\"} fill={'black'} />\r\n        </g>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nclass Arrow extends PureComponent {\r\n  static Definition = ArrowDefinition;\r\n  static offsetX = constants.cellSize * 0.10;\r\n  static smallScaling = 0.75;\r\n\r\n  static rotationMap = {\r\n    '0,1': 0,\r\n    '-1,1': 45,\r\n    '-1,0': 90,\r\n    '-1,-1': 135,\r\n    '0,-1': 180,\r\n    '1,-1': -135,\r\n    '1,0': -90,\r\n    '1,1': -45,\r\n  };\r\n\r\n  render() {\r\n    const {offsetX, smallScaling} = this.constructor;\r\n    const {from, to, colour, type, small} = this.props;\r\n    const diff = {x: to.x - from.x, y: to.y - from.y};\r\n    const rotation = this.constructor.rotationMap[`${diff.x},${diff.y}`];\r\n    const offsetYFactor = Math.sqrt(Math.abs(diff.x) + Math.abs(diff.y));\r\n\r\n    return (\r\n      <use\r\n        xlinkHref={`#arrow-${type}-${colour}`}\r\n        transform={[\r\n          `translate(${constants.cellSize * from.x},${constants.cellSize * from.y})`,\r\n          `rotate(${rotation},${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n          `translate(${offsetX},${constants.cellSize / 2 * offsetYFactor})`,\r\n          ...(small ? [\r\n            `translate(${constants.cellSize / 2},${constants.cellSize / 2})`,\r\n            `scale(${smallScaling})`,\r\n            `translate(${-constants.cellSize / 2},${-constants.cellSize / 2})`,\r\n          ] : []),\r\n        ].filter(transform => transform).join(',')}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nArrow.propTypes = {\r\n  from: PropTypes.object.isRequired,\r\n  to: PropTypes.object.isRequired,\r\n  colour: PropTypes.oneOf(['white', 'black']).isRequired,\r\n  type: PropTypes.oneOf(['move', 'build']).isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n};\r\n\r\nArrow.defaultProps = {\r\n  small: false,\r\n};\r\n\r\nexport default Arrow;\r\n","import React, {Fragment, PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport _ from \"lodash\";\r\nimport Game from \"../../../game/game\";\r\nimport * as constants from './constants';\r\nimport Cell from \"./Cell\";\r\nimport Piece from \"./Piece\";\r\nimport '../../../styles/svg-board.css';\r\nimport Arrow from \"./Arrow\";\r\n\r\nclass SvgBoardBackground extends PureComponent {\r\n  render() {\r\n    let {\r\n      className, clickable, undoable, isCellAvailable, isCellUndoable, small, medium, makeMove, onSelect, selected,\r\n      allowControl, settings, rowsAndColumns, transformation, animated, showArrows, game, arrows,\r\n    } = this.props;\r\n    const {theme} = settings;\r\n\r\n    className = classNames(\"board\", \"svg-board\", `board-theme-${theme.scheme || 'default'}`, {\r\n      'small-board': small,\r\n      'medium-board': medium,\r\n      editable: !!makeMove && (clickable || undoable),\r\n      selectable: !!onSelect,\r\n      selected,\r\n    }, className);\r\n    const rowCount = rowsAndColumns.length;\r\n    const columnCount= Math.max(...rowsAndColumns.map(row => row.cells.length)) || 0;\r\n\r\n    return (\r\n      <svg\r\n        className={className}\r\n        viewBox={`0 0 ${constants.cellSize * columnCount} ${constants.cellSize * rowCount}`}\r\n        style={{'--column-count': columnCount, '--row-count': rowCount}}\r\n        preserveAspectRatio={\"xMinYMin meet\"}\r\n        onClick={onSelect}\r\n      >\r\n        <g data-key={'rows'}>\r\n          {rowsAndColumns.map(row => (\r\n            <g data-key={`row-${row.y}`} key={`row-${row.y}`}>\r\n              {row.cells.map(cell => (\r\n                <SvgBoardCell\r\n                  key={`${cell.x}-${cell.y}`}\r\n                  cell={cell}\r\n                  clickable={clickable || (undoable && isCellUndoable(cell))}\r\n                  available={isCellAvailable(cell)}\r\n                  undoable={isCellUndoable(cell)}\r\n                  allowControl={allowControl}\r\n                  settings={settings}\r\n                  makeMove={this.props.makeMove}\r\n                  undo={this.props.undo}\r\n                  theme={theme}\r\n                  animated={animated}\r\n                />\r\n              ))}\r\n            </g>\r\n          ))}\r\n        </g>\r\n        {animated ? (\r\n          <SvgBoardPieces rowsAndColumns={rowsAndColumns} theme={theme} allowControl={allowControl} />\r\n        ) : null}\r\n        {showArrows ? (\r\n          arrows ? (\r\n            arrows.map((arrow, index) => (\r\n              <Arrow key={index} {...arrow} />\r\n            ))\r\n          ) : (\r\n            <Fragment>\r\n              <SvgBoardHistoryArrows game={game} transformation={transformation} />\r\n              {/*<SvgBoardAvailableMovesArrows game={game} isCellAvailable={isCellAvailable} transformation={transformation} />*/}\r\n            </Fragment>\r\n          )\r\n        ) : null}\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardBackground.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  transformation: PropTypes.func,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n  showArrows: PropTypes.bool.isRequired,\r\n  game: PropTypes.instanceOf(Game),\r\n  arrows: PropTypes.array,\r\n};\r\n\r\nSvgBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  animated: false,\r\n  showArrows: false,\r\n};\r\n\r\nclass SvgBoardBackgroundDefinitions extends PureComponent {\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <svg className={classNames('board', 'svg-board')} style={{display: 'none'}}>\r\n          <defs>\r\n            <Cell.Definitions />\r\n            <Piece.Definitions />\r\n            <Arrow.Definition />\r\n          </defs>\r\n        </svg>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\nSvgBoardBackground.Definitions = SvgBoardBackgroundDefinitions;\r\n\r\nclass SvgBoardHistoryArrows extends PureComponent {\r\n  getPlayerMoves() {\r\n    const {transformation} = this.props;\r\n    const {player, relevantHistory} = this.getRelevantHistory();\r\n    const gameWithPieceMove = relevantHistory\r\n      .find(game => Game.MOVE_TYPES_MOVE_WORKER.includes(game.thisMoveType));\r\n    const gameWithBuildMove = relevantHistory\r\n      .find(game => game.thisMoveType === Game.MOVE_TYPE_BUILD_AROUND_WORKER);\r\n\r\n    const {move, build} = {\r\n      move: gameWithPieceMove ? {\r\n        from: gameWithPieceMove.previous.lastMove,\r\n        to: gameWithPieceMove.lastMove,\r\n      } : null,\r\n      build: gameWithBuildMove ? {\r\n        from: gameWithBuildMove.previous.lastMove,\r\n        to: gameWithBuildMove.lastMove,\r\n      }: null,\r\n    };\r\n\r\n    if (transformation) {\r\n      if (move) {\r\n        move.from = transformation.reverseCoordinates(gameWithPieceMove.previous.rowsAndColumns, move.from);\r\n        move.to = transformation.reverseCoordinates(gameWithPieceMove.rowsAndColumns, move.to);\r\n        move.type = 'move';\r\n      }\r\n      if (build) {\r\n        build.from = transformation.reverseCoordinates(gameWithBuildMove.previous.rowsAndColumns, build.from);\r\n        build.to = transformation.reverseCoordinates(gameWithBuildMove.rowsAndColumns, build.to);\r\n        build.type = 'build';\r\n      }\r\n    }\r\n\r\n    return {player, move, build};\r\n  }\r\n\r\n  getRelevantHistory() {\r\n    const {game} = this.props;\r\n\r\n    const relevantHistory = [game];\r\n    const player = game.thisPlayer;\r\n    let iteratingGame = game;\r\n    while (iteratingGame.previous) {\r\n      iteratingGame = iteratingGame.previous;\r\n      if (iteratingGame.thisPlayer !== player) {\r\n        break;\r\n      }\r\n      relevantHistory.push(iteratingGame);\r\n    }\r\n\r\n    return {player, relevantHistory};\r\n  }\r\n\r\n  render() {\r\n    const {game} = this.props;\r\n    if (!game) {\r\n      return null;\r\n    }\r\n\r\n    const {player, move, build} = this.getPlayerMoves();\r\n    if (!move && !build) {\r\n      return null;\r\n    }\r\n    const colour = player === Game.PLAYER_A ? 'white' : 'black';\r\n\r\n    let moveArrow = null, buildArrow = null;\r\n    if (move) {\r\n      moveArrow = <Arrow key={'move'} from={move.from} to={move.to} colour={colour} type={'move'} />;\r\n    }\r\n    if (build) {\r\n      buildArrow = <Arrow key={'build'} from={build.from} to={build.to} colour={colour} type={'build'} />;\r\n    }\r\n\r\n    return [moveArrow, buildArrow];\r\n  }\r\n}\r\n\r\nSvgBoardHistoryArrows.propTypes = {\r\n  game: PropTypes.instanceOf(Game),\r\n  transformation: PropTypes.func,\r\n};\r\n\r\nclass SvgBoardAvailableMovesArrows extends PureComponent {\r\n  render() {\r\n    const {game, transformation, isCellAvailable} = this.props;\r\n    if (!game) {\r\n      return null;\r\n    }\r\n    if (!Game.MOVE_TYPES_MOVE_OR_BUILD.includes(game.moveType)) {\r\n      return null;\r\n    }\r\n\r\n    let from = game.lastMove;\r\n    let availableCells = game.findCells(isCellAvailable);\r\n    if (transformation) {\r\n      from = transformation.reverseCoordinates(game.rowsAndColumns, from);\r\n      availableCells = availableCells.map(cell => transformation.reverseCoordinates(game.rowsAndColumns, cell));\r\n    }\r\n    const colour = game.nextPlayer === Game.PLAYER_A ? 'white' : 'black';\r\n    const type = game.moveType === Game.MOVE_TYPE_BUILD_AROUND_WORKER ? 'build' : 'move';\r\n\r\n    return availableCells.map((cell, index) => (\r\n      <Arrow key={index} from={from} to={cell} colour={colour} type={type} small />\r\n    ));\r\n  }\r\n}\r\n\r\nSvgBoardAvailableMovesArrows.propTypes = {\r\n  game: PropTypes.instanceOf(Game),\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  transformation: PropTypes.func,\r\n};\r\n\r\nclass SvgBoardPieces extends PureComponent {\r\n  render() {\r\n    const {rowsAndColumns, theme, allowControl} = this.props;\r\n\r\n    const pieces = _.sortBy(Game.findCells(rowsAndColumns, cell => cell.player), ['player', 'worker']);\r\n\r\n    return (\r\n      <g data-key={'pieces'} style={{pointerEvents: 'none'}}>\r\n        {pieces.map(cell => (\r\n          <SvgBoardPiece\r\n            key={`${cell.player}-${cell.worker}`}\r\n            cell={cell}\r\n            theme={theme}\r\n            allowControl={allowControl}\r\n          />\r\n        ))}\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardPieces.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  theme: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nclass SvgBoardPiece extends PureComponent {\r\n  state = {\r\n    previousPosition: {x: this.props.cell.x, y: this.props.cell.y},\r\n    position: {x: this.props.cell.x, y: this.props.cell.y},\r\n  };\r\n\r\n  animateTransform = React.createRef();\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.cell.x !== state.position.x || props.cell.y !== state.position.y) {\r\n      return {previousPosition: state.position, position: {x: props.cell.x, y: props.cell.y}};\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (this.state.position !== prevState.position) {\r\n      setTimeout(() => {\r\n        if (this.animateTransform.current) {\r\n          this.animateTransform.current.beginElement();\r\n        }\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {cell, theme, allowControl} = this.props;\r\n    const {previousPosition, position} = this.state;\r\n  \tconst isPlayerAOpponent = !allowControl.includes(Game.PLAYER_A) && allowControl.includes(Game.PLAYER_B);\r\n  \tconst isPlayerBOpponent = !isPlayerAOpponent;\r\n    return (\r\n      <g transform={`translate(${position.x * 100},${position.y * 100})`}>\r\n        <Piece\r\n          style={theme.pieces || 'king'}\r\n          colour={cell.player === Game.PLAYER_A ? 'white' : 'black'}\r\n          rotated={theme.rotateOpponent && (cell.player === Game.PLAYER_A ? isPlayerAOpponent : isPlayerBOpponent)}\r\n        />\r\n        <animateTransform\r\n          ref={this.animateTransform}\r\n          attributeName={'transform'}\r\n          attributeType={'XML'}\r\n          type={'translate'}\r\n          from={`${previousPosition.x * 100} ${previousPosition.y * 100}`}\r\n          to={`${position.x * 100} ${position.y * 100}`}\r\n          dur={'0.1s'}\r\n          repeatCount={1}\r\n          fill={'freeze'}\r\n        />\r\n      </g>\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardPiece.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  theme: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nclass SvgBoardCell extends PureComponent {\r\n  makeMove = () => {\r\n    if (this.props.available && this.props.makeMove) {\r\n      this.props.makeMove(this.props.cell);\r\n    } else if (this.props.undoable && this.props.undo) {\r\n      this.props.undo();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {cell, clickable, available, undoable, settings: {theme}, makeMove, undo, animated, allowControl} = this.props;\r\n    return (\r\n      <Cell\r\n        x={cell.x}\r\n        y={cell.y}\r\n        available={available}\r\n        undoable={undoable}\r\n        level={cell.level}\r\n        player={cell.player}\r\n        allowControl={allowControl}\r\n        animated={animated}\r\n        theme={theme}\r\n        onClick={((makeMove && available) || (undo && undoable)) && clickable ? this.makeMove : null}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nSvgBoardCell.propTypes = {\r\n  cell: PropTypes.object.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  available: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  animated: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n};\r\n\r\nSvgBoardCell.defaultProps = {\r\n  clickable: false,\r\n  available: false,\r\n  undoable: false,\r\n  animated: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n};\r\n\r\nexport default SvgBoardBackground;\r\n","import SvgBoardBackground from \"./SvgBoardBackground\";\r\n\r\nexport default SvgBoardBackground;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../../game/game\";\r\nimport HtmlBoardBackground from \"./HtmlBoardBackground\";\r\nimport SvgBoardBackground from \"./SvgBoardBackground\";\r\nimport \"../../styles/board.css\";\r\nimport \"../../styles/board-theme.css\";\r\n\r\nclass BoardBackground extends Component {\r\n  render() {\r\n    let {renderer = 'svg', ...props} = this.props;\r\n\r\n    const renderers = {\r\n      'html': HtmlBoardBackground,\r\n      'svg': SvgBoardBackground,\r\n    };\r\n    const Renderer = renderers[renderer];\r\n    return <Renderer {...props} />;\r\n  }\r\n}\r\n\r\nBoardBackground.propTypes = {\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  transformation: PropTypes.func,\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  makeMove: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  clickable: PropTypes.bool.isRequired,\r\n  undoable: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  isCellAvailable: PropTypes.func.isRequired,\r\n  isCellUndoable: PropTypes.func.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n  showArrows: PropTypes.bool.isRequired,\r\n  game: PropTypes.instanceOf(Game),\r\n  arrows: PropTypes.array,\r\n};\r\n\r\nBoardBackground.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  clickable: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  animated: false,\r\n  showArrows: false,\r\n};\r\n\r\nexport default BoardBackground;\r\n","import React, {PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport _  from 'lodash';\r\nimport Game from \"../../game/game\";\r\nimport BoardBackground from \"./BoardBackground\";\r\nimport {Menu} from \"semantic-ui-react\";\r\n\r\nclass Board extends PureComponent {\r\n  makeMove = (cell) => {\r\n    const {game: {rowsAndColumns}, transformation} = this.props;\r\n    if (transformation) {\r\n      cell = transformation.coordinates(rowsAndColumns, cell);\r\n    }\r\n    this.props.makeMove(this.props.game.makeMove({x: cell.x, y: cell.y}));\r\n  };\r\n\r\n  undo = () => {\r\n    this.props.makeMove(this.props.game.canUndo ? this.props.game.undo() : this.props.game.takeMoveBack());\r\n  };\r\n\r\n  onSelect = () => {\r\n    this.props.onSelect(this.props.game);\r\n  };\r\n\r\n  isCellAvailable = cell => {\r\n    const {game: {rowsAndColumns}, transformation} = this.props;\r\n    if (transformation) {\r\n      cell = transformation.coordinates(rowsAndColumns, cell);\r\n    }\r\n    return this.props.game.isMoveAvailable(cell);\r\n  };\r\n\r\n  isCellUndoable = cell => {\r\n    const {game: {rowsAndColumns}, transformation} = this.props;\r\n    if (transformation) {\r\n      cell = transformation.coordinates(rowsAndColumns, cell);\r\n    }\r\n    if (this.props.minChainCount === undefined || this.props.minChainCount === null) {\r\n      if (!this.props.game.canUndo) {\r\n        return false;\r\n      }\r\n    } else {\r\n      if (this.props.game.chainCount <= this.props.minChainCount) {\r\n        return false;\r\n      }\r\n    }\r\n    const lastMove = this.props.game.lastMove;\r\n    if (!lastMove) {\r\n      return false;\r\n    }\r\n    return lastMove.x === cell.x && lastMove.y === cell.y;\r\n  };\r\n\r\n  isGameUndoable() {\r\n    return !!this.props.game.findCell(this.isCellUndoable);\r\n  }\r\n\r\n  render() {\r\n    const {game, transformation, allowControl, onSelect, makeMove, animated} = this.props;\r\n    let rowsAndColumns = game.rowsAndColumns;\r\n    if (transformation) {\r\n      rowsAndColumns = transformation(rowsAndColumns);\r\n    }\r\n\r\n    return (\r\n      <BoardBackground\r\n        {...this.props}\r\n        isCellAvailable={animated ? this.isCellAvailable : () => false}\r\n        isCellUndoable={animated ? this.isCellUndoable : () => false}\r\n        clickable={allowControl.includes(game.nextPlayer)}\r\n        undoable={animated ? this.isGameUndoable() : false}\r\n        onSelect={onSelect ? this.onSelect : null}\r\n        makeMove={makeMove ? this.makeMove : null}\r\n        undo={makeMove ? this.undo : null}\r\n        rowsAndColumns={rowsAndColumns}\r\n        transformation={transformation}\r\n        game={game}\r\n        animated={animated}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nBoard.propTypes = {\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  transformation: PropTypes.func,\r\n  makeMove: PropTypes.func,\r\n  minChainCount: PropTypes.number,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  onSelect: PropTypes.func,\r\n  selected: PropTypes.bool.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n  animated: PropTypes.bool.isRequired,\r\n};\r\n\r\nBoard.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n  selected: false,\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n  animated: false,\r\n};\r\n\r\nclass BoardTransformation extends PureComponent {\r\n  state = {\r\n    rotations: 0,\r\n    flippedHorizontally: false,\r\n  };\r\n\r\n  // noinspection JSSuspiciousNameCombination\r\n  static transformationMap = {\r\n    '0,false': null,\r\n    // makeTransformRowsAndColumns({transpose:  false, flipX: false, flipY: false}),\r\n    '1,false': this.makeTransformRowsAndColumns({transpose: true, flipX: false, flipY: true}),\r\n    '2,false': this.makeTransformRowsAndColumns({transpose: false, flipX: true, flipY: true}),\r\n    '3,false': this.makeTransformRowsAndColumns({transpose: true, flipX: true, flipY: false}),\r\n    '0,true': this.makeTransformRowsAndColumns({transpose: false, flipX: true, flipY: false}),\r\n    '1,true': this.makeTransformRowsAndColumns({transpose: true, flipX: true, flipY: true}),\r\n    '2,true': this.makeTransformRowsAndColumns({transpose: false, flipX: false, flipY: true}),\r\n    '3,true': this.makeTransformRowsAndColumns({transpose: true, flipX: false, flipY: false}),\r\n  };\r\n\r\n  static makeTransformRowsAndColumns(config) {\r\n    const transformRowsAndColumns = rowsAndColumns => {\r\n      return this.transformRowsAndColumns(rowsAndColumns, config);\r\n    };\r\n    transformRowsAndColumns.coordinates = (rowsAndColumns, coordinates) => {\r\n      return this.reverseTransformCoordinates(rowsAndColumns, coordinates, config);\r\n    };\r\n    // We can tell if the board is flipped (horizontally or vertically)\r\n    const flipped = config.transpose ^ config.flipX ^ config.flipY;\r\n    const reverseConfig = config.transpose && !flipped ? {\r\n      transpose: config.transpose,\r\n      flipX: !config.flipX,\r\n      flipY: !config.flipY,\r\n    } : config;\r\n    transformRowsAndColumns.reverseCoordinates = (rowsAndColumns, coordinates) => {\r\n      return this.reverseTransformCoordinates(rowsAndColumns, coordinates, reverseConfig);\r\n    };\r\n\r\n    return transformRowsAndColumns;\r\n  }\r\n\r\n  static transformRowsAndColumns(rowsAndColumns, config) {\r\n    let {newRowCount, newColumnCount} = this.getNewRowAndColumnCount(rowsAndColumns, config);\r\n    const newXs = _.range(newColumnCount);\r\n    const newYs = _.range(newRowCount);\r\n\r\n    return newYs.map(newY => ({\r\n      y: newY,\r\n      cells: newXs.map(newX => {\r\n        let {oldX, oldY} = this.getOldCoordinates( {newX, newY}, {newRowCount, newColumnCount}, config);\r\n        return {\r\n        ...rowsAndColumns[oldY].cells[oldX],\r\n          x: newX, y: newY,\r\n        };\r\n      }),\r\n    }));\r\n  }\r\n\r\n  static reverseTransformCoordinates(rowsAndColumns, coordinates, config) {\r\n    let {newRowCount, newColumnCount} = this.getNewRowAndColumnCount(rowsAndColumns, config);\r\n    const {x: newX, y: newY} = coordinates;\r\n    const {oldX, oldY} = this.getOldCoordinates( {newX, newY}, {newRowCount, newColumnCount}, config);\r\n\r\n    return {x: oldX, y: oldY};\r\n  }\r\n\r\n  static getNewRowAndColumnCount(rowsAndColumns, config) {\r\n    const rowCount = rowsAndColumns.length;\r\n    const columnCount = Math.max(...rowsAndColumns.map(row => row.cells.length)) || 0;\r\n    const {transpose} = config;\r\n    let newRowCount, newColumnCount;\r\n    if (transpose) {\r\n      [newColumnCount, newRowCount] = [rowCount, columnCount];\r\n    } else {\r\n      [newColumnCount, newRowCount] = [columnCount, rowCount];\r\n    }\r\n    return {newRowCount, newColumnCount};\r\n  }\r\n\r\n  static getOldCoordinates({newX, newY}, {newColumnCount, newRowCount}, config) {\r\n    const {transpose, flipX, flipY} = config;\r\n    let oldX, oldY;\r\n    if (transpose) {\r\n      [oldX, oldY] = [newY, newX];\r\n    } else {\r\n      [oldX, oldY] = [newX, newY];\r\n    }\r\n    if (flipX) {\r\n      oldX = newColumnCount - 1 - oldX;\r\n    }\r\n    if (flipY) {\r\n      oldY = newRowCount - 1 - oldY;\r\n    }\r\n    return {oldX, oldY};\r\n  }\r\n\r\n   updateOrientation = method => {\r\n     this.setState(method, () => {\r\n       if (this.props.onChange) {\r\n         const {rotations, flippedHorizontally} = this.state;\r\n         const transformation = this.constructor.transformationMap[`${rotations},${flippedHorizontally}`];\r\n         this.props.onChange({rotations, flippedHorizontally, transformation});\r\n       }\r\n     });\r\n   };\r\n\r\n  rotateCounterClockwise = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: (state.rotations + 3) % 4,\r\n    }));\r\n  };\r\n\r\n  rotateClockwise = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: (state.rotations + 1) % 4,\r\n    }));\r\n  };\r\n\r\n  flipHorizontally = () => {\r\n    this.updateOrientation(state => ({\r\n      flippedHorizontally: !state.flippedHorizontally,\r\n    }));\r\n  };\r\n\r\n  flipVertically = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: (state.rotations + 2) % 4,\r\n      flippedHorizontally: !state.flippedHorizontally,\r\n    }));\r\n  };\r\n\r\n  reset = () => {\r\n    this.updateOrientation(state => ({\r\n      rotations: 0,\r\n      flippedHorizontally: false,\r\n    }));\r\n  };\r\n\r\n  render() {\r\n    const {rotations, flippedHorizontally} = this.state;\r\n\r\n    return (\r\n      <Menu size={'massive'} items={[\r\n        {key: 'rotate-counter-clockwise', icon: 'undo', onClick: this.rotateCounterClockwise},\r\n        {key: 'rotate-clockwise', icon: 'redo', onClick: this.rotateClockwise},\r\n        {key: 'flip-horizontal', icon: 'arrows alternate horizontal', onClick: this.flipHorizontally},\r\n        {key: 'flip-vertical', icon: 'arrows alternate vertical', onClick: this.flipVertically},\r\n        {key: 'home', icon: 'home', onClick: this.reset, disabled: !rotations && !flippedHorizontally},\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nBoardTransformation.propTypes = {\r\n  onChange: PropTypes.func,\r\n};\r\n\r\nexport {\r\n  BoardTransformation,\r\n};\r\n\r\nexport default Board;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../../game/game\";\r\nimport BoardBackground from \"./BoardBackground\";\r\n\r\nclass ThemeDemoBoard extends Component {\r\n  static demoRowsAndColumns = [\r\n    {\r\n      y: 0,\r\n      cells: [\r\n        {x: 0, y: 0, player: null, worker: null, level: 0},\r\n        {x: 1, y: 0, player: null, worker: null, level: 1},\r\n        {x: 2, y: 0, player: null, worker: null, level: 2},\r\n        {x: 3, y: 0, player: null, worker: null, level: 3},\r\n        {x: 4, y: 0, player: null, worker: null, level: 4},\r\n        {x: 5, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 0},\r\n        {x: 6, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n      ],\r\n    },\r\n  ];\r\n  static demoRowsAndColumnsAnimated = [\r\n    {\r\n      y: 0,\r\n      cells: [\r\n        {x: 0, y: 0, player: null, worker: null, level: 0},\r\n        {x: 1, y: 0, player: null, worker: null, level: 1},\r\n        {x: 2, y: 0, player: null, worker: null, level: 2},\r\n        {x: 3, y: 0, player: null, worker: null, level: 3},\r\n        {x: 4, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 3},\r\n        {x: 5, y: 0, player: null, worker: null, level: 0},\r\n        {x: 6, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n      ],\r\n    },\r\n  ];\r\n  static arrows = [\r\n    {from: {x: 5, y: 0}, to: {x: 4, y: 0}, colour: 'white', type: 'build'},\r\n    {from: {x: 4, y: 0}, to: {x: 5, y: 0}, colour: 'white', type: 'move'},\r\n  ];\r\n\r\n  state = {\r\n    rowsAndColumns: this.constructor.demoRowsAndColumns,\r\n  };\r\n\r\n  isCellAvailable = () => {\r\n    return false;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  animate = () => {\r\n    this.setState(state => ({\r\n      rowsAndColumns: state.rowsAndColumns === this.constructor.demoRowsAndColumns\r\n        ? this.constructor.demoRowsAndColumnsAnimated\r\n        : this.constructor.demoRowsAndColumns,\r\n    }));\r\n  };\r\n  animationInterval = this.props.settings.theme.animations ? setInterval(this.animate, 2000) : null;\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (this.props.settings.theme.animations !== prevProps.settings.theme.animations) {\r\n      if (this.props.settings.theme.animations) {\r\n        if (!this.animationInterval) {\r\n          this.animationInterval = setInterval(this.animate, 2000);\r\n        }\r\n      } else {\r\n        if (this.animationInterval) {\r\n          clearInterval(this.animationInterval);\r\n          this.animationInterval = null;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.animationInterval) {\r\n      clearInterval(this.animationInterval);\r\n      this.animationInterval = null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {small, medium, settings} = this.props;\r\n    const {rowsAndColumns} = this.state;\r\n\r\n    return (\r\n      <BoardBackground\r\n        small={small}\r\n        medium={medium}\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={rowsAndColumns}\r\n        undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        arrows={settings.theme.arrows ? this.constructor.arrows : undefined}\r\n        settings={settings}\r\n        animated={settings.theme.animations}\r\n        showArrows={settings.theme.arrows}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nThemeDemoBoard.propTypes = {\r\n  className: PropTypes.oneOfType([PropTypes.string, PropTypes.object, PropTypes.array]).isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n  settings: PropTypes.object.isRequired,\r\n};\r\n\r\nThemeDemoBoard.defaultProps = {\r\n  className: '',\r\n  small: false,\r\n  medium: false,\r\n};\r\n\r\nexport default ThemeDemoBoard;\r\n","import Board from './Board';\r\nimport ThemeDemoBoard from './ThemeDemoBoard';\r\n\r\nexport {\r\n  ThemeDemoBoard,\r\n};\r\n\r\nexport default Board;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../../game/game\";\r\nimport BoardBackground from \"./BoardBackground\";\r\n\r\nclass PlayerColourBoard extends Component {\r\n  static colours = {\r\n    [Game.PLAYER_A]: [\r\n      {\r\n        y: 0,\r\n        cells: [\r\n          {x: 0, y: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST, level: 0},\r\n        ],\r\n      },\r\n    ],\r\n    [Game.PLAYER_B]: [\r\n      {\r\n        y: 0,\r\n        cells: [\r\n          {x: 0, y: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST, level: 0},\r\n        ],\r\n      },\r\n    ],\r\n  };\r\n\r\n  isCellAvailable = () => {\r\n    return false;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  render() {\r\n    const {small, medium, player, applicableSettings, allowControl} = this.props;\r\n\r\n    return (\r\n      <BoardBackground\r\n        small={small}\r\n        medium={medium}\r\n        rowsAndColumns={this.constructor.colours[player]}\r\n        undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        settings={applicableSettings}\r\n        allowControl={allowControl}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nPlayerColourBoard.propTypes = {\r\n  applicableSettings: PropTypes.object.isRequired,\r\n  player: PropTypes.oneOf(Game.PLAYERS).isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  small: PropTypes.bool.isRequired,\r\n  medium: PropTypes.bool.isRequired,\r\n};\r\n\r\nPlayerColourBoard.defaultProps = {\r\n  small: false,\r\n  medium: false,\r\n};\r\n\r\nexport default PlayerColourBoard;\r\n","import React, {Component} from 'react';\r\nimport {client} from \"./client\";\r\n\r\nclass ClientWatcher extends Component {\r\n  static SubComponent = null;\r\n\r\n  static forComponent(Component) {\r\n    class ClientWatcherForComponent extends this {\r\n      static SubComponent = Component;\r\n    }\r\n\r\n    return ClientWatcherForComponent;\r\n  }\r\n\r\n  state = {\r\n    connected: client.connected,\r\n    available: client.available,\r\n    disconnected: client.disconnected,\r\n    user: client.user,\r\n    username: client.user ? client.user.name : null,\r\n    usersInfo: client.usersInfo,\r\n    gamesInfo: client.gamesInfo,\r\n    tournamentsInfo: client.tournamentsInfo,\r\n    challengesInfo: client.challengesInfo,\r\n  };\r\n\r\n  componentDidMount() {\r\n    client.subscribe({\r\n      onConnect: this.connectionChanged,\r\n      onDisconnect: this.connectionChanged,\r\n      onUser: this.gotUser,\r\n      onUsers: this.gotUsers,\r\n      onGames: this.gotGames,\r\n      onTournaments: this.gotTournaments,\r\n      onChallenges: this.gotChallenges,\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    client.unsubscribe({\r\n      onUser: this.gotUser,\r\n      onUsers: this.gotUsers,\r\n      onGames: this.gotGames,\r\n      onTournaments: this.gotTournaments,\r\n      onChallenges: this.gotChallenges,\r\n    });\r\n  }\r\n\r\n  connectionChanged = connected => {\r\n    this.setState({connected, disconnected: client.disconnected, available: client.available});\r\n  };\r\n\r\n  gotUser = user => {\r\n    this.setState({user});\r\n  };\r\n\r\n  gotUsers = usersInfo => {\r\n    this.setState({usersInfo});\r\n  };\r\n\r\n  gotGames = gamesInfo => {\r\n    this.setState({gamesInfo});\r\n  };\r\n\r\n  gotTournaments = tournamentsInfo => {\r\n    this.setState({tournamentsInfo});\r\n  };\r\n\r\n  gotChallenges = challengesInfo => {\r\n    this.setState({challengesInfo});\r\n  };\r\n\r\n  render() {\r\n    const {connected, disconnected, available, user, usersInfo, gamesInfo, tournamentsInfo, challengesInfo} = this.state;\r\n    const SubComponent = this.constructor.SubComponent;\r\n    return (\r\n      <SubComponent\r\n        {...this.props}\r\n        connected={connected}\r\n        disconnected={disconnected}\r\n        available={available}\r\n        client={client}\r\n        user={user}\r\n        usersInfo={usersInfo}\r\n        gamesInfo={gamesInfo}\r\n        tournamentsInfo={tournamentsInfo}\r\n        challengesInfo={challengesInfo}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport const withClient = Component => {\r\n  return ClientWatcher.forComponent(Component);\r\n};\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport jdenticon from \"jdenticon\";\r\nimport classNames from \"classnames\";\r\n\r\nclass HashedIcon extends Component {\r\n  ref = React.createRef();\r\n\r\n  componentDidMount() {\r\n    this.updateIcon();\r\n  }\r\n\r\n  updateIcon() {\r\n    if (this.ref.current) {\r\n      jdenticon.update(this.ref.current);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.hash !== this.props) {\r\n      this.updateIcon();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {hash, floated, size, textSized} = this.props;\r\n    return (\r\n      <svg\r\n        ref={this.ref}\r\n        className={classNames([\"ui\", \"mini\", \"right\", \"floated\", \"image\"], {floated: !!floated, [floated]: !!floated, [size]: !!size, 'text-sized': textSized})}\r\n        data-jdenticon-value={hash}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nHashedIcon.propTypes = {\r\n  hash: PropTypes.string.isRequired,\r\n  floated: PropTypes.oneOf(['left', 'right']),\r\n  size: PropTypes.oneOf(['mini', 'tiny', 'small', 'medium', 'large', 'big', 'huge', 'massive']),\r\n  textSized: PropTypes.bool.isRequired,\r\n};\r\n\r\nHashedIcon.defaultProps = {\r\n  textSized: false,\r\n};\r\n\r\nexport default HashedIcon;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Icon, Label, Card, Grid, Pagination} from \"semantic-ui-react\";\r\nimport moment from 'moment';\r\n\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport classNames from \"classnames\";\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nexport class GameCard extends Component {\r\n  selectLiveGame = () => {\r\n    this.props.selectLiveGame(this.props.game);\r\n  };\r\n\r\n  render() {\r\n    const {user, applicableSettings, usersById, tournamentsById, game, terse, live, currentGameId} = this.props;\r\n\r\n    const tournament = tournamentsById[game.tournamentId];\r\n\r\n    const gameGame = Game.deserialize(game.game);\r\n    const playerA = usersById[game.userIds[0]];\r\n    const playerB = usersById[game.userIds[1]];\r\n    const nextPlayerUser = gameGame.nextPlayer === Game.PLAYER_A ? playerA : playerB;\r\n    const playerAToPlay = nextPlayerUser === playerA;\r\n    const playerBToPlay = nextPlayerUser === playerB;\r\n    const isUserPlayerA = user ? playerA.id === user.id : false;\r\n    const isUserPlayerB = user ? playerB.id === user.id : false;\r\n    const winnerUser = game.finished ? (game.winner === Game.PLAYER_A ? playerA : playerB) : null;\r\n    const isMyGame = isUserPlayerA || isUserPlayerB;\r\n    const isMyTurn = (isUserPlayerA && playerAToPlay) || (isUserPlayerB && playerBToPlay);\r\n    const showPlayerA = !terse || !isMyGame || isUserPlayerB;\r\n    const showPlayerB = !terse || !isMyGame || isUserPlayerA;\r\n\r\n    return (\r\n      <Card\r\n        as={NavLink}\r\n        to={`/game/${game.id}`}\r\n        onClick={this.selectLiveGame}\r\n        style={{\r\n          ...(!terse ? {} : {width: 'auto'}),\r\n          ...(game.id === currentGameId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n        className={classNames({attention: live && isMyTurn})}\r\n      >\r\n        <Card.Content>\r\n          {!terse ? (\r\n            <Board\r\n              className={'ui image floated right mini'}\r\n              game={gameGame}\r\n              small\r\n              settings={applicableSettings}\r\n            />\r\n          ) : null}\r\n          <Card.Header>\r\n            {!(showPlayerA && showPlayerB) ? \" vs \" : null}\r\n            {showPlayerA ? (\r\n              <Label color={winnerUser === playerA || isMyTurn ? 'green' : undefined} >\r\n                {winnerUser === playerA ? <Icon name={'trophy'}/> : null}\r\n                {playerAToPlay ? <Icon name={'caret right'}/> : null}\r\n                {playerA.name}\r\n                <HashedIcon floated={'right'} size={'mini'} textSized hash={playerA.id} />\r\n              </Label>\r\n            ) : null}\r\n            {showPlayerA && showPlayerB ? \" vs \" : null}\r\n            {showPlayerB ? (\r\n              <Label color={winnerUser === playerB || isMyTurn ? 'green' : undefined} >\r\n                {winnerUser === playerB ? <Icon name={'trophy'}/> : null}\r\n                {playerBToPlay ? <Icon name={'caret right'} color={\"green\"}/> : null}\r\n                {playerB.name}\r\n                <HashedIcon floated={'right'} size={'mini'} textSized hash={playerB.id} />\r\n              </Label>\r\n            ) : null}\r\n          </Card.Header>\r\n          {!terse ? (\r\n            <Card.Meta>\r\n              {isMyGame ? <Label icon={{name: 'user', color: 'green'}} content={'My game'} /> : null}\r\n              {\" \"}\r\n              {!game.finished ? <Label icon={{name: 'circle', color: 'green'}} content={'Live'} /> : null}\r\n              {\" \"}\r\n              <Label content={`Move ${game.move}`} icon={'play'} />\r\n              {\" \"}\r\n              <Label content={moment(game.endDatetime || game.startDatetime).from()} icon={'calendar'} />\r\n              {\" \"}\r\n              {tournament ? <Label content={tournament.name} icon={'sitemap'} /> : null}\r\n            </Card.Meta>\r\n          ) : (\r\n            tournament ? <Label icon={'sitemap'} /> : null\r\n          )}\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nGameCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournamentsById: PropTypes.object.isRequired,\r\n  game: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  live: PropTypes.bool.isRequired,\r\n  currentGameId: PropTypes.string,\r\n  applicableSettings: PropTypes.object.isRequired,\r\n};\r\n\r\nGameCard.defaultProps = {\r\n  terse: false,\r\n  live: false,\r\n};\r\n\r\nclass GameList extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {applicableSettings, user, usersById, tournamentsById, games, terse, live, selectLiveGame, currentGameId, pageSize, reverse} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    let {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil(games.length / pageSize);\r\n    if (activePage > totalPages) {\r\n      activePage = totalPages;\r\n    }\r\n    let visibleGames = games\r\n      .slice((totalPages - activePage) * pageSize, (totalPages - activePage) * pageSize + pageSize);\r\n    if (reverse) {\r\n      visibleGames = visibleGames.reverse();\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group style={{maxHeight: '300px', overflowY: 'auto', flexWrap: !terse ? undefined : 'unset'}}>\r\n          {visibleGames.map(game => (\r\n            <GameCard\r\n              key={game.id}\r\n              user={user}\r\n              usersById={usersById}\r\n              tournamentsById={tournamentsById}\r\n              game={game}\r\n              selectLiveGame={selectLiveGame}\r\n              terse={terse}\r\n              live={live}\r\n              currentGameId={currentGameId}\r\n              applicableSettings={applicableSettings}\r\n            />\r\n          ))}\r\n        </Card.Group>\r\n        {totalPages > 1 ? (\r\n          <Grid centered>\r\n            <Grid.Row>\r\n              <Pagination\r\n                totalPages={totalPages}\r\n                activePage={activePage}\r\n                onPageChange={this.onPageChange}\r\n                pointing\r\n                secondary\r\n              />\r\n            </Grid.Row>\r\n          </Grid>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nGameList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournamentsById: PropTypes.object.isRequired,\r\n  games: PropTypes.array.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  live: PropTypes.bool.isRequired,\r\n  currentGameId: PropTypes.string,\r\n  pageSize: PropTypes.number.isRequired,\r\n  reverse: PropTypes.bool.isRequired,\r\n  applicableSettings: PropTypes.object.isRequired,\r\n};\r\n\r\nGameList.defaultProps = {\r\n  terse: false,\r\n  live: false,\r\n  pageSize: 10,\r\n  reverse: true,\r\n};\r\n\r\nexport default GameList;\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Form, Input, Modal, Segment} from \"semantic-ui-react\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport Client from \"../client/client\";\r\n\r\nclass CreateTournament extends Component {\r\n  state = {\r\n    name: '',\r\n    gameCount: '1',\r\n  };\r\n\r\n  createTournament = () => {\r\n    const {client} = this.props;\r\n    const {name, gameCount} = this.state;\r\n    client.createTournament({name, gameCount: parseInt(gameCount, 10)});\r\n  };\r\n\r\n  onClose = () => {\r\n    this.setState({name: '', gameCount: 1});\r\n  };\r\n\r\n  setValue = (e, {name, value}) => {\r\n    this.setState({[name]: value});\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        size={'mini'}\r\n        trigger={<Button color={'yellow'} icon={'sitemap'} content={'Create tournament'} />}\r\n        header={'Create tournament'}\r\n        content={\r\n          <Segment>\r\n            <Form>\r\n              <Form.Field\r\n                name={'name'}\r\n                control={Input}\r\n                label={'Name'}\r\n                placeholder={'Tournament name'}\r\n                onChange={this.setValue}\r\n                required\r\n                defaultValue={this.state.name}\r\n              />\r\n              <Form.Field\r\n                name={'gameCount'}\r\n                control={Input}\r\n                label={`${this.state.gameCount} game(s) between each pair of players`}\r\n                placeholder={'Game count between each pair of players'}\r\n                onChange={this.setValue}\r\n                type={'range'}\r\n                min={1}\r\n                max={5}\r\n                defaultValue={this.state.gameCount}\r\n                required\r\n              />\r\n            </Form>\r\n          </Segment>\r\n        }\r\n        actions={[\r\n          {key: 'cancel', content: 'Cancel'},\r\n          {key: 'create', positive: true, content: 'Create Tournament', onClick: this.createTournament, disabled: !this.state.name},\r\n        ]}\r\n        onClose={this.onClose}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nCreateTournament.propTypes = {\r\n  client: PropTypes.instanceOf(Client),\r\n};\r\n\r\nexport default withClient(CreateTournament);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Label, Card, Grid, Pagination} from \"semantic-ui-react\";\r\nimport moment from 'moment';\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nclass TournamentCard extends Component {\r\n  selectLiveTournament = () => {\r\n    this.props.selectLiveTournament(this.props.tournament);\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, currentTournamentId, tournament, terse} = this.props;\r\n\r\n    const isMyTournament = user ? tournament.userIds.includes(user.id) : false;\r\n    const didUserCreated = user ? tournament.creatorUserId === user.id : false;\r\n    const didUserWin = tournament.finished ? tournament.winnerUserId === user.id : false;\r\n    const creator = usersById[tournament.creatorUserId];\r\n\r\n    const statusLabel = (\r\n      <Label\r\n        content={tournament.started ? (tournament.finished ? 'Finished' : `Round ${tournament.round}/${tournament.rounds}`) : 'Waiting'}\r\n        icon={{\r\n          name: tournament.started ? (tournament.finished ? 'trophy' : 'play') : 'hourglass',\r\n          colour: tournament.started ? 'green' : undefined,\r\n        }}\r\n      />\r\n    );\r\n\r\n    return (\r\n      <Card\r\n        as={NavLink}\r\n        to={`/tournament/${tournament.id}`}\r\n        // onClick={this.selectLiveTournament}\r\n        style={{\r\n          ...(!terse ? {} : {width: 'auto'}),\r\n          ...(tournament.id === currentTournamentId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n      >\r\n        <Card.Content>\r\n          <Card.Header>\r\n            <Label content={tournament.name} /> by\r\n            <Label color={didUserCreated ? 'green' : undefined} content={creator.name} />\r\n            {terse ? statusLabel : null}\r\n          </Card.Header>\r\n          {!terse ? (\r\n            <Card.Meta>\r\n              {isMyTournament ? <Label icon={{name: 'user', color: 'green'}} content={'Participating'} /> : null}\r\n              {\" \"}\r\n              {didUserWin ? <Label icon={{name: 'trophy', color: 'yellow'}} content={'Won'} /> : (\r\n                tournament.finished ? (\r\n                  <Label icon={'trophy'} content={usersById[tournament.winnerUserId] ? usersById[tournament.winnerUserId].name : tournament.winnerUserId} />\r\n                ) : null\r\n              )}\r\n              {\" \"}\r\n              {tournament.started && !tournament.finished ? <Label icon={{name: 'circle', color: 'green'}} content={'Live'} /> : null}\r\n              {\" \"}\r\n              {statusLabel}\r\n              {\" \"}\r\n              <Label content={`${tournament.userIds.length} players`} icon={'users'} />\r\n              {\" \"}\r\n              <Label content={moment(tournament.endDatetime || tournament.startDatetime || tournament.createdDatetime).from()} icon={'calendar'} />\r\n            </Card.Meta>\r\n          ) : null}\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nTournamentCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournament: PropTypes.object.isRequired,\r\n  currentTournamentId: PropTypes.string,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n};\r\n\r\nTournamentCard.defaultProps = {\r\n  terse: false,\r\n};\r\n\r\nclass TournamentList extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {user, usersById, tournaments, terse, selectLiveTournament, currentTournamentId, pageSize} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    let {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil(tournaments.length / pageSize);\r\n    if (activePage > totalPages) {\r\n      activePage = totalPages;\r\n    }\r\n    const visibleTournaments = tournaments\r\n      .slice((totalPages - activePage) * pageSize, (totalPages - activePage) * pageSize + pageSize)\r\n      .reverse();\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group style={{maxHeight: '300px', overflowY: 'auto', flexWrap: !terse ? undefined : 'unset'}}>\r\n          {visibleTournaments.map(tournament => (\r\n            <TournamentCard\r\n              key={tournament.id}\r\n              user={user}\r\n              usersById={usersById}\r\n              tournament={tournament}\r\n              currentTournamentId={currentTournamentId}\r\n              selectLiveTournament={selectLiveTournament}\r\n              terse={terse}\r\n            />\r\n          ))}\r\n        </Card.Group>\r\n        {totalPages > 1 ? (\r\n          <Grid centered>\r\n            <Grid.Row>\r\n              <Pagination\r\n                totalPages={totalPages}\r\n                activePage={activePage}\r\n                onPageChange={this.onPageChange}\r\n                pointing\r\n                secondary\r\n              />\r\n            </Grid.Row>\r\n          </Grid>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nTournamentList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  tournaments: PropTypes.array.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  terse: PropTypes.bool.isRequired,\r\n  currentTournamentId: PropTypes.string,\r\n  pageSize: PropTypes.number.isRequired,\r\n};\r\n\r\nTournamentList.defaultProps = {\r\n  terse: false,\r\n  pageSize: 10,\r\n};\r\n\r\nexport default TournamentList;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Label, Card, Grid, Pagination} from \"semantic-ui-react\";\r\n\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport {NavLink} from \"react-router-dom\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nexport class ChallengeCard extends Component {\r\n  selectChallenge = () => {\r\n    this.props.selectChallenge(this.props.challenge);\r\n  };\r\n\r\n  get userChallenge() {\r\n    const {user, challenge} = this.props;\r\n    if (!user) {\r\n      return null;\r\n    }\r\n    if (!challenge) {\r\n      return null;\r\n    }\r\n    return user.challenges[challenge.id] || null;\r\n  }\r\n\r\n  render() {\r\n    const {user, applicableSettings, usersById, challenge, currentChallengeId} = this.props;\r\n    const userChallenge = this.userChallenge;\r\n\r\n    const creator = usersById[challenge.userId];\r\n    return (\r\n      <Card\r\n        as={NavLink}\r\n        to={`/challenge/${challenge.id}`}\r\n        onClick={this.selectChallenge}\r\n        style={{\r\n          ...(challenge.id === currentChallengeId ? {backgroundColor: 'lightgreen'} : {}),\r\n        }}\r\n      >\r\n        <Card.Content>\r\n          <Card.Header>\r\n            {challenge.options.type === 'mate'\r\n              ? `Find mate in ${challenge.options.typeOptions.mateIn}`\r\n              : 'Unknown challenge'}\r\n          </Card.Header>\r\n          <Card.Meta>\r\n            <Label\r\n              icon={{\r\n                name: {1: 'smile outline', 2: 'meh outline', 3: 'frown outline'}[challenge.meta.difficulty],\r\n                color: {1: 'green', 2: 'orange', 3: 'red'}[challenge.meta.difficulty],\r\n              }}\r\n              content={`${challenge.meta.difficulty}/${challenge.meta.maxDifficulty}`}\r\n              title={{1: 'Easy', 2: 'Medium', 3: 'Hard'}[challenge.meta.difficulty]}\r\n            />\r\n            <Label icon={'user'} content={`By ${creator.name}`} />\r\n            {userChallenge && userChallenge.meta.started && !userChallenge.meta.won ? (\r\n              <Label icon={{name: 'play', color: 'green'}} content={'Started'} />\r\n            ) : null}\r\n            {userChallenge && userChallenge.meta.won ? (\r\n              <Label icon={{name: 'trophy', color: 'green'}} content={'Solved'} />\r\n            ) : null}\r\n            {userChallenge && userChallenge.meta.mistakes ? (\r\n              <Label icon={{name: 'exclamation', color: 'red'}} content={`${userChallenge.meta.mistakes} mistakes`} />\r\n            ) : null}\r\n            {user && challenge.isMyChallenge ? (\r\n              <Label\r\n                icon={(\r\n                  challenge.meta.public && challenge.meta.publishDatetime.isSameOrBefore()\r\n                    ? {name: 'check', color: 'green'} : (\r\n                      challenge.meta.public\r\n                        ? {name: 'pause', color: 'yellow'} : {name: 'x', color: 'red'}\r\n                    ))}\r\n                content={(\r\n                  challenge.meta.public && challenge.meta.publishDatetime.isSameOrBefore()\r\n                    ? challenge.meta.publishDatetime.fromNow() : (\r\n                      challenge.meta.public\r\n                        ? challenge.meta.publishDatetime.toNow() : \"Private\"\r\n                    ))}\r\n              />\r\n            ) : (\r\n              <Label\r\n                icon={'calendar'}\r\n                content={challenge.meta.publishDatetime.fromNow()}\r\n              />\r\n            )}\r\n            <Board\r\n              game={Game.fromCompressedPositionNotation(challenge.startingPosition.position)}\r\n              medium\r\n              settings={applicableSettings}\r\n            />\r\n          </Card.Meta>\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeCard.propTypes = {\r\n  user: PropTypes.object,\r\n  usersById: PropTypes.object.isRequired,\r\n  challenge: PropTypes.object.isRequired,\r\n  selectChallenge: PropTypes.func.isRequired,\r\n  currentChallengeId: PropTypes.string,\r\n  applicableSettings: PropTypes.object.isRequired,\r\n};\r\n\r\nclass ChallengeList extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {client, user, usersInfo: {byId: usersById}, challenges, selectChallenge, currentChallengeId, pageSize} = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    let {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil(challenges.length / pageSize);\r\n    if (activePage > totalPages) {\r\n      activePage = totalPages;\r\n    }\r\n    const visibleChallenges = challenges\r\n      .slice((totalPages - activePage) * pageSize, (totalPages - activePage) * pageSize + pageSize)\r\n      .reverse();\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group style={{maxHeight: '400px', overflowY: 'auto'}}>\r\n          {visibleChallenges.map(challenge => (\r\n            <ChallengeCard\r\n              key={challenge.id}\r\n              user={user}\r\n              usersById={usersById}\r\n              challenge={challenge}\r\n              selectChallenge={selectChallenge}\r\n              currentChallengeId={currentChallengeId}\r\n              applicableSettings={client.applicableSettings}\r\n            />\r\n          ))}\r\n        </Card.Group>\r\n        {totalPages > 1 ? (\r\n          <Grid centered>\r\n            <Grid.Row>\r\n              <Pagination\r\n                totalPages={totalPages}\r\n                activePage={activePage}\r\n                onPageChange={this.onPageChange}\r\n                pointing\r\n                secondary\r\n              />\r\n            </Grid.Row>\r\n          </Grid>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeList.propTypes = {\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  challenges: PropTypes.array.isRequired,\r\n  selectChallenge: PropTypes.func.isRequired,\r\n  currentChallengeId: PropTypes.string,\r\n  pageSize: PropTypes.number.isRequired,\r\n};\r\n\r\nChallengeList.defaultProps = {\r\n  pageSize: 10,\r\n};\r\n\r\nexport default withClient(ChallengeList);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport {Tab, Button, Icon, Input, Label, Card, Segment, Modal, Checkbox} from \"semantic-ui-react\";\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport GameList from \"./GameList\";\r\nimport CreateTournament from \"./CreateTournament\";\r\nimport TournamentList from \"./TournamentList\";\r\nimport ChallengeList, {ChallengeCard} from \"./ChallengeList\";\r\n\r\nclass UserList extends Component {\r\n  render() {\r\n    const {client, user, users, challengedUser, readyToPlayUsers, readyToPlayMeUsers} = this.props;\r\n    return (\r\n      <Card.Group style={{maxHeight: '300px', overflowY: 'auto'}}>\r\n        {users.map(otherUser => (\r\n          <UserCard\r\n            key={otherUser.id}\r\n            client={client}\r\n            user={user}\r\n            otherUser={otherUser}\r\n            challengedUser={challengedUser}\r\n            readyToPlayUsers={readyToPlayUsers}\r\n            readyToPlayMeUsers={readyToPlayMeUsers}\r\n          />\r\n        ))}\r\n      </Card.Group>\r\n    );\r\n  }\r\n}\r\n\r\nUserList.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  users: PropTypes.array.isRequired,\r\n  challengedUser: PropTypes.object,\r\n  readyToPlayUsers: PropTypes.array,\r\n  readyToPlayMeUsers: PropTypes.array,\r\n};\r\n\r\nclass ChallengeUserButton extends Component {\r\n  changeReadyToPlay = () => {\r\n    this.props.client.changeReadyToPlay(!this.props.user.readyToPlay);\r\n  };\r\n\r\n  challengeUser = () => {\r\n    this.props.client.changeReadyToPlay(this.props.user.readyToPlay === this.props.otherUser.id ? false : this.props.otherUser.id);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      client, user, otherUser,\r\n      usersInfo: {challengedUser, readyToPlay : readyToPlayUsers, readyToPlayMe : readyToPlayMeUsers},\r\n    } = this.props;\r\n    if (!client || !user || !otherUser.online) {\r\n      return null;\r\n    }\r\n\r\n    let playButtonColour, playButtonAttention, playButtonIcon, playButtonOnClick, playButtonLabel;\r\n    if (user.id === otherUser.id) {\r\n      playButtonOnClick = this.changeReadyToPlay;\r\n      if (user.readyToPlay) {\r\n        playButtonColour = 'green';\r\n        playButtonIcon = {loading: true, name: 'circle notch'};\r\n        if (challengedUser) {\r\n          playButtonLabel = `Waiting for ${challengedUser.name}...`;\r\n        } else {\r\n          playButtonLabel = 'Waiting for opponent...';\r\n        }\r\n      } else {\r\n        playButtonColour = 'yellow';\r\n        playButtonIcon = {name: 'play'};\r\n        if (readyToPlayMeUsers && readyToPlayMeUsers.length) {\r\n          if (readyToPlayMeUsers.length === 1) {\r\n            playButtonLabel = `${readyToPlayMeUsers[0].name} has challenged you`;\r\n            playButtonAttention = true;\r\n          } else {\r\n            playButtonLabel = `${readyToPlayMeUsers.length} users have challenged you`;\r\n            playButtonAttention = true;\r\n          }\r\n        } else if (readyToPlayUsers && readyToPlayUsers.length) {\r\n          if (readyToPlayUsers.length === 1) {\r\n            playButtonLabel = `Play ${readyToPlayUsers[0].name}`;\r\n          } else {\r\n            playButtonLabel = `${readyToPlayUsers.length} users ready to play`;\r\n          }\r\n        } else {\r\n          playButtonLabel = 'Play';\r\n        }\r\n      }\r\n    } else {\r\n      playButtonOnClick = this.challengeUser;\r\n      if (challengedUser && challengedUser.id === otherUser.id) {\r\n        playButtonColour = 'green';\r\n        playButtonIcon = {loading: true, name: 'circle notch'};\r\n        playButtonLabel = `Waiting for ${otherUser.name}...`;\r\n      } else {\r\n        playButtonColour = 'yellow';\r\n        playButtonIcon = {name: 'play'};\r\n        if (otherUser.readyToPlay === user.id) {\r\n          playButtonLabel = `${otherUser.name} has challenged you`;\r\n          playButtonAttention = true;\r\n        } else if (otherUser.readyToPlay === true) {\r\n          playButtonLabel = `${otherUser.name} is ready to Play`;\r\n        } else {\r\n          playButtonLabel = `Challenge ${otherUser.name}`;\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Button\r\n        className={classNames({attention: playButtonAttention})}\r\n        color={playButtonColour}\r\n        onClick={playButtonOnClick}\r\n      >\r\n        <Icon {...playButtonIcon} />\r\n        {playButtonLabel}\r\n      </Button>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeUserButton.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object.isRequired,\r\n  usersInfo: PropTypes.object.isRequired,\r\n};\r\n\r\nChallengeUserButton = withClient(ChallengeUserButton);\r\n\r\nclass UserCard extends Component {\r\n  render() {\r\n    const {client, user, otherUser} = this.props;\r\n\r\n    return (\r\n      <Card>\r\n        <Card.Content>\r\n          <HashedIcon floated={'right'} size={'mini'} hash={otherUser.id} />\r\n          <Card.Header>\r\n            {otherUser.name}\r\n            {\" \"}\r\n            {client && user && user.id === otherUser.id ? (\r\n              <EditUser client={client} user={user} trigger={<Label as={'a'} icon={'edit'} content={'Edit'}/>} />\r\n            ) : null}\r\n          </Card.Header>\r\n          <Card.Meta>\r\n            {user && otherUser.id === user.id ? <Label><Icon name={\"user\"} color={\"green\"} />Me</Label> : null}\r\n            {\" \"}\r\n            {user && otherUser.id === user.id ? <EditUser client={client} user={user} trigger={<Label as={'a'}><Icon name={\"lock\"} color={user.hasPassword ? \"green\" : \"red\"} />{user.hasPassword ? '' : 'No password'}</Label>} /> : null}\r\n            {\" \"}\r\n            {otherUser.readyToPlay ? <Label><Icon loading name={\"circle notch\"} color={\"green\"} />Ready</Label> : null}\r\n            {\" \"}\r\n            {otherUser.online ? <Label><Icon name={\"circle\"} color={\"green\"} />Online</Label> : null}\r\n            {\" \"}\r\n            <Label\r\n              title={`${otherUser.isUserRatingProvisional ? 'Provisional - ' : ''}Won ${otherUser.winCount} out of ${otherUser.gameCount}`}\r\n              color={{1: 'yellow', 2: 'grey', 3: 'brown'}[otherUser.rank]}\r\n            >\r\n              <Icon\r\n                name={otherUser.isUserRatingProvisional ? \"question\" : \"star outline\"}\r\n                color={otherUser.isUserRatingProvisional ? \"orange\" : undefined}\r\n              />\r\n              {\" \"}{otherUser.score}\r\n            </Label>\r\n            {\" \"}\r\n            <Label icon={'trophy'} content={` ${otherUser.winCount}/${otherUser.gameCount}`} />\r\n            {\" \"}\r\n            {otherUser.tournamentWinCount ? (\r\n              <Label\r\n                icon={{name: 'sitemap', color: 'yellow'}}\r\n                content={otherUser.tournamentWinCount}\r\n                title={`Won ${otherUser.tournamentWinCount}/${otherUser.tournamentCount} tournaments entered`}\r\n              />\r\n              ) : null}\r\n          </Card.Meta>\r\n        </Card.Content>\r\n        {client && user && otherUser.online ? <Card.Content extra>\r\n          <div className='ui two buttons'>\r\n            <ChallengeUserButton otherUser={otherUser} />\r\n          </div>\r\n        </Card.Content> : null}\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nUserCard.propTypes = {\r\n  client: PropTypes.object,\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object.isRequired,\r\n  changeReadyToPlay: PropTypes.func,\r\n  challengedUser: PropTypes.object,\r\n  readyToPlayUsers: PropTypes.array,\r\n  readyToPlayMeUsers: PropTypes.array,\r\n};\r\n\r\nclass EditUser extends Component {\r\n  state = {\r\n    user: this.props.user,\r\n    username: this.props.user.name,\r\n    password: '',\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.user !== state.user) {\r\n      return {\r\n        user: props.user,\r\n        username: props.user ? props.user.name : null,\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  changeUsername = ({target: {value}}) => {\r\n    this.setState({username: value});\r\n  };\r\n\r\n  changePassword = ({target: {value}}) => {\r\n    this.setState({password: value});\r\n  };\r\n\r\n  updateUsername = () => {\r\n    this.props.client.changeUsername(this.state.username);\r\n  };\r\n\r\n  updatePassword = () => {\r\n    this.props.client.changePassword(this.state.password);\r\n    this.setState({password: ''});\r\n  };\r\n\r\n  render() {\r\n    const {username, password} = this.state;\r\n    const {user, trigger} = this.props;\r\n\r\n    return (\r\n      <Modal\r\n        trigger={trigger}\r\n        size={'small'}\r\n        header={'Edit user'}\r\n        content={(\r\n          <Segment>\r\n            <Input label={'Name'} value={username} onChange={this.changeUsername} action={{content: 'Change', onClick: this.updateUsername}} />\r\n            <br />\r\n            <Input label={{content: user.hasPassword ? 'Password is set' : 'Set a password', color: user.hasPassword ? 'green' : 'red'}} value={password} onChange={this.changePassword} action={{content: 'Change', color: user.hasPassword ? undefined : 'green', onClick: this.updatePassword}} />\r\n          </Segment>\r\n        )}\r\n        actions={[\r\n          {key: 'cancel', negative: true, content: 'Cancel'},\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditUser.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object.isRequired,\r\n  trigger: PropTypes.node.isRequired,\r\n};\r\n\r\nexport class LogIn extends Component {\r\n  state = {\r\n    username: '',\r\n    password: '',\r\n    mergeUsers: false,\r\n  };\r\n\r\n  changeUsername = ({target: {value}}) => {\r\n    this.setState({username: value});\r\n  };\r\n\r\n  changePassword = ({target: {value}}) => {\r\n    this.setState({password: value});\r\n  };\r\n\r\n  changeMergeUsers = ({target: {checked}}) => {\r\n    this.setState({mergeUsers: checked});\r\n  };\r\n\r\n  logIn = () => {\r\n    this.props.client.logIn(this.state.username, this.state.password, this.mergeUsers);\r\n    this.setState({username: '', password: ''});\r\n  };\r\n\r\n  render() {\r\n    const {username, password, mergeUsers} = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        ref={this.modal}\r\n        trigger={<Label as={'a'} icon={'sign in'} content={'Log In'} float={'left'} />}\r\n        size={'small'}\r\n        header={'Log In'}\r\n        content={(\r\n          <Segment>\r\n            <Input label={'Name'} value={username} onChange={this.changeUsername}/>\r\n            <br />\r\n            <Input label={'Password'} value={password} onChange={this.changePassword} />\r\n            <br />\r\n            <Checkbox\r\n              label={'Merge users'}\r\n              checked={mergeUsers}\r\n              onChange={this.changeMergeUsers}\r\n            />\r\n          </Segment>\r\n        )}\r\n        actions={[\r\n          {key: 'cancel', negative: true, content: 'Cancel'},\r\n          {key: 'logIn', positive: true, content: 'Log In', onClick: this.logIn},\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nLogIn.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nexport class LogOut extends Component {\r\n  logOut = () => {\r\n    this.props.client.logOut();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Label as={'a'} icon={'log out'} content={'Log Out'} onClick={this.logOut} />\r\n    );\r\n  }\r\n}\r\n\r\nLogOut.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nclass Lobby extends Component {\r\n  changeReadyToPlay = () => {\r\n    this.props.client.changeReadyToPlay(!this.props.user.readyToPlay);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      client, user,\r\n      usersInfo: {byId: usersById, users, online, offline, challengedUser, readyToPlay, readyToPlayMe},\r\n      gamesInfo: {myLive, otherLive, myFinished, otherFinished}, selectLiveGame, selectLiveTournament,\r\n      challengesInfo: {otherUnsolved, challenges, otherStarted, otherNotStarted, otherSolved},\r\n      tournamentsInfo,\r\n    } = this.props;\r\n    const {byId: tournamentsById} = tournamentsInfo;\r\n\r\n    if (!user) {\r\n      return <Tab.Pane>Connecting to server...</Tab.Pane>;\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Card.Group centered>\r\n          {user ? (\r\n            <UserCard\r\n              client={client}\r\n              otherUser={user}\r\n              user={user}\r\n              challengedUser={challengedUser}\r\n              readyToPlayUsers={readyToPlay}\r\n              readyToPlayMeUsers={readyToPlayMe}\r\n            />\r\n          ) : null}\r\n          {otherUnsolved.length ? (\r\n            <ChallengeCard\r\n              user={user}\r\n              usersById={usersById}\r\n              challenge={otherUnsolved[0]}\r\n              selectChallenge={this.props.selectLiveChallenge}\r\n              currentChallengeId={null}\r\n              applicableSettings={client.applicableSettings}\r\n            />\r\n          ) : null}\r\n        </Card.Group>\r\n        <Segment>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {key: 'my-live', label: \"My Live games\", items: myLive, color: 'green'},\r\n            {key: 'other-live', label: \"Other Live games\", items: otherLive, color: 'green'},\r\n            {key: 'my-past', label: \"My Past games\", items: myFinished},\r\n            {key: 'other-past', label: \"Other Past games\", items: otherFinished},\r\n          ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n            {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n              <GameList\r\n                user={user}\r\n                usersById={usersById}\r\n                tournamentsById={tournamentsById}\r\n                games={items}\r\n                selectLiveGame={selectLiveGame}\r\n                applicableSettings={client.applicableSettings}\r\n              />\r\n            )}\r\n          ))} />\r\n        </Segment>\r\n        {challenges ? (<Segment>\r\n          <Tab menu={{pointing: true}} panes={(() => {\r\n            let challengesList = [\r\n              {key: 'other-started', label: \"Started Challenges\", items: otherStarted, color: 'green'},\r\n              {key: 'other-not-started', label: \"New Challenges\", items: otherNotStarted},\r\n              {key: 'other-solved', label: \"Solved Challenges\", items: otherSolved},\r\n            ].filter(({items}) => items.length);\r\n            if (!challengesList.length) {\r\n              challengesList = [\r\n                {key: 'challenges', label: \"Challenges\", items: challenges},\r\n              ];\r\n            }\r\n            return challengesList;\r\n          })().map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                  <ChallengeList selectChallenge={this.props.selectLiveChallenge} challenges={items} />\r\n                )}\r\n            ))\r\n          } />\r\n        </Segment>) : null}\r\n        <Segment>\r\n          <CreateTournament />\r\n          <br/><br/>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {key: 'my-live', label: \"My Future & Running tournaments\", items: tournamentsInfo.myFutureAndLive, color: 'green'},\r\n            {key: 'other-live', label: \"Other Future and Running tournaments\", items: tournamentsInfo.otherFutureAndLive, color: 'green'},\r\n            {key: 'my-past', label: \"My Past tournaments\", items: tournamentsInfo.myFinished},\r\n            {key: 'other-past', label: \"Other Past tournaments\", items: tournamentsInfo.otherFinished},\r\n          ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n            {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n              <TournamentList\r\n                user={user}\r\n                usersById={usersById}\r\n                tournaments={items}\r\n                selectLiveTournament={selectLiveTournament}\r\n              />\r\n            )}\r\n          ))} />\r\n        </Segment>\r\n        <Segment>\r\n          <Tab menu={{pointing: true}} panes={[\r\n            {key: 'online', label: \"Online Users\", items: online, color: 'green'},\r\n            {key: 'offline', label: \"Offline Users\", items: offline},\r\n            {key: 'all', label: \"All Users\", items: users},\r\n          ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n            {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n              <UserList\r\n                client={client}\r\n                users={items}\r\n                user={user}\r\n                challengedUser={challengedUser}\r\n                readyToPlayUsers={readyToPlay}\r\n                readyToPlayMeUsers={readyToPlayMe}\r\n              />\r\n            )}\r\n          ))} />\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nLobby.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  challengesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  selectLiveChallenge: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withClient(Lobby);\r\n\r\nexport {\r\n  ChallengeUserButton,\r\n  EditUser,\r\n};\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport '../styles/play.css';\r\nimport Game from \"../game/game\";\r\nimport Board from \"./Board\";\r\nimport {\r\n  Button,\r\n  Checkbox,\r\n  Grid,\r\n  Header,\r\n  Label,\r\n  Menu,\r\n  Modal,\r\n  Pagination,\r\n  Responsive,\r\n  Segment,\r\n  Statistic\r\n} from \"semantic-ui-react\";\r\nimport classNames from 'classnames';\r\nimport {BoardTransformation} from \"./Board/Board\";\r\nimport keydown, {Keys} from \"react-keydown\";\r\nimport PlayerColourBoard from \"./Board/PlayerColourBoard\";\r\nimport {ChallengeUserButton} from \"./Lobby\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass Play extends Component {\r\n  static MOVE_TYPE_NAMES = {\r\n    [Game.MOVE_TYPE_PLACE_FIRST_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_PLACE_SECOND_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: \"Select a worker\",\r\n    [Game.MOVE_TYPE_MOVE_FIRST_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_MOVE_SECOND_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_BUILD_AROUND_WORKER]: \"Build\",\r\n  };\r\n\r\n  state = {\r\n    selectedGame: null,\r\n    game: this.props.game,\r\n    transformation: null,\r\n  };\r\n\r\n  autoSubmitModal = React.createRef();\r\n\r\n  makeMove = game => {\r\n    if (this.props.submit) {\r\n      this.setState({game})\r\n    } else {\r\n      this.props.makeMove(game);\r\n    }\r\n    if (this.props.onDisplayPositionChange) {\r\n      this.props.onDisplayPositionChange(game);\r\n    }\r\n  };\r\n\r\n  takeMoveBack = () => {\r\n    this.makeMove(this.state.game.takeMoveBack());\r\n  };\r\n\r\n  undo = () => {\r\n    this.makeMove(this.state.game.undo());\r\n  };\r\n\r\n  newGame = () => {\r\n    this.makeMove(Game.create());\r\n  };\r\n\r\n  selectGame = game => {\r\n    const selectedGame = game === this.state.game ? null : game;\r\n    this.setState({selectedGame});\r\n    if (this.props.onSelectedGameChange) {\r\n      this.props.onSelectedGameChange(selectedGame);\r\n    }\r\n  };\r\n\r\n  makeMoveToSelected = game => {\r\n    this.selectGame(game);\r\n  };\r\n\r\n  takeMoveBackToSelected = () => {\r\n    this.selectGame(this.state.selectedGame.takeMoveBack());\r\n  };\r\n\r\n  undoToSelected = () => {\r\n    this.selectGame(this.state.selectedGame.undo());\r\n  };\r\n\r\n  deselectGame = () => {\r\n    this.selectGame(null);\r\n  };\r\n\r\n  submit = () => {\r\n    const moves = this.getMovesToSubmit();\r\n    if (moves.length) {\r\n      this.props.submit(moves, this.state.game);\r\n    }\r\n  };\r\n\r\n  getMovesToSubmit() {\r\n    const {game: propsGame} = this.props;\r\n    const {game: stateGame} = this.state;\r\n    const history = stateGame.fullHistory;\r\n    const propsGameIndex = history.findIndex(\r\n      game => game.compressedFullNotation === propsGame.compressedFullNotation);\r\n    if (propsGameIndex < 0) {\r\n      console.error(\"Could not find live game in history\");\r\n      return [];\r\n    }\r\n    const newHistory = history.slice(propsGameIndex + 1);\r\n    const moves = newHistory.map(game => game.lastMove);\r\n\r\n    return moves;\r\n  }\r\n\r\n  resignOrAbort = () => {\r\n    this.props.submit(\"resign\");\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props.game !== prevProps.game) {\r\n      const gameChanged = (\r\n        !this.props.game\r\n        || !prevProps.game\r\n        || this.props.game.compressedFullNotation !== prevProps.game.compressedFullNotation\r\n        || this.props.game.positionNotation !== prevProps.game.positionNotation\r\n      );\r\n      if (gameChanged) {\r\n        this.selectGame(null);\r\n        this.setState({game: this.props.game, resigning: false});\r\n      }\r\n    }\r\n    if (this.props.client.applicableSettings.autoSubmitMoves) {\r\n      if (!this.canSubmit(prevProps, prevState) && this.canSubmit()) {\r\n        this.submit();\r\n      }\r\n    }\r\n  }\r\n\r\n  changeAutoSubmitMoves = () => {\r\n    if (!this.props.client.applicableSettings.autoSubmitMoves) {\r\n      this.autoSubmitModal.current.handleOpen();\r\n    } else {\r\n      this.props.changeSettings({...this.props.user.settings, autoSubmitMoves: false});\r\n    }\r\n  };\r\n\r\n  doAutoSubmitMoves = () => {\r\n    this.props.changeSettings({...this.props.user.settings, autoSubmitMoves: true});\r\n    if (this.canSubmit()) {\r\n      this.submit();\r\n    }\r\n  };\r\n\r\n  canSubmit(props = this.props, state = this.state) {\r\n    const {submit} = props;\r\n    const {selectedGame, game} = state;\r\n    return (\r\n      !!submit\r\n      && !selectedGame\r\n      && game !== props.game\r\n      && !!this.getMovesToSubmit().length\r\n      && (\r\n        game.finished\r\n        || game.nextPlayer !== props.game.nextPlayer\r\n      )\r\n    );\r\n  }\r\n\r\n  onTransformationChange = ({transformation}) => {\r\n    this.setState({transformation});\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      client, user, names, allowControl, matchGame, children, usersInfo: {byId: usersById},\r\n    } = this.props;\r\n    const {selectedGame, game, transformation} = this.state;\r\n    const displayGame = selectedGame || game;\r\n    const isMyGame = allowControl.length > 0;\r\n    const canSubmit = this.canSubmit();\r\n    const tooShortToResign = matchGame ? matchGame.tooShortToResign : false;\r\n    const isPlayerBOpponent = allowControl.includes(Game.PLAYER_A);\r\n    const canUndo = !selectedGame && (this.props.submit ? game.chainCount > this.props.game.chainCount : game.canUndo);\r\n    const canTakeBack = !!(!this.props.submit && !selectedGame && game.previous);\r\n\r\n  \tconst controlsNode = (\r\n  \t  <Fragment>\r\n        <Grid.Row>\r\n          <PlayPlayer\r\n            player={isPlayerBOpponent ? Game.PLAYER_A : Game.PLAYER_B}\r\n            playerUser={matchGame ? usersById[matchGame.userIds[isPlayerBOpponent ? 0 : 1]] : null}\r\n            canSubmit={canSubmit}\r\n            canAnyPlayerSubmit={canSubmit}\r\n            canUndo={canUndo}\r\n            canTakeBack={canTakeBack}\r\n            submit={this.props.submit ? this.submit : null}\r\n            undo={this.props.submit ? this.takeMoveBack : this.undo}\r\n            takeBack={this.takeMoveBack}\r\n            changeAutoSubmitMoves={this.changeAutoSubmitMoves}\r\n            game={game}\r\n            applicableSettings={client.applicableSettings}\r\n            names={names}\r\n            allowControl={allowControl}\r\n          />\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <PlayPlayer\r\n            player={isPlayerBOpponent ? Game.PLAYER_B : Game.PLAYER_A}\r\n            playerUser={matchGame ? usersById[matchGame.userIds[isPlayerBOpponent ? 1 : 0]] : null}\r\n            canSubmit={false}\r\n            canAnyPlayerSubmit={canSubmit}\r\n            canUndo={canUndo}\r\n            canTakeBack={canTakeBack}\r\n            submit={this.props.submit ? this.submit : null}\r\n            undo={this.props.submit ? this.takeMoveBack : this.undo}\r\n            takeBack={this.takeMoveBack}\r\n            changeAutoSubmitMoves={this.changeAutoSubmitMoves}\r\n            game={game}\r\n            applicableSettings={client.applicableSettings}\r\n            names={names}\r\n            allowControl={allowControl}\r\n          />\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <PlayNavigation game={game} selectedGame={selectedGame} selectGame={this.selectGame} />\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <BoardTransformation onChange={this.onTransformationChange} />\r\n        </Grid.Row>\r\n        {children}\r\n      </Fragment>\r\n    );\r\n  \tconst boardNode = (\r\n      <Board\r\n        game={displayGame}\r\n        transformation={transformation}\r\n        makeMove={selectedGame ? this.makeMoveToSelected : this.makeMove}\r\n        minChainCount={displayGame === game ? (\r\n          this.props.submit ? this.props.game.chainCount : (\r\n            this.props.game.canUndo ? this.props.game.previous.chainCount : this.props.game.chainCount\r\n          )\r\n        ) : 0}\r\n        allowControl={displayGame === game ? allowControl : undefined}\r\n        settings={client.applicableSettings}\r\n        animated={client.applicableSettings.theme.animations}\r\n        showArrows={client.applicableSettings.theme.arrows}\r\n      />\r\n    );\r\n\r\n    return (\r\n      <Fragment>\r\n        <Segment style={{textAlign: \"center\"}}>\r\n          <Grid centered columns={'equal'} textAlign={'center'}>\r\n            <Responsive as={Grid.Row} minWidth={800}>\r\n              <Grid.Column>{controlsNode}</Grid.Column>\r\n              <Grid.Column>{boardNode}</Grid.Column>\r\n            </Responsive>\r\n            <Responsive as={Fragment} maxWidth={800}>\r\n              <Grid.Row>\r\n                <Grid.Column stretched={false} textAlign={'center'}>\r\n                  {boardNode}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column stretched={false} textAlign={'center'}>\r\n                  {controlsNode}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n            </Responsive>\r\n          </Grid>\r\n        </Segment>\r\n        {this.props.submit && isMyGame ? (\r\n          <Segment>\r\n            <Statistic.Group widths={\"two\"} size={\"tiny\"}>\r\n              <Statistic value={\r\n                <Modal\r\n                  trigger={<Button negative disabled={!!selectedGame || this.props.game.finished}>{tooShortToResign ? 'Abort' : 'Resign'}</Button>}\r\n                  header={tooShortToResign ? 'Abort?' : 'Resign?'}\r\n                  content={`Are you sure you want to ${tooShortToResign ? 'abort' : 'forfeit'}?${tooShortToResign ? ' This game is too short to resign.' : ''}`}\r\n                  actions={[{key: 'resign', content: tooShortToResign ? 'Abort' : 'Resign', negative: true, onClick: this.resignOrAbort}, { key: 'continue', content: 'Continue', inverted: true, secondary: true }]}\r\n                />\r\n              } />\r\n              <Statistic value={<Button negative onClick={this.props.submit ? this.takeMoveBack : this.undo} disabled={!canUndo}>Undo</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        {!this.props.submit ? (\r\n          <Segment>\r\n            <Statistic.Group widths={\"two\"} size={\"small\"}>\r\n              <Statistic value={<Button negative onClick={this.takeMoveBack} disabled={!canTakeBack}>Take Back a Move</Button>}/>\r\n              <Statistic value={<Button negative onClick={this.newGame} disabled={!!selectedGame || !game.previous}>New Game</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        <PlayHistory\r\n          game={game}\r\n          selectedGame={selectedGame}\r\n          selectGame={this.selectGame}\r\n          user={user}\r\n          applicableSettings={client.applicableSettings}\r\n        />\r\n        {selectedGame ? (\r\n          <Segment textAlign={\"center\"}>\r\n            <Header as={\"h2\"}>Reviewing previous move</Header>\r\n            <Statistic.Group widths={\"three\"} size={\"small\"}>\r\n              {selectedGame.finished ? (\r\n                <Statistic color={\"green\"} value={names[selectedGame.winner]} label={\"Won!\"} />\r\n              ) : (\r\n                <Statistic value={names[selectedGame.nextPlayer]} label={this.constructor.MOVE_TYPE_NAMES[selectedGame.moveType]} />\r\n              )}\r\n              <Statistic value={selectedGame.moveCount} label={\"Move\"} />\r\n              <Statistic value={<Button negative onClick={this.undoToSelected} disabled={!selectedGame.canUndo}>Undo</Button>} />\r\n            </Statistic.Group>\r\n            <Statistic.Group widths={\"two\"} size={\"small\"}>\r\n              <Statistic value={<Button negative onClick={this.takeMoveBackToSelected} disabled={!selectedGame.previous}>Take Back a Move</Button>}/>\r\n              <Statistic value={<Button negative onClick={this.deselectGame}>Stop reviewing</Button>} />\r\n            </Statistic.Group>\r\n          </Segment>\r\n        ) : null}\r\n        <Modal\r\n          ref={this.autoSubmitModal}\r\n          header={'Auto submit moves'}\r\n          content={'Are you sure you want to be auto submitting your moves?'}\r\n          actions={[\r\n            {key: 'yes', content: 'Auto submit', onClick: this.doAutoSubmitMoves, primary: true},\r\n            {key: 'no', content: 'No, manually submit moves', secondary: true},\r\n          ]}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nPlay.propTypes = {\r\n  user: PropTypes.object,\r\n  otherUser: PropTypes.object,\r\n  settings: PropTypes.object,\r\n  changeSettings: PropTypes.func,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  matchGame: PropTypes.object,\r\n  makeMove: PropTypes.func,\r\n  submit: PropTypes.func,\r\n  challengeUser: PropTypes.func,\r\n  stopChallengeUser: PropTypes.func,\r\n  challengedUser: PropTypes.object,\r\n  names: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  children: PropTypes.node,\r\n  onSelectedGameChange: PropTypes.func,\r\n  onDisplayPositionChange: PropTypes.func,\r\n  usersInfo: PropTypes.object.isRequired,\r\n};\r\n\r\nPlay.defaultProps = {\r\n  names: {\r\n    [Game.PLAYER_A]: \"Player A\",\r\n    [Game.PLAYER_B]: \"Player B\",\r\n  },\r\n  allowControl: [Game.PLAYER_A, Game.PLAYER_B],\r\n};\r\n\r\nPlay = withClient(Play);\r\n\r\nclass PlayPlayer extends Component {\r\n  static MOVE_TYPE_NAMES = {\r\n    [Game.MOVE_TYPE_PLACE_FIRST_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_PLACE_SECOND_WORKER]: \"Place a worker\",\r\n    [Game.MOVE_TYPE_SELECT_WORKER_TO_MOVE]: \"Select a worker\",\r\n    [Game.MOVE_TYPE_MOVE_FIRST_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_MOVE_SECOND_WORKER]: \"Move worker\",\r\n    [Game.MOVE_TYPE_BUILD_AROUND_WORKER]: \"Build\",\r\n  };\r\n\r\n  submitAndDisableConfirm = () => {\r\n    this.props.submit();\r\n    this.props.client.updateSettings({...this.props.user.settings, confirmSubmitMoves: false});\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      game, player, allowControl, names, applicableSettings, changeAutoSubmitMoves, playerUser,\r\n      canSubmit, canAnyPlayerSubmit, canUndo, canTakeBack, submit, undo, takeBack,\r\n    } = this.props;\r\n    const isPlayerControlled = allowControl.includes(player);\r\n    const previousGame = canAnyPlayerSubmit ? game.previous : game;\r\n    const isPlayersTurn = previousGame.nextPlayer === player;\r\n    const playerWon = previousGame.winner === player;\r\n    const finished = previousGame.finished;\r\n\r\n    return (\r\n      <Menu\r\n        stackable\r\n        className={classNames({attention: !finished && isPlayerControlled && isPlayersTurn && !canSubmit})}\r\n        size={'massive'}\r\n        inverted={finished || player === Game.PLAYER_B}\r\n        color={finished ? (playerWon ? 'green' : 'red') : undefined}\r\n        items={[\r\n          {key: 'icon',\r\n            icon: finished ? (playerWon ? 'trophy' : 'thumbs down') : (isPlayersTurn ? 'play' : 'hourglass'),\r\n            content: (\r\n              <Fragment>\r\n                <PlayerColourBoard medium applicableSettings={applicableSettings} player={player} allowControl={allowControl} />\r\n                {names[player]}\r\n              </Fragment>\r\n            )},\r\n          {key: 'instructions', content: (\r\n            finished\r\n              ? (playerWon ? 'Won' : 'Lost')\r\n              : (\r\n                canSubmit\r\n                  ? (\r\n                    applicableSettings.autoSubmitMoves\r\n                      ? 'Auto-submitting'\r\n                      : (\r\n                        <Fragment>\r\n                          {applicableSettings.confirmSubmitMoves ? (\r\n                            <Modal\r\n                              size={'mini'}\r\n                              trigger={\r\n                                <Button\r\n                                  positive\r\n                                  className={'attention'}\r\n                                >\r\n                                  Preview\r\n                                </Button>\r\n                              }\r\n                              header={'Submit move'}\r\n                              content={\r\n                                <Modal.Content>\r\n                                  Are you sure you want to submit these moves?\r\n                                  <br />\r\n                                  <Board\r\n                                    game={game}\r\n                                    medium\r\n                                    settings={applicableSettings}\r\n                                    animated\r\n                                    showArrows\r\n                                  />\r\n                                </Modal.Content>\r\n                              }\r\n                              actions={[\r\n                                {key: 'never-ask-again', content: 'Never ask again', onClick: this.submitAndDisableConfirm},\r\n                                {key: 'cancel', negative: true, content: 'Cancel'},\r\n                                {key: 'ok', positive: true, content: 'Submit', onClick: submit},\r\n                              ]}\r\n                            />\r\n                          ) : (\r\n                            <Button\r\n                              positive\r\n                              className={'attention'}\r\n                              onClick={submit}\r\n                            >\r\n                              Submit\r\n                            </Button>\r\n                          )}\r\n                          {isPlayerControlled && canUndo ? (\r\n                            <Fragment>\r\n                              {\" or \"}<Button negative content={'Undo'} disabled={!canUndo} onClick={undo} />\r\n                            </Fragment>\r\n                          ) : null}\r\n                        </Fragment>\r\n                      )\r\n                  ) : (\r\n                    isPlayersTurn\r\n                      ? (\r\n                        isPlayerControlled && canUndo\r\n                          ? (\r\n                            <Fragment>\r\n                              {this.constructor.MOVE_TYPE_NAMES[previousGame.moveType]}\r\n                              {\" or \"}<Button negative content={'Undo'} disabled={!canUndo} onClick={undo} />\r\n                            </Fragment>\r\n                          )\r\n                          : this.constructor.MOVE_TYPE_NAMES[previousGame.moveType]\r\n                      )\r\n                      : `Waiting for ${names[Game.OTHER_PLAYER[player]]}`\r\n                  )\r\n              )\r\n          )},\r\n          !canUndo && canTakeBack && !isPlayersTurn ? {\r\n            key: 'take-move-back', content: (\r\n              <Button negative content={'Take move back'} onClick={takeBack}/>\r\n            ),\r\n          } : null,\r\n          !finished && submit && allowControl.includes(player) ? {\r\n            key: 'auto-submit', content: (\r\n              <Checkbox\r\n                label={'Auto submit moves'}\r\n                toggle\r\n                checked={applicableSettings.autoSubmitMoves}\r\n                onChange={changeAutoSubmitMoves}\r\n              />\r\n            )\r\n          } : null,\r\n          finished && playerUser && playerUser.online ? {\r\n            key: 'challenge', content: (\r\n              <ChallengeUserButton otherUser={playerUser} />\r\n            ),\r\n          } : null,\r\n        ].filter(item => item)}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nPlayPlayer.propTypes = {\r\n  applicableSettings: PropTypes.object,\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  names: PropTypes.object.isRequired,\r\n  allowControl: PropTypes.array.isRequired,\r\n  player: PropTypes.oneOf(Game.PLAYERS).isRequired,\r\n  playerUser: PropTypes.object,\r\n  canSubmit: PropTypes.bool.isRequired,\r\n  canAnyPlayerSubmit: PropTypes.bool.isRequired,\r\n  canUndo: PropTypes.bool.isRequired,\r\n  canTakeBack: PropTypes.bool.isRequired,\r\n  submit: PropTypes.func,\r\n  undo: PropTypes.func,\r\n  takeBack: PropTypes.func,\r\n  changeAutoSubmitMoves: PropTypes.func.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nPlayPlayer = withClient(PlayPlayer);\r\n\r\nclass PlayHistory extends Component {\r\n  state = {\r\n    activePage: 1,\r\n  };\r\n\r\n  onPageChange = (e, {activePage}) => {\r\n    this.setState({activePage});\r\n  };\r\n\r\n  render() {\r\n    const {game, applicableSettings, selectedGame, selectGame, pageSize, moveNotation} = this.props;\r\n    const {activePage} = this.state;\r\n\r\n    const totalPages = Math.ceil((game.history.length - 1) / pageSize);\r\n    const visibleGames = [...game.history]\r\n      .slice(1 + (totalPages - activePage) * pageSize, 1 + (totalPages - activePage) * pageSize + pageSize)\r\n      .reverse();\r\n    const lastVisibleGame = visibleGames[visibleGames.length - 1];\r\n\r\n    return (\r\n      <Segment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <PlayNavigation game={game} selectedGame={selectedGame} selectGame={selectGame} />\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            {visibleGames.map(previousGame => (\r\n              <Fragment key={previousGame.chainCount}>\r\n                {previousGame.moveCount % 2 === 1 ? (\r\n                  <Label content={previousGame.moveCount - 1} />\r\n                ) : null}\r\n                <Board\r\n                  game={previousGame}\r\n                  small\r\n                  onSelect={selectGame}\r\n                  selected={previousGame === selectedGame}\r\n                  settings={applicableSettings}\r\n                />\r\n                {moveNotation ? (\r\n                  <Label color={'green'}>\r\n                    {previousGame.lastMovesInHistory.map(({x, y, resign}) => resign\r\n                      ? 'R' : `${['A', 'B', 'C', 'D', 'E'][x]}${y + 1}`).join('/')}\r\n                  </Label>\r\n                ) : null}\r\n              </Fragment>\r\n            ))}\r\n            {lastVisibleGame && (lastVisibleGame.moveCount % 2 === 0) ? (\r\n              <Label content={lastVisibleGame.moveCount - 2} />\r\n            ) : null}\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Pagination\r\n              totalPages={totalPages}\r\n              activePage={activePage}\r\n              onPageChange={this.onPageChange}\r\n              pointing\r\n              secondary\r\n            />\r\n          </Grid.Row>\r\n        </Grid>\r\n      </Segment>\r\n    );\r\n  }\r\n}\r\n\r\nPlayHistory.propTypes = {\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  selectedGame: PropTypes.instanceOf(Game),\r\n  user: PropTypes.object,\r\n  applicableSettings: PropTypes.object.isRequired,\r\n  selectGame: PropTypes.func,\r\n  pageSize: PropTypes.number.isRequired,\r\n  moveNotation: PropTypes.bool.isRequired,\r\n};\r\n\r\nPlayHistory.defaultProps = {\r\n  pageSize: 10,\r\n  moveNotation: false,\r\n};\r\n\r\nclass PlayNavigation extends Component {\r\n  static keys = [\r\n    'left', 'right', 'shift+left', 'shift+right', 'home', 'end',\r\n  ];\r\n\r\n  componentWillReceiveProps({keydown}) {\r\n    if (keydown.event) {\r\n      const {which, shiftKey} = keydown.event;\r\n      if (which === Keys.left && shiftKey) {\r\n        this.goToCurrentMove();\r\n      } else if (which === Keys.home) {\r\n        this.goToCurrentMove();\r\n      } else if (which === Keys.left && !shiftKey) {\r\n        this.goToNextMove();\r\n      } else if (which === Keys.right && !shiftKey) {\r\n        this.goToPreviousMove();\r\n      } else if (which === Keys.right && shiftKey) {\r\n        this.goToFirstMove();\r\n      } else if (which === Keys.home) {\r\n        this.goToFirstMove();\r\n      }\r\n    }\r\n  }\r\n\r\n  get gameIndexes() {\r\n    const {game, selectedGame} = this.props;\r\n    const selectedGameIndex = game.history.indexOf(selectedGame || game);\r\n    let mostRecentAncestorGameIndex = selectedGameIndex;\r\n    let ancestor = selectedGame;\r\n    while (mostRecentAncestorGameIndex === -1 && ancestor) {\r\n      ancestor = ancestor.previousInHistory;\r\n      mostRecentAncestorGameIndex = game.history.indexOf(ancestor);\r\n    }\r\n    const lastGameIndex = game.history.length - 1;\r\n\r\n    return {selectedGameIndex, lastGameIndex, mostRecentAncestorGameIndex};\r\n  }\r\n\r\n  canGoToCurrentMove() {\r\n    const {selectedGameIndex, lastGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex !== lastGameIndex;\r\n  }\r\n\r\n  goToCurrentMove = () => {\r\n    if (!this.canGoToCurrentMove()) {\r\n      return;\r\n    }\r\n    this.props.selectGame(this.props.game);\r\n  };\r\n\r\n  canGoToNextMove() {\r\n    const {selectedGameIndex, lastGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex >= 0 && selectedGameIndex !== lastGameIndex;\r\n  }\r\n\r\n  goToNextMove = () => {\r\n    if (!this.canGoToNextMove()) {\r\n      return;\r\n    }\r\n    const selectedGameIndex = this.props.game.history.indexOf(this.props.selectedGame || this.props.game);\r\n    this.props.selectGame(this.props.game.history[selectedGameIndex + 1]);\r\n  };\r\n\r\n  goToAncestor = () => {\r\n    const {mostRecentAncestorGameIndex} = this.gameIndexes;\r\n    this.props.selectGame(this.props.game.history[mostRecentAncestorGameIndex]);\r\n  };\r\n\r\n  canGoToPreviousMove() {\r\n    const {selectedGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex >= 0 && selectedGameIndex !== 0;\r\n  }\r\n\r\n  goToPreviousMove = () => {\r\n    if (!this.canGoToPreviousMove()) {\r\n      return;\r\n    }\r\n    this.props.selectGame((this.props.selectedGame || this.props.game).previousInHistory);\r\n  };\r\n\r\n  goToPreviousVariationMove = () => {\r\n    this.props.selectGame(this.props.selectedGame.previousInHistory);\r\n  };\r\n\r\n  canGoToFirstMove() {\r\n    const {selectedGameIndex} = this.gameIndexes;\r\n\r\n    return selectedGameIndex !== 0;\r\n  }\r\n\r\n  goToFirstMove = () => {\r\n    if (!this.canGoToFirstMove()) {\r\n      return;\r\n    }\r\n    this.props.selectGame(this.props.game.history[0]);\r\n  };\r\n\r\n  render() {\r\n    const {game, selectedGame} = this.props;\r\n    const {selectedGameIndex, mostRecentAncestorGameIndex} = this.gameIndexes;\r\n\r\n    return (\r\n      <Menu size={'massive'} items={[\r\n        {key: 'current', icon: 'fast backward', onClick: this.goToCurrentMove, disabled: !this.canGoToCurrentMove()},\r\n        ...(selectedGameIndex >= 0 ? [\r\n          {key: 'previous', icon: 'backward', onClick: this.goToNextMove, disabled: !this.canGoToNextMove()},\r\n          {key: 'moveCount', content: selectedGameIndex >= 0 ? `${(selectedGame || game).moveCount}/${game.moveCount}` : selectedGame.moveCount, disabled: game.finished},\r\n          {key: 'next', icon: 'forward', onClick: this.goToPreviousMove, disabled: !this.canGoToPreviousMove()},\r\n        ] : [\r\n          {key: 'goToAncestor', content: `Return to ${mostRecentAncestorGameIndex}/${game.moveCount}`, onClick: this.goToAncestor},\r\n        ]),\r\n        {key: 'first', icon: 'fast forward', onClick: this.goToFirstMove, disabled: !this.canGoToFirstMove()},\r\n        ...(selectedGameIndex >= 0 ? [] : [\r\n          {key: 'ancestor', content: `Variation ${selectedGame.moveCount}/${mostRecentAncestorGameIndex}`, disabled: true},\r\n          {key: 'next', icon: 'forward', onClick: this.goToPreviousVariationMove, disabled: selectedGame.moveCount <= 1},\r\n        ]),\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nPlayNavigation.propTypes = {\r\n  game: PropTypes.instanceOf(Game).isRequired,\r\n  selectedGame: PropTypes.instanceOf(Game),\r\n  selectGame: PropTypes.func.isRequired,\r\n};\r\n\r\nPlayNavigation = keydown(PlayNavigation.keys)(PlayNavigation);\r\n\r\nexport default Play;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Play from \"./Play\";\r\nimport Game from \"../game/game\";\r\nimport {Grid, Modal, Menu} from \"semantic-ui-react\";\r\nimport * as utils from \"../utils\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass Hotseat extends Component {\r\n  state = {\r\n    selectedGame: null,\r\n    error: false,\r\n    ...this.constructor.getGameAndErrorFromUrlPosition(),\r\n  };\r\n\r\n  static getGameAndErrorFromUrlPosition() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const position = params.get('position');\r\n    if (position) {\r\n      let game, error;\r\n      try {\r\n        game = Game.fromCompressedMoveNotation(position);\r\n        if (!game) {\r\n          error = 'The position was not valid';\r\n        } else {\r\n          error = null;\r\n        }\r\n      } catch (e) {\r\n        game = null;\r\n        error = 'The series of moves where not valid';\r\n      }\r\n      if (!game) {\r\n        return {game: Game.create(), error};\r\n      }\r\n      return {game, error: false};\r\n    } else {\r\n      return {game: Game.create(), error: false};\r\n    }\r\n  }\r\n\r\n  dismissUrlPositionError = () =>{\r\n    this.setState({error: null});\r\n  };\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  share = () => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const game = this.state.game;\r\n      navigator.share({\r\n        title: `Thyra Online - Game after ${game.moveCount} moves`,\r\n        text: `Review Santorini game between after ${game.moveCount} moves`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n  };\r\n\r\n  onSelectedGameChange = selectedGame => {\r\n    this.setState({selectedGame});\r\n  };\r\n\r\n  render() {\r\n    const {game, error, selectedGame} = this.state;\r\n    const {user} = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Modal\r\n          open={error}\r\n          size={'mini'}\r\n          onClose={this.dismissUrlPositionError}\r\n          header={'Could not load shared position'}\r\n          content={`${error}. Please check that you copied the full URL`}\r\n          actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n        />\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu inverted size={'massive'} items={[\r\n              {key: 'share', icon: 'share', content: 'Share position', color: 'green', active: true, as: 'a',\r\n                href: `?position=${(selectedGame || game).compressedFullNotation}`,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to game'}\r\n            ]} />\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Play\r\n          user={user}\r\n          game={game}\r\n          makeMove={this.makeMove}\r\n          onSelectedGameChange={this.onSelectedGameChange}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nHotseat.propTypes = {\r\n  user: PropTypes.object,\r\n};\r\n\r\nexport default withClient(Hotseat);\r\n","import React, {Component, Fragment} from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport {Checkbox, Form, Grid, Header, Label, Modal, Segment, Tab} from \"semantic-ui-react\";\r\nimport Client from \"../client/client\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport {ThemeDemoBoard} from \"./Board\";\r\n\r\nclass SettingsContent extends Component {\r\n  themeSchemeOptions = [\r\n    {value: '', label: 'Default'},\r\n    {value: 'subtle', label: 'Subtle'},\r\n    {value: 'pastel', label: 'Pastel'},\r\n    {value: 'green', label: 'Green'},\r\n    {value: 'halloween', label: 'Halloween'},\r\n  ];\r\n  themeCellsOptions = [\r\n    {value: 'original', label: 'Original'},\r\n    {value: 'halloween', label: 'Halloween'},\r\n  ];\r\n  themePiecesOptions = [\r\n    {value: 'pawn', label: 'Pawn'},\r\n    {value: 'king', label: 'King'},\r\n    {value: 'circle', label: 'Circle'},\r\n    {value: 'certificate', label: 'Star'},\r\n    {value: 'sun', label: 'Sun'},\r\n    {value: 'rocket', label: 'Rocket'},\r\n    {value: 'bug', label: 'Bug'},\r\n    {value: 'eye', label: 'Eye'},\r\n    {value: 'user', label: 'User'},\r\n    {value: 'halloween-witch-hat', label: 'Halloween: Witch Hat'},\r\n    {value: 'halloween-cauldron', label: 'Halloween: Cauldron'},\r\n    {value: 'halloween-bat', label: 'Halloween: Bat'},\r\n    {value: 'halloween-spider', label: 'Halloween: Spider'},\r\n    {value: 'halloween-cat', label: 'Halloween: Cat'},\r\n    {value: 'halloween-tombstone', label: 'Halloween: Tombstone'},\r\n    {value: 'halloween-pumpkin', label: 'Halloween: Pumpkin'},\r\n    {value: 'halloween-ghost', label: 'Halloween: Ghost'},\r\n  ];\r\n  themeNumbersOptions = [\r\n    {value: '', label: 'None'},\r\n    {value: 'obvious', label: 'Obvious'},\r\n    {value: 'subtle', label: 'Subtle'},\r\n    {value: 'very-subtle', label: 'Very subtle'},\r\n  ];\r\n\r\n  themeDemoBoard = overrides => {\r\n    const {settings: {theme}} = this.props;\r\n    return (\r\n      <ThemeDemoBoard medium settings={{theme: {...theme, animations: false, ...overrides}}}/>\r\n    );\r\n  };\r\n\r\n  updateAutoSubmitMove = (e, {checked}) => {\r\n    this.props.updateSettings({autoSubmitMoves: checked});\r\n  };\r\n\r\n  updateConfirmSubmitMoves = (e, {checked}) => {\r\n    this.props.updateSettings({confirmSubmitMoves: checked});\r\n  };\r\n\r\n  updateEnableNotifications = (e, {checked}) => {\r\n    this.props.updateSettings({enableNotifications: checked});\r\n  };\r\n\r\n  updateThemeUseTopicalTheme = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {useTopicalTheme: checked}});\r\n  };\r\n\r\n  updateThemeRotateOpponent = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {rotateOpponent: checked}});\r\n  };\r\n\r\n  updateAnimations = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {animations: checked}});\r\n  };\r\n\r\n  updateArrows = (e, {checked}) => {\r\n    this.props.updateSettings({theme: {arrows: checked}});\r\n  };\r\n\r\n  updateThemeNumbers = (e, {value}) => {\r\n    this.props.updateSettings({theme: {numbers: value}});\r\n  };\r\n\r\n  updateThemeScheme = (e, {value}) => {\r\n    this.props.updateSettings({theme: {scheme: value}});\r\n  };\r\n\r\n  updateThemePieces = (e, {value}) => {\r\n    this.props.updateSettings({theme: {pieces: value}});\r\n  };\r\n\r\n  updateThemeCells = (e, {value}) => {\r\n    this.props.updateSettings({theme: {cells: value}});\r\n  };\r\n\r\n  render() {\r\n    const {settings: {autoSubmitMoves, confirmSubmitMoves, enableNotifications, theme}, applicableSettingsName, applicableSettingsOverride} = this.props;\r\n    const {useTopicalTheme, cells = 'original', pieces = 'king', scheme, rotateOpponent, animations, arrows, numbers} = theme;\r\n\r\n    return (\r\n      <Tab menu={{pointing: true, attached: false}} panes={[\r\n        {menuItem: 'Playing', render: () => (\r\n          <Segment>\r\n            <Form>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Auto-submit online moves'}\r\n                  name={'autoSubmitMoves'}\r\n                  checked={autoSubmitMoves}\r\n                  onChange={this.updateAutoSubmitMove}\r\n                />\r\n              </Form.Group>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Confirm before submitting online moves'}\r\n                  name={'confirmSubmitMoves'}\r\n                  checked={confirmSubmitMoves}\r\n                  onChange={this.updateConfirmSubmitMoves}\r\n                />\r\n              </Form.Group>\r\n              <Form.Group>\r\n                <Checkbox\r\n                  label={'Enable notifications'}\r\n                  name={'enableNotifications'}\r\n                  checked={enableNotifications}\r\n                  onChange={this.updateEnableNotifications}\r\n                />\r\n              </Form.Group>\r\n            </Form>\r\n          </Segment>\r\n        )},\r\n        {menuItem: 'Theme', render: () => (\r\n          <Segment>\r\n            <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n              <Grid.Row>\r\n                <Grid.Column textAlign={'center'}>\r\n                  {this.themeDemoBoard({animations: theme.animations})}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Grid.Column width={4}>\r\n                  <Checkbox\r\n                    label={'Use topical theme when available'}\r\n                    name={'theme.useTopicalTheme'}\r\n                    checked={useTopicalTheme}\r\n                    onChange={this.updateThemeUseTopicalTheme}\r\n                  />\r\n                </Grid.Column>\r\n                <Grid.Column floated={'right'} textAlign={'right'}>\r\n                  {applicableSettingsName ? (\r\n                    <Fragment>\r\n                      {applicableSettingsName}\r\n                      <br/>\r\n                      {this.themeDemoBoard(applicableSettingsOverride.theme)}\r\n                    </Fragment>\r\n                  ) : null}\r\n                </Grid.Column>\r\n              </Grid.Row>\r\n              <Grid.Row>\r\n                <Tab menu={{pointing: true, attached: false}} panes={[\r\n                  {menuItem: 'Pieces', render: () => (\r\n                    <Tab.Pane>\r\n                    <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n                      <Grid.Row>\r\n                        <Grid.Column width={4}>\r\n                          <Checkbox\r\n                            label={'Rotate Opponent'}\r\n                            name={'theme.rotateOpponent'}\r\n                            checked={rotateOpponent}\r\n                            onChange={this.updateThemeRotateOpponent}\r\n                          />\r\n                        </Grid.Column>\r\n                        <Grid.Column floated={'right'} textAlign={'right'}>\r\n                          {this.themeDemoBoard({rotateOpponent: true})}\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      <Grid.Row>\r\n                        <Grid.Column width={4}>\r\n                          <Checkbox\r\n                            label={'Animation'}\r\n                            name={'theme.animations'}\r\n                            checked={animations}\r\n                            onChange={this.updateAnimations}\r\n                          />\r\n                        </Grid.Column>\r\n                        <Grid.Column floated={'right'} textAlign={'right'}>\r\n                          {this.themeDemoBoard({animations: true})}\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      <Grid.Row>\r\n                        <Grid.Column width={4}>\r\n                          <Checkbox\r\n                            label={'Arrows'}\r\n                            name={'theme.arrows'}\r\n                            checked={arrows}\r\n                            onChange={this.updateArrows}\r\n                          />\r\n                        </Grid.Column>\r\n                        <Grid.Column floated={'right'} textAlign={'right'}>\r\n                          {this.themeDemoBoard({arrows: true})}\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      <Grid.Row>\r\n                        <Grid.Column textAlign={'center'}>\r\n                          <Form.Field><Header as={'h2'}>Pieces:</Header></Form.Field>\r\n                        </Grid.Column>\r\n                      </Grid.Row>\r\n                      {this.themePiecesOptions.map(option => (\r\n                        <Grid.Row key={`theme-pieces-${option.value}`}>\r\n                          <Grid.Column width={4}>\r\n                            <Checkbox\r\n                              radio\r\n                              label={option.label}\r\n                              name={'theme.pieces'}\r\n                              value={option.value}\r\n                              checked={pieces === option.value}\r\n                              onChange={this.updateThemePieces}\r\n                            />\r\n                          </Grid.Column>\r\n                          <Grid.Column floated={'right'} textAlign={'right'}>\r\n                            {this.themeDemoBoard({pieces: option.value})}\r\n                          </Grid.Column>\r\n                        </Grid.Row>\r\n                      ))}\r\n                    </Grid>\r\n                  </Tab.Pane>\r\n                  )},\r\n                  {menuItem: 'Board', render: () => (\r\n                    <Tab.Pane>\r\n                      <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n                        <Grid.Row>\r\n                          <Grid.Column textAlign={'center'}>\r\n                            <Form.Field><Header as={'h2'}>Cells:</Header></Form.Field>\r\n                          </Grid.Column>\r\n                          </Grid.Row>\r\n                        {this.themeCellsOptions.map(option => (\r\n                          <Grid.Row key={`theme-cells-${option.value}`}>\r\n                            <Grid.Column width={4}>\r\n                              <Checkbox\r\n                                radio\r\n                                label={option.label}\r\n                                name={'theme.cells'}\r\n                                value={option.value}\r\n                                checked={cells === option.value}\r\n                                onChange={this.updateThemeCells}\r\n                              />\r\n                            </Grid.Column>\r\n                            <Grid.Column floated={'right'} textAlign={'right'}>\r\n                              {this.themeDemoBoard({cells: option.value})}\r\n                            </Grid.Column>\r\n                          </Grid.Row>\r\n                        ))}\r\n                        <Grid.Row>\r\n                          <Grid.Column textAlign={'center'}>\r\n                            <Form.Field><Header as={'h2'}>Colours:</Header></Form.Field>\r\n                          </Grid.Column>\r\n                        </Grid.Row>\r\n                        {this.themeSchemeOptions.map(option => (\r\n                          <Grid.Row key={`theme-scheme-${option.value}`}>\r\n                            <Grid.Column width={4}>\r\n                              <Checkbox\r\n                                radio\r\n                                label={option.label}\r\n                                name={'theme.scheme'}\r\n                                value={option.value}\r\n                                checked={scheme === option.value}\r\n                                onChange={this.updateThemeScheme}\r\n                              />\r\n                            </Grid.Column>\r\n                            <Grid.Column floated={'right'} textAlign={'right'}>\r\n                              {this.themeDemoBoard({scheme: option.value})}\r\n                            </Grid.Column>\r\n                          </Grid.Row>\r\n                        ))}\r\n                      </Grid>\r\n                    </Tab.Pane>\r\n                  )},\r\n                  {menuItem: 'Level Indicators', render: () => (\r\n                    <Tab.Pane>\r\n                      <Grid stackable columns={'equal'} verticalAlign={'middle'}>\r\n                        {this.themeNumbersOptions.map(option => (\r\n                          <Grid.Row key={`theme-numbers-${option.value}`}>\r\n                            <Grid.Column width={4}>\r\n                              <Checkbox\r\n                                radio\r\n                                label={option.label}\r\n                                name={'theme.numbers'}\r\n                                value={option.value}\r\n                                checked={numbers === option.value}\r\n                                onChange={this.updateThemeNumbers}\r\n                              />\r\n                            </Grid.Column>\r\n                            <Grid.Column floated={'right'} textAlign={'right'}>\r\n                              {this.themeDemoBoard({numbers: option.value})}\r\n                            </Grid.Column>\r\n                          </Grid.Row>\r\n                        ))}\r\n                      </Grid>\r\n                    </Tab.Pane>\r\n                  )}\r\n                ]} />\r\n              </Grid.Row>\r\n            </Grid>\r\n          </Segment>\r\n        )},\r\n      ]} />\r\n    );\r\n  }\r\n}\r\n\r\nSettingsContent.propTypes = {\r\n  settings: PropTypes.object.isRequired,\r\n  updateSettings: PropTypes.func.isRequired,\r\n  applicableThemeName: PropTypes.string,\r\n  applicableSettingsOverride: PropTypes.object,\r\n};\r\n\r\nclass Settings extends Component {\r\n  state = {\r\n    user: null,\r\n    settings: Client.getDefaultSettings(),\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    if (props.user && props.user !== state.user) {\r\n      return {\r\n        user: props.user,\r\n        settings: props.client.settings,\r\n      };\r\n    }\r\n\r\n    return {};\r\n  }\r\n\r\n  updateSettings = update => {\r\n    this.setState(state => ({\r\n      settings: {\r\n        ...state.settings,\r\n        ...update,\r\n        theme: {\r\n          ...state.settings.theme,\r\n          ...update.theme,\r\n        },\r\n      },\r\n    }));\r\n  };\r\n\r\n  save = () => {\r\n    this.props.client.updateSettings(this.state.settings);\r\n  };\r\n\r\n  render() {\r\n    const {settings} = this.state;\r\n    const {client} = this.props;\r\n\r\n    return (\r\n      <Modal\r\n        trigger={<Label as={'a'} icon={'cog'} content={'Settings'} />}\r\n        size={'small'}\r\n        header={'Settings'}\r\n        actions={[\r\n          {key: 'cancel', content: 'Cancel'},\r\n          {key: 'save', content: 'Save', positive: true, onClick: this.save},\r\n        ]}\r\n        content={{scrolling: true, content: (\r\n          <SettingsContent\r\n            settings={settings}\r\n            updateSettings={this.updateSettings}\r\n            applicableSettingsName={client.applicableSettingsName}\r\n            applicableSettingsOverride={client.applicableSettingsOverride}\r\n          />\r\n        )}}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nSettings.propTypes = {\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n};\r\n\r\nexport default withClient(Settings);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Grid, Icon, Label, Menu, Modal, Responsive, Segment, Tab} from \"semantic-ui-react\";\r\nimport { createSelector } from 'reselect';\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport Game from \"../game/game\";\r\nimport Play from \"./Play\";\r\nimport {NavLink, Route, Switch, withRouter} from \"react-router-dom\";\r\nimport * as utils from \"../utils\";\r\nimport HashedIcon from \"./HashedIcon\";\r\nimport Settings from \"./Settings\";\r\nimport GameList from \"./GameList\";\r\nimport {ChallengeUserButton} from \"./Lobby\";\r\n\r\nclass OnlineGamePlayer extends Component {\r\n  render() {\r\n    const {game, player} = this.props;\r\n    let initialPlayer, resultingPlayerScore;\r\n    if (game) {\r\n      if (game.initialPlayerA.id === player.id) {\r\n        initialPlayer = game.initialPlayerA;\r\n        resultingPlayerScore = game.resultingPlayerAScore;\r\n      } else if (game.initialPlayerB.id === player.id) {\r\n        initialPlayer = game.initialPlayerB;\r\n        resultingPlayerScore = game.resultingPlayerBScore;\r\n      } else {\r\n        initialPlayer = null;\r\n        resultingPlayerScore = null;\r\n      }\r\n    } else {\r\n      initialPlayer = null;\r\n      resultingPlayerScore = null;\r\n    }\r\n    const isWinner = game && game.winnerUserId === player.id;\r\n    return (\r\n      <Fragment>\r\n        {isWinner ? <Icon name={'trophy'} color={\"green\"} /> : null}{\" \"}\r\n        <span style={isWinner ? {color: '#21BA45'} : undefined}>\r\n          {player.name}\r\n          {initialPlayer && !game.tournamentId ? (\r\n            <Fragment>\r\n              {\" \"}({resultingPlayerScore ? (\r\n                <Fragment>\r\n                  {isWinner ? `+${initialPlayer.winPoints}` : initialPlayer.losePoints}\r\n                  {\" \"}<Icon name={'long arrow alternate right'} />{\" \"}\r\n                  {resultingPlayerScore}\r\n                </Fragment>\r\n              ) : (\r\n                <Fragment>\r\n                  {initialPlayer.score}\r\n                  {\" \"}+{initialPlayer.winPoints}/{initialPlayer.losePoints}\r\n                </Fragment>\r\n              )})\r\n            </Fragment>\r\n          ) : null}\r\n        </span>\r\n        <HashedIcon floated={'right'} size={'mini'} hash={player.id} />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineGamePlayer.propTypes = {\r\n  game: PropTypes.object,\r\n  player: PropTypes.object.isRequired,\r\n};\r\n\r\nclass ChosenOnlineGame extends Component {\r\n  state = {\r\n    selectedGame: null,\r\n  };\r\n\r\n  gameSelector = createSelector([\r\n    props => props.match.params.id,\r\n    props => props.gamesInfo.byId,\r\n  ], (gameId, gamesById) => gamesById[gameId]);\r\n\r\n  get game() {\r\n    return this.gameSelector(this.props);\r\n  }\r\n\r\n  playersInfoSelector = createSelector([\r\n    props => props.user,\r\n    props => props.usersInfo,\r\n    () => this.game,\r\n  ], (user, {byId: usersById}, game) => {\r\n    const playerA = usersById[game.userIds[0]];\r\n    const playerB = usersById[game.userIds[1]];\r\n    const isUserPlayerA = user ? playerA.id === user.id : false;\r\n    const isUserPlayerB = user ? playerB.id === user.id : false;\r\n    const userPlayer = isUserPlayerA ? Game.PLAYER_A : isUserPlayerB ? Game.PLAYER_B : null;\r\n    const otherUser = isUserPlayerA ? playerB : isUserPlayerB ? playerA : null;\r\n\r\n    return {\r\n      playerA, playerB,\r\n      isUserPlayerA, isUserPlayerB,\r\n      userPlayer, otherUser,\r\n    };\r\n  });\r\n\r\n  get playersInfo() {\r\n    return this.playersInfoSelector(this.props);\r\n  }\r\n\r\n  gameGameSelector = createSelector([\r\n    () => this.game,\r\n  ], game => game ? Game.deserialize(game.game) : null);\r\n\r\n  get gameGame() {\r\n    return this.gameGameSelector(this.props);\r\n  }\r\n\r\n  dismissUrlGameError = () => {\r\n    this.props.selectLiveGame(null);\r\n  };\r\n\r\n  submit = moves => {\r\n    this.props.client.submitGameMove(this.game, moves);\r\n  };\r\n\r\n  componentDidMount() {\r\n    const game = this.game;\r\n    if (game) {\r\n      this.props.selectLiveGame(game);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const game = this.game;\r\n    if (game) {\r\n      this.props.selectLiveGame(game);\r\n    }\r\n  }\r\n\r\n  close = () => {\r\n    this.props.selectLiveGame(null);\r\n  };\r\n\r\n  changeSettings = settings => {\r\n    this.props.client.updateSettings(settings);\r\n  };\r\n\r\n  shareGame = e => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const game = this.game;\r\n      const {playerA, playerB} = this.playersInfo;\r\n      navigator.share({\r\n        title: `Thyra Online - ${game.finished ? 'Review' : 'Live'} ${playerA.name} vs ${playerB.name}`,\r\n        text: `${game.finished? 'Review finished': 'Watch live'} Santorini game between ${playerA.name} and ${playerB.name}`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  challengeUser = () => {\r\n    const {otherUser} = this.playersInfo;\r\n    if (otherUser) {\r\n      this.props.client.changeReadyToPlay(otherUser.id);\r\n    }\r\n  };\r\n\r\n  stopChallengeUser = () => {\r\n    this.props.client.changeReadyToPlay(false);\r\n  };\r\n\r\n  onSelectedGameChange = selectedGame => {\r\n    this.setState({selectedGame});\r\n  };\r\n\r\n  copyPlayPosition = () => {\r\n    utils.copyToClipboard((this.state.selectedGame || this.state.game).positionNotation);\r\n    alert('Play position copied to clipboard');\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      location, client, user, game, selectLiveGame,\r\n      usersInfo: {challengedUser, byId: usersById}, gamesInfo: {otherLive: otherLiveGames, myLive: myLiveGames},\r\n      tournamentsInfo: {byId: tournamentsById},\r\n    } = this.props;\r\n    const {selectedGame} = this.state;\r\n    const {gameGame} = this;\r\n\r\n    if (!gameGame) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlGameError}\r\n            header={'Could not find game'}\r\n            content={'This game cannot be found. Please check that you copied the full URL, or perhaps the game was aborted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find game\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const {otherUser, playerA, playerB, isUserPlayerA, isUserPlayerB, userPlayer} = this.playersInfo;\r\n    if (!playerA || !playerB) {\r\n      return null;\r\n    }\r\n\r\n    const gamesNode = (\r\n      <Segment>\r\n        <ChallengeUserButton otherUser={user} />\r\n        <br />\r\n        <br />\r\n        <GameList\r\n          user={user}\r\n          selectLiveGame={selectLiveGame}\r\n          games={myLiveGames.concat(otherLiveGames)}\r\n          usersById={usersById}\r\n          tournamentsById={tournamentsById}\r\n          terse\r\n          live\r\n          currentGameId={game ? game.id : null}\r\n          reverse={false}\r\n          applicableSettings={client.applicableSettings}\r\n        />\r\n      </Segment>\r\n    );\r\n    const tournament = game ? tournamentsById[game.tournamentId] : null;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Settings/>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} inverted items={[\r\n              {key: 'close', content: 'Close', icon: 'x', onClick: this.close, color: 'red', active: true},\r\n              {key: 'share', content: 'Share Game', icon: 'share', onClick: this.shareGame, as: NavLink,\r\n                to: location.pathname, color: 'green', active: true,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to game'},\r\n              {key: 'play', content: 'Play position', icon: 'retweet', as: NavLink,\r\n                to: `/hotseat?position=${(selectedGame || gameGame).compressedFullNotation}`, color: 'green', active: true,\r\n                title: 'Click to open hotseat with this game', target: '_blank'},\r\n              (process.env.REACT_APP_DEBUG || (user && user.admin)) ? {key: 'edit', content: 'Edit position', icon: 'edit', as: NavLink,\r\n                to: `/challenge/create?position=${(selectedGame || gameGame).positionNotation}`, color: 'green', active: true,\r\n                title: 'Click to edit the position for this game', target: '_blank'} : null,\r\n              (process.env.REACT_APP_DEBUG || (user && user.admin)) ? {key: 'copy-play', icon: 'clipboard', content: 'Copy play position', color: 'green', active: true,\r\n                title: 'Click to copy play position to position', onClick: this.copyPlayPosition} : null,\r\n            ].filter(item => item)} />\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} items={[\r\n              {key: 'player-a', content: (\r\n                <Fragment>\r\n                  {isUserPlayerA ? <Label color={'green'} icon={\"user\"} content={'Me'} /> : null}\r\n                  <OnlineGamePlayer game={game} player={playerA} />\r\n                </Fragment>\r\n              ), color: isUserPlayerA ? 'green' : undefined},\r\n              {key: 'player-b', content: (\r\n                <Fragment>\r\n                  {isUserPlayerB ? <Label color={'green'} icon={\"user\"} content={'Me'} /> : null}\r\n                  <OnlineGamePlayer game={game} player={playerB} />\r\n                </Fragment>\r\n              ), color: isUserPlayerB ? 'green' : undefined},\r\n              tournament ? {key: 'tournament', content: (\r\n                <NavLink to={`/tournament/${tournament.id}`}>\r\n                  <Icon name={'sitemap'} /> {tournament.name}\r\n                </NavLink>\r\n              ), as: 'span'} : null,\r\n            ].filter(item => item)}/>\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Responsive as={Fragment} maxWidth={800}>\r\n          {gamesNode}\r\n        </Responsive>\r\n        <Play\r\n          user={user}\r\n          otherUser={otherUser}\r\n          changeSettings={this.changeSettings}\r\n          game={gameGame}\r\n          matchGame={game}\r\n          names={{[Game.PLAYER_A]: playerA.name, [Game.PLAYER_B]: playerB.name}}\r\n          allowControl={[userPlayer].filter(player => player)}\r\n          submit={this.submit}\r\n          challengeUser={this.challengeUser}\r\n          stopChallengeUser={this.stopChallengeUser}\r\n          challengedUser={challengedUser}\r\n          onSelectedGameChange={this.onSelectedGameChange}\r\n        >\r\n          <Responsive as={Grid.Row} minWidth={800}>\r\n            {gamesNode}\r\n          </Responsive>\r\n        </Play>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChosenOnlineGame.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  game: PropTypes.object,\r\n};\r\n\r\nChosenOnlineGame = withRouter(withClient(ChosenOnlineGame));\r\n\r\nclass OnlineGame extends Component {\r\n  gameGameSelector = createSelector([\r\n    props => props.game,\r\n  ], game => game ? Game.deserialize(game.game) : null);\r\n\r\n  get gameGame() {\r\n    return this.gameGameSelector(this.props);\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      selectLiveGame, game, client, user, usersInfo: {byId},\r\n      gamesInfo: {games, myLive, otherLive, myFinished, otherFinished},\r\n      tournamentsInfo: {byId: tournamentsById},\r\n    } = this.props;\r\n    if (!Object.values(byId).length) {\r\n      return null;\r\n    }\r\n    const gameGame = this.gameGame;\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Segment>\r\n            <Tab menu={{pointing: true}} panes={[\r\n              {key: 'my-live', label: \"My Live games\", items: myLive, color: 'green'},\r\n              {key: 'other-live', label: \"Other Live games\", items: otherLive, color: 'green'},\r\n              {key: 'my-past', label: \"My Past games\", items: myFinished},\r\n              {key: 'other-past', label: \"Other Past games\", items: otherFinished},\r\n              {key: 'all', label: \"All games\", items: games},\r\n            ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                <GameList\r\n                  user={user}\r\n                  usersById={byId}\r\n                  tournamentsById={tournamentsById}\r\n                  games={items}\r\n                  selectLiveGame={selectLiveGame}\r\n                  applicableSettings={client.applicableSettings}\r\n                />\r\n              )}\r\n            ))} />\r\n          </Segment>\r\n        </Route>\r\n        <Route path={`${this.props.match.path}/:id`}>\r\n          <ChosenOnlineGame game={game} gameGame={gameGame} selectLiveGame={selectLiveGame} />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineGame.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  game: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(OnlineGame));\r\n","import notifications from './notifications';\r\n\r\nexport default {\r\n  notifications,\r\n};\r\n","import {client} from \"../client/client\";\r\n\r\nclass Notifications {\r\n  async requestPermission() {\r\n    if (window.Notification && window.Notification.permission !== 'denied') {\r\n      await window.Notification.requestPermission();\r\n    }\r\n  }\r\n\r\n  async notify() {\r\n    if (!client.applicableSettings.enableNotifications) {\r\n      return;\r\n    }\r\n    await this.requestPermission();\r\n    if (window.Notification && window.Notification.permission === \"granted\") {\r\n      try {\r\n        new Notification(...arguments);\r\n      } catch (e) {\r\n        console.error(\"Could not send notification\", e);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst notifications = new Notifications();\r\n\r\nexport default notifications;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport _ from 'lodash';\r\nimport classNames from 'classnames';\r\nimport {Button, Grid, Icon, Label, Menu, Modal, Segment, Statistic, Tab, Table} from \"semantic-ui-react\";\r\n\r\nimport {withClient} from \"../client/withClient\";\r\nimport {NavLink, Route, Switch, withRouter} from \"react-router-dom\";\r\nimport * as utils from \"../utils\";\r\nimport HashedIcon from \"./HashedIcon\";\r\n// import TournamentList from \"./TournamentList\";\r\nimport {GameCard} from \"./GameList\";\r\nimport {createSelector} from \"reselect\";\r\nimport '../styles/tournament.css';\r\nimport CreateTournament from \"./CreateTournament\";\r\nimport TournamentList from \"./TournamentList\";\r\n\r\nclass ChosenOnlineTournament extends Component {\r\n  tournamentSelector = createSelector([\r\n    props => props.match.params.id,\r\n    props => props.tournamentsInfo.byId,\r\n  ], (tournamentId, tournamentsById) => tournamentsById[tournamentId]);\r\n\r\n  get tournament() {\r\n    return this.tournamentSelector(this.props);\r\n  }\r\n\r\n  dismissUrlTournamentError = () => {\r\n    this.props.selectLiveTournament(null);\r\n  };\r\n\r\n  componentDidMount() {\r\n    const {tournament} = this;\r\n    if (tournament) {\r\n      this.props.selectLiveTournament(tournament);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const {tournament} = this;\r\n    if (tournament) {\r\n      this.props.selectLiveTournament(tournament);\r\n    }\r\n  }\r\n\r\n  close = () => {\r\n    this.props.selectLiveTournament(null);\r\n  };\r\n\r\n  shareTournament = e => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const {tournament} = this;\r\n      navigator.share({\r\n        title: `Thyra Online - ${tournament.started ? (tournament.finished ? 'Past' : 'Live') : 'Future'} tournament ${tournament.name}`,\r\n        text: `${tournament.started ? (tournament.finished ? 'Review Past' : 'Watch Live') : 'Future'} Santorini tournament ${tournament.name}`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  toggleParticipation = () => {\r\n    const {tournament} = this;\r\n    this.props.toggleParticipation(tournament);\r\n  };\r\n\r\n  startTournament = () => {\r\n    const {tournament} = this;\r\n    this.props.startTournament(tournament);\r\n  };\r\n\r\n  abortTournament = () => {\r\n    const {tournament} = this;\r\n    this.props.abortTournament(tournament);\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      location, client, user, selectLiveGame,\r\n      usersInfo: {byId: usersById}, gamesInfo: {byId: gamesById}, tournamentsInfo,\r\n    } = this.props;\r\n    const {byId: tournamentsById} = tournamentsInfo;\r\n    const {tournament} = this;\r\n\r\n    if (!tournament) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlTournamentError}\r\n            header={'Could not find tournament'}\r\n            content={'This tournament cannot be found. Please check that you copied the full URL, or perhaps the tournament was aborted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find tournament\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const players = _.orderBy(tournament.userIds.map(otherUserId => usersById[otherUserId]), [\r\n      user => tournament.userStats ? tournament.userStats[user.id].points : 0,\r\n      user => tournament.userStats ? tournament.userStats[user.id].initialScore.score : 0,\r\n      'id',\r\n    ], ['desc', 'desc', 'desc']);\r\n    const isMyTournament = user ? tournament.userIds.includes(user.id) : false;\r\n    const didUserCreated = user ? tournament.creatorUserId === user.id : false;\r\n\r\n    return (\r\n      <Fragment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} inverted items={[\r\n              {key: 'close', content: 'Close', icon: 'x', onClick: this.close, color: 'red', active: true},\r\n              {key: 'share', content: 'Share Tournament', icon: 'share', onClick: this.shareTournament, as: NavLink,\r\n                to: location.pathname, color: 'green', active: true,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to tournament'},\r\n            ]} />\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Segment>\r\n          <Statistic.Group widths={\"three\"} size={\"tiny\"}>\r\n            <Statistic\r\n              value={tournament.started ? (tournament.finished ? 'Finished' : `${tournament.round}/${tournament.rounds}`) : 'Waiting'}\r\n              label={tournament.started ? (tournament.finished ? 'Status' : 'Rounds') : 'Status'}\r\n            />\r\n            <Statistic\r\n              value={tournament.userIds.length}\r\n              label={'Users'}\r\n            />\r\n            <Statistic\r\n              value={tournament.gameCount}\r\n              label={'Games between each pair'}\r\n            />\r\n          </Statistic.Group>\r\n          <Grid columns={'equal'}>\r\n            <Grid.Column textAlign={'left'}><Button negative onClick={this.close}>Close</Button></Grid.Column>\r\n            <Grid.Column>\r\n              <Button\r\n                positive\r\n                icon\r\n                onClick={this.shareTournament}\r\n                style={{width: '100%'}}\r\n                as={NavLink}\r\n                to={location.pathname}\r\n                title={navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to tournament'}\r\n              >\r\n                <Icon name={'share'}/> Share Tournament\r\n              </Button>\r\n            </Grid.Column>\r\n          </Grid>\r\n        </Segment>\r\n        {!tournament.started ? (\r\n          <Segment>\r\n            <Grid columns={'equal'}>\r\n              <Grid.Column textAlign={'left'}>\r\n                <Button\r\n                  disabled={tournament.started}\r\n                  style={{width: '100%'}}\r\n                  color={isMyTournament ? 'yellow' : 'green'}\r\n                  onClick={this.toggleParticipation}\r\n                >\r\n                  {tournament.started ? null : <Icon name={isMyTournament ? 'hourglass' : 'play'} />}\r\n                  {isMyTournament ? 'Participating' : (\r\n                    tournament.started ? (\r\n                      tournament.finished ? 'Tournament finished' : 'Tournament started'\r\n                    ) : 'Join the tournament'\r\n                  )}\r\n                </Button>\r\n              </Grid.Column>\r\n              <Grid.Column>\r\n                <Button\r\n                  disabled={!didUserCreated || players.length < 2 || tournament.started}\r\n                  positive\r\n                  icon\r\n                  onClick={this.startTournament}\r\n                  style={{width: '100%'}}\r\n                  color={players.length >= 2 ? (didUserCreated ? 'green' : 'yellow') : 'yellow'}\r\n                >\r\n                  {tournament.finished  ? null : (\r\n                    <Icon name={players.length >= 2 ? (didUserCreated ? 'play' : 'hourglass') : 'play'}/>\r\n                  )}\r\n                  {tournament.started ? (\r\n                    tournament.finished ? 'Finished' : 'Started'\r\n                  ) : (\r\n                    players.length >= 2 ? (\r\n                      didUserCreated ? 'Start tournament' : 'Waiting for tournament to start'\r\n                    ) : 'Needs at least participants'\r\n                  )}\r\n                </Button>\r\n              </Grid.Column>\r\n            </Grid>\r\n          </Segment>\r\n        ) : null }\r\n        <Segment>\r\n          {tournament.started ? (\r\n            <Tab menu={{pointing: true, attached: false}} panes={[\r\n              {menuItem: 'Rankings', render: () => (\r\n                <Table celled collapsing unstackable>\r\n                  <Table.Header>\r\n                    <Table.Row>\r\n                      {tournament.finished ? <Table.HeaderCell> </Table.HeaderCell> : null}\r\n                      <Table.HeaderCell>Rank</Table.HeaderCell>\r\n                      <Table.HeaderCell>User</Table.HeaderCell>\r\n                      <Table.HeaderCell>Score (TB)</Table.HeaderCell>\r\n                      <Table.HeaderCell>Expected Score</Table.HeaderCell>\r\n                      {tournament.started && !tournament.finished ? <Table.HeaderCell>Game</Table.HeaderCell> : null}\r\n                      {tournament.finished ? <Table.HeaderCell>Score difference</Table.HeaderCell> : null}\r\n                    </Table.Row>\r\n                  </Table.Header>\r\n                  <Table.Body>\r\n                    {players.map(player => {\r\n                      const stats = tournament.userStats[player.id];\r\n                      return (\r\n                        <Table.Row key={player.id}>\r\n                          {tournament.finished ? (\r\n                            <Table.Cell>{stats.rank <= 3 ? (\r\n                              <Icon\r\n                                name={{1: 'trophy', 2: 'certificate', 3: 'certificate'}[stats.rank]}\r\n                                color={{1: 'yellow', 2: 'grey', 3: 'brown'}[stats.rank]}\r\n                              />\r\n                            ) : null}</Table.Cell>\r\n                          ) : null}\r\n                          <Table.Cell>{stats.rank}</Table.Cell>\r\n                          <Table.Cell>\r\n                            <HashedIcon floated={'left'} size={'mini'} hash={player.id} />\r\n                            {player.name}\r\n                          </Table.Cell>\r\n                          <Table.Cell>{stats.points === stats.ratedPoints ? stats.points : `${stats.ratedPoints} (${stats.points})`}</Table.Cell>\r\n                          <Table.Cell>{stats.initialScore.expectedPoints.toFixed(1)}</Table.Cell>\r\n                          {tournament.started && !tournament.finished ? (\r\n                            <Table.Cell>{stats.waitingForNextRound ? 'Waiting for next round' : (\r\n                              stats.currentGameId ? (\r\n                                <GameCard\r\n                                  user={null}\r\n                                  usersById={usersById}\r\n                                  tournamentsById={tournamentsById}\r\n                                  game={gamesById[stats.currentGameId]}\r\n                                  selectLiveGame={selectLiveGame}\r\n                                  terse\r\n                                  live\r\n                                  applicableSettings={client.applicableSettings}\r\n                                />\r\n                              ) : 'Finished'\r\n                            )}</Table.Cell>\r\n                          ) : null}\r\n                          {tournament.finished ? (\r\n                            <Table.Cell>{stats.scoreDifference > 0 ? `+${stats.scoreDifference}` : stats.scoreDifference}</Table.Cell>\r\n                          ) : null}\r\n                        </Table.Row>\r\n                      );\r\n                    })}\r\n                  </Table.Body>\r\n                </Table>\r\n              )},\r\n              {menuItem: 'Games', render: () => (\r\n                <Table celled collapsing unstackable>\r\n                  <Table.Header>\r\n                    <Table.Row>\r\n                      <Table.HeaderCell colSpan={2}>White</Table.HeaderCell>\r\n                      <Table.HeaderCell colSpan={2}>Black</Table.HeaderCell>\r\n                      <Table.HeaderCell>Game</Table.HeaderCell>\r\n                    </Table.Row>\r\n                  </Table.Header>\r\n                  {tournament.schedule.map((round, roundIndex) => (\r\n                    <Fragment key={roundIndex}>\r\n                      <Table.Header>\r\n                        <Table.Row>\r\n                          <Table.HeaderCell colSpan={5}>{round.type === 'playoff' ? 'Playoffs - ' : null}Round {round.round}</Table.HeaderCell>\r\n                        </Table.Row>\r\n                      </Table.Header>\r\n                      <Table.Body>\r\n                        {round.pairings.map(({userIds: [playerAId, playerBId], gameId}, gameIndex) => {\r\n                          const game = gamesById[gameId];\r\n                          const playerAWon = game && game.finished && game.winnerUserId === playerAId;\r\n                          const playerBWon = game && game.finished && game.winnerUserId === playerBId;\r\n                          return (\r\n                            <Table.Row key={gameIndex}>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-a', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {playerAId ? (\r\n                                  <Fragment>\r\n                                    <HashedIcon floated={'left'} size={'mini'} hash={playerAId} />\r\n                                    {usersById[playerAId].name}\r\n                                  </Fragment>\r\n                                ) : 'Sitting out this round'}\r\n                              </Table.Cell>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-a', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {game && game.finished ? (game.winnerUserId === playerAId ? '1' : '0') : '-'}\r\n                              </Table.Cell>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-b', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {playerBId ? (\r\n                                  <Fragment>\r\n                                    <HashedIcon floated={'left'} size={'mini'} hash={playerBId} />\r\n                                    {usersById[playerBId].name}\r\n                                  </Fragment>\r\n                                ) : 'Sitting out this round'}\r\n                              </Table.Cell>\r\n                              <Table.Cell className={classNames('tournament-game', 'player-b', {'player-a-won': playerAWon, 'player-b-won': playerBWon})}>\r\n                                {game && game.finished ? (game.winnerUserId === playerBId ? '1' : '0') : '-'}\r\n                              </Table.Cell>\r\n                              <Table.Cell>\r\n                                {playerAId && playerBId ? (\r\n                                  game ? (\r\n                                    <GameCard\r\n                                      user={null}\r\n                                      usersById={usersById}\r\n                                      tournamentsById={tournamentsById}\r\n                                      game={game}\r\n                                      selectLiveGame={selectLiveGame}\r\n                                      terse\r\n                                      live\r\n                                      applicableSettings={client.applicableSettings}\r\n                                    />\r\n                                  ) : 'Not started yet'\r\n                                ) : null}\r\n                              </Table.Cell>\r\n                            </Table.Row>\r\n                          )\r\n                        })}\r\n                      </Table.Body>\r\n                    </Fragment>\r\n                  ))}\r\n                </Table>\r\n              )},\r\n            ]} />\r\n          ) : (\r\n            <Table celled collapsing unstackable>\r\n              <Table.Header>\r\n                <Table.Row>\r\n                  <Table.HeaderCell>User</Table.HeaderCell>\r\n                  <Table.HeaderCell>Rating</Table.HeaderCell>\r\n                </Table.Row>\r\n              </Table.Header>\r\n              <Table.Body>\r\n                {players.map(player => (\r\n                  <Table.Row key={player.id}>\r\n                    <Table.Cell>\r\n                      <HashedIcon floated={'left'} size={'mini'} hash={player.id} />\r\n                      {player.name}\r\n                    </Table.Cell>\r\n                    <Table.Cell>{player.score}</Table.Cell>\r\n                  </Table.Row>\r\n                ))}\r\n              </Table.Body>\r\n            </Table>\r\n          )}\r\n        </Segment>\r\n        {didUserCreated && !tournament.started ? (\r\n          <Segment>\r\n            <Grid columns={'equal'}>\r\n              <Grid.Column textAlign={'left'}>\r\n              </Grid.Column>\r\n              <Grid.Column>\r\n                <Modal\r\n                  size={'mini'}\r\n                  trigger={\r\n                    <Button\r\n                      disabled={!didUserCreated}\r\n                      negative\r\n                      icon\r\n                      style={{width: '100%'}}\r\n                    >\r\n                      <Icon name={'stop'}/>\r\n                      {'Abort tournament'}\r\n                    </Button>\r\n                  }\r\n                  header={'Abort tournament'}\r\n                  content={'Are you sure you want to abort the tournament?'}\r\n                  actions={[\r\n                    {key: 'yes', content: 'Abort', onClick: this.abortTournament, negative: true},\r\n                    {key: 'no', content: 'No, keep tournament', secondary: true},\r\n                  ]}\r\n                />\r\n              </Grid.Column>\r\n            </Grid>\r\n          </Segment>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChosenOnlineTournament.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  location: PropTypes.object.isRequired,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  tournament: PropTypes.object,\r\n  toggleParticipation: PropTypes.func.isRequired,\r\n  startTournament: PropTypes.func.isRequired,\r\n  abortTournament: PropTypes.func.isRequired,\r\n};\r\n\r\nChosenOnlineTournament = withRouter(withClient(ChosenOnlineTournament));\r\n\r\nclass OnlineTournament extends Component {\r\n  render() {\r\n    const {\r\n      selectLiveGame, selectLiveTournament, toggleParticipation, startTournament, abortTournament, tournament, user,\r\n      usersInfo: {byId: usersById}, tournamentsInfo,\r\n    } = this.props;\r\n    if (!Object.values(usersById).length) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Segment>\r\n            <CreateTournament />\r\n            <br/><br/>\r\n            <Tab menu={{pointing: true}} panes={[\r\n              {key: 'my-live', label: \"My Future & Running tournaments\", items: tournamentsInfo.myFutureAndLive, color: 'green'},\r\n              {key: 'other-live', label: \"Other Future and Running tournaments\", items: tournamentsInfo.otherFutureAndLive, color: 'green'},\r\n              {key: 'my-past', label: \"My Past tournaments\", items: tournamentsInfo.myFinished},\r\n              {key: 'other-past', label: \"Other Past tournaments\", items: tournamentsInfo.otherFinished},\r\n            ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                <TournamentList\r\n                  user={user}\r\n                  usersById={usersById}\r\n                  tournaments={items}\r\n                  selectLiveTournament={selectLiveTournament}\r\n                />\r\n              )}\r\n            ))} />\r\n          </Segment>\r\n        </Route>\r\n        <Route path={`${this.props.match.path}/:id`}>\r\n          <ChosenOnlineTournament\r\n            tournament={tournament}\r\n            selectLiveGame={selectLiveGame}\r\n            selectLiveTournament={selectLiveTournament}\r\n            toggleParticipation={toggleParticipation}\r\n            startTournament={startTournament}\r\n            abortTournament={abortTournament}\r\n          />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nOnlineTournament.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  tournament: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  usersInfo: PropTypes.object.isRequired,\r\n  gamesInfo: PropTypes.object.isRequired,\r\n  tournamentsInfo: PropTypes.object.isRequired,\r\n  selectLiveGame: PropTypes.func.isRequired,\r\n  selectLiveTournament: PropTypes.func.isRequired,\r\n  toggleParticipation: PropTypes.func.isRequired,\r\n  startTournament: PropTypes.func.isRequired,\r\n  abortTournament: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(OnlineTournament));\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Grid, Label, Menu, Message} from \"semantic-ui-react\";\r\nimport BoardBackground from \"./Board/BoardBackground\";\r\nimport Game from \"../game/game\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nclass LearnBoard extends Component {\r\n  state = {\r\n    rowsAndColumns: this.props.rowsAndColumns,\r\n    arrows: null,\r\n    selectedMoveCell: null,\r\n    movedFromCell: null,\r\n    selectedBuildCell: null,\r\n    won: false,\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.rowsAndColumns !== this.props.rowsAndColumns) {\r\n      this.reset();\r\n    }\r\n  }\r\n\r\n  isCellAvailable = cell => {\r\n    const {canMove, canBuild} = this.props;\r\n    if (!canMove && !canBuild) {\r\n      return false;\r\n    }\r\n    const {selectedMoveCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return false;\r\n    }\r\n    if (canMove && !canBuild) {\r\n      return this.isCellAvailableForMoving(cell, selectedMoveCell);\r\n    } else if (canBuild && !canMove) {\r\n      return this.isCellAvailableForBuilding(cell, selectedBuildCell);\r\n    } else if (canMove && canBuild) {\r\n      if (!selectedMoveCell && !selectedBuildCell) {\r\n        return this.isCellAvailableForMoving(cell, selectedMoveCell);\r\n      } else if (selectedMoveCell) {\r\n        return this.isCellAvailableForMoving(cell, selectedMoveCell);\r\n      } else if (selectedBuildCell) {\r\n        return this.isCellAvailableForBuilding(cell, selectedBuildCell);\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  isCellAvailableForMoving(cell, selectedMoveCell) {\r\n    if (!selectedMoveCell) {\r\n      return cell.player === Game.PLAYER_A;\r\n    }\r\n    if (selectedMoveCell.level === 3) {\r\n      return false;\r\n    }\r\n    if (Math.max(Math.abs(cell.x - selectedMoveCell.x), Math.abs(cell.y - selectedMoveCell.y)) !== 1) {\r\n      return false;\r\n    }\r\n    if ((cell.level - selectedMoveCell.level) > 1) {\r\n      return false;\r\n    }\r\n    if (cell.player) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  isCellAvailableForBuilding(cell, selectedBuildCell) {\r\n    if (!selectedBuildCell) {\r\n      return cell.player === Game.PLAYER_A;\r\n    }\r\n    if (Math.max(Math.abs(cell.x - selectedBuildCell.x), Math.abs(cell.y - selectedBuildCell.y)) !== 1) {\r\n      return false;\r\n    }\r\n    if (cell.level > 3) {\r\n      return false;\r\n    }\r\n    if (cell.player) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  makeMove = cell => {\r\n    const {selectedMoveCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return;\r\n    }\r\n    const {canMove, canBuild} = this.props;\r\n    if (canMove && !canBuild) {\r\n      this.makeMoveMoving(cell, selectedMoveCell);\r\n    } else if (canBuild && !canMove) {\r\n      this.makeMoveBuilding(cell, selectedBuildCell);\r\n    } else if (canMove && canBuild) {\r\n      if (!selectedMoveCell && !selectedBuildCell) {\r\n        this.makeMoveMoving(cell, selectedMoveCell);\r\n      } else if (selectedMoveCell) {\r\n        this.makeMoveMoving(cell, selectedMoveCell);\r\n        if (cell.level !== 3) {\r\n          this.setState({movedFromCell: selectedMoveCell});\r\n          this.makeMoveBuilding(cell, selectedBuildCell);\r\n        }\r\n      } else if (selectedBuildCell) {\r\n        this.makeMoveBuilding(cell, selectedBuildCell);\r\n        this.setState({movedFromCell: null});\r\n      }\r\n    }\r\n  };\r\n\r\n  makeMoveMoving(cell, selectedMoveCell) {\r\n    if (selectedMoveCell) {\r\n      this.setState(({rowsAndColumns}) => ({\r\n        selectedMoveCell: null,\r\n        rowsAndColumns: Game.updateCells(rowsAndColumns, ...[\r\n          {x: selectedMoveCell.x, y: selectedMoveCell.y, player: null, worker: null},\r\n          {x: cell.x, y: cell.y, player: selectedMoveCell.player, worker: selectedMoveCell.worker},\r\n        ]),\r\n        arrows: [\r\n          {from: selectedMoveCell, to: cell, type: 'move', colour: 'white'},\r\n        ],\r\n        won: cell.level === 3,\r\n      }));\r\n    } else {\r\n      this.setState({selectedMoveCell: cell});\r\n    }\r\n  }\r\n\r\n  makeMoveUndoMoving(movedFromCell, selectedBuildCell) {\r\n    this.setState(({rowsAndColumns}) => ({\r\n      selectedMoveCell: movedFromCell,\r\n      selectedBuildCell: null,\r\n      rowsAndColumns: Game.updateCells(rowsAndColumns, ...[\r\n        {x: selectedBuildCell.x, y: selectedBuildCell.y, player: null, worker: null},\r\n        {x: movedFromCell.x, y: movedFromCell.y, player: movedFromCell.player, worker: movedFromCell.worker},\r\n      ]),\r\n      arrows: null,\r\n      won: false,\r\n    }));\r\n  }\r\n\r\n  makeMoveBuilding(cell, selectedBuildCell) {\r\n    if (selectedBuildCell) {\r\n      this.setState(({rowsAndColumns}) => ({\r\n        selectedBuildCell: null,\r\n        rowsAndColumns: Game.updateCells(rowsAndColumns, {\r\n          x: cell.x, y: cell.y, level: rowsAndColumns[cell.y].cells[cell.x].level + 1,\r\n        }),\r\n        arrows: [\r\n          {from: selectedBuildCell, to: cell, type: 'build', colour: 'white'},\r\n        ],\r\n      }));\r\n    } else {\r\n      this.setState({selectedBuildCell: cell});\r\n    }\r\n  }\r\n\r\n  isCellUndoable = cell => {\r\n    if (!this.props.canMove && !this.props.canBuild) {\r\n      return false;\r\n    }\r\n    const {selectedMoveCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return false;\r\n    }\r\n    const {canMove, canBuild} = this.props;\r\n    if (canMove && !canBuild) {\r\n      return selectedMoveCell !== null && selectedMoveCell.x === cell.x && selectedMoveCell.y === cell.y;\r\n    } else if (canBuild && !canMove) {\r\n      return selectedBuildCell !== null && selectedBuildCell.x === cell.x && selectedBuildCell.y === cell.y;\r\n    } else if (canMove && canBuild) {\r\n      if (selectedMoveCell) {\r\n        return selectedMoveCell.x === cell.x && selectedMoveCell.y === cell.y;\r\n      } else if (selectedBuildCell) {\r\n        return selectedBuildCell.x === cell.x && selectedBuildCell.y === cell.y;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  undo = () => {\r\n    const {canMove, canBuild} = this.props;\r\n    const {selectedMoveCell, movedFromCell, selectedBuildCell, won} = this.state;\r\n    if (won) {\r\n      return;\r\n    }\r\n    if (canMove && !canBuild) {\r\n      this.setState({selectedMoveCell: null});\r\n    } else if (canBuild && !canMove) {\r\n      this.setState({selectedBuildCell: null});\r\n    } else if (canMove && canBuild) {\r\n      if (selectedMoveCell) {\r\n        this.setState({selectedMoveCell: null});\r\n      } else if (selectedBuildCell) {\r\n        this.makeMoveUndoMoving(movedFromCell, selectedBuildCell);\r\n      }\r\n    }\r\n  };\r\n\r\n  reset = () => {\r\n    const {rowsAndColumns} = this.props;\r\n    this.setState({\r\n      rowsAndColumns, arrows: null, won: false, selectedMoveCell: null, movedFromCell: null, selectedBuildCell: null,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {client, board, canMove, canBuild, rowsAndColumns: originalRowsAndColumns} = this.props;\r\n    const {rowsAndColumns, arrows, won, selectedMoveCell, selectedBuildCell} = this.state;\r\n    const rawSettings = client.applicableSettings;\r\n    const settings = {...rawSettings, theme: {...rawSettings.theme, numbers: 'obvious'}};\r\n\r\n    return (\r\n      <Fragment>\r\n        {canMove || canBuild ? (\r\n          <Fragment>\r\n            <br />\r\n            <Label color={won ? 'green' : 'blue'} icon={won ? 'trophy' : undefined} content={(\r\n              won ? \"You won! Press reset to start again\" : (\r\n                !selectedMoveCell && !selectedBuildCell ? \"Select one of your pieces\" : (\r\n                  selectedMoveCell ? \"Select a square to move to, or click on your piece to do something else\" : (\r\n                    \"Select a square to build on, or click on your piece to do something else\"\r\n                  )\r\n                )\r\n              )\r\n            )} />\r\n            <br />\r\n          </Fragment>\r\n        ) : null}\r\n        <BoardBackground\r\n          medium\r\n          allowControl={[]}\r\n          clickable={canMove || canBuild}\r\n          undoable={canMove || canBuild}\r\n          isCellAvailable={this.isCellAvailable}\r\n          isCellUndoable={this.isCellUndoable}\r\n          makeMove={this.makeMove}\r\n          undo={this.undo}\r\n          settings={settings}\r\n          animated showArrows\r\n          rowsAndColumns={rowsAndColumns}\r\n          {...(arrows ? {...board, arrows} : board)}\r\n        />\r\n        {canMove || canBuild ? (\r\n          <div>\r\n            <Button onClick={this.reset} disabled={rowsAndColumns === originalRowsAndColumns} primary>Reset</Button>\r\n          </div>\r\n        ) : null}\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nLearnBoard.propTypes = {\r\n  user: PropTypes.object,\r\n  board: PropTypes.object,\r\n  rowsAndColumns: PropTypes.array.isRequired,\r\n  canMove: PropTypes.bool.isRequired,\r\n  canBuild: PropTypes.bool.isRequired,\r\n};\r\n\r\nLearnBoard.defaultProps = {\r\n  canMove: false,\r\n  canBuild: false,\r\n};\r\n\r\nLearnBoard = withClient(LearnBoard);\r\n\r\nclass LearnToPlay extends Component {\r\n  static steps = [\r\n    {title: 'Introduction', body: <Fragment>\r\n      <div>\r\n        In this website, you can play <strong>Santorini©</strong> games with people around the world.\r\n      </div>\r\n      <div>\r\n        The board consists of a <strong>5x5 square grid</strong>, and each player, <strong>black</strong>{\" and \"}\r\n        <strong>white</strong>, has two <strong>pieces</strong> each:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <div>\r\n        The <strong>objective</strong> of the game is to move one of your pieces to the <strong>3rd level</strong>,\r\n        and of course, to <strong>prevent your opponent</strong> from doing so before you:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 3, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 0}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 0}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Moving', body: <Fragment>\r\n      <div>\r\n        You can <strong>move 1 square</strong> in any direction, <strong>horizontally</strong>,\r\n        <strong>vertically</strong>, or <strong>diagonally</strong>.\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        But you <strong>can't move in a square that has another piece</strong>, your's or the opponent's:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Beneath, you can <strong>try moving your pieces</strong>. Notice that you need to <strong>click on a piece to\r\n        select it</strong>, and then <strong>click on the target square</strong> to move it.\r\n        To <strong>deselect</strong> a selected piece <strong>click on it again</strong>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        canMove\r\n      />\r\n    </Fragment>},\r\n    {title: 'Levels', body:<Fragment>\r\n      <div>\r\n        In the game there are <strong>five levels</strong>: <Label color={'green'}>ground</Label>,\r\n        <Label color={'grey'}>level 1</Label>, <Label color={'yellow'}>level 2</Label>,\r\n        <Label color={'red'}>level 3</Label>, and the <Label color={'blue'}>blocked level (level 4)</Label>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n            {x: 2, y: 0, level: 2, player: null, worker: null},\r\n            {x: 3, y: 0, level: 3, player: null, worker: null},\r\n            {x: 4, y: 0, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <div>\r\n        You can go <strong>up one level</strong>, go <strong>down any number of levels</strong>, and <strong>move to\r\n        the same level</strong>. You can <strong>never move to a blocked level</strong>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'move', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Try it yourself below:\r\n      </div>\r\n      <LearnBoard\r\n        canMove\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 2, player: null, worker: null},\r\n            {x: 2, y: 0, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 1, player: null, worker: null},\r\n            {x: 1, y: 2, level: 1, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Building', body:<Fragment>\r\n      <div>\r\n        After you've moved one of your pieces, you <strong>must build on 1 nearby square</strong>, horizontally,\r\n        vertically, or diagonally:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 2}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        You can <strong>build at any square</strong> next to the piece you moved: it <strong>doesn't matter which\r\n        level your are</strong>, and which level you want to build. But you can never build more than the blocked\r\n        level:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n            {x: 2, y: 0, level: 2, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 2, player: null, worker: null},\r\n            {x: 1, y: 2, level: 3, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 0}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 2}, type: 'build', colour: 'white'},\r\n            {from: {x: 1, y: 1}, to: {x: 1, y: 2}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Try it yourself below, by selecting your player and then building:\r\n      </div>\r\n      <LearnBoard\r\n        canBuild\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 1, player: null, worker: null},\r\n            {x: 2, y: 0, level: 2, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 3, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 2, player: null, worker: null},\r\n            {x: 1, y: 2, level: 3, player: null, worker: null},\r\n            {x: 2, y: 2, level: 4, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Winning', body:<Fragment>\r\n      <div>\r\n        If there was no opponent on the board (you wish!), you would do something like the following\r\n        moves <strong>to win</strong>:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 2, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 2, y: 1}, to: {x: 1, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 2, y: 1}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 1, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <br/>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 1, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: null, worker: null},\r\n            {x: 1, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 2, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 1, y: 1}, to: {x: 0, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 1, level: 3, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'build', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      {/*<br/>*/}\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 2, player: null, worker: null},\r\n            {x: 1, y: 1, level: 3, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n        board={{\r\n          arrows: [\r\n            {from: {x: 0, y: 1}, to: {x: 1, y: 1}, type: 'move', colour: 'white'},\r\n          ],\r\n        }}\r\n      />\r\n      <div>\r\n        Why don't you try this below?\r\n      </div>\r\n      <LearnBoard\r\n        canMove canBuild\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Good starting positions', body:<Fragment>\r\n      <div>\r\n        To start the game, the first player puts their pieces anywhere on the board, and then second player does the\r\n        same. Here are some good examples:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: null, worker: null},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: null, worker: null},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'Disadvantaged starting positions', body:<Fragment>\r\n      <div>\r\n        In these starting positions the both players have their pieces near the center, and they can move easily to\r\n        any square on the board. In contrast, these starting positions would probably put the black players at a\r\n        disadvantage, since his pieces are too far away from the opponent's:\r\n      </div>\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: null, worker: null},\r\n          ]},\r\n        ]}\r\n      />\r\n      <LearnBoard\r\n        rowsAndColumns={[\r\n          {y: 0, cells: [\r\n            {x: 0, y: 0, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n            {x: 1, y: 0, level: 0, player: null, worker: null},\r\n            {x: 2, y: 0, level: 0, player: null, worker: null},\r\n            {x: 3, y: 0, level: 0, player: null, worker: null},\r\n            {x: 4, y: 0, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 1, cells: [\r\n            {x: 0, y: 1, level: 0, player: null, worker: null},\r\n            {x: 1, y: 1, level: 0, player: null, worker: null},\r\n            {x: 2, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n            {x: 3, y: 1, level: 0, player: null, worker: null},\r\n            {x: 4, y: 1, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 2, cells: [\r\n            {x: 0, y: 2, level: 0, player: null, worker: null},\r\n            {x: 1, y: 2, level: 0, player: null, worker: null},\r\n            {x: 2, y: 2, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_SECOND},\r\n            {x: 3, y: 2, level: 0, player: null, worker: null},\r\n            {x: 4, y: 2, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 3, cells: [\r\n            {x: 0, y: 3, level: 0, player: null, worker: null},\r\n            {x: 1, y: 3, level: 0, player: null, worker: null},\r\n            {x: 2, y: 3, level: 0, player: null, worker: null},\r\n            {x: 3, y: 3, level: 0, player: null, worker: null},\r\n            {x: 4, y: 3, level: 0, player: null, worker: null},\r\n          ]},\r\n          {y: 4, cells: [\r\n            {x: 0, y: 4, level: 0, player: null, worker: null},\r\n            {x: 1, y: 4, level: 0, player: null, worker: null},\r\n            {x: 2, y: 4, level: 0, player: null, worker: null},\r\n            {x: 3, y: 4, level: 0, player: null, worker: null},\r\n            {x: 4, y: 4, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_SECOND},\r\n          ]},\r\n        ]}\r\n      />\r\n    </Fragment>},\r\n    {title: 'You\\'re ready to play!', body: <Fragment>\r\n      <div>\r\n        You're now ready to play! You can now <NavLink to={'./hotseat'}>play with a friend on the same\r\n        screen</NavLink> or play online <NavLink to={'./lobby'}>at the lobby</NavLink>.\r\n      </div>\r\n    </Fragment>}\r\n  ];\r\n\r\n  state = {\r\n    stepIndex: 0,\r\n  };\r\n\r\n  goToFirstStep = () => {\r\n    this.setState({stepIndex: 0});\r\n  };\r\n\r\n  goToPreviousStep = () => {\r\n    this.setState(state => ({stepIndex: state.stepIndex - 1}));\r\n  };\r\n\r\n  goToNextStep = () => {\r\n    this.setState(state => ({stepIndex: state.stepIndex + 1}));\r\n  };\r\n\r\n  goToLastStep = () => {\r\n    this.setState({stepIndex: this.constructor.steps.length - 1});\r\n  };\r\n\r\n  render() {\r\n    const {stepIndex} = this.state;\r\n    const steps = this.constructor.steps;\r\n    const step = steps[stepIndex];\r\n\r\n    return (\r\n      <Message>\r\n        <Message.Content>\r\n          <Grid columns={'equal'} verticalAlign={'middle'} textAlign={'center'}>\r\n            <Grid.Row>\r\n              <Menu size={'massive'} items={[\r\n                {key: 'first', icon: 'fast backward', onClick: this.goToFirstStep, disabled: stepIndex === 0},\r\n                {key: 'previous', icon: 'backward', onClick: this.goToPreviousStep, disabled: stepIndex === 0},\r\n                {key: 'next', icon: 'forward', onClick: this.goToNextStep, disabled: stepIndex === steps.length - 1},\r\n                {key: 'last', icon: 'fast forward', onClick: this.goToLastStep, disabled: stepIndex === steps.length - 1},\r\n              ]}/>\r\n            </Grid.Row>\r\n            <Grid.Row><Message.Header>{stepIndex + 1}.  {step.title}</Message.Header></Grid.Row>\r\n            <Grid.Row><Message content={<Fragment key={stepIndex}>{step.body}</Fragment>} /></Grid.Row>\r\n            <Grid.Row>\r\n              {stepIndex < steps.length - 1 ? (\r\n                <Button primary onClick={this.goToNextStep} icon={'forward'} content={'Go to next step'} />\r\n              ) : (\r\n                <Fragment>\r\n                  <Button positive as={NavLink} to={'/lobby'} icon={'play'} content={'Play with someone online'} />\r\n                  <Button positive as={NavLink} to={'/hotseat'} icon={'retweet'} content={'Play with a friend on the same screen'} />\r\n                </Fragment>\r\n              )}\r\n            </Grid.Row>\r\n          </Grid>\r\n        </Message.Content>\r\n      </Message>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LearnToPlay;\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport BoardBackground from \"./Board/BoardBackground\";\r\nimport Game from \"../game/game\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport {Button, Grid, Menu, Message, Modal, Segment} from \"semantic-ui-react\";\r\nimport keydown from \"react-keydown\";\r\nimport Play from \"./Play\";\r\nimport * as utils from \"../utils\";\r\n\r\nclass EditPosition extends Component {\r\n  static initialPositionNotation = Game.getPositionNotation(Game.getInitialRowsAndColumns());\r\n\r\n  state = {\r\n    paletteSelectedItem: {x: 0, y: 1},\r\n    paletteUpdate: {player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n    position: Game.getInitialRowsAndColumns(),\r\n    positionError: null,\r\n    urlError: false,\r\n    ...this.getGameAndErrorFromUrlPosition(),\r\n    selectedGame: null,\r\n    previousPosition: null,\r\n  };\r\n\r\n  getGameAndErrorFromUrlPosition() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const position = params.get('position') || this.props.initialPositionNotation;\r\n    if (position) {\r\n      let game, urlError;\r\n      try {\r\n        game = Game.fromCompressedPositionNotation(position);\r\n        if (!game) {\r\n          urlError = 'The position was not valid';\r\n        }\r\n      } catch (e) {\r\n        game = null;\r\n        urlError = `The board position was not valid: ${e.message}`;\r\n      }\r\n      if (!game) {\r\n        return {game: Game.create(), urlError, position: Game.getInitialRowsAndColumns()};\r\n      }\r\n      return {game, urlError: false, position: game.rowsAndColumns};\r\n    } else {\r\n      return {game: Game.create(), urlError: false, position: Game.getInitialRowsAndColumns()};\r\n    }\r\n  }\r\n\r\n  dismissUrlPositionError = () =>{\r\n    this.setState({error: null});\r\n  };\r\n\r\n  onPaletteSelectedItemChange = (paletteSelectedItem, paletteUpdate) => {\r\n    this.setState({paletteSelectedItem, paletteUpdate});\r\n  };\r\n\r\n  onPositionChange = position => {\r\n    let game, positionError;\r\n    try {\r\n      game = Game.fromPosition(position);\r\n      positionError = null;\r\n    } catch (e) {\r\n      game = Game.create();\r\n      positionError = e.message;\r\n    }\r\n    this.setState(state => ({\r\n      position,\r\n      game,\r\n      positionError,\r\n      previousPosition: state.position,\r\n    }));\r\n  };\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  onSelectedGameChange = selectedGame => {\r\n    this.setState({selectedGame});\r\n  };\r\n\r\n  copyGame = () => {\r\n    const {game, selectedGame} = this.state;\r\n    const visibleGame = selectedGame || game;\r\n    this.onPositionChange(visibleGame.rowsAndColumns);\r\n  };\r\n\r\n  resetBoard = () => {\r\n    this.onPositionChange(Game.getInitialRowsAndColumns());\r\n  };\r\n\r\n  undo = () => {\r\n    this.onPositionChange(this.state.previousPosition);\r\n  };\r\n\r\n  resetGame = () => {\r\n    this.onPositionChange(this.state.position);\r\n  };\r\n\r\n  copyPosition = () => {\r\n    utils.copyToClipboard(Game.getPositionNotation(this.state.position));\r\n    alert('Position copied to clipboard');\r\n  };\r\n\r\n  copyPlayPosition = () => {\r\n    utils.copyToClipboard((this.state.selectedGame || this.state.game).positionNotation);\r\n    alert('Play position copied to clipboard');\r\n  };\r\n\r\n  usePosition = () => {\r\n    this.props.usePosition(Game.fromPosition(this.state.position).positionNotation);\r\n  };\r\n\r\n  render() {\r\n    const {user, client, keydown, usePosition} = this.props;\r\n    const {paletteSelectedItem, position, paletteUpdate, positionError, urlError, game, selectedGame, previousPosition} = this.state;\r\n    const settings = client.applicableSettings;\r\n\r\n    const positionNotation = Game.getPositionNotation(position);\r\n    return (\r\n      <Fragment>\r\n        <Modal\r\n          open={!!urlError}\r\n          size={'mini'}\r\n          onClose={this.dismissUrlPositionError}\r\n          header={'Could not load shared position'}\r\n          content={`${urlError}. Please check that you copied the full URL`}\r\n          actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n        />\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu inverted size={'massive'} items={[\r\n              {key: 'share', icon: 'share', content: 'Share position', color: 'green', active: true, as: 'a',\r\n                href: `?position=${positionNotation}`,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to position'},\r\n              {key: 'copy', icon: 'clipboard', content: 'Copy position', color: 'green', active: true,\r\n                title: 'Click to copy position to position', onClick: this.copyPosition},\r\n              {key: 'copy-play', icon: 'clipboard', content: 'Copy play position', color: 'green', active: true,\r\n                title: 'Click to copy play position to position', onClick: this.copyPlayPosition},\r\n            ]} />\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Segment>\r\n          {positionError ? <Message error content={positionError} /> : null}\r\n          <Play\r\n            user={user}\r\n            settings={settings}\r\n            game={game}\r\n            makeMove={this.makeMove}\r\n            onSelectedGameChange={this.onSelectedGameChange}\r\n          >\r\n            <div>\r\n              <Button\r\n                content={'Reset game'}\r\n                primary\r\n                onClick={this.resetGame}\r\n              />\r\n            </div>\r\n            <EditPositionPalette\r\n              selectedItem={paletteSelectedItem}\r\n              onSelectedItemChange={this.onPaletteSelectedItemChange}\r\n              keydown={keydown}\r\n            />\r\n            <div>\r\n              <Button\r\n                content={'Copy from game'}\r\n                primary\r\n                disabled={(selectedGame || game).positionNotation === positionNotation}\r\n                onClick={this.copyGame}\r\n              />\r\n              <Button\r\n                content={'Reset'}\r\n                negative\r\n                disabled={positionNotation === this.constructor.initialPositionNotation}\r\n                onClick={this.resetBoard}\r\n              />\r\n              <Button\r\n                content={'Undo'}\r\n                secondary\r\n                disabled={!previousPosition}\r\n                onClick={this.undo}\r\n              />\r\n            </div>\r\n            <EditPositionBoard\r\n              position={position}\r\n              update={paletteUpdate}\r\n              onPositionChange={this.onPositionChange}\r\n            />\r\n            {usePosition ? (\r\n              <div>\r\n                <Button\r\n                  content={'Use position'}\r\n                  primary\r\n                  onClick={this.usePosition}\r\n                  disabled={!!positionError}\r\n                />\r\n              </div>\r\n            ) : null}\r\n          </Play>\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nEditPosition.propTypes = {\r\n  keydown: PropTypes.object.isRequired,\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  usePosition: PropTypes.func,\r\n  initialPositionNotation: PropTypes.string,\r\n};\r\n\r\nclass EditPositionPalette extends Component {\r\n  static rowsAndColumns = [\r\n    {y: 0, cells: [\r\n      {x: 0, y: 0, level: 0, player: null, worker: null},\r\n      {x: 1, y: 0, level: 1, player: null, worker: null},\r\n      {x: 2, y: 0, level: 2, player: null, worker: null},\r\n      {x: 3, y: 0, level: 3, player: null, worker: null},\r\n      {x: 4, y: 0, level: 4, player: null, worker: null},\r\n    ]},\r\n    {y: 1, cells: [\r\n      {x: 0, y: 1, level: 0, player: Game.PLAYER_A, worker: Game.WORKER_FIRST},\r\n      {x: 1, y: 1, level: 0, player: Game.PLAYER_B, worker: Game.WORKER_FIRST},\r\n      {x: 2, y: 1, level: 0, player: null, worker: null},\r\n      {x: 3, y: 1, level: 0, player: null, worker: null},\r\n      {x: 4, y: 1, level: 0, player: null, worker: null},\r\n    ]},\r\n  ];\r\n  static keys = [\r\n    'q', '0', '1', '2', '3', '4', 'a', 'b',\r\n  ];\r\n  static moveFromKey = {\r\n    'q': {x: 0, y: 0},\r\n    0: {x: 0, y: 0},\r\n    1: {x: 1, y: 0},\r\n    2: {x: 2, y: 0},\r\n    3: {x: 3, y: 0},\r\n    4: {x: 4, y: 0},\r\n    a: {x: 0, y: 1},\r\n    b: {x: 1, y: 1},\r\n  };\r\n\r\n  state = {\r\n    selectedItem: {x: 0, y: 1},\r\n  };\r\n\r\n  componentWillReceiveProps({keydown}) {\r\n    if (keydown.event) {\r\n      const {key} = keydown.event;\r\n      const coordinates = this.constructor.moveFromKey[key];\r\n      if (coordinates) {\r\n        const {x, y} = coordinates;\r\n        const move = this.constructor.rowsAndColumns[y].cells[x];\r\n        this.makeMove(move);\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.selectedItem !== undefined && this.props.selectedItem === undefined) {\r\n      this.setState({selectedItem: prevProps.selectedItem});\r\n    }\r\n  }\r\n\r\n  get selectedItem() {\r\n    if (this.props.selectedItem === undefined) {\r\n      return this.state.selectedItem;\r\n    } else {\r\n      return this.props.selectedItem;\r\n    }\r\n  }\r\n\r\n  isCellAvailable = cell => {\r\n    return !this.isCellUndoable(cell) && (cell.y === 0 || cell.x <= 1);\r\n  };\r\n\r\n  isCellUndoable = cell => {\r\n    const {selectedItem} = this;\r\n    return cell.x === selectedItem.x && cell.y === selectedItem.y;\r\n  };\r\n\r\n  makeMove = cell => {\r\n    const selectedItem = {x: cell.x, y: cell.y};\r\n    if (this.props.selectedItem === undefined) {\r\n      this.setState({selectedItem: selectedItem});\r\n    }\r\n    if (this.props.onSelectedItemChange) {\r\n      const update = cell.player ? {player: cell.player} : {level: cell.level};\r\n      this.props.onSelectedItemChange(selectedItem, update);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {client} = this.props;\r\n    const settings = client.applicableSettings;\r\n\r\n    return (\r\n      <BoardBackground\r\n        medium\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={this.constructor.rowsAndColumns}\r\n        clickable undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        makeMove={this.makeMove}\r\n        settings={settings}\r\n        animated={false}\r\n        showArrows={false}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditPositionPalette.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  selectedItem: PropTypes.object,\r\n  onSelectedItemChange: PropTypes.func,\r\n  keydown: PropTypes.object.isRequired,\r\n};\r\n\r\nEditPositionPalette = withClient(EditPositionPalette);\r\n\r\nclass EditPositionBoard extends Component {\r\n  state = {\r\n    position: Game.getInitialRowsAndColumns(),\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.position !== undefined && this.props.position === undefined) {\r\n      this.setState({position: prevProps.position});\r\n    }\r\n  }\r\n\r\n  get position() {\r\n    if (this.props.position === undefined) {\r\n      return this.state.position;\r\n    } else {\r\n      return this.props.position;\r\n    }\r\n  }\r\n\r\n  isCellAvailable = () => {\r\n    return true;\r\n  };\r\n\r\n  isCellUndoable = () => {\r\n    return false;\r\n  };\r\n\r\n  makeMove = cell => {\r\n    const {update} = this.props;\r\n    if ('level' in update) {\r\n      if (cell.level !== update.level) {\r\n        this.updatePosition({x: cell.x, y: cell.y, level: update.level});\r\n      }\r\n    } else if ('player' in update) {\r\n      if (cell.player !== update.player) {\r\n        this.updatePosition({x: cell.x, y: cell.y, player: update.player, worker: Game.WORKER_FIRST});\r\n      } else {\r\n        this.updatePosition({x: cell.x, y: cell.y, player: null, worker: null});\r\n      }\r\n    }\r\n  };\r\n\r\n  updatePosition = newCell => {\r\n    const newPosition = Game.updateCells(this.position, newCell);\r\n\r\n    if (this.props.position === undefined) {\r\n      this.setState({position: newPosition});\r\n    }\r\n    if (this.props.onPositionChange) {\r\n      this.props.onPositionChange(newPosition);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {position} = this;\r\n    const {client} = this.props;\r\n    const settings = client.applicableSettings;\r\n\r\n    return (\r\n      <BoardBackground\r\n        medium\r\n        allowControl={[Game.PLAYER_A, Game.PLAYER_B]}\r\n        rowsAndColumns={position}\r\n        clickable undoable={false}\r\n        isCellAvailable={this.isCellAvailable}\r\n        isCellUndoable={this.isCellUndoable}\r\n        makeMove={this.makeMove}\r\n        settings={settings}\r\n        animated={false}\r\n        showArrows={false}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nEditPositionBoard.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  position: PropTypes.array,\r\n  update: PropTypes.object.isRequired,\r\n  onPositionChange: PropTypes.func,\r\n};\r\n\r\nEditPositionBoard = withClient(EditPositionBoard);\r\n\r\nexport default keydown(EditPositionPalette.SubComponent.keys)(withClient(EditPosition));\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Button, Checkbox, Form, Grid, Header, Icon, Input, Segment} from \"semantic-ui-react\";\r\nimport Game from \"../game/game\";\r\nimport _ from \"lodash\";\r\nimport Board from \"./Board\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport Play from \"./Play\";\r\nimport EditPosition from \"./EditPosition\";\r\nimport moment from \"moment\";\r\n\r\nclass CreateChallenge extends Component {\r\n  state = {\r\n    editing: true,\r\n    challenge: null,\r\n    currentStep: null,\r\n    tree: null,\r\n    game: null,\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.props.initialChallenge) {\r\n      this.onCreateChallenge(this.fillGames(this.props.initialChallenge));\r\n    }\r\n  }\r\n\r\n  fillGames(challengeStep) {\r\n    challengeStep = {...challengeStep};\r\n    if (!challengeStep.game && challengeStep.position) {\r\n      challengeStep.game = Game.fromCompressedPositionNotation(challengeStep.position);\r\n    }\r\n    if (challengeStep.startingPosition) {\r\n      challengeStep.startingPosition = this.fillGames(challengeStep.startingPosition);\r\n    } else if (challengeStep.playerResponses) {\r\n      challengeStep.playerResponses = challengeStep.playerResponses.map(nextStep => this.fillGames(nextStep));\r\n    } else if ('challengeResponse' in challengeStep) {\r\n      if (challengeStep.challengeResponse) {\r\n        challengeStep.challengeResponse = this.fillGames(challengeStep.challengeResponse);\r\n      }\r\n    } else {\r\n      throw new Error('Cannot find type of step');\r\n    }\r\n\r\n    return challengeStep;\r\n  }\r\n\r\n  onCreateChallenge = challenge => {\r\n    this.setState({\r\n      editing: false,\r\n      challenge,\r\n      currentStep: challenge.startingPosition,\r\n      tree: this.getTree(challenge.startingPosition),\r\n      game: challenge.startingPosition.game,\r\n    });\r\n  };\r\n\r\n  getDifficultyStars(difficulty, maxDifficulty) {\r\n    return _.range(maxDifficulty).map(index => (\r\n      <Icon\r\n        key={index}\r\n        name={difficulty > index ? 'star' : 'star outline'}\r\n        color={'yellow'}\r\n      />\r\n    ));\r\n  }\r\n\r\n  makeMove = newGame => {\r\n    this.setState({game: newGame});\r\n  };\r\n\r\n  getExistingResponse(newGame) {\r\n    const {currentStep} = this.state;\r\n    if (currentStep.playerResponses) {\r\n      return currentStep.playerResponses\r\n        .find(response => response.position === newGame.positionNotation);\r\n    } else {\r\n      if (currentStep.challengeResponse && currentStep.challengeResponse.position === newGame.positionNotation) {\r\n        return currentStep.challengeResponse;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  getPathIndexes() {\r\n    const {currentStep, tree} = this.state;\r\n    let treePath = tree.find(treePath => treePath.find(treePathStep => treePathStep === currentStep));\r\n    treePath = treePath.slice(0, treePath.findIndex(treePathStep => treePathStep === currentStep) + 1);\r\n    const pathIndexes = treePath.map((treePathStep, index) =>\r\n      index === 0\r\n        ? ['challenge', 'startingPosition']\r\n        : (\r\n          treePath[index - 1].playerResponses\r\n            ? ['playerResponses', treePath[index - 1].playerResponses.indexOf(treePathStep)]\r\n            : ['challengeResponse']\r\n        )\r\n    );\r\n\r\n    return pathIndexes;\r\n  }\r\n\r\n  duplicateChallenge(pathIndexes) {\r\n    const {challenge} = this.state;\r\n\r\n    const newChallenge = {\r\n      ...challenge,\r\n      startingPosition: {...challenge.startingPosition},\r\n    };\r\n    let newModifyingStep = newChallenge.startingPosition;\r\n    for (const index of _.flatten(pathIndexes.slice(1))) {\r\n      const oldStep = newModifyingStep[index];\r\n      const newStep = Array.isArray(oldStep) ? oldStep.slice() : {...oldStep};\r\n      newModifyingStep[index] = newStep;\r\n      newModifyingStep = newStep;\r\n    }\r\n\r\n    return {newChallenge, newModifyingStep};\r\n  }\r\n\r\n  addGameToStep(newModifyingStep, newGame) {\r\n    let newStep = null;\r\n    if (newModifyingStep.playerResponses) {\r\n      newModifyingStep.playerResponses = newModifyingStep.playerResponses.slice();\r\n      newModifyingStep = newModifyingStep.playerResponses;\r\n      newStep = {\r\n        position: newGame.positionNotation,\r\n        moves: newGame.lastMovesInHistory,\r\n        game: newGame,\r\n        challengeResponse: null,\r\n      };\r\n      newModifyingStep.push(newStep);\r\n    } else {\r\n      newStep = {\r\n        position: newGame.positionNotation,\r\n        moves: newGame.lastMovesInHistory,\r\n        game: newGame,\r\n        playerResponses: [],\r\n      };\r\n      newModifyingStep.challengeResponse = newStep;\r\n    }\r\n\r\n    return newStep;\r\n  }\r\n\r\n  removeStep(newModifyingStep, step) {\r\n    if (newModifyingStep.playerResponses) {\r\n      newModifyingStep.playerResponses = newModifyingStep.playerResponses.filter(response => response !== step);\r\n    } else {\r\n      newModifyingStep.challengeResponse = null;\r\n    }\r\n\r\n    return newModifyingStep;\r\n  }\r\n\r\n  submit = moves => {\r\n    const {currentStep} = this.state;\r\n    const newGame = currentStep.game.makeMoves(moves);\r\n\r\n    const existingResponse = this.getExistingResponse(newGame);\r\n    if (existingResponse) {\r\n      this.setState({\r\n        currentStep: existingResponse,\r\n        game: existingResponse.game,\r\n      });\r\n      return;\r\n    }\r\n\r\n    const pathIndexes = this.getPathIndexes();\r\n    let {newChallenge, newModifyingStep} = this.duplicateChallenge(pathIndexes);\r\n    let newStep = this.addGameToStep(newModifyingStep, newGame);\r\n    this.setState({\r\n      challenge: newChallenge,\r\n      currentStep: newStep,\r\n      tree: this.getTree(newChallenge.startingPosition),\r\n      game: newStep.game,\r\n    });\r\n  };\r\n\r\n  getTree(startingPosition = this.state.challenge.startingPosition) {\r\n    let tree = [[startingPosition]];\r\n    while (tree !== (tree = this.getNextTree(tree))) {}\r\n\r\n    return tree;\r\n  }\r\n\r\n  getNextTree(tree) {\r\n    const nextTree = _.flatten(tree.map(this.getNextTreePath));\r\n    if (nextTree.length !== tree.length) {\r\n      return nextTree;\r\n    }\r\n    if (tree.find((treePath, index) => treePath !== nextTree[index])) {\r\n      return nextTree;\r\n    }\r\n\r\n    return tree;\r\n  }\r\n\r\n  getNextTreePath = treePath => {\r\n    const lastTreeStep = treePath[treePath.length - 1];\r\n    if (lastTreeStep.playerResponses) {\r\n      if (lastTreeStep.playerResponses.length) {\r\n        return lastTreeStep.playerResponses.map(nextStep => treePath.concat(nextStep));\r\n      } else {\r\n        return [treePath];\r\n      }\r\n    } else {\r\n      if (lastTreeStep.challengeResponse) {\r\n        return [treePath.concat(lastTreeStep.challengeResponse)];\r\n      } else {\r\n        return [treePath];\r\n      }\r\n    }\r\n  };\r\n\r\n  deleteCurrentStep = () => {\r\n    const {currentStep} = this.state;\r\n    const pathIndexes = this.getPathIndexes().slice(0, -1);\r\n    let {newChallenge, newModifyingStep} = this.duplicateChallenge(pathIndexes);\r\n    let newStep = this.removeStep(newModifyingStep, currentStep);\r\n    this.setState({\r\n      challenge: newChallenge,\r\n      currentStep: newStep,\r\n      tree: this.getTree(newChallenge.startingPosition),\r\n      game: newStep.game,\r\n    });\r\n  };\r\n\r\n  editChallenge = () => {\r\n    this.setState({editing: true});\r\n  };\r\n\r\n  createChallenge = () => {\r\n    const cleanedChallenge = JSON.parse(JSON.stringify(this.state.challenge, (key, value) => {\r\n      if (value instanceof Game) {\r\n        return undefined;\r\n      } else {\r\n        return value;\r\n      }\r\n    }));\r\n    this.props.client.createChallenge(cleanedChallenge);\r\n  };\r\n\r\n  updateChallenge = () => {\r\n    const cleanedChallenge = JSON.parse(JSON.stringify(this.state.challenge, (key, value) => {\r\n      if (value instanceof Game) {\r\n        return undefined;\r\n      } else {\r\n        return value;\r\n      }\r\n    }));\r\n    this.props.client.updateChallenge(cleanedChallenge);\r\n  };\r\n\r\n  createOrUpdateChallenge = () => {\r\n    if (this.state.challenge.id) {\r\n      this.updateChallenge();\r\n    } else {\r\n      this.createChallenge();\r\n    }\r\n  };\r\n\r\n  discardChallenge = () => {\r\n    this.setState({\r\n      editing: true,\r\n      challenge: null,\r\n      currentStep: null,\r\n      tree: null,\r\n      game: null,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {user, client} = this.props;\r\n    const {editing, challenge, game, tree, currentStep} = this.state;\r\n    const settings = client.applicableSettings;\r\n\r\n    if (!challenge) {\r\n      return null;\r\n    }\r\n\r\n    if (editing && challenge.isMyChallenge) {\r\n      return (\r\n        <ChallengeForm initialChallenge={challenge} onCreateChallenge={this.onCreateChallenge} />\r\n      )\r\n    }\r\n    const challengePrompt = challenge.options.type === 'mate' ? `Find mate in ${challenge.options.typeOptions.mateIn}` : 'Unknown challenge';\r\n\r\n    return (\r\n      <Fragment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Segment>\r\n              <Header as={'h1'}>{challengePrompt}</Header>\r\n              <Header as={'h4'} className={'difficulty-header'}>{this.getDifficultyStars(challenge.meta.difficulty, challenge.meta.maxDifficulty)}</Header>\r\n              <Header as={'h4'}>{challenge.meta.source}</Header>\r\n            </Segment>\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Button secondary onClick={this.editChallenge}>Edit</Button>\r\n            <Button positive onClick={this.createOrUpdateChallenge}>{challenge.id ? 'Update' : 'Create'}</Button>\r\n            <Button negative onClick={this.discardChallenge}>Discard</Button>\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Segment>\r\n          <Header as={'h3'}>Tree</Header>\r\n          <table>\r\n            <tbody>\r\n            {tree.map((treePath, rowIndex) => (\r\n              <tr key={rowIndex}>\r\n                {treePath.map((treePathStep, columnIndex) => (\r\n                  <td key={columnIndex}>\r\n                    {rowIndex === 0 || treePathStep !== tree[rowIndex - 1][columnIndex] ? (\r\n                      <Board\r\n                        small\r\n                        selected={game === treePathStep.game}\r\n                        onSelect={() => {\r\n                          this.setState({\r\n                            currentStep: treePathStep,\r\n                            game: treePathStep.game,\r\n                          });\r\n                        }}\r\n                        settings={settings}\r\n                        game={treePathStep.game}\r\n                      />\r\n                    ) : null}\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n            </tbody>\r\n          </table>\r\n        </Segment>\r\n        {currentStep.game ? <Segment>\r\n          <Header as={'h3'}>Current step</Header>\r\n          <Play\r\n            user={user}\r\n            changeSettings={this.changeSettings}\r\n            game={game}\r\n            allowControl={[currentStep.game.nextPlayer]}\r\n            names={{[challenge.options.initialPlayer]: 'Player', [Game.OTHER_PLAYER[challenge.options.initialPlayer]]: 'Challenge'}}\r\n            submit={this.submit}\r\n            onDisplayPositionChange={this.onDisplayPositionChange}\r\n            makeMove={this.makeMove}\r\n          >\r\n            <Button negative disabled={currentStep === challenge} onClick={this.deleteCurrentStep}>\r\n              <Icon name={'delete'}/>Delete response\r\n            </Button>\r\n          </Play>\r\n        </Segment> : null}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nCreateChallenge.propTypes = {\r\n  initialChallenge: PropTypes.object,\r\n};\r\n\r\nclass ChallengeForm extends Component {\r\n  static valueConversion = {\r\n    'options.typeOptions.mateIn': parseInt,\r\n    'meta.difficulty': parseInt,\r\n    'meta.publishDatetime': timestamp => timestamp ? moment(timestamp) : null,\r\n  };\r\n\r\n  state = {\r\n    challenge: this.props.initialChallenge || {\r\n      options: {\r\n        initialPlayer: null,\r\n        type: 'mate',\r\n        typeOptions: {\r\n          mateIn: 1,\r\n        },\r\n      },\r\n      meta: {\r\n        source: '',\r\n        difficulty: 1,\r\n        maxDifficulty: 3,\r\n        public: true,\r\n        publishDatetime: null,\r\n      },\r\n      startingPosition: {\r\n        position: Game.create().positionNotation,\r\n        game: Game.create(),\r\n        playerResponses: [],\r\n      },\r\n    },\r\n    error: {\r\n      position: null,\r\n    },\r\n    editingPosition: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (!this.props.initialChallenge) {\r\n      const params = new URLSearchParams(window.location.search);\r\n      const position = params.get('position');\r\n      if (position) {\r\n        this.setValue(null, {name: 'startingPosition.position', value: position});\r\n        this.setState({editingPosition: true});\r\n      }\r\n    }\r\n  }\r\n\r\n  setValue = (e, {name, value, checked}) => {\r\n    if (value === undefined && typeof checked === typeof true) {\r\n      value = checked;\r\n    }\r\n    let convertedValue = value;\r\n    if (name in this.constructor.valueConversion) {\r\n      convertedValue = this.constructor.valueConversion[name](convertedValue);\r\n    }\r\n    this.setState(state => {\r\n      const challenge = {\r\n        ...state.challenge,\r\n      };\r\n      let newChallengeToChange = challenge;\r\n      const parts = name.split('.');\r\n      for (const part of parts.slice(0, parts.length - 1)) {\r\n        newChallengeToChange = newChallengeToChange[part] || {};\r\n      }\r\n      newChallengeToChange[parts[parts.length - 1]] = convertedValue;\r\n      return {challenge};\r\n    });\r\n    this.onValueSet(name, convertedValue);\r\n  };\r\n\r\n  onValueSet = name => {\r\n    if (name === 'startingPosition.position') {\r\n      this.setState(state => {\r\n        const position = state.challenge.startingPosition.position;\r\n        const isPositionValid = position\r\n          ? Game.isValidCompressedPositionNotation(position) : false;\r\n        const game = isPositionValid ? Game.fromCompressedPositionNotation(position) : null;\r\n        return {\r\n          error: {\r\n            ...state.error,\r\n            position: !position || isPositionValid ? null : 'This is not a valid position',\r\n          },\r\n          challenge: {\r\n            ...state.challenge,\r\n            options: {\r\n              ...state.challenge.options,\r\n              initialPlayer: game ? game.nextPlayer : null,\r\n            },\r\n            startingPosition: {\r\n              ...state.challenge.startingPosition,\r\n              game,\r\n            }\r\n          },\r\n        };\r\n      });\r\n    }\r\n  };\r\n\r\n  createChallenge = () => {\r\n    const {challenge, error} = this.state;\r\n    if (error.position) {\r\n      return;\r\n    }\r\n    this.props.onCreateChallenge(challenge);\r\n  };\r\n\r\n  usePosition = positionNotation => {\r\n    this.setState({\r\n      editingPosition: false,\r\n    });\r\n    this.setValue(null, {name: 'startingPosition.position', value: positionNotation});\r\n  };\r\n\r\n  editPosition = () => {\r\n    this.setState({editingPosition: true});\r\n  };\r\n\r\n  render() {\r\n    const {client, initialChallenge} = this.props;\r\n    const {editingPosition, challenge, error} = this.state;\r\n    const settings = client.applicableSettings;\r\n\r\n    if (editingPosition) {\r\n      return (\r\n        <EditPosition\r\n          usePosition={this.usePosition}\r\n          initialPositionNotation={challenge.startingPosition.position}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        <Header>Create a challenge</Header>\r\n        <Segment>\r\n          <Form onSubmit={this.createChallenge}>\r\n            <Form.Group>\r\n              <Form.Field\r\n                name={'startingPosition.position'}\r\n                control={Input}\r\n                label={'Initial position'}\r\n                placeholder={'Game position'}\r\n                onChange={this.setValue}\r\n                value={challenge.startingPosition.position}\r\n                required\r\n                error={error.position}\r\n              />\r\n              <Button\r\n                content={'Edit position'}\r\n                secondary\r\n                onClick={this.editPosition}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group inline>\r\n              <label>Starting player</label>\r\n              <Form.Radio\r\n                name={'options.initialPlayer'}\r\n                label={'Player A'}\r\n                onChange={this.setValue}\r\n                value={Game.PLAYER_A}\r\n                checked={challenge.options.initialPlayer === Game.PLAYER_A}\r\n                disabled={challenge.options.initialPlayer !== Game.PLAYER_A}\r\n              />\r\n              <Form.Radio\r\n                name={'options.initialPlayer'}\r\n                label={'Player B'}\r\n                onChange={this.setValue}\r\n                value={Game.PLAYER_B}\r\n                checked={challenge.options.initialPlayer === Game.PLAYER_B}\r\n                disabled={challenge.options.initialPlayer !== Game.PLAYER_B}\r\n              />\r\n            </Form.Group>\r\n            {challenge.startingPosition.game ? (\r\n              <Board\r\n                medium\r\n                settings={settings}\r\n                game={challenge.startingPosition.game}\r\n              />\r\n            ) : null}\r\n            <Form.Select\r\n              options={[\r\n                {key: 'mate', value: 'mate', text: 'Mate'},\r\n              ]}\r\n              name={'options.type'}\r\n              label={'Type'}\r\n              onChange={this.setValue}\r\n              required\r\n              value={challenge.options.type}\r\n            />\r\n            <Form.Group>\r\n              <Form.Field\r\n                control={Input}\r\n                type={'range'}\r\n                label={`Mate In: ${challenge.options.typeOptions.mateIn}`}\r\n                min={1}\r\n                max={10}\r\n                name={'options.typeOptions.mateIn'}\r\n                onChange={this.setValue}\r\n                required\r\n                value={challenge.options.typeOptions.mateIn}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Field\r\n                control={Input}\r\n                label={'Source'}\r\n                name={'meta.source'}\r\n                onChange={this.setValue}\r\n                value={challenge.meta.source}\r\n              />\r\n              <Form.Field\r\n                control={Input}\r\n                type={'range'}\r\n                label={`Difficulty: ${challenge.meta.difficulty}/${challenge.meta.maxDifficulty}`}\r\n                min={1}\r\n                max={challenge.meta.maxDifficulty}\r\n                name={'meta.difficulty'}\r\n                onChange={this.setValue}\r\n                required\r\n                value={challenge.meta.difficulty}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Field\r\n                control={Checkbox}\r\n                label={'Public'}\r\n                name={'meta.public'}\r\n                onChange={this.setValue}\r\n                checked={challenge.meta.public}\r\n              />\r\n              <Form.Field\r\n                control={Input}\r\n                type={'datetime-local'}\r\n                label={'Publish On'}\r\n                name={'meta.publishDatetime'}\r\n                onChange={this.setValue}\r\n                value={challenge.meta.publishDatetime ? challenge.meta.publishDatetime.format(\"YYYY-MM-DDTHH:mm\") : ''}\r\n              />\r\n            </Form.Group>\r\n            <Form.Button primary content={initialChallenge ? 'Update' : 'Create'} />\r\n          </Form>\r\n        </Segment>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChallengeForm.propTypes = {\r\n  initialChallenge: PropTypes.object,\r\n  onCreateChallenge: PropTypes.func.isRequired,\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n};\r\n\r\nChallengeForm = withClient(ChallengeForm);\r\n\r\nexport default withClient(CreateChallenge);\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {withRouter} from \"react-router-dom\";\r\nimport {Modal} from \"semantic-ui-react\";\r\nimport CreateChallenge from \"./CreateChallenge\";\r\nimport {withClient} from \"../client/withClient\";\r\n\r\nclass EditChallenge extends Component {\r\n  get challenge() {\r\n    const {match, challengesInfo: {byId}} = this.props;\r\n    const challenge = byId[match.params.id];\r\n    return challenge;\r\n  }\r\n\r\n  dismissUrlChallengeError = () => {\r\n    this.props.history.push('/challenge');\r\n  };\r\n\r\n  render() {\r\n    const challenge = this.challenge;\r\n    if (!challenge || !challenge.isMyChallenge) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlChallengeError}\r\n            header={'Could not find challenge'}\r\n            content={'This challenge cannot be found. Please check that you copied the full URL, or perhaps the challenge was deleted'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find challenge\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <CreateChallenge initialChallenge={challenge} />\r\n    );\r\n  }\r\n}\r\n\r\nEditChallenge.propTypes = {\r\n  match: PropTypes.object.isRequired,\r\n  history: PropTypes.object.isRequired,\r\n  challengesInfo: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withRouter(withClient(EditChallenge));\r\n","import React, {Component, Fragment} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Game from \"../game/game\";\r\nimport {Button, Grid, Header, Icon, Label, Menu, Message, Modal, Segment, Tab} from \"semantic-ui-react\";\r\nimport Play from \"./Play\";\r\nimport {withClient} from \"../client/withClient\";\r\nimport _ from 'lodash';\r\nimport \"../styles/challenges.css\";\r\nimport ChallengeList from \"./ChallengeList\";\r\nimport {Link, NavLink, Route, Switch, withRouter} from \"react-router-dom\";\r\nimport CreateChallenge from \"./CreateChallenge\";\r\nimport EditChallenge from \"./EditChallenge\";\r\nimport * as utils from \"../utils\";\r\n\r\nclass Challenges extends Component {\r\n  render() {\r\n    const {user, challengesInfo: {otherStarted, otherNotStarted, otherSolved, mine}} = this.props;\r\n\r\n    return (\r\n      <Switch>\r\n        <Route exact path={this.props.match.path}>\r\n          <Fragment>\r\n            <Segment>\r\n              <Link to={`${this.props.match.path}/create`}><Button content={'Create Challenge'} /></Link>\r\n            </Segment>\r\n            <Tab menu={{pointing: true}} panes={[\r\n              {key: 'other-started', label: \"Started Challenges\", items: otherStarted, color: 'green'},\r\n              {key: 'other-not-started', label: \"New Challenges\", items: otherNotStarted},\r\n              {key: 'other-solved', label: \"Solved Challenges\", items: otherSolved},\r\n              {key: 'mine', label: \"My Challenges\", items: mine},\r\n            ].filter(({items}) => items.length).map(({key, label, items, color}) => (\r\n              {menuItem: {key, content: <Fragment>{label} <Label content={items.length} color={color} /></Fragment>}, render: () => (\r\n                <ChallengeList selectChallenge={this.props.selectLiveChallenge} challenges={items} />\r\n              )}\r\n            ))} />\r\n          </Fragment>\r\n        </Route>\r\n        {(process.env.REACT_APP_DEBUG || (user && user.admin)) ? (\r\n          <Route exact path={`${this.props.match.path}/create`}>\r\n            <CreateChallenge />\r\n          </Route>\r\n        ) : null}\r\n        {(process.env.REACT_APP_DEBUG || (user && user.admin)) ? (\r\n          <Route exact path={`${this.props.match.path}/:id/edit`}>\r\n            <EditChallenge />\r\n          </Route>\r\n        ) : null}\r\n        <Route exact path={`${this.props.match.path}/:id`}>\r\n          <ChallengePlayer selectLiveChallenge={this.props.selectLiveChallenge} />\r\n        </Route>\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nChallenges.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  liveChallenge: PropTypes.object,\r\n  selectLiveChallenge: PropTypes.func.isRequired,\r\n};\r\n\r\nclass ChallengePlayer extends Component {\r\n  state = {\r\n    challengeId: this.challenge ? this.challenge.id : null,\r\n    game: this.getResumedChallengeGame(),\r\n    submittedGame: null,\r\n    path: this.challenge ? [] : null,\r\n    wrongMove: false,\r\n    won: false,\r\n  };\r\n\r\n  get challenge() {\r\n    const {match, challengesInfo: {byId}} = this.props;\r\n    const challenge = byId[match.params.id];\r\n    return challenge;\r\n  }\r\n\r\n  get userChallenge() {\r\n    const challenge = this.challenge;\r\n    if (!challenge) {\r\n      return null;\r\n    }\r\n    const {user} = this.props;\r\n    return user.challenges[challenge.id] || {\r\n      meta: {\r\n        started: false,\r\n        mistakes: 0,\r\n        won: false,\r\n      },\r\n      startingPosition: {\r\n        position: challenge.startingPosition.position,\r\n        invalidPlayerPositions: [],\r\n        playerResponses: [],\r\n      },\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const challenge = this.challenge;\r\n\r\n    if (challenge) {\r\n      this.props.selectLiveChallenge(challenge);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    const challenge = this.challenge;\r\n\r\n    if (challenge && prevState.challengeId !== challenge.id) {\r\n      this.props.selectLiveChallenge(challenge);\r\n      this.setState({\r\n        challengeId: challenge.id,\r\n        game: this.getResumedChallengeGame(),\r\n        submittedGame: null,\r\n        path: [],\r\n        wrongMove: false,\r\n        won: false,\r\n      });\r\n    }\r\n    if (!challenge && this.state.challengeId) {\r\n      this.setState({\r\n          challengeId: null,\r\n          game: null,\r\n          submittedGame: null,\r\n          path: [],\r\n          wrongMove: false,\r\n          won: false,\r\n      });\r\n    }\r\n    if (challenge && this.props.user && this.state.submittedGame) {\r\n      this.updateChallenge(this.state.submittedGame, {askServer: false});\r\n    }\r\n  }\r\n\r\n  submit = (moves, newGame) => {\r\n    if (this.state.won) {\r\n      return;\r\n    }\r\n\r\n    this.updateChallenge(newGame, {askServer: true});\r\n  };\r\n\r\n  getResumedChallengeGame() {\r\n    const userChallenge = this.userChallenge;\r\n    if (!userChallenge) {\r\n      return null;\r\n    }\r\n    let resultingGame = Game.fromCompressedPositionNotation(userChallenge.startingPosition.position);\r\n    let userChallengeStep = userChallenge.startingPosition;\r\n    while (userChallengeStep) {\r\n      const lastPlayerResponse = userChallengeStep.playerResponses[userChallengeStep.playerResponses.length - 1];\r\n      if (!lastPlayerResponse) {\r\n        break;\r\n      }\r\n      resultingGame = resultingGame.makeMoves(lastPlayerResponse.moves);\r\n      if (!lastPlayerResponse.challengeResponse) {\r\n        break;\r\n      }\r\n      resultingGame = resultingGame.makeMoves(lastPlayerResponse.challengeResponse.moves);\r\n      userChallengeStep = lastPlayerResponse.challengeResponse;\r\n    }\r\n\r\n    return resultingGame;\r\n  }\r\n\r\n  updateChallenge(gameToUpdate, {askServer = true} = {}) {\r\n    const {user} = this.props;\r\n    if (!user) {\r\n      return;\r\n    }\r\n    const challenge = this.challenge;\r\n    const userChallenge = this.userChallenge;\r\n\r\n    const history = gameToUpdate.history;\r\n    let userChallengeStep = userChallenge.startingPosition;\r\n    let remainingHistory = history.slice(1).filter((game, index) => index % 2 === 0);\r\n    if (!remainingHistory.length) {\r\n      return;\r\n    }\r\n    while (remainingHistory.length) {\r\n      const historyGame = remainingHistory.shift();\r\n      if (userChallengeStep.invalidPlayerPositions.includes(historyGame.positionNotation)) {\r\n        this.setState({\r\n          wrongMove: true,\r\n          won: false,\r\n          submittedGame: null,\r\n        });\r\n        return;\r\n      }\r\n      const validPlayerResponse = userChallengeStep.playerResponses\r\n        .find(response => response.position === historyGame.positionNotation);\r\n      if (!validPlayerResponse) {\r\n        if (askServer) {\r\n          this.props.client.submitChallengeMove(challenge, gameToUpdate.path.filter((item, index) => index % 2 === 0));\r\n          this.setState({submittedGame: gameToUpdate});\r\n        }\r\n        return;\r\n      }\r\n      if (!validPlayerResponse.challengeResponse) {\r\n        this.setState({\r\n          wrongMove: false,\r\n          won: true,\r\n          game: historyGame.positionNotation !== this.state.game.positionNotation ? historyGame : this.state.game,\r\n          submittedGame: null,\r\n        });\r\n        return;\r\n      }\r\n      userChallengeStep = validPlayerResponse.challengeResponse;\r\n    }\r\n\r\n    this.setState({\r\n      game: gameToUpdate.makeMoves(userChallengeStep.moves),\r\n      wrongMove: false,\r\n      won: false,\r\n      submittedGame: null,\r\n    });\r\n  }\r\n\r\n  onDisplayPositionChange = () => {\r\n    if (this.state.wrongMove) {\r\n      this.setState({wrongMove: false, submittedGame: null});\r\n    }\r\n  };\r\n\r\n  getDifficultyStars(difficulty, maxDifficulty) {\r\n    return _.range(maxDifficulty).map(index => (\r\n      <Icon\r\n        key={index}\r\n        name={difficulty > index ? 'star' : 'star outline'}\r\n        color={'yellow'}\r\n      />\r\n    ));\r\n  }\r\n\r\n  dismissUrlChallengeError = () => {\r\n    this.props.selectLiveChallenge(null);\r\n  };\r\n\r\n  close = () => {\r\n    this.props.selectLiveChallenge(null);\r\n  };\r\n\r\n  shareChallenge = e => {\r\n    const url = window.location.href;\r\n    if (navigator.share) {\r\n      const challenge = this.challenge;\r\n      navigator.share({\r\n        title: `Thyra Online - Solve challenge${challenge.options.type === 'mate' ? `: Find mate in ${challenge.options.typeOptions.mateIn}` : ''}`,\r\n        text: `Solve Santorini challenge`,\r\n        url,\r\n      }).catch(() => {\r\n        utils.copyToClipboard(url);\r\n        alert('Link copied to clipboard');\r\n      });\r\n    } else {\r\n      utils.copyToClipboard(url);\r\n      alert('Link copied to clipboard');\r\n    }\r\n    e.preventDefault();\r\n  };\r\n\r\n  render() {\r\n    if (!this.props.user) {\r\n      return null;\r\n    }\r\n    const challenge = this.challenge;\r\n    if (!challenge) {\r\n      return (\r\n        <Fragment>\r\n          <Modal\r\n            open={true}\r\n            size={'mini'}\r\n            onClose={this.dismissUrlChallengeError}\r\n            header={'Could not find challenge'}\r\n            content={'This challenge cannot be found. Please check that you copied the full URL, or perhaps the challenge was removed'}\r\n            actions={[{key: 'ok', content: 'OK', positive: true}]}\r\n          />\r\n          Could not find challenge\r\n        </Fragment>\r\n      );\r\n    }\r\n\r\n    const {game, wrongMove, won} = this.state;\r\n    if (!game) {\r\n      return null;\r\n    }\r\n\r\n    const {user, location} = this.props;\r\n    const challengePrompt = challenge.options.type === 'mate'\r\n      ? `Find mate in ${challenge.options.typeOptions.mateIn}`\r\n      : 'Unknown challenge';\r\n    const message = (\r\n      wrongMove ? (\r\n        <Message error icon={'warning'} content={\"That's not the right answer\"} />\r\n      ) : won ? (\r\n        <Message success icon={'check'} content={\"Correct! You solved it!\"} />\r\n      ) : (\r\n        <Message content={challengePrompt} />\r\n      )\r\n    );\r\n    return (\r\n      <Fragment>\r\n        <Grid centered>\r\n          <Grid.Row>\r\n            <Menu stackable size={'massive'} inverted items={[\r\n              {key: 'close', content: 'Close', icon: 'x', onClick: this.close, color: 'red', active: true},\r\n              {key: 'share', content: 'Share Game', icon: 'share', onClick: this.shareChallenge, as: NavLink,\r\n                to: location.pathname, color: 'green', active: true,\r\n                title: navigator.share ? 'Click to open the sharing menu' : 'Click to copy URL to challenge'},\r\n              (process.env.REACT_APP_DEBUG || (user && user.admin)) && challenge.isMyChallenge ? {key: 'edit', content: 'Edit challenge', icon: 'edit', as: NavLink,\r\n                to: `/challenge/${challenge.id}/edit`, color: 'green', active: true,\r\n                title: 'Click to edit the challenge'} : null,\r\n            ].filter(item => item)} />\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            <Segment>\r\n              <Header as={'h1'}>{challengePrompt}</Header>\r\n              <Header as={'h4'} className={'difficulty-header'}>{this.getDifficultyStars(challenge.meta.difficulty, challenge.meta.maxDifficulty)}</Header>\r\n              <Header as={'h4'}>{challenge.meta.source}</Header>\r\n            </Segment>\r\n          </Grid.Row>\r\n          <Grid.Row>\r\n            {message}\r\n          </Grid.Row>\r\n        </Grid>\r\n        <Play\r\n          user={user}\r\n          changeSettings={this.changeSettings}\r\n          game={game}\r\n          allowControl={[challenge.options.initialPlayer]}\r\n          names={{[challenge.options.initialPlayer]: 'You', [Game.OTHER_PLAYER[challenge.options.initialPlayer]]: 'Challenge'}}\r\n          submit={this.submit}\r\n          onDisplayPositionChange={this.onDisplayPositionChange}\r\n        >\r\n          {message}\r\n        </Play>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nChallengePlayer.propTypes = {\r\n  user: PropTypes.object,\r\n  client: PropTypes.object.isRequired,\r\n  selectLiveChallenge: PropTypes.func.isRequired\r\n};\r\n\r\nChallengePlayer = withRouter(withClient(ChallengePlayer));\r\n\r\nexport default withRouter(withClient(Challenges));\r\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport 'fomantic-ui-css/semantic.css';\nimport {Container, Header, Label, Message, Segment, Tab} from 'semantic-ui-react';\nimport './styles/App.css';\nimport './styles/semantic-ui.css';\nimport {client} from \"./client/client\";\nimport NavigationalTab from \"./components/NavigationalTab\";\nimport {withRouter} from \"react-router-dom\";\nimport Hotseat from \"./components/Hotseat\";\nimport Lobby, {EditUser, LogIn, LogOut} from \"./components/Lobby\";\nimport OnlineGame from \"./components/OnlineGame\";\nimport {withClient} from \"./client/withClient\";\nimport services from \"./services\";\nimport SvgBoardBackground from \"./components/Board/SvgBoardBackground\";\nimport OnlineTournament from \"./components/OnlineTournament\";\nimport Settings from \"./components/Settings\";\nimport LearnToPlay from \"./components/LearnToPlay\";\nimport Challenges from \"./components/Challenges\";\n\nclass App extends Component {\n  state = {\n    liveGame: null,\n    liveTournament: null,\n    liveChallenge: null,\n  };\n\n  selectLiveGame = liveGame => {\n    let gameUrl;\n    if (liveGame) {\n      gameUrl = `/game/${liveGame.id}`;\n    } else {\n      gameUrl = '/lobby';\n    }\n    if (gameUrl !== this.props.location.pathname) {\n      this.props.history.push(gameUrl);\n    }\n    if (this.state.liveGame === liveGame) {\n      return;\n    }\n    this.setState({liveGame});\n  };\n\n  selectLiveTournament = liveTournament => {\n    let tournamentUrl;\n    if (liveTournament) {\n      tournamentUrl = `/tournament/${liveTournament.id}`;\n    } else {\n      tournamentUrl = `/lobby`;\n    }\n    if (tournamentUrl !== this.props.location.pathname) {\n      this.props.history.push(tournamentUrl);\n    }\n    if (this.state.liveTournament === liveTournament) {\n      return;\n    }\n    this.setState({liveTournament});\n  };\n\n  selectLiveChallenge = liveChallenge => {\n    let challengeUrl;\n    if (liveChallenge) {\n      challengeUrl = `/challenge/${liveChallenge.id}`;\n    } else {\n      challengeUrl = `/lobby`;\n    }\n    if (challengeUrl !== this.props.location.pathname) {\n      this.props.history.push(challengeUrl);\n    }\n    if (this.state.liveChallenge === liveChallenge) {\n      return;\n    }\n    this.setState({liveChallenge});\n  };\n\n  toggleParticipation = tournament => {\n    const {user, client} = this.props;\n\n    if (tournament.userIds.includes(user.id)) {\n      client.leaveTournament(tournament);\n    } else {\n      client.joinTournament(tournament);\n    }\n  };\n\n  startTournament = tournament => {\n    const {client} = this.props;\n\n    client.startTournament(tournament);\n  };\n\n  abortTournament = tournament => {\n    const {client} = this.props;\n\n    client.abortTournament(tournament);\n  };\n\n  componentDidUpdate(prevProps) {\n    this.askForNotificationPermissionOnWaitForGame(prevProps);\n    this.navigateToMyNewGame(prevProps);\n    this.notifyAboutMyMove(prevProps);\n  }\n\n  askForNotificationPermissionOnWaitForGame(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return;\n    }\n    if ((!prevProps.user || !prevProps.user.readyToPlay) && (user && user.readyToPlay) && user.settings.enableNotifications) {\n      services.notifications.requestPermission();\n    }\n  }\n\n  navigateToMyNewGame(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return\n    }\n\n    if (prevProps.gamesInfo.myLive === this.props.gamesInfo.myLive) {\n      return;\n    }\n\n    if (this.state.liveGame && !this.state.liveGame.finished) {\n      return;\n    }\n\n    const previousMyLiveGameIds = new Set(prevProps.gamesInfo.myLive.map(game => game.id));\n    const myLiveGameIds = this.props.gamesInfo.myLive.map(game => game.id);\n    const newMyLiveGameIds = myLiveGameIds.filter(id => !previousMyLiveGameIds.has(id));\n    if (newMyLiveGameIds.length !== 1) {\n      return;\n    }\n\n    const newGame = this.props.gamesInfo.byId[newMyLiveGameIds[0]];\n    if (newGame.move === 1) {\n      const otherUserId = newGame.userIds[0] === user.id ? newGame.userIds[1] : (newGame.userIds[1] === user.id ? newGame.userIds[0] : null);\n      const otherUser = this.props.usersInfo.byId[otherUserId];\n      services.notifications.notify(otherUser ? `New game vs ${otherUser.name} started` : `New game started`);\n    }\n    if (newGame.move === 1) {\n      this.selectLiveGame(newGame);\n    }\n  }\n\n  notifyAboutMyMove(prevProps) {\n    const user = this.props.user;\n    if (!user) {\n      return;\n    }\n    if (!this.props.gamesInfo.myLive.length) {\n      return;\n    }\n    const gamesThatChangedToMyTurn = this.props.gamesInfo.myLive\n      .filter(game => game.nextUserId === user.id)\n      .filter(game => {\n        const prevGame = prevProps.gamesInfo.byId[game.id];\n        return prevGame && prevGame.nextUserId !== user.id;\n      });\n    if (!gamesThatChangedToMyTurn.length) {\n      return;\n    }\n\n    const otherUsers = gamesThatChangedToMyTurn.map(game => {\n      const otherUserId = game.userIds[0] === user.id ? game.userIds[1] : (game.userIds[1] === user.id ? game.userIds[0] : null);\n      const otherUser = this.props.usersInfo.byId[otherUserId];\n      return otherUser;\n    });\n    const otherUser = otherUsers.length === 1 ? otherUsers[0] : null;\n    services.notifications.notify(otherUser ? `Your turn at game vs ${otherUser.name}` : `It's your turn to play in ${gamesThatChangedToMyTurn.length}`, {\n      tag: 'your-turn',\n      body: `It's your turn to play in ${gamesThatChangedToMyTurn.length} games`,\n    });\n  }\n\n  render() {\n    const {liveGame, liveTournament, liveChallenge} = this.state;\n    const {connected, disconnected, available, user, usersInfo: {byId: usersById}} = this.props;\n    const playerA = liveGame ? usersById[liveGame.userIds[0]] : null;\n    const playerB = liveGame ? usersById[liveGame.userIds[1]] : null;\n    const isUserPlayerA = (user && playerA) ? playerA.id === user.id : false;\n    const isUserPlayerB = (user && playerB) ? playerB.id === user.id : false;\n    const isMyGame = isUserPlayerA || isUserPlayerB;\n    const onlineGameLabel = (liveGame && playerA && playerB)\n      ? (liveGame.finished\n        ? `Review ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`\n        : (isMyGame\n          ? `Live Play ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`\n          : `Spectate ${isUserPlayerA ? 'you' : playerA.name} vs ${isUserPlayerB ? 'you' : playerB.name}`))\n      : 'Live Play/Spectate/Review';\n    const isMyTournament = (liveTournament && user) ? liveTournament.userIds.includes(user.id) : false;\n    const onlineTournamentLabel = liveTournament\n      ? (liveTournament.finished\n        ? `Review tournament ${liveTournament.name}`\n        : (isMyTournament\n          ? `Live tournament ${liveTournament.name}`\n          : `Spectate tournament ${liveTournament.name}`))\n      : 'Tournaments';\n    return (\n      <Container>\n        <SvgBoardBackground.Definitions />\n        <Segment textAlign={\"center\"}>\n          <Header as={\"h1\"}>Thyra Online</Header>\n          <Settings/>\n          <LogIn client={client} />\n          {user ? <EditUser client={client} user={user} trigger={<Label as={'a'} icon={'edit'} content={'Edit'}/>} /> : null}\n          <LogOut client={client} />\n        </Segment>\n        {!connected ? (\n          (disconnected || !available) ? (\n            <Message\n              negative\n              header={'Trying to connect ot server...'}\n              content={<p>The server seems to be experiencing problems, or maybe it's a bit slow. It will connect as soon as possible</p>}\n            />\n          ) : (\n            <Message\n              header={'Connecting to server...'}\n              content={<p>Please sit tight as we're trying to connect to the server</p>}\n            />\n          )\n        ) : null}\n        <NavigationalTab menu={{pointing: true, attached: false, stackable: true}} panes={[\n          client.available ? {menuItem: {icon: 'users', content: 'Lobby'}, path: 'lobby', render: () => (\n            <Tab.Pane><Lobby selectLiveGame={this.selectLiveGame} selectLiveTournament={this.selectLiveTournament} selectLiveChallenge={this.selectLiveChallenge} /></Tab.Pane>\n          )} : null,\n          client.available ? {menuItem: {icon: 'play', content: onlineGameLabel}, path: 'game', navigate: liveGame ? `game/${liveGame.id}` : 'game', render: () => (\n            <Tab.Pane><OnlineGame game={liveGame} selectLiveGame={this.selectLiveGame} /></Tab.Pane>\n          )} : null,\n          client.available ? {menuItem: {icon: 'sitemap', content: onlineTournamentLabel}, path: 'tournament', navigate: liveTournament ? `tournament/${liveTournament.id}` : 'tournament', render: () => (\n            <Tab.Pane>\n              <OnlineTournament\n                tournament={liveTournament}\n                selectLiveTournament={this.selectLiveTournament}\n                selectLiveGame={this.selectLiveGame}\n                toggleParticipation={this.toggleParticipation}\n                startTournament={this.startTournament}\n                abortTournament={this.abortTournament}\n              />\n            </Tab.Pane>\n          )} : null,\n          {menuItem: {icon: 'retweet', content: 'Hotseat'}, path: 'hotseat', render: () => (\n            <Tab.Pane><Hotseat /></Tab.Pane>\n          )},\n          (process.env.REACT_APP_DEBUG || (user && user.admin)) ? {menuItem: {icon: 'shield', content: liveChallenge ? (\n            liveChallenge.options.type === 'mate'\n              ? `Find mate in ${liveChallenge.options.typeOptions.mateIn}`\n              : 'Unknown challenge'\n          ) : 'Challenges'}, path: 'challenge', navigate: liveChallenge ? `challenge/${liveChallenge.id}` : 'challenge', render: () => (\n            <Tab.Pane><Challenges challenge={liveChallenge} selectLiveChallenge={this.selectLiveChallenge} /></Tab.Pane>\n          )} : null,\n          {menuItem: {icon: 'book', content: 'Learn To Play'}, path: 'learn-to-play', render: () => (\n            <Tab.Pane><LearnToPlay /></Tab.Pane>\n          )},\n        ]} />\n        <Header as={\"h6\"} style={{color: '#dddddd'}}>{process.env.REACT_APP_VERSION || '?'}</Header>\n      </Container>\n    );\n  }\n}\n\nApp.propTypes = {\n  location: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  user: PropTypes.object,\n  usersInfo: PropTypes.object.isRequired,\n};\n\nexport default withRouter(withClient(App));\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {BrowserRouter, Route, Switch} from \"react-router-dom\";\n\nReactDOM.render((\n  <BrowserRouter basename={process.env.REACT_APP_PAGE_BASE_PATH}>\n    <Switch>\n      <Route>\n        <App />\n      </Route>\n    </Switch>\n  </BrowserRouter>\n), document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}